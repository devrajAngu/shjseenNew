!function(){"use strict";var t,$=tinymce.util.Tools.resolve("tinymce.PluginManager");let I=0;const e=t=>e=>typeof e===t,r=e=>{return"string"==(o=typeof(e=e),null===e?"null":"object"==o&&Array.isArray(e)?"array":"object"==o&&(e=e,(t=String).prototype.isPrototypeOf(e)||(null==(e=e.constructor)?void 0:e.name)===t.name)?"string":o);var t,o},V=e("boolean"),m=e=>null==e,c=e=>!m(e),i=e("function"),j=e("number"),o=e=>()=>e,a=o(!1);class d{constructor(e,t){this.tag=e,this.value=t}static some(e){return new d(!0,e)}static none(){return d.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?d.some(e(this.value)):d.none()}bind(e){return this.tag?e(this.value):d.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:d.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return c(e)?d.some(e):d.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}d.singletonNone=new d(!1);const q=Array.prototype.indexOf,l=(e,t)=>{return e=e,t=t,-1<q.call(e,t)},n=(t,o)=>{const r=t.length,n=new Array(r);for(let e=0;e<r;e++){const r=t[e];n[e]=o(r,e)}return n},s=(o,r)=>{for(let e=0,t=o.length;e<t;e++)r(o[e],e)},F=Object.keys,u=("undefined"!=typeof window||Function("return this;")(),e=>e.dom.nodeName.toLowerCase()),p=e=>e.dom.nodeType,g=t=>e=>p(e)===t,h=g(1),f=g(3),H=g(9),z=g(11),v=(e,t,o)=>{if(!(r(o)||V(o)||j(o)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,o+"")},y=(e,t)=>{e=e.dom.getAttribute(t);return null===e?void 0:e},w=(e,t)=>d.from(y(e,t)),b=(e,t)=>{e.dom.removeAttribute(t)},N=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},T={fromHtml:(e,t)=>{t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return N(t.childNodes[0])},fromTag:(e,t)=>{t=(t||document).createElement(e);return N(t)},fromText:(e,t)=>{t=(t||document).createTextNode(e);return N(t)},fromDom:N,fromPoint:(e,t,o)=>d.from(e.dom.elementFromPoint(t,o)).map(N)},A=(e,t)=>{var o=e.dom;if(1!==o.nodeType)return!1;{const e=o;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},K=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,U=A,Y=(t=/^\s+|\s+$/g,e=>e.replace(t,"")),C=e=>void 0!==e.style&&i(e.style.getPropertyValue),_=e=>H(e)?e:T.fromDom(e.dom.ownerDocument),S=e=>d.from(e.dom.parentNode).map(T.fromDom),G=e=>d.from(e.dom.nextSibling).map(T.fromDom),x=e=>n(e.dom.childNodes,T.fromDom),J=i(Element.prototype.attachShadow)&&i(Node.prototype.getRootNode)?e=>T.fromDom(e.dom.getRootNode()):_,Q=e=>T.fromDom(e.dom.host),W=e=>{const t=f(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;const o=t.ownerDocument;return e=T.fromDom(t),e=J(e),(z(r=e)&&c(r.dom.host)?d.some(e):d.none()).fold(()=>o.body.contains(t),(n=W,a=Q,e=>n(a(e))));var r,n,a},X=(e,t)=>C(e)?e.style.getPropertyValue(t):"",D=(t,o)=>{S(t).each(e=>{e.dom.insertBefore(o.dom,t.dom)})},Z=(e,t)=>{G(e).fold(()=>{S(e).each(e=>{E(e,t)})},e=>{D(e,t)})},E=(e,t)=>{e.dom.appendChild(t.dom)},ee=(o,r)=>{s(r,(e,t)=>{t=0===t?o:r[t-1];Z(t,e)})},te=(e,t)=>{let o=[];return s(x(e),e=>{o=(o=t(e)?o.concat([e]):o).concat(te(e,t))}),o},oe=(e,t,o)=>{let r=e.dom;for(var n=i(o)?o:a;r.parentNode;){r=r.parentNode;const e=T.fromDom(r);if(t(e))return d.some(e);if(n(e))break}return d.none()},re=e=>{e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},ne=(e,t,o)=>oe(e,e=>A(e,t),o),ae=(e,t)=>{return t=t,e=void 0===e?document:e.dom,K(e)?d.none():d.from(e.querySelector(t)).map(T.fromDom)},ie=(o=>{const t=e=>o(e)?d.from(e.dom.nodeValue):d.none();return{get:e=>{if(o(e))return t(e).getOr("");throw new Error("Can only get text value of a text node")},getOption:t,set:(e,t)=>{if(!o(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=t}}})(f);var de=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];const le=(e,t)=>({element:e,offset:t}),se=(t,e,o)=>t.property().isText(e)&&0===t.property().getText(e).trim().length||t.property().isComment(e)?o(e).bind(e=>se(t,e,o).orThunk(()=>d.some(e))):d.none(),me=(e,t)=>(e.property().isText(t)?e.property().getText(t):e.property().children(t)).length,ce=(e,t)=>{var o,t=se(e,t,e.query().prevSibling).getOr(t);return!e.property().isText(t)&&0<(o=e.property().children(t)).length?ce(e,o[o.length-1]):le(t,me(e,t))},ue=ce,pe={up:o({selector:ne,closest:(e,t,o)=>{return r=ne,o=o,n=e=e,a=t=t,A(n,a)?d.some(e):i(o)&&o(e)?d.none():r(e,t,o);var r,n,a},predicate:oe,all:(e,t)=>{var o=i(t)?t:a;let r=e.dom;for(var n=[];null!==r.parentNode&&void 0!==r.parentNode;){const e=r.parentNode,t=T.fromDom(e);if(n.push(t),!0===o(t))break;r=e}return n}}),down:o({selector:(e,t)=>{return t=t,e=void 0===e?document:e.dom,K(e)?[]:n(e.querySelectorAll(t),T.fromDom)},predicate:te}),styles:o({get:(e,t)=>{var o=e.dom,r=window.getComputedStyle(o).getPropertyValue(t);return""!==r||W(e)?r:X(o,t)},getRaw:(e,t)=>{e=e.dom,e=X(e,t);return d.from(e).filter(e=>0<e.length)},set:(e,t,o)=>{e=e.dom;if(!r(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);C(e)&&e.style.setProperty(t,o)},remove:(e,t)=>{var o,r;r=e.dom,t=t,C(r)&&r.style.removeProperty(t),o=(e,t)=>e===t,w(e,"style").map(Y).exists(e=>o(e,""))&&b(e,"style")}}),attrs:o({get:y,set:(e,t,o)=>{v(e.dom,t,o)},remove:b,copyTo:(e,t)=>{e=e.dom.attributes,o=(e,t)=>(e[t.name]=t.value,e),r={},s(e,(e,t)=>{r=o(r,e)});var o,r,e=r;{const l=t.dom;var n,a=e,i=F(a);for(let e=0,t=i.length;e<t;e++){var d=i[e];n=a[d],d=d,v(l,d,n)}}}}),insert:o({before:D,after:Z,afterAll:ee,append:E,appendAll:(t,e)=>{s(e,e=>{E(t,e)})},prepend:(t,o)=>{var e;e=(e=t).dom.childNodes,d.from(e[0]).map(T.fromDom).fold(()=>{E(t,o)},e=>{t.dom.insertBefore(o.dom,e.dom)})},wrap:(e,t)=>{D(e,t),E(t,e)}}),remove:o({unwrap:e=>{var t=x(e);0<t.length&&ee(e,t),re(e)},remove:re}),create:o({nu:T.fromTag,clone:e=>T.fromDom(e.dom.cloneNode(!1)),text:T.fromText}),query:o({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:e=>d.from(e.dom.previousSibling).map(T.fromDom),nextSibling:G}),property:o({children:x,name:u,parent:S,document:e=>_(e).dom,isText:f,isComment:e=>8===p(e)||"#comment"===u(e),isElement:h,isSpecial:e=>{e=u(e);return l(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],e)},getLanguage:e=>h(e)?w(e,"lang"):d.none(),getText:e=>ie.get(e),setText:(e,t)=>ie.set(e,t),isBoundary:e=>!!h(e)&&("body"===u(e)||l(de,u(e))),isEmptyTag:e=>!!h(e)&&l(["br","img","hr","input"],u(e)),isNonEditable:e=>h(e)&&"false"===y(e,"contenteditable")}),eq:(e,t)=>e.dom===t.dom,is:U},M="details",ge="mce-accordion",P="mce-accordion-summary",k="mce-accordion-body",he="div";var fe=tinymce.util.Tools.resolve("tinymce.util.Tools");const B=e=>"SUMMARY"===(null==e?void 0:e.nodeName),ve=e=>"DETAILS"===(null==e?void 0:e.nodeName),ye=e=>e.hasAttribute("open"),we=e=>{var t=e.selection.getNode();return B(t)||Boolean(e.dom.getParent(t,B))},be=e=>!we(e)&&e.dom.isEditable(e.selection.getNode()),O=e=>d.from(e.dom.getParent(e.selection.getNode(),ve)),Ne=e=>(e.innerHTML='<br data-mce-bogus="1" />',e),Te=e=>Ne(e.dom.create("p")),Ae=n=>e=>{var t,o,r;t=n,o=e,B(null==o?void 0:o.lastChild)&&(r=Te(t),o.appendChild(r),t.selection.setCursorLocation(r,0)),o=n,t=e,B(null==t?void 0:t.firstChild)||(r=o,r=Ne(r.dom.create("summary")),t.prepend(r),o.selection.setCursorLocation(r,0))},Ce=(e,t)=>{t=null!=t?t:!ye(e);return t?e.setAttribute("open","open"):e.removeAttribute("open"),t},Se=l=>{l.addCommand("InsertAccordion",()=>{var e,o=l;if(be(o)){const t=T.fromDom(o.getBody()),r=(e=(new Date).getTime(),"acc_"+Math.floor(1e9*Math.random())+ ++I+String(e)),n=o.dom.encode(o.selection.getRng().toString()||o.translate("Accordion summary...")),a=o.dom.encode(o.translate("Accordion body...")),i=`<summary class="${P}">${n}</summary>`,d=`<div class="${k}"><p>${a}</p></div>`;o.undoManager.transact(()=>{o.insertContent([`<details data-mce-id="${r}" class="${ge}" open="open">`,i,d,"</details>"].join("")),ae(t,`[data-mce-id="${r}"]`).each(e=>{b(e,"data-mce-id"),ae(e,"summary").each(e=>{var t=o.dom.createRng(),e=ue(pe,e);t.setStart(e.element.dom,e.offset),t.setEnd(e.element.dom,e.offset),o.selection.setRng(t)})})})}}),l.addCommand("ToggleAccordion",(e,t)=>{var r,n;r=l,n=t,O(r).each(e=>{var t,o;t=r,o=e,e=Ce(e,n),t.dispatch("ToggledAccordion",{element:o,state:e})})}),l.addCommand("ToggleAllAccordions",(e,t)=>{var o,r;o=l,r=t,0!==(t=Array.from(o.getBody().querySelectorAll("details"))).length&&(s(t,e=>Ce(e,null!=r?r:!ye(e))),o.dispatch("ToggledAllAccordions",{elements:t,state:r}))}),l.addCommand("RemoveAccordion",()=>{var n;n=l,O(n).each(e=>{var t,o,r=e["nextSibling"];r?(n.selection.select(r,!0),n.selection.collapse(!0)):(r=n,t=e,o=Te(r),t.insertAdjacentElement("afterend",o),r.selection.setCursorLocation(o,0)),e.remove()})})};var L=tinymce.util.Tools.resolve("tinymce.html.Node");const R=e=>{return null!=(e=null==(e=e.attr("class"))?void 0:e.split(" "))?e:[]},xe=(e,t)=>{t=new Set([...R(e),...t]),t=Array.from(t);0<t.length&&e.attr("class",t.join(" "))},De=e=>e.name===M&&l(R(e),ge),Ee=e=>{var t=e.children();let o,r;var n,a=[];for(let e=0;e<t.length;e++){var i=t[e];"summary"===i.name&&m(o)?o=i:(n=i).name===he&&l(R(n),k)&&m(r)?r=i:a.push(i)}return{summaryNode:o,wrapperNode:r,otherNodes:a}},Me=e=>{var t=new L("br",1);t.attr("data-mce-bogus","1"),e.empty(),e.append(t)};var Pe=tinymce.util.Tools.resolve("tinymce.util.VK");const ke=o=>e=>{const t=()=>e.setEnabled(be(o));return o.on("NodeChange",t),()=>o.off("NodeChange",t)};$.add("accordion",e=>{var o,t,r,n,a;a=()=>n.execCommand("InsertAccordion"),(n=e).ui.registry.addButton("accordion",{icon:"accordion",tooltip:"Insert accordion",onSetup:ke(n),onAction:a}),n.ui.registry.addMenuItem("accordion",{icon:"accordion",text:"Accordion",onSetup:ke(n),onAction:a}),n.ui.registry.addToggleButton("accordiontoggle",{icon:"accordion-toggle",tooltip:"Toggle accordion",onAction:()=>n.execCommand("ToggleAccordion")}),n.ui.registry.addToggleButton("accordionremove",{icon:"remove",tooltip:"Delete accordion",onAction:()=>n.execCommand("RemoveAccordion")}),n.ui.registry.addContextToolbar("accordion",{predicate:e=>n.dom.is(e,"details")&&n.getBody().contains(e)&&n.dom.isEditable(e.parentNode),items:"accordiontoggle accordionremove",scope:"node",position:"node"}),Se(e),(r=t=e).on("keydown",e=>{!e.shiftKey&&e.keyCode===Pe.ENTER&&we(r)&&(e.preventDefault(),r.execCommand("ToggleAccordion"))}),t.on("ExecCommand",e=>{var e=e.command.toLowerCase();"delete"!==e&&"forwarddelete"!==e||(e=t,!O(e).isSome())||(e=t,fe.each(fe.grep(e.dom.select("details",e.getBody())),Ae(e)))}),(o=e).on("PreInit",()=>{var{serializer:e,parser:t}=o;t.addNodeFilter(M,t=>{for(let e=0;e<t.length;e++){var o=t[e];if(De(o)){const t=o,{summaryNode:a,wrapperNode:i,otherNodes:d}=Ee(t),l=c(a),s=l?a:new L("summary",1);m(s.firstChild)&&Me(s),xe(s,[P]),l||(c(t.firstChild)?t.insert(s,t.firstChild,!0):t.append(s));var o=c(i),r=o?i:new L(he,1);if(xe(r,[k]),0<d.length)for(let e=0;e<d.length;e++){var n=d[e];r.append(n)}if(m(r.firstChild)){const t=new L("p",1);Me(t),r.append(t)}o||t.append(r)}}}),e.addNodeFilter(M,t=>{var a,o,r=new Set([P]);for(let e=0;e<t.length;e++){var n=t[e];if(De(n)){const t=n,{summaryNode:i,wrapperNode:d}=Ee(t);c(i)&&(n=i,a=r,o=void 0,o=(o=>{var r=[];for(let e=0,t=o.length;e<t;e++){var n=o[e];a.has(n)||r.push(n)}return r})(R(n)),n.attr("class",0<o.length?o.join(" "):null)),c(d)&&d.unwrap()}}})})})}();