!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager");const e=n=>t=>{return r=typeof(t=t),(null===t?"null":"object"==r&&Array.isArray(t)?"array":"object"==r&&(t=t,(e=String).prototype.isPrototypeOf(t)||(null==(t=t.constructor)?void 0:t.name)===e.name)?"string":r)===n;var e,r},r=e=>t=>typeof t===e,n=e("string"),o=e("object"),s=t=>null===t,a=r("boolean"),l=r("number");class i{constructor(t,e){this.tag=t,this.value=e}static some(t){return new i(!0,t)}static none(){return i.singletonNone}fold(t,e){return this.tag?e(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?i.some(t(this.value)):i.none()}bind(t){return this.tag?t(this.value):i.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:i.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(null!=t?t:"Called getOrDie on None")}static from(t){return null==t?i.none():i.some(t)}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}i.singletonNone=new i(!1);const u=(r,n)=>{for(let t=0,e=r.length;t<e;t++)n(r[t],t)},c=Object.keys,d=(r,n)=>{var o=c(r);for(let t=0,e=o.length;t<e;t++){var s=o[t];n(r[s],s)}},h="undefined"!=typeof window?window:Function("return this;")(),m=(t,r)=>{{var n=t.split(".");let e=null!=r?r:h;for(let t=0;t<n.length&&null!=e;++t)e=e[n[t]];return e}},g=Object.getPrototypeOf,v=t=>{var e=m("ownerDocument.defaultView",t);return o(t)&&((t=>{var e="HTMLElement";if(t=t,null==(t=m("HTMLElement",t)))throw new Error(e+" not available on this browser");return t})(e).prototype.isPrototypeOf(t)||/^HTML\w*Element$/.test(g(t).constructor.name))},f=t=>t.dom.nodeValue,p=e=>t=>t.dom.nodeType===e,b=t=>w(t)&&v(t.dom),w=p(1),_=p(3),y=(t,e,r)=>{t=t.dom;if(!(n(r)||a(r)||l(r)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,r+"")},A=(t,e)=>{t.dom.removeAttribute(e)},k=(t,e)=>{e=null===(t=t.dom.getAttribute(e))?void 0:t;return void 0===e||""===e?[]:e.split(" ")},N=t=>void 0!==t.dom.classList,T=t=>{if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},E={" ":"nbsp","­":"shy"},C=(t,e)=>{let r="";return d(t,(t,e)=>{r+=e}),new RegExp("["+r+"]",e?"g":"")},D=C(E),H=C(E,!0),I=(t=>{let e="";return d(t,t=>{e&&(e+=","),e+="span.mce-"+t}),e})(E),O="mce-nbsp",L=t=>t.dom.contentEditable,$=t=>'<span data-mce-bogus="1" class="mce-'+E[t]+'">'+t+"</span>",V=t=>"span"===t.nodeName.toLowerCase()&&t.classList.contains("mce-nbsp-wrap"),F=t=>{var e=f(t);return _(t)&&n(e)&&D.test(e)},j=(t,r,n)=>{let o=[];t=((e,r)=>{const n=e.length,o=new Array(n);for(let t=0;t<n;t++){const n=e[t];o[t]=r(n,t)}return o})(t.dom.childNodes,T);return u(t,t=>{var e;o=(o=n&&(V((e=t).dom)||(e=e,!b(e))||"false"!==L(e))&&r(t)?o.concat([t]):o).concat(j(t,r,((t,e)=>{if(b(t)&&!V(t.dom)){const e=L(t);if("true"===e)return!0;if("false"===e)return!1}return e})(t,n)))}),o},B=(s,t)=>{const a=s.dom,e=j(T(t),F,s.dom.isEditable(t));u(e,t=>{var e,r,n;const o=t.dom.parentNode;if(V(o))r=T(o),n=O,N(r)?r.dom.classList.add(n):(r=r,n=n,n=k(r,"class").concat([n]),y(r,"class",n.join(" ")));else{const o=a.encode(null!=(n=f(t))?n:"").replace(H,$),r=a.create("div",{},o);for(;e=r.lastChild;)a.insertAfter(e,t.dom);s.dom.remove(t.dom)}})},S=(a,t)=>{t=a.dom.select(I,t);u(t,t=>{var e,r,n,s,o;V(t)?(e=T(t),o=O,N(e)?e.dom.classList.remove(o):(r=e,n="class",s=o,0<(o=(r=>{var n=[];for(let t=0,e=r.length;t<e;t++){var o=r[t];o!==s&&n.push(o)}return n})(k(r,n))).length?y(r,n,o.join(" ")):A(r,n)),o=e,0===(N(o)?o.dom.classList:(r=o,k(r,"class"))).length&&A(o,"class")):a.dom.remove(t,!0)})},M=t=>{var e=t.getBody(),r=t.selection.getBookmark(),n=void 0!==(n=((t,e)=>{for(;t.parentNode;){if(t.parentNode===e)return e;t=t.parentNode}})(t.selection.getNode(),e))?n:e;S(t,n),B(t,n),t.selection.moveToBookmark(r)},x=(t,e)=>{n=t,r=e.get(),n.dispatch("VisualChars",{state:r});var r,n=t.getBody();(!0===e.get()?B:S)(t,n)},K=t=>t.options.get("visualchars_default_state"),R=(r,e)=>{const n=(()=>{let e=null;return{cancel:()=>{s(e)||(clearTimeout(e),e=null)},throttle:(...t)=>{s(e)&&(e=setTimeout(()=>{e=null,(()=>{M(r)}).apply(null,t)},300))}}})();r.on("keydown",t=>{!0===e.get()&&(13===t.keyCode?M(r):n.throttle())}),r.on("remove",n.cancel)},P=(r,n)=>e=>{e.setActive(n.get());const t=t=>e.setActive(t.state);return r.on("VisualChars",t),()=>r.off("VisualChars",t)};t.add("visualchars",t=>{(0,t.options.register)("visualchars_default_state",{processor:"boolean",default:!1});var e,r,n,o,s,a,l,i,u=(()=>{let e=K(t);return{get:()=>e,set:t=>{e=t}}})();return i=u,(l=t).addCommand("mceVisualChars",()=>{var t,e,r;t=l,(e=i).set(!e.get()),r=t.selection.getBookmark(),x(t,e),t.selection.moveToBookmark(r)}),s=u,a=()=>o.execCommand("mceVisualChars"),(o=t).ui.registry.addToggleButton("visualchars",{tooltip:"Show invisible characters",icon:"visualchars",onAction:a,onSetup:P(o,s)}),o.ui.registry.addToggleMenuItem("visualchars",{text:"Show invisible characters",icon:"visualchars",onAction:a,onSetup:P(o,s)}),R(t,u),n=u,(r=t).on("init",()=>{x(r,n)}),e=u,{isEnabled:()=>e.get()}})}();