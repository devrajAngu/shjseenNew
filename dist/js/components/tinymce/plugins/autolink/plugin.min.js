!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");const t=t=>e=>e.options.get(t),g=t("autolink_pattern"),i=t("link_default_target"),m=t("link_default_protocol"),d=t("allow_unsafe_link_target"),c=e=>{return"string"==(o=typeof(e=e),null===e?"null":"object"==o&&Array.isArray(e)?"array":"object"==o&&(e=e,(t=String).prototype.isPrototypeOf(e)||(null==(e=e.constructor)?void 0:e.name)===t.name)?"string":o);var t,o},k=e=>void 0===e,n=e=>!(null==e),p=Object.hasOwnProperty;var v=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker");const y=e=>/^[(\[{ \u00a0]$/.test(e),w=(t,o,n)=>{for(let e=o-1;0<=e;e--){const o=t.charAt(e);if("\ufeff"!==o&&n(o))return e}return-1},r=(t,n)=>{const r=t.schema.getVoidElements(),e=g(t),{dom:a,selection:o}=t;if(null===a.getParent(o.getNode(),"a[href]")){const s=o.getRng(),i=v(a,e=>{return a.isBlock(e)||(t=r,o=e.nodeName.toLowerCase(),p.call(t,o))||"false"===a.getContentEditable(e);var t,o}),{container:d,offset:c}=(()=>{let e=s.endContainer,t=s.endOffset;for(;1===e.nodeType&&e.childNodes[t];)e=e.childNodes[t],t=(3===e.nodeType?e.data:e.childNodes).length;return{container:e,offset:t}})(),u=null!=(l=a.getParent(d,a.isBlock))?l:a.getRoot(),f=i.backwards(d,c+n,(e,t)=>{var o,e=e.data,t=w(e,t,(o=y,e=>!o(e)));return-1===t||(e=e[t],/[?!,.;:]/.test(e))?t:t+1},u);if(f){let o=f.container;var l=i.backwards(f.container,f.offset,(e,t)=>{o=e;e=w(e.data,t,y);return-1===e?e:e+1},u),n=a.createRng(),l=(l?n.setStart(l.container,l.offset):n.setStart(o,0),n.setEnd(f.container,f.offset),n.toString().replace(/\uFEFF/g,"").match(e));if(l){let e=l[0];return 4<=(l=e).length&&"www."===l.substr(0,4)?e=m(t)+"://"+e:-1===(l=e.indexOf("@",0))||!k(void 0)&&!(l+"@".length<=void 0)||/^([A-Za-z][A-Za-z\d.+-]*:\/\/)|mailto:/.test(e)||(e="mailto:"+e),{rng:n,url:e}}}}return null},a=(e,t)=>{var{dom:o,selection:n}=e,{rng:t,url:r}=t,a=n.getBookmark(),l=(n.setRng(t),"createlink"),s={command:l,ui:!1,value:r};if(!e.dispatch("BeforeExecCommand",s).isDefaultPrevented()){e.getDoc().execCommand(l,!1,r),e.dispatch("ExecCommand",s);const t=i(e);if(c(t)){const i=n.getNode();o.setAttrib(i,"target",t),"_blank"!==t||d(e)||o.setAttrib(i,"rel","noopener")}}n.moveToBookmark(a),e.nodeChanged()},l=e=>{var t=r(e,-1);n(t)&&a(e,t)},s=l;e.add("autolink",e=>{var o,t;(t=e.options.register)("autolink_pattern",{processor:"regexp",default:new RegExp("^"+/(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)[A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*(?::\d+)?(?:\/(?:[-.~*+=!;:'%@$(),\/\w]*[-~*+=%@$()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?/g.source+"$","i")}),t("link_default_target",{processor:"string"}),t("link_default_protocol",{processor:"string",default:"https"}),(o=e).on("keydown",e=>{var t;13!==e.keyCode||e.isDefaultPrevented()||(e=o,t=r(e,0),n(t)&&a(e,t))}),o.on("keyup",e=>{32===e.keyCode?l(o):(48===e.keyCode&&e.shiftKey||221===e.keyCode)&&s(o)})})}();