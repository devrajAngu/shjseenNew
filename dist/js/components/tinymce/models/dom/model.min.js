!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.ModelManager");const o=o=>e=>{return r=typeof(e=e),(null===e?"null":"object"==r&&Array.isArray(e)?"array":"object"==r&&(e=e,(t=String).prototype.isPrototypeOf(e)||(null==(e=e.constructor)?void 0:e.name)===t.name)?"string":r)===o;var t,r},n=t=>e=>typeof e===t,l=t=>e=>t===e,u=o("string"),$=o("object"),i=o("array"),U=l(null),s=n("boolean"),a=l(void 0),m=e=>!(null==e),G=n("function"),K=n("number"),f=()=>{},h=e=>()=>e,p=e=>e;function D(t,...r){return(...e)=>{e=r.concat(e);return t.apply(null,e)}}const Y=t=>e=>!t(e),J=e=>e(),Q=h(!1),O=h(!0);class v{constructor(e,t){this.tag=e,this.value=t}static some(e){return new v(!0,e)}static none(){return v.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?v.some(e(this.value)):v.none()}bind(e){return this.tag?e(this.value):v.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:v.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return m(e)?v.some(e):v.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}v.singletonNone=new v(!1);const X=Array.prototype.slice,Z=Array.prototype.indexOf,ee=Array.prototype.push,w=(e,t)=>{return e=e,t=t,-1<Z.call(e,t)},b=(r,o)=>{for(let e=0,t=r.length;e<t;e++)if(o(r[e],e))return!0;return!1},k=(t,r)=>{var o=[];for(let e=0;e<t;e++)o.push(r(e));return o},y=(t,r)=>{const o=t.length,n=new Array(o);for(let e=0;e<o;e++){const o=t[e];n[e]=r(o,e)}return n},x=(r,o)=>{for(let e=0,t=r.length;e<t;e++)o(r[e],e)},te=(r,o)=>{var n=[],l=[];for(let e=0,t=r.length;e<t;e++){var s=r[e];(o(s,e)?n:l).push(s)}return{pass:n,fail:l}},C=(r,o)=>{var n=[];for(let e=0,t=r.length;e<t;e++){var l=r[e];o(l,e)&&n.push(l)}return n},re=(e,t,r)=>{var o,n,l=e;for(let e=l.length-1;0<=e;e--)o=l[e],n=e,r=t(r,o,n);return r},oe=(e,r,o)=>(x(e,(e,t)=>{o=r(o,e,t)}),o),ne=(e,t)=>{var r=e,o=t,n=Q;for(let e=0,t=r.length;e<t;e++){var l=r[e];if(o(l,e))return v.some(l);if(n(l,e))break}return v.none()},le=(r,o)=>{for(let e=0,t=r.length;e<t;e++)if(o(r[e],e))return v.some(e);return v.none()},se=r=>{var o=[];for(let e=0,t=r.length;e<t;++e){if(!i(r[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+r);ee.apply(o,r[e])}return o},S=(e,t)=>se(y(e,t)),ae=(r,o)=>{for(let e=0,t=r.length;e<t;++e)if(!0!==o(r[e],e))return!1;return!0},ie=(r,o)=>{var n={};for(let e=0,t=r.length;e<t;e++){var l=r[e];n[String(l)]=o(l,e)}return n},ce=(e,t)=>0<=t&&t<e.length?v.some(e[t]):v.none(),me=e=>ce(e,0),de=e=>ce(e,e.length-1),ue=(t,r)=>{for(let e=0;e<t.length;e++){var o=r(t[e],e);if(o.isSome())return o}return v.none()},fe=Object.keys,ge=Object.hasOwnProperty,T=(r,o)=>{var n=fe(r);for(let e=0,t=n.length;e<t;e++){var l=n[e];o(r[l],l)}},he=(e,r)=>{{var o=(e,t)=>({k:t,v:r(e,t)});const n={};return T(e,(e,t)=>{e=o(e,t);n[e.k]=e.v}),n}},pe=(e,r)=>{const o=[];return T(e,(e,t)=>{o.push(r(e,t))}),o},ve=e=>pe(e,p),we=(e,t)=>ge.call(e,t),be="undefined"!=typeof window?window:Function("return this;")(),ye=(e,r)=>{{var o=e.split(".");let t=null!=r?r:be;for(let e=0;e<o.length&&null!=t;++e)t=t[o[e]];return t}},xe=Object.getPrototypeOf,Ce=e=>{var t=ye("ownerDocument.defaultView",e);return $(e)&&((e=>{var t="HTMLElement";if(e=e,null==(e=ye("HTMLElement",e)))throw new Error(t+" not available on this browser");return e})(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(xe(e).constructor.name))},R=e=>e.dom.nodeName.toLowerCase(),Se=e=>e.dom.nodeType,Te=t=>e=>Se(e)===t,Re=e=>8===Se(e)||"#comment"===R(e),De=e=>Oe(e)&&Ce(e.dom),Oe=Te(1),ke=Te(3),Ee=Te(9),Ne=Te(11),g=t=>e=>Oe(e)&&R(e)===t,Be=(e,t,r)=>{if(!(u(r)||s(r)||K(r)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,r+"")},E=(e,t,r)=>{Be(e.dom,t,r)},_e=(e,t)=>{const r=e.dom;T(t,(e,t)=>{Be(r,t,e)})},ze=(e,t)=>{e=e.dom.getAttribute(t);return null===e?void 0:e},Ae=(e,t)=>v.from(ze(e,t)),N=(e,t)=>{e.dom.removeAttribute(t)},Le=e=>oe(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),We=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},B={fromHtml:(e,t)=>{t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return We(t.childNodes[0])},fromTag:(e,t)=>{t=(t||document).createElement(e);return We(t)},fromText:(e,t)=>{t=(t||document).createTextNode(e);return We(t)},fromDom:We,fromPoint:(e,t,r)=>v.from(e.dom.elementFromPoint(t,r)).map(We)},_=(e,t)=>{var r=e.dom;if(1!==r.nodeType)return!1;{const e=r;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},Me=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,je=(e,t)=>{t=void 0===t?document:t.dom;return Me(t)?v.none():v.from(t.querySelector(e)).map(B.fromDom)},z=(e,t)=>e.dom===t.dom,Pe=(e,t)=>{e=e.dom,t=t.dom;return e!==t&&e.contains(t)},Ie=_,Fe=e=>B.fromDom(e.dom.ownerDocument),He=e=>Ee(e)?e:Fe(e),qe=e=>v.from(e.dom.parentNode).map(B.fromDom),Ve=e=>v.from(e.dom.parentElement).map(B.fromDom),$e=(e,t)=>{var r=G(t)?t:Q;let o=e.dom;for(var n=[];null!==o.parentNode&&void 0!==o.parentNode;){const e=o.parentNode,t=B.fromDom(e);if(n.push(t),!0===r(t))break;o=e}return n},Ue=e=>v.from(e.dom.previousSibling).map(B.fromDom),Ge=e=>v.from(e.dom.nextSibling).map(B.fromDom),d=e=>y(e.dom.childNodes,B.fromDom),Ke=(e,t)=>{e=e.dom.childNodes;return v.from(e[t]).map(B.fromDom)},Ye=(t,r)=>{qe(t).each(e=>{e.dom.insertBefore(r.dom,t.dom)})},Je=(e,t)=>{Ge(e).fold(()=>{qe(e).each(e=>{A(e,t)})},e=>{Ye(e,t)})},Qe=(t,r)=>{var e;e=t,Ke(e,0).fold(()=>{A(t,r)},e=>{t.dom.insertBefore(r.dom,e.dom)})},A=(e,t)=>{e.dom.appendChild(t.dom)},Xe=(e,t)=>{Ye(e,t),A(t,e)},Ze=(r,o)=>{x(o,(e,t)=>{t=0===t?r:o[t-1];Je(t,e)})},et=(t,e)=>{x(e,e=>{A(t,e)})},tt=e=>{e.dom.textContent="",x(d(e),e=>{L(e)})},L=e=>{e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},rt=e=>{var t=d(e);0<t.length&&Ze(e,t),L(e)},ot=(e,t)=>B.fromDom(e.dom.cloneNode(t)),nt=e=>ot(e,!1),lt=e=>ot(e,!0),st=(e,t)=>{t=B.fromTag(t),e=Le(e);return _e(t,e),t},at=["tfoot","thead","tbody","colgroup"],it=(e,t,r)=>({element:e,rowspan:t,colspan:r}),ct=(e,t,r)=>({element:e,cells:t,section:r}),W=(e,t,r)=>({element:e,isNew:t,isLocked:r}),mt=(e,t,r,o)=>({element:e,cells:t,section:r,isNew:o}),dt=G(Element.prototype.attachShadow)&&G(Node.prototype.getRootNode),ut=h(dt),ft=dt?e=>B.fromDom(e.dom.getRootNode()):He,gt=e=>B.fromDom(e.dom.host),ht=e=>{const t=ke(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;const r=t.ownerDocument;return e=B.fromDom(t),e=ft(e),(Ne(o=e)&&m(o.dom.host)?v.some(e):v.none()).fold(()=>r.body.contains(t),(n=ht,l=gt,e=>n(l(e))));var o,n,l},pt=e=>{e=e.dom.body;if(null==e)throw new Error("Body is not available yet");return B.fromDom(e)},vt=(e,t)=>{let r=[];return x(d(e),e=>{r=(r=t(e)?r.concat([e]):r).concat(vt(e,t))}),r},wt=(e,t,r)=>{return e=e,r=r,C($e(e,r),e=>_(e,t))},bt=(e,t)=>{return e=e,C(d(e),e=>_(e,t))},yt=(e,t)=>{return t=t,e=void 0===e?document:e.dom,Me(e)?[]:y(e.querySelectorAll(t),B.fromDom)};var xt,Ct,St,Tt=(e,t,r,o,n)=>e(r,o)?v.some(r):G(n)&&n(r)?v.none():t(r,o,n);const Rt=(e,t,r)=>{let o=e.dom;for(var n=G(r)?r:Q;o.parentNode;){o=o.parentNode;const e=B.fromDom(o);if(t(e))return v.some(e);if(n(e))break}return v.none()},Dt=(e,t,r)=>Tt((e,t)=>t(e),Rt,e,t,r),Ot=(e,t,r)=>Rt(e,e=>_(e,t),r),kt=(e,t)=>{return e=e,ne(e.dom.childNodes,e=>{return e=B.fromDom(e),_(e,t)}).map(B.fromDom)},Et=(e,t)=>je(t,e),M=(e,t,r)=>Tt((e,t)=>_(e,t),Ot,e,t,r),Nt=(e,t,r=(e,t)=>e===t)=>e.exists(e=>r(e,t)),Bt=t=>{const r=[],o=e=>{r.push(e)};for(let e=0;e<t.length;e++)t[e].each(o);return r},_t=(e,t)=>e?v.some(t):v.none(),zt=(e,t,r)=>""===t||e.length>=t.length&&e.substr(r,r+t.length)===t,r=(e,t,r=0,o)=>{e=e.indexOf(t,r);return-1!==e&&(!!a(o)||e+t.length<=o)},At=(e,t)=>zt(e,t,0),Lt=(e,t)=>zt(e,t,e.length-t.length),Wt=(xt=/^\s+|\s+$/g,e=>e.replace(xt,"")),Mt=e=>0<e.length,jt=e=>void 0!==e.style&&G(e.style.getPropertyValue),Pt=(e,t,r)=>{if(!u(r))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",r,":: Element ",e),new Error("CSS value must be a string: "+r);jt(e)&&e.style.setProperty(t,r)},j=(e,t,r)=>{e=e.dom;Pt(e,t,r)},It=(e,t)=>{const r=e.dom;T(t,(e,t)=>{Pt(r,t,e)})},Ft=(e,t)=>{var r=e.dom,o=window.getComputedStyle(r).getPropertyValue(t);return""!==o||ht(e)?o:Ht(r,t)},Ht=(e,t)=>jt(e)?e.style.getPropertyValue(t):"",qt=(e,t)=>{e=e.dom,e=Ht(e,t);return v.from(e).filter(e=>0<e.length)},Vt=(e,t)=>{var r;r=e.dom,t=t,jt(r)&&r.style.removeProperty(t),Nt(Ae(e,"style").map(Wt),"")&&N(e,"style")},$t=(e,t,r=0)=>Ae(e,t).map(e=>parseInt(e,10)).getOr(r),Ut=(e,t)=>$t(e,t,1),Gt=e=>g("col")(e)?1<$t(e,"span",1):1<Ut(e,"colspan"),Kt=e=>1<Ut(e,"rowspan"),Yt=(e,t)=>parseInt(Ft(e,t),10),Jt=h(10),Qt=h(10),Xt=(e,t)=>Zt(e,t,O),Zt=(e,t,r)=>S(d(e),e=>_(e,t)?r(e)?[e]:[]:Zt(e,t,r)),er=(e,t)=>{return[e,t,r=Q]=[["td","th"],e,t],r(t)?v.none():w(e,R(t))?v.some(t):Ot(t,e.join(","),e=>_(e,"table")||r(e));var r},tr=e=>Xt(e,"th,td"),rr=e=>_(e,"colgroup")?bt(e,"col"):S(nr(e),e=>bt(e,"col")),P=(e,t)=>M(e,"table",t),or=e=>Xt(e,"tr"),nr=e=>P(e).fold(h([]),e=>bt(e,"colgroup")),lr=(e,r)=>y(e,e=>{if("colgroup"===R(e)){const r=y(rr(e),e=>{var t=$t(e,"span",1);return it(e,1,t)});return ct(e,r,"colgroup")}var t=y(tr(e),e=>{var t=$t(e,"rowspan",1),r=$t(e,"colspan",1);return it(e,t,r)});return ct(e,t,r(e))}),sr=e=>qe(e).map(e=>{var t,e=R(e);return t=e,w(at,t)?e:"tbody"}).getOr("tbody"),ar=e=>{var t=or(e),e=[...nr(e),...t];return lr(e,sr)},ir=t=>{let r,o=!1;return(...e)=>(o||(o=!0,r=t.apply(null,e)),r)},cr=()=>mr(0,0),mr=(e,t)=>({major:e,minor:t}),dr={nu:mr,detect:(e,t)=>{var t=String(t).toLowerCase();if(0===e.length)return cr();{var r=t;const o=((t,r)=>{for(let e=0;e<t.length;e++){var o=t[e];if(o.test(r))return o}})(e,r);return o?(t=e=>Number(r.replace(o,"$"+e)),mr(t(1),t(2))):{major:0,minor:0}}},unknown:cr},ur=(e,t)=>{const r=String(t).toLowerCase();return ne(e,e=>e.search(r))},fr=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,gr=t=>e=>r(e,t),hr=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>r(e,"edge/")&&r(e,"chrome")&&r(e,"safari")&&r(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,fr],search:e=>r(e,"chrome")&&!r(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>r(e,"msie")||r(e,"trident")},{name:"Opera",versionRegexes:[fr,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:gr("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:gr("firefox")},{name:"Safari",versionRegexes:[fr,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(r(e,"safari")||r(e,"mobile/"))&&r(e,"applewebkit")}],pr=[{name:"Windows",search:gr("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>r(e,"iphone")||r(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:gr("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:gr("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:gr("linux"),versionRegexes:[]},{name:"Solaris",search:gr("sunos"),versionRegexes:[]},{name:"FreeBSD",search:gr("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:gr("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],vr={browsers:h(hr),oses:h(pr)},wr="Chromium",br="Firefox",yr=e=>{const t=e.current,r=e.version,o=e=>()=>t===e;return{current:t,version:r,isEdge:o("Edge"),isChromium:o(wr),isIE:o("IE"),isOpera:o("Opera"),isFirefox:o(br),isSafari:o("Safari")}},xr=()=>yr({current:void 0,version:dr.unknown()}),Cr=yr,Sr=(h("Edge"),h(wr),h("IE"),h("Opera"),h(br),h("Safari"),"Windows"),Tr="Android",Rr="Solaris",Dr="FreeBSD",Or="ChromeOS",kr=e=>{const t=e.current,r=e.version,o=e=>()=>t===e;return{current:t,version:r,isWindows:o(Sr),isiOS:o("iOS"),isAndroid:o(Tr),isMacOS:o("macOS"),isLinux:o("Linux"),isSolaris:o(Rr),isFreeBSD:o(Dr),isChromeOS:o(Or)}},Er=()=>kr({current:void 0,version:dr.unknown()}),Nr=kr,Br=(h(Sr),h("iOS"),h(Tr),h("Linux"),h("macOS"),h(Rr),h(Dr),h(Or),e=>window.matchMedia(e).matches);let _r=ir(()=>{{var t=navigator.userAgent,e=v.from(navigator.userAgentData),r=Br,o,n,l,s,a,i,c;const m=vr.browsers(),d=vr.oses(),u=e.bind(e=>{return o=m,e=e,ue(e.brands,t=>{const r=t.brand.toLowerCase();return ne(o,e=>{return r===(null==(e=e.brand)?void 0:e.toLowerCase())}).map(e=>({current:e.name,version:dr.nu(parseInt(t.version,10),0)}))});var o}).orThunk(()=>{return e=m,r=t,ur(e,r).map(e=>{var t=dr.detect(e.versionRegexes,r);return{current:e.name,version:t}});var e,r}).fold(xr,Cr),f=(e=d,c=t,ur(e,c).map(e=>{var t=dr.detect(e.versionRegexes,c);return{current:e.name,version:t}}).fold(Er,Nr)),g=(e=u,n=t,r=r,l=(o=f).isiOS()&&!0===/ipad/i.test(n),s=o.isiOS()&&!l,a=o.isiOS()||o.isAndroid(),i=a||r("(pointer:coarse)"),r=l||!s&&a&&r("(min-device-width:768px)"),a=s||a&&!r,e=e.isSafari()&&o.isiOS()&&!1===/safari/i.test(n),n=!a&&!r&&!e,{isiPad:h(l),isiPhone:h(s),isTablet:h(r),isPhone:h(a),isTouch:h(i),isAndroid:o.isAndroid,isiOS:o.isiOS,isWebView:h(e),isDesktop:h(n)});return{browser:u,os:f,deviceType:g}}});const zr=()=>_r(),Ar=(r,o)=>{const e=e=>{var t=o(e);if(t<=0||null===t){const o=Ft(e,r);return parseFloat(o)||0}return t},n=(r,e)=>oe(e,(e,t)=>{t=Ft(r,t),t=void 0===t?0:parseInt(t,10);return isNaN(t)?e:e+t},0);return{set:(e,t)=>{if(!K(t)&&!t.match(/^[0-9]+$/))throw new Error(r+".set accepts only positive integer values. Value was "+t);e=e.dom;jt(e)&&(e.style[r]=t+"px")},get:e,getOuter:e,aggregate:n,max:(e,t,r)=>{e=n(e,r);return e<t?t-e:0}}},Lr=(e,t,r)=>{return e=Ft(e,t),t=r,e=parseFloat(e),(isNaN(e)?v.none():v.some(e)).getOr(t)},Wr=Ar("width",e=>e.dom.offsetWidth),Mr=e=>Wr.get(e),jr=e=>Wr.getOuter(e),Pr=e=>{return t=(t=(e=e).dom).getBoundingClientRect().width||t.offsetWidth,e=e,t-Lr(e,"padding-left",0)-Lr(e,"padding-right",0)-Lr(e,"border-left-width",0)-Lr(e,"border-right-width",0);var t},Ir=(e,t,r)=>{var o=e.cells,n=o.slice(0,t),o=o.slice(t),t=n.concat(r).concat(o);return qr(e,t)},Fr=(e,t,r)=>Ir(e,t,[r]),Hr=(e,t,r)=>{e.cells[t]=r},qr=(e,t)=>mt(e.element,t,e.section,e.isNew),Vr=(e,t)=>e.cells[t],I=(e,t)=>Vr(e,t).element,$r=e=>e.cells.length,F=e=>{e=te(e,e=>"colgroup"===e.section);return{rows:e.fail,cols:e.pass}},Ur=(e,t,r)=>{r=y(e.cells,r);return mt(t(e.element),r,e.section,!0)},Gr="data-snooker-locked-cols",Kr=e=>Ae(e,Gr).bind(e=>v.from(e.match(/\d+/g))).map(e=>ie(e,O)),Yr=e=>{e=oe(F(e).rows,(r,e)=>(x(e.cells,(e,t)=>{e.isLocked&&(r[t]=!0)}),r),{}),e=pe(e,(e,t)=>parseInt(t,10));return(e=X.call(e,0)).sort(void 0),e},Jr=(e,t)=>{e=S(e.all,e=>e.cells);return C(e,t)},Qr=e=>{const a={},t=[],i=me(e).map(e=>e.element).bind(P).bind(Kr).getOr({});let r=0,c=0,m=0;var{pass:e,fail:o}=te(e,e=>"colgroup"===e.section),{columns:o,colgroups:e}=(x(o,e=>{const s=[];x(e.cells,r=>{let o=0;for(;void 0!==a[m+","+o];)o++;t=i,l=o.toString();const e=we(t,l)&&void 0!==t[l]&&null!==t[l],n={element:r.element,rowspan:r.rowspan,colspan:r.colspan,row:m,column:o,isLocked:e};var t,l;for(let t=0;t<r.colspan;t++)for(let e=0;e<r.rowspan;e++){const r=o+t,s=m+e+","+r;a[s]=n,c=Math.max(c,r+1)}s.push(n)}),r++,t.push(ct(e.element,s,e.section)),m++}),de(e).map(e=>{const t=(e=>{const o={};let n=0;return x(e.cells,t=>{const r=t.colspan;k(r,e=>{e=n+e;o[e]={element:t.element,colspan:r,column:e}}),n+=r}),o})(e),r={element:e.element,columns:ve(t)};return{colgroups:[r],columns:t}}).getOrThunk(()=>({colgroups:[],columns:{}})));return{grid:{rows:r,columns:c},access:a,all:t,columns:o,colgroups:e}},H=e=>{e=ar(e);return Qr(e)},Xr=Qr,Zr=(e,t,r)=>v.from(e.access[t+","+r]),eo=(e,t,r)=>{e=Jr(e,e=>r(t,e.element));return 0<e.length?v.some(e[0]):v.none()},to=Jr,ro=e=>S(e.all,e=>e.cells),oo=e=>ve(e.columns),no=e=>0<fe(e.columns).length,lo=(e,t)=>v.from(e.columns[t]),so=(r,o=O)=>{const e=r.grid,t=k(e.columns,p),n=k(e.rows,p);return y(t,t=>ao(()=>S(n,e=>Zr(r,e,t).filter(e=>e.column===t).toArray()),e=>1===e.colspan&&o(e.element),()=>Zr(r,0,t)))},ao=(e,t,r)=>{const o=e();return ne(o,t).orThunk(()=>v.from(o[0]).orThunk(r)).map(e=>e.element)},io=r=>{const e=r.grid,t=k(e.rows,p),o=k(e.columns,p);return y(t,t=>ao(()=>S(o,e=>Zr(r,t,e).filter(e=>e.row===t).fold(h([]),e=>[e])),e=>1===e.rowspan,()=>Zr(r,t,0)))},co=(t,r)=>e=>{return"rtl"==(e=e,"rtl"===Ft(e,"direction")?"rtl":"ltr")?r:t},mo=Ar("height",e=>{var t=e.dom;return ht(e)?t.getBoundingClientRect().height:t.offsetHeight}),uo=e=>mo.get(e),fo=e=>mo.getOuter(e),go=(r,o)=>({left:r,top:o,translate:(e,t)=>go(r+e,o+t)}),ho=go,po=(e,t)=>void 0!==e?e:void 0!==t?t:0,vo=e=>{var t,r,o=e.dom.ownerDocument,n=o.body,l=o.defaultView,o=o.documentElement;return n===e.dom?ho(n.offsetLeft,n.offsetTop):(t=po(null==l?void 0:l.pageYOffset,o.scrollTop),l=po(null==l?void 0:l.pageXOffset,o.scrollLeft),r=po(o.clientTop,n.clientTop),o=po(o.clientLeft,n.clientLeft),wo(e).translate(l-o,t-r))},wo=e=>{var t=e.dom,r=t.ownerDocument.body;return r===t?ho(r.offsetLeft,r.offsetTop):ht(e)?(r=t.getBoundingClientRect(),ho(r.left,r.top)):ho(0,0)},bo=(e,t)=>({row:e,y:t}),yo=(e,t)=>({col:e,x:t}),xo=e=>vo(e).left+jr(e),Co=e=>vo(e).left,So=(e,t)=>yo(e,Co(t)),To=(e,t)=>yo(e,xo(t)),Ro=e=>vo(e).top,Do=(e,t)=>bo(e,Ro(t)),Oo=(e,t)=>bo(e,Ro(t)+fo(t)),ko=(r,t,o)=>{var e,n;return 0===o.length?[]:(e=y(o.slice(1),(e,t)=>e.map(e=>r(t,e))),n=o[o.length-1].map(e=>t(o.length-1,e)),e.concat([n]))},Eo={delta:p,positions:e=>ko(Do,Oo,e),edge:Ro},No=co({delta:p,edge:Co,positions:e=>ko(So,To,e)},{delta:e=>-e,edge:xo,positions:e=>ko(To,So,e)}),Bo={delta:(e,t)=>No(t).delta(e,t),positions:(e,t)=>No(t).positions(e,t),edge:e=>No(e).edge(e)},_o={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},zo=(St="[eE][+-]?"+(Ct="[0-9]+"),Ct=["Infinity",Ct+"\\."+(cl=e=>`(?:${e})?`)(Ct)+cl(St),"\\."+Ct+cl(St),Ct+cl(St)].join("|"),new RegExp(`^([+-]?(?:${Ct}))(.*)$`)),Ao=/(\d+(\.\d+)?)%/,Lo=/(\d+(\.\d+)?)px|em/,Wo=g("col"),Mo=(e,t,r)=>{var o=Ve(e).getOrThunk(()=>pt(Fe(e)));return t(e)/r(o)*100},jo=(e,t)=>{j(e,"width",t+"px")},Po=(e,t)=>{j(e,"width",t+"%")},Io=(e,t)=>{j(e,"height",t+"px")},Fo=e=>{a=e;var t,r,o,n,l,s,a=Lr(a,"height",a.dom.offsetHeight)+"px";return a?(a=a,t=e,r=uo,o=Io,s=parseFloat(a),Lt(a,"%")&&"table"!==R(t)?(a=t,n=s,l=r,t=o,r=P(a).map(e=>{e=l(e);return Math.floor(n/100*e)}).getOr(n),t(a,r),r):s):uo(e)},Ho=(e,t)=>qt(e,t).orThunk(()=>Ae(e,t).map(e=>e+"px")),qo=e=>Ho(e,"width"),Vo=e=>Mo(e,Mr,Pr),$o=e=>{return Wo(e)?Mr(e):Lr(e,"width",e.dom.offsetWidth)},Uo=e=>{return e=e,Fo(e)/Ut(e,"rowspan")},Go=(e,t,r)=>{j(e,"width",t+r)},Ko=e=>Mo(e,Mr,Pr)+"%",Yo=h(Ao),Jo=g("col"),Qo=e=>qo(e).getOrThunk(()=>$o(e)+"px"),Xo=e=>{return t=e,Ho(t,"height").getOrThunk(()=>Uo(e)+"px");var t},Zo=(e,t,r,o,n,l)=>e.filter(o).fold(()=>l(((t,r)=>{if(r<0||r>=t.length-1)return v.none();const e=t[r].fold(()=>{var e=(e=>{e=X.call(e,0);return e.reverse(),e})(t.slice(0,r));return ue(e,(e,t)=>e.map(e=>({value:e,delta:t+1})))},e=>v.some({value:e,delta:0})),o=t[r+1].fold(()=>{var e=t.slice(r+1);return ue(e,(e,t)=>e.map(e=>({value:e,delta:t+1})))},e=>v.some({value:e,delta:1}));return e.bind(r=>o.map(e=>{var t=e.delta+r.delta;return Math.abs(e.value-r.value)/t}))})(r,t)),e=>n(e)),en=(e,t,n,l)=>{const s=so(e),r=no(e)?(e=e,y(oo(e),e=>v.from(e.element))):s,a=[v.some(Bo.edge(t))].concat(y(Bo.positions(s,t),e=>e.map(e=>e.x))),i=Y(Gt);return y(r,(e,o)=>Zo(e,o,a,i,e=>{if(r=e,t=(t=zr().browser).isChromium()||t.isFirefox(),!Jo(r)||t)return n(e);var t,r;{const e=null!=(r=s[o])?p(r):v.none();return Zo(e,o,a,i,e=>l(v.some(Mr(e))),l)}},l))},tn=e=>e.map(e=>e+"px").getOr(""),rn=(e,t,r)=>en(e,t,$o,e=>e.getOrThunk(r.minCellWidth)),on=(e,t,r,o,n)=>{const l=io(e),s=[v.some(r.edge(t))].concat(y(r.positions(l,t),e=>e.map(e=>e.y)));return y(l,(e,t)=>Zo(e,t,s,Y(Kt),o,n))},nn=(e,t)=>()=>ht(e)?t(e):parseFloat(qt(e,"width").getOr("0")),ln=n=>{const r=nn(n,e=>parseFloat(Ko(e))),t=nn(n,Mr);return{width:r,pixelWidth:t,getWidths:(e,t)=>{return e=e,r=n,o=t,en(e,r,Vo,e=>e.fold(()=>o.minCellWidth(),e=>e/o.pixelWidth()*100));var r,o},getCellDelta:e=>e/t()*100,singleColumnWidth:(e,t)=>[100-e],minCellWidth:()=>Jt()/t()*100,setElementWidth:Po,adjustTableWidth:e=>{var t=r();Po(n,t+e/100*t)},isRelative:!0,label:"percent"}},sn=r=>{const t=nn(r,Mr);return{width:t,pixelWidth:t,getWidths:(e,t)=>rn(e,r,t),getCellDelta:p,singleColumnWidth:(e,t)=>[Math.max(Jt(),e+t)-e],minCellWidth:Jt,setElementWidth:jo,adjustTableWidth:e=>{e=t()+e;jo(r,e)},isRelative:!1,label:"pixel"}},an=o=>qo(o).fold(()=>{return r=o,e=nn(r,Mr),t=h(0),{width:e,pixelWidth:e,getWidths:(e,t)=>rn(e,r,t),getCellDelta:t,singleColumnWidth:h([0]),minCellWidth:t,setElementWidth:f,adjustTableWidth:f,isRelative:!0,label:"none"};var r,e,t},e=>{return t=o,e=e,(null!==Yo().exec(e)?ln:sn)(t);var t}),cn=sn,mn=ln,dn=(e,t,r)=>{e=e[r].element,r=B.fromTag("td");A(r,B.fromTag("br")),(t?A:Qe)(e,r)},un=(r=>{const t=e=>r(e)?v.from(e.dom.nodeValue):v.none();return{get:e=>{if(r(e))return t(e).getOr("");throw new Error("Can only get text value of a text node")},getOption:t,set:(e,t)=>{if(!r(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=t}}})(ke),fn=e=>un.get(e),gn=e=>un.getOption(e),hn=(e,t)=>un.set(e,t),pn=e=>"img"===R(e)?1:gn(e).fold(()=>d(e).length,e=>e.length),vn=["img","br"],wn=e=>{return gn(e).filter(e=>0!==e.trim().length||-1<e.indexOf(" ")).isSome()||w(vn,R(e))||(e=e,De(e)&&"false"===ze(e,"contenteditable"))},bn=e=>{{var o=wn;const n=t=>{for(let e=0;e<t.childNodes.length;e++){var r=B.fromDom(t.childNodes[e]);if(o(r))return v.some(r);r=n(t.childNodes[e]);if(r.isSome())return r}return v.none()};return n(e.dom)}},yn=e=>xn(e,wn),xn=(e,o)=>{const n=e=>{var t=d(e);for(let e=t.length-1;0<=e;e--){var r=t[e];if(o(r))return v.some(r);r=n(r);if(r.isSome())return r}return v.none()};return n(e)},Cn={scope:["row","col"]},Sn=t=>()=>{var e=B.fromTag("td",t.dom);return A(e,B.fromTag("br",t.dom)),e},Tn=e=>()=>B.fromTag("col",e.dom),Rn=e=>()=>B.fromTag("colgroup",e.dom),Dn=e=>()=>B.fromTag("tr",e.dom),On=(e,t,r)=>{const o=((e,t)=>{t=st(e,t),e=d(lt(e));return et(t,e),t})(e,t);return T(r,(e,t)=>{null===e?N(o,t):E(o,t,e)}),o},kn=(i,c,m)=>{const d=(e,t)=>{var r,o;r=e.element.dom,o=t.dom,jt(r)&&jt(o)&&(o.style.cssText=r.style.cssText),Vt(t,"height"),1!==e.colspan&&Vt(t,"width")};return{col:e=>{var t=B.fromTag(R(e.element),c.dom);return d(e,t),i(e.element,t),t},colgroup:Rn(c),row:Dn(c),cell:e=>{var r,o,n,l,s,t=B.fromTag(R(e.element),c.dom),a=m.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),a=0<a.length?(r=e.element,o=t,n=a,bn(r).map(e=>{var t=n.join(","),e=wt(e,t,e=>z(e,r));return re(e,(e,t)=>{t=nt(t);return A(e,t),t},o)}).getOr(o)):t;return A(a,B.fromTag("br")),d(e,t),l=e.element,s=t,T(Cn,(t,r)=>Ae(l,r).filter(e=>w(t,e)).each(e=>E(s,r,e))),i(e.element,t),t},replace:On,colGap:Tn(c),gap:Sn(c)}},En=e=>({col:Tn(e),colgroup:Rn(e),row:Dn(e),cell:Sn(e),replace:e=>e,colGap:Tn(e),gap:Sn(e)}),Nn=t=>e=>e.options.get(t),Bn=e=>{var t=e.dom,t=null!=(t=t.getParent(e.selection.getStart(),t.isBlock))?t:e.getBody();return Pr(B.fromDom(t))+"px"},_n=e=>v.from(e.options.get("table_clone_elements")),zn=Nn("table_header_type"),An=Nn("table_column_resizing"),Ln=e=>"preservetable"===An(e),Wn=e=>"resizetable"===An(e),Mn=Nn("table_sizing_mode"),jn=e=>"relative"===Mn(e),Pn=e=>"fixed"===Mn(e),In=e=>"responsive"===Mn(e),Fn=Nn("table_resize_bars"),Hn=Nn("table_style_by_css"),qn=Nn("table_merge_content_on_paste"),Vn=Nn("table_use_colgroups"),$n=e=>M(e,"[contenteditable]"),Un=(e,t=!1)=>ht(e)?e.dom.isContentEditable:$n(e).fold(h(t),e=>"true"===Gn(e)),Gn=e=>e.dom.contentEditable,Kn=e=>B.fromDom(e.getBody()),Yn=t=>e=>z(e,Kn(t)),Jn=e=>{N(e,"data-mce-style");var t=e=>N(e,"data-mce-style");x(tr(e),t),x(rr(e),t),x(or(e),t)},Qn=e=>B.fromDom(e.selection.getStart()),Xn=e=>e.getBoundingClientRect().width,Zn=e=>e.getBoundingClientRect().height,el=e=>Dt(e,g("table")).exists(Un),tl=(e,t)=>{var r=t.column,o=t.column+t.colspan-1,n=t.row,t=t.row+t.rowspan-1;return r<=e.finishCol&&o>=e.startCol&&n<=e.finishRow&&t>=e.startRow},rl=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,ol=(e,t,r)=>{const o=eo(e,t,z),n=eo(e,r,z);return o.bind(r=>n.map(e=>{return t=r,e=e,{startRow:Math.min(t.row,e.row),startCol:Math.min(t.column,e.column),finishRow:Math.max(t.row+t.rowspan-1,e.row+e.rowspan-1),finishCol:Math.max(t.column+t.colspan-1,e.column+e.colspan-1)};var t}))},nl=(t,e,r)=>ol(t,e,r).map(e=>{e=to(t,D(tl,e));return y(e,e=>e.element)}),ll=(e,t)=>eo(e,t,(e,t)=>Pe(t,e)).map(e=>e.element),sl=(e,t,r,o,n)=>{const l=al(e),s=z(e,r)?v.some(t):ll(l,t),a=z(e,n)?v.some(o):ll(l,o);return s.bind(t=>a.bind(e=>nl(l,t,e)))},al=H;var il=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],cl=()=>({up:h({selector:Ot,closest:M,predicate:Rt,all:$e}),down:h({selector:yt,predicate:vt}),styles:h({get:Ft,getRaw:qt,set:j,remove:Vt}),attrs:h({get:ze,set:E,remove:N,copyTo:(e,t)=>{e=Le(e);_e(t,e)}}),insert:h({before:Ye,after:Je,afterAll:Ze,append:A,appendAll:et,prepend:Qe,wrap:Xe}),remove:h({unwrap:rt,remove:L}),create:h({nu:B.fromTag,clone:e=>B.fromDom(e.dom.cloneNode(!1)),text:B.fromText}),query:h({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:Ue,nextSibling:Ge}),property:h({children:d,name:R,parent:qe,document:e=>He(e).dom,isText:ke,isComment:Re,isElement:Oe,isSpecial:e=>{e=R(e);return w(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],e)},getLanguage:e=>Oe(e)?Ae(e,"lang"):v.none(),getText:fn,setText:hn,isBoundary:e=>!!Oe(e)&&("body"===R(e)||w(il,R(e))),isEmptyTag:e=>!!Oe(e)&&w(["br","img","hr","input"],R(e)),isNonEditable:e=>Oe(e)&&"false"===ze(e,"contenteditable")}),eq:z,is:Ie});const ml=(r,o,e,t)=>{e=o(r,e);return re(t,(e,t)=>{t=o(r,t);return dl(r,e,t)},e)},dl=(t,e,r)=>e.bind(e=>r.filter(D(t.eq,e))),ul=cl(),fl=(r,e)=>{return t=ul,0<e.length?(t=t,o=(e,t)=>r(t),e=e,ml(t,o,e[0],e.slice(1))):v.none();var t,o},gl=e=>Ot(e,"table"),hl=(l,s,r)=>{const a=t=>e=>void 0!==r&&r(e)||z(e,t);return z(l,s)?v.some({boxes:v.some([l]),start:l,finish:s}):gl(l).bind(n=>gl(s).bind(o=>{if(z(n,o))return v.some({boxes:((e,t,r)=>{e=al(e);return nl(e,t,r)})(n,l,s),start:l,finish:s});if(Pe(n,o)){const r=wt(s,"td,th",a(n)),e=0<r.length?r[r.length-1]:s;return v.some({boxes:sl(n,l,n,s,o),start:l,finish:e})}if(Pe(o,n)){const r=wt(l,"td,th",a(o)),t=0<r.length?r[r.length-1]:l;return v.some({boxes:sl(o,l,n,s,o),start:l,finish:t})}return((e,t)=>{{var[r,e,t,o=Q]=[ul,e,t,void 0];const n=[e].concat(r.up().all(e)),l=[t].concat(r.up().all(t)),s=t=>le(t,o).fold(()=>t,e=>t.slice(0,e+1)),a=s(n),i=s(l),c=ne(a,e=>b(i,D(r.eq,e)));return{firstpath:a,secondpath:i,shared:c}}})(l,s).shared.bind(e=>M(e,"table",r).bind(e=>{var t=wt(s,"td,th",a(e)),t=0<t.length?t[t.length-1]:s,r=wt(l,"td,th",a(e)),r=0<r.length?r[r.length-1]:l;return v.some({boxes:sl(e,l,n,s,o),start:r,finish:t})}))}))},pl=(e,t)=>{e=yt(e,t);return 0<e.length?v.some(e):v.none()},vl=(e,t,o)=>Et(e,t).bind(r=>Et(e,o).bind(t=>fl(gl,[r,t]).map(e=>({first:r,last:t,table:e})))),wl=(e,r,o,n,t)=>{return e=e,l=t,ne(e,e=>_(e,l)).bind(e=>{return t=e,l=r,s=o,P(t).bind(e=>{return r=al(e),e=t,o=l,n=s,eo(r,e,z).bind(e=>{var t=0<o?e.row+e.rowspan-1:e.row,e=0<n?e.column+e.colspan-1:e.column;return Zr(r,t+o,e+n).map(e=>e.element)});var r,o,n}).bind(e=>{return t=e,r=n,Ot(t,"table").bind(e=>Et(e,r).bind(e=>hl(e,t).bind(t=>t.boxes.map(e=>({boxes:e,start:t.start,finish:t.finish})))));var t,r});var t,l,s});var l},bl=(e,t)=>pl(e,t),yl=(o,e,t)=>vl(o,e,t).bind(n=>{const e=e=>z(o,e),t="thead,tfoot,tbody,table",r=Ot(n.first,t,e),l=Ot(n.last,t,e);return r.bind(o=>l.bind(e=>{return z(o,e)?(e=n.table,t=n.first,r=n.last,s=al(e),e=t,t=r,ol(s,e,t).bind(e=>{{var o=s,n=e;let r=!0;var l=D(rl,n);for(let t=n.startRow;t<=n.finishRow;t++)for(let e=n.startCol;e<=n.finishCol;e++)r=r&&Zr(o,t,e).exists(l);return r?v.some(n):v.none()}})):v.none();var t,r,s}))}),xl=p,Cl=e=>{const t=(e,t)=>Ae(e,t).exists(e=>1<parseInt(e,10));return 0<e.length&&ae(e,e=>t(e,"rowspan")||t(e,"colspan"))?v.some(e):v.none()},Sl=(e,t,r)=>t.length<=1?v.none():yl(e,r.firstSelectedSelector,r.lastSelectedSelector).map(e=>({bounds:e,cells:t})),Tl="data-mce-selected",Rl="data-mce-first-selected",Dl="data-mce-last-selected",Ol="["+Tl+"]",kl={selected:Tl,selectedSelector:"td["+Tl+"],th["+Tl+"]",firstSelected:Rl,firstSelectedSelector:"td["+Rl+"],th["+Rl+"]",lastSelected:Dl,lastSelectedSelector:"td["+Dl+"],th["+Dl+"]"},El=(e,t,r)=>({element:r,mergable:Sl(t,e,kl),unmergable:Cl(e),selection:xl(e)}),Nl=o=>(e,t)=>{var r=R(e),r="col"===r||"colgroup"===r?P(r=e).bind(e=>bl(e,kl.firstSelectedSelector)).fold(h(r),e=>e[0]):e;return M(r,o,t)},Bl=Nl("th,td,caption"),_l=Nl("th,td"),zl=e=>{return e=e.model.table.getSelectedCells(),y(e,B.fromDom)},Al=(c,m)=>{c.on("BeforeGetContent",o=>{var e,t=e=>{o.preventDefault(),e=e,P(e[0]).map(e=>{e=((e,t)=>{const r=e=>_(e.element,t),o=lt(e),n=ar(o),l=an(e),s=Xr(n),a=((e,o)=>{var t=e.grid.columns;let n=e.grid.rows,l=t,s=0,a=0;const i=[],c=[];return T(e.access,e=>{if(i.push(e),o(e)){c.push(e);const o=e.row,t=o+e.rowspan-1,i=e.column,r=i+e.colspan-1;o<n?n=o:t>s&&(s=t),i<l?l=i:r>a&&(a=r)}}),{minRow:n,minCol:l,maxRow:s,maxCol:a,allCells:i,selectedCells:c}})(s,r),i="th:not("+t+"),td:not("+t+")",c=Zt(o,"th,td",e=>_(e,i));x(c,L);var m=n,d=s,u=a,f=r,g=C(m,e=>"colgroup"!==e.section),h=d.grid.columns,p=d.grid.rows;for(let r=0;r<p;r++){let t=!1;for(let e=0;e<h;e++)r<u.minRow||r>u.maxRow||e<u.minCol||e>u.maxCol||(Zr(d,r,e).filter(f).isNone()?dn(g,t,r):t=!0)}m=e,e=H(e),b=l;var v=0===(v=a).minCol&&e.grid.columns===v.maxCol+1?0:(e=rn(e,m,b),m=oe(e,(e,t)=>e+t,0),e=oe(e.slice(v.minCol,v.maxCol+1),(e,t)=>e+t,0)/m*b.pixelWidth()-b.pixelWidth(),b.getCellDelta(e)),m=o,w=a,b=s,e=v;return T(b.columns,e=>{(e.column<w.minCol||e.column>w.maxCol)&&L(e.element)}),b=C(Xt(m,"tr"),e=>0===e.dom.childElementCount),x(b,L),w.minCol!==w.maxCol&&w.minRow!==w.maxRow||x(Xt(m,"th,td"),e=>{N(e,"rowspan"),N(e,"colspan")}),N(m,Gr),N(m,"data-snooker-col-series"),an(m).adjustTableWidth(e),o})(e,Ol);return Jn(e),[e]}).each(e=>{var t,r;o.content=("text"===o.format?(r=e,y(r,e=>e.dom.innerText)):(t=c,r=e,y(r,e=>t.selection.serializer.serialize(e.dom,{})))).join("")})};if(!0===o.selection){e=c;const o=C(zl(e),e=>_(e,kl.selectedSelector));1<=o.length&&t(o)}}),c.on("BeforeSetContent",i=>{var e;!0===i.selection&&!0===i.paste&&(e=zl(c),me(e).each(a=>{P(a).each(e=>{const t=C((o=i.content,(n=document.createElement("div")).innerHTML=o,d(B.fromDom(n))),e=>"meta"!==R(e)),r=g("table");var o,n;if(qn(c)&&1===t.length&&r(t[0])){i.preventDefault();const r=B.fromDom(c.getDoc()),l=En(r),s={element:a,clipboard:t[0],generators:l};m.pasteCells(e,s).each(()=>{c.focus()})}})}))})},Ll=(e,t)=>({element:e,offset:t}),Wl=(t,e,r)=>t.property().isText(e)&&0===t.property().getText(e).trim().length||t.property().isComment(e)?r(e).bind(e=>Wl(t,e,r).orThunk(()=>v.some(e))):v.none(),Ml=(e,t)=>(e.property().isText(t)?e.property().getText(t):e.property().children(t)).length,jl=(e,t)=>{var r,t=Wl(e,t,e.query().prevSibling).getOr(t);return!e.property().isText(t)&&0<(r=e.property().children(t)).length?jl(e,r[r.length-1]):Ll(t,Ml(e,t))},Pl=jl,Il=cl(),Fl=(r,o)=>{var e;Gt(r)||(e=r,qo(e).bind(e=>{return e=e,n=["fixed","relative","empty"],v.from(zo.exec(e)).bind(e=>{var t,r,o=Number(e[1]),e=e[2];return t=e,r=n,b(r,e=>b(_o[e],e=>t===e))?v.some({value:o,unit:e}):v.none()});var n}).each(e=>{var t=e.value/2;Go(r,t,e.unit),Go(o,t,e.unit)}))},Hl=e=>y(e,h(0)),ql=(e,t,r,o,n)=>n(e.slice(0,t)).concat(o).concat(n(e.slice(r))),Vl=l=>(e,t,r,o)=>{if(l(r)){const l=Math.max(o,e[t]-Math.abs(r)),n=Math.abs(l-e[t]);return 0<=r?n:-n}return r},$l=Vl(e=>e<0),Ul=Vl(O),Gl=()=>{const s=(e,r,t,o)=>{const n=(100+t)/100,l=Math.max(o,(e[r]+t)/n);return y(e,(e,t)=>(t===r?l:e/n)-e)},a=(e,t,r,o,n,l)=>{return l?s(e,t,o,n):(l=e,e=t,t=r,r=o,o=n,r=$l(l,e,r,o),ql(l,e,t+1,[r,0],Hl))};return{resizeTable:(e,t)=>e(t),clampTableDelta:$l,calcLeftEdgeDeltas:a,calcMiddleDeltas:(e,t,r,o,n,l,s)=>a(e,r,o,n,l,s),calcRightEdgeDeltas:(e,t,r,o,n,l)=>{if(l)return s(e,r,o,n);{const s=$l(e,r,o,n);return Hl(e.slice(0,r)).concat([s])}},calcRedestributedWidths:(e,t,r,o)=>{if(o){const o=(t+r)/t,n=y(e,e=>e/o);return{delta:100*o-100,newSizes:n}}return{delta:r,newSizes:e}}}},Kl=()=>{const s=(e,t,r,o,n)=>{o=Ul(e,0<=o?r:t,o,n);return ql(e,t,r+1,[o,-o],Hl)};return{resizeTable:(e,t,r)=>{r&&e(t)},clampTableDelta:(e,t,r,o,n)=>{if(n){if(0<=r)return r;{const t=oe(e,(e,t)=>e+t-o,0);return Math.max(-t,r)}}return $l(e,t,r,o)},calcLeftEdgeDeltas:s,calcMiddleDeltas:(e,t,r,o,n,l)=>s(e,r,o,n,l),calcRightEdgeDeltas:(e,t,r,o,n,l)=>{if(l)return Hl(e);{const t=o/e.length;return y(e,h(t))}},calcRedestributedWidths:(e,t,r,o)=>({delta:0,newSizes:e})}},Yl=e=>H(e).grid,Jl=g("th"),Ql=e=>ae(e,e=>Jl(e.element)),Xl=e=>{var t="thead"===e.section,r=Nt(Zl(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||r?{type:"header",subType:(e=r,(r=t)&&e?"sectionCells":r?"section":"cells")}:{type:"body"}},Zl=e=>{var t=C(e,e=>Jl(e.element));return 0===t.length?v.some("td"):t.length===e.length?v.some("th"):v.none()},es=(e,t,r)=>W(r(e.element,t),!0,e.isLocked),ts=(e,t)=>e.section!==t?mt(e.element,e.cells,t,e.isNew):e,rs=()=>({transformRow:ts,transformCell:(e,t,r)=>{var o,r=r(e.element,t),n="td"!==R(r)?(t=r,o=st(t,"td"),Je(t,o),n=d(t),et(o,n),L(t),o):r;return W(n,e.isNew,e.isLocked)}}),os=()=>({transformRow:ts,transformCell:es}),ns=()=>({transformRow:(e,t)=>ts(e,"thead"===t?"tbody":t),transformCell:es}),ls=rs,ss=os,as=ns,is=()=>({transformRow:p,transformCell:es}),cs=(e,t,r,o)=>{r===o?N(e,t):E(e,t,r)},ms=(e,t,r)=>{de(bt(e,t)).fold(()=>Qe(e,r),e=>Je(e,r))},ds=(s,e)=>{const r=[],o=[],a=e=>y(e,e=>{e.isNew&&r.push(e.element);const t=e.element;return tt(t),x(e.cells,e=>{e.isNew&&o.push(e.element),cs(e.element,"colspan",e.colspan,1),cs(e.element,"rowspan",e.rowspan,1),A(t,e.element)}),t}),i=e=>S(e,e=>y(e.cells,e=>(cs(e.element,"span",e.colspan,1),e.element))),t=(e,t)=>{var r,o,n,l;0<e.length?(e=e,o=s,n=r=t,l=kt(o,n).getOrThunk(()=>{var e=B.fromTag(n,Fe(o).dom);return"thead"===n?ms(o,"caption,colgroup",e):"colgroup"===n?ms(o,"caption",e):A(o,e),e}),tt(l),r=("colgroup"===r?i:a)(e),et(l,r)):(e=t,kt(s,e).each(L))},n=[],l=[],c=[],m=[];return x(e,e=>{switch(e.section){case"thead":n.push(e);break;case"tbody":l.push(e);break;case"tfoot":c.push(e);break;case"colgroup":m.push(e)}}),t(m,"colgroup"),t(n,"thead"),t(l,"tbody"),t(c,"tfoot"),{newRows:r,newCells:o}},us=(e,t)=>{if(0===e.length)return 0;const r=e[0];return le(e,e=>!t(r.element,e.element)).getOr(e.length)},fs=(g,h)=>{const p=y(g,e=>y(e.cells,Q));return y(g,(e,f)=>{var t,r,o=S(e.cells,(e,t)=>{if(!1===p[f][t]){c=t,m=h,u=(a=g)[i=f],r="colgroup"===u.section;var r={colspan:us(u.cells.slice(c),m),rowspan:r?1:us((u=a.slice(i),d=c,y(u,e=>Vr(e,d))),m)},o=f,n=t,l=r.rowspan,s=r.colspan;for(let t=o;t<o+l;t++)for(let e=n;e<n+s;e++)p[t][e]=!0;return[{element:e.element,rowspan:r.rowspan,colspan:r.colspan,isNew:e.isNew}]}var a,i,c,m,d,u,r;return[]});return t=e.element,r=e.section,{element:t,cells:o,section:r,isNew:e.isNew}})},gs=(o,n,l)=>{const e=[];x(o.colgroups,t=>{var r=[];for(let e=0;e<o.grid.columns;e++){const t=lo(o,e).map(e=>W(e.element,l,!1)).getOrThunk(()=>W(n.colGap(),!0,!1));r.push(t)}e.push(mt(t.element,r,"colgroup",l))});for(let t=0;t<o.grid.rows;t++){var r=[];for(let e=0;e<o.grid.columns;e++){var s=Zr(o,t,e).map(e=>W(e.element,l,e.isLocked)).getOrThunk(()=>W(n.gap(),!0,!1));r.push(s)}var a=o.all[t],a=mt(a.element,r,a.section,l);e.push(a)}return e},hs=e=>fs(e,z),ps=(e,t)=>ue(e.all,e=>ne(e.cells,e=>z(t,e.element))),vs=(t,e,r)=>{e=y(e.selection,e=>er(e).bind(e=>ps(t,e)).filter(r)),e=Bt(e);return _t(0<e.length,e)},e=(i,t,c,m,d)=>(n,e,o,l)=>{const s=H(n),a=v.from(null==l?void 0:l.section).getOrThunk(is);return t(s,e).map(e=>{t=s,r=o;var t=gs(t,r,!1),r=i(t,e,z,d(o),a),t=Yr(r.grid);return{info:e,grid:hs(r.grid),cursor:r.cursor,lockedColumns:t}}).bind(e=>{var t=ds(n,e.grid),r=v.from(null==l?void 0:l.sizing).getOrThunk(()=>an(n)),o=v.from(null==l?void 0:l.resize).getOrThunk(Kl);return c(n,e.grid,e.info,{sizing:r,resize:o,section:a}),m(n),N(n,Gr),0<e.lockedColumns.length&&E(n,Gr,e.lockedColumns.join(",")),v.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})})},ws=(e,t)=>vs(e,t,O).map(e=>({cells:e,generators:t.generators,clipboard:t.clipboard})),bs=(e,t)=>vs(e,t,O),ys=(e,t)=>vs(e,t,e=>!e.isLocked),xs=(r,e)=>ae(e,e=>{return t=r,e=e,ps(t,e).exists(e=>!e.isLocked);var t}),Cs=(e,r,o,n)=>{var l=F(e).rows;let s=!0;for(let t=0;t<l.length;t++)for(let e=0;e<$r(l[0]);e++){var a=l[t],i=Vr(a,e),c=o(i.element,r);c&&!s?Hr(a,e,W(n(),!0,i.isLocked)):c&&(s=!1)}return e},Ss=r=>{const e=e=>e(r),t=h(r),o=()=>n,n={tag:!0,inner:r,fold:(e,t)=>t(r),isValue:O,isError:Q,map:e=>Rs.value(e(r)),mapError:o,bind:e,exists:e,forall:e,getOr:t,or:o,getOrThunk:t,orThunk:o,getOrDie:t,each:e=>{e(r)},toOptional:()=>v.some(r)};return n},Ts=r=>{const e=()=>t,t={tag:!1,inner:r,fold:(e,t)=>e(r),isValue:Q,isError:O,map:e,mapError:e=>Rs.error(e(r)),bind:e,exists:Q,forall:O,getOr:p,or:p,getOrThunk:J,orThunk:J,getOrDie:(o=String(r),()=>{throw new Error(o)}),each:f,toOptional:v.none};var o;return t},Rs={value:Ss,error:Ts,fromOption:(e,t)=>e.fold(()=>Ts(t),Ss)},Ds=(e,t)=>({rowDelta:0,colDelta:$r(e[0])-$r(t[0])}),Os=(e,t)=>({rowDelta:e.length-t.length,colDelta:0}),ks=(e,t,r,o)=>{const n="colgroup"===t.section?r.col:r.cell;return k(e,e=>W(n(),!0,o(e)))},Es=(e,t,r,o)=>{const n=e[e.length-1];return e.concat(k(t,()=>{var e="colgroup"===n.section?r.colgroup:r.row,e=Ur(n,e,p),t=ks(e.cells.length,e,r,e=>we(o,e.toString()));return qr(e,t)}))},Ns=(e,r,o,n)=>y(e,e=>{var t=ks(r,e,o,Q);return Ir(e,n,t)}),Bs=(e,t,r)=>{const o=t.colDelta<0?Ns:p,n=t.rowDelta<0?Es:p,l=Yr(e),s=$r(e[0]),a=b(l,e=>e===s-1),i=o(e,Math.abs(t.colDelta),r,a?s-1:s),c=Yr(i);return n(i,Math.abs(t.rowDelta),r,ie(c,O))},_s=(t,r,e)=>C(e,e=>e>=t.column&&e<=$r(r[0])+t.column),zs=(r,e,t,o,n)=>{var l,s,a,i;l=e,s=r,a=n,i=o.cell,0<s&&s<l[0].cells.length&&x(l,e=>{var t=e.cells[s-1];let r=0;for(var o=i();e.cells.length>s+r&&a(t.element,e.cells[s+r].element);)Hr(e,s+r,W(o,!0,e.cells[s+r].isLocked)),r++});const c=Os(t,e),m=Bs(t,c,o),d=Os(e,m),u=Bs(e,d,o);return y(u,(e,t)=>Ir(e,r,m[t].cells))},As=(e,t,r,o,n)=>{{var l=t,s=e,a=n,i=o.cell,c;const f=F(l).rows;if(0<s&&s<f.length){n=f[s-1].cells,c=a;const l=oe(n,(e,t)=>b(e,e=>c(e.element,t.element))?e:e.concat([t]),[]);x(l,r=>{let o=v.none();for(let e=s;e<f.length;e++)for(let t=0;t<$r(f[0]);t++){const n=f[e],l=Vr(n,t);a(l.element,r.element)&&(o=o.isNone()?v.some(i()):o).each(e=>{Hr(n,t,W(e,!0,l.isLocked))})}})}}var m,d,l=Yr(t),n=Ds(t,r),n={...n,colDelta:n.colDelta-l.length},l=Bs(t,n,o),{cols:n,rows:u}=F(l),l=Yr(l),t=Ds(r,t),t={...t,colDelta:t.colDelta+l.length},l=(m=o,d=l,y(r,o=>oe(d,(e,t)=>{var r=ks(1,o,m,O)[0];return Fr(e,t,r)},o))),r=Bs(l,t,o);return[...n,...u.slice(0,e),...r,...u.slice(e,u.length)]},Ls=(e,r,t,o,n)=>{const{rows:l,cols:s}=F(e),a=l.slice(0,r),i=l.slice(r);return[...s,...a,(e=l[t],c=o,m=n,Ur(e,e=>m(e,c),(e,t)=>r>0&&r<l.length&&o(I(l[r-1],t),I(l[r],t))?Vr(l[r],t):W(n(e.element,o),!0,e.isLocked))),...i];var c,m},Ws=(e,r,o,n,l)=>y(e,e=>{const s=0<r&&r<$r(e)&&n(I(e,r-1),I(e,r)),t=((e,t,r,o,n,l)=>{if("colgroup"!==r&&s)return Vr(e,t);{const t=Vr(e,o);return W(l(t.element,n),!0,!1)}})(e,r,e.section,o,n,l);return Fr(e,r,t)}),Ms=(e,t,r,o)=>{return n=e,l=t,s=r,a=o,void 0!==I(n[l],s)&&0<l&&a(I(n[l-1],s),I(n[l],s))||(a=e[t],0<(n=r)&&o(I(a,n-1),I(a,n)));var n,l,s,a},js=(e,t,r,o)=>{var n=e=>("row"===e?Kt:Gt)(t)?e+"group":e;return e?Jl(t)?n(r):null:o&&Jl(t)?n("row"===r?"col":"row"):null},Ps=(e,t,r)=>W(r(e.element,t),!0,e.isLocked),Is=(e,n,l,s,a,i,c)=>y(e,(e,o)=>{return t=(e=e).cells,t=y(t,(e,t)=>{if(r=e,b(n,e=>l(r.element,e.element))){const n=c(e,o,t)?a(e,l,s):e;return i(n,o,t).each(e=>{var r=n.element,e={scope:v.from(e)};T(e,(e,t)=>{e.fold(()=>{N(r,t)},e=>{Be(r.dom,t,e)})})}),n}var r;return e}),mt(e.element,t,e.section,e.isNew);var t}),Fs=(r,o,n)=>S(r,(e,t)=>Ms(r,t,o,n)?[]:[Vr(e,o)]),Hs=(e,t,r,o,n)=>{const l=F(e).rows,s=S(t,e=>Fs(l,e,o)),a=y(l,e=>Ql(e.cells)),i=(t=s,u=a,ae(u,p)&&Ql(t)?O:(e,t,r)=>!("th"===R(e.element)&&u[t])),c=(m=r,d=a,(e,t)=>v.some(js(m,e.element,"row",d[t])));var m,d,u;return Is(e,s,o,n,Ps,c,i)},qs=(e,t,r,o)=>{const n=F(e).rows,l=y(t,e=>Vr(n[e.row],e.column));return Is(e,l,r,o,Ps,v.none,O)},Vs=l=>{if(!i(l))throw new Error("cases must be an array");if(0===l.length)throw new Error("there must be at least one case");const s=[],a={};return x(l,(e,t)=>{var r=fe(e);if(1!==r.length)throw new Error("one and only one name per case");const o=r[0],n=e[o];if(void 0!==a[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!i(n))throw new Error("case arguments must be an array");s.push(o),a[o]=(...r)=>{var e=r.length;if(e!==n.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+n.length+" ("+n+"), got "+e);return{fold:(...e)=>{if(e.length!==l.length)throw new Error("Wrong number of arguments to fold. Expected "+l.length+", got "+e.length);return e[t].apply(null,r)},match:e=>{const t=fe(e);if(s.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+s.join(",")+"\nActual: "+t.join(","));if(ae(s,e=>w(t,e)))return e[o].apply(null,r);throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+s.join(", "))},log:e=>{console.log(e,{constructors:s,constructor:o,params:r})}}}}),a},$s={...Vs([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}])},Us=(t,r,o)=>{let n=0;for(let e=t;e<r;e++)n+=void 0!==o[e]?o[e]:0;return n},Gs=(e,t,r)=>{e=e,t=t;e=(no(e)?(e,r)=>{e=oo(e);return y(e,(e,t)=>({element:e.element,width:r[t],colspan:e.colspan}))}:(e,r)=>{e=ro(e);return y(e,e=>{var t=Us(e.column,e.column+e.colspan,r);return{element:e.element,width:t,colspan:e.colspan}})})(e,t);x(e,e=>{r.setElementWidth(e.element,e.width)})},Ks=(e,t,r,o,n)=>{const l=H(e),s=n.getCellDelta(t),a=n.getWidths(l,n),i=r===l.grid.columns-1,c=o.clampTableDelta(a,r,s,n.minCellWidth(),i),m=((e,t,o,n,l)=>{const s=e.slice(0),r=(t=t,0===(e=e).length?$s.none():1===e.length?$s.only(0):0===t?$s.left(0,1):t===e.length-1?$s.right(t-1,t):0<t&&t<e.length-1?$s.middle(t-1,t,t+1):$s.none()),a=h(y(s,h(0)));return r.fold(a,e=>n.singleColumnWidth(s[e],o),(e,t)=>l.calcLeftEdgeDeltas(s,e,t,o,n.minCellWidth(),n.isRelative),(e,t,r)=>l.calcMiddleDeltas(s,e,t,r,o,n.minCellWidth(),n.isRelative),(e,t)=>l.calcRightEdgeDeltas(s,e,t,o,n.minCellWidth(),n.isRelative))})(a,r,c,n,o),d=y(m,(e,t)=>e+a[t]);Gs(l,d,n),o.resizeTable(n.adjustTableWidth,c,i)},Ys=e=>oe(e,(e,t)=>b(e,e=>e.column===t.column)?e:e.concat([t]),[]).sort((e,t)=>e.column-t.column),Js=g("col"),Qs=g("colgroup"),Xs=e=>"tr"===R(e)||Qs(e),Zs=e=>Ae(e,"scope").map(e=>e.substr(0,3)),ea=(o,n=e=>({element:e,colspan:$t(e,"colspan",1),rowspan:$t(e,"rowspan",1)}))=>{const l=e=>{if(Xs(e))return Qs((t={element:e}).element)?o.colgroup(t):o.row(t);{const t=e,r=(e=n(t),Js(e.element)?o.col(e):o.cell(e));return s=v.some({item:t,replacement:r}),r}var t};let s=v.none();return{getOrInit:(t,r)=>s.fold(()=>l(t),e=>r(t,e.item)?e.replacement:l(t))}},ta=o=>r=>{const s=[],a=e=>{var t=r.replace(e,o,"td"===o?{scope:null}:{});return s.push({item:e,sub:t}),t};return{replaceOrInit:(t,r)=>{if(Xs(t)||Js(t))return t;{const l=t;return o=l,n=r,ne(s,e=>n(e.item,o)).fold(()=>a(l),e=>r(t,e.item)?e.sub:a(l))}var o,n}}},ra=o=>({unmerge:r=>{const e=Zs(r);return e.each(e=>E(r,"scope",e)),()=>{const t=o.cell({element:r,colspan:1,rowspan:1});return Vt(t,"width"),Vt(r,"width"),e.each(e=>E(t,"scope",e)),t}},merge:r=>(Vt(r[0],"width"),(()=>{var e=Bt(y(r,Zs));if(0===e.length)return v.none();{const r=e[0],t=["row","col"];return b(e,e=>e!==r&&w(t,e))?v.none():v.from(r)}})().fold(()=>N(r[0],"scope"),e=>E(r[0],"scope",e+"group")),h(r[0]))}),oa=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],na=cl(),la=e=>{var t=na;return t=t.property().name(e),w(oa,t)},sa=e=>{var t=na;return t=t.property().name(e),w(["ol","ul"],t)},aa=e=>{const l=g("br"),o=n=>yn(n).bind(r=>{const o=Ge(r).map(e=>{return!!la(e)||(t=na,r=e,!!w(["br","img","hr","input"],t.property().name(r))&&"img"!==R(e));var t,r}).getOr(!1);return qe(r).map(e=>{return!0===o||"li"===R(t=e)||Rt(t,sa).isSome()||l(r)||la(e)&&!z(n,e)?[]:[B.fromTag("br")];var t})}).getOr([]),t=0===(r=S(e,e=>{var t,r=d(e);return t=r,ae(t,e=>l(e)||ke(e)&&0===fn(e).trim().length)?[]:r.concat(o(e))})).length?[B.fromTag("br")]:r;var r;tt(e[0]),et(e[0],t)},ia=e=>Un(e,!0),ca=e=>{0===tr(e).length&&L(e)},ma=(e,t)=>({grid:e,cursor:t}),c=(e,t,r)=>{t=((e,t,r)=>{const o=F(e).rows;return v.from(null==(t=null==(e=o[t])?void 0:e.cells[r])?void 0:t.element).filter(ia).orThunk(()=>{return e=o,ue(e,e=>ue(e.cells,e=>{e=e.element;return _t(ia(e),e)}));var e})})(e,t,r);return ma(e,t)},da=e=>oe(e,(e,t)=>b(e,e=>e.row===t.row)?e:e.concat([t]),[]).sort((e,t)=>e.row-t.row),ua=(s,a)=>(e,t,r,o,n)=>{var l=da(t),e=((e,t,r,o,l,n,s)=>{const{cols:a,rows:i}=F(e),c=i[t[0]],m=S(t,e=>{return r=i,n=l,e=r[o=e],S(e.cells,(e,t)=>Ms(r,o,t,n)?[]:[e]);var r,o,n}),d=y(c.cells,(e,t)=>Ql(Fs(i,t,l))),u=[...i];x(t,e=>{u[e]=s.transformRow(i[e],r)});var f,g,h,e=[...a,...u],t=(t=c,h=d,ae(h,p)&&Ql(t.cells)?O:(e,t,r)=>!("th"===R(e.element)&&h[r])),o=(f=o,g=d,(e,t,r)=>v.some(js(f,e.element,"col",g[r])));return Is(e,m,l,n,s.transformCell,o,t)})(e,y(l,e=>e.row),s,a,r,o.replaceOrInit,n);return c(e,t[0].row,t[0].column)},fa=ua("thead",!0),ga=ua("tbody",!1),ha=ua("tfoot",!1),pa=(e,t,r)=>{e=e,o=r.section;var o,r=lr(e,()=>o),e=Xr(r);return gs(e,t,!0)},va=(e,t,r,o)=>{var n;t=t,o=o.sizing,t=Xr(t),n=o.getWidths(t,o),Gs(t,n,o)},wa=(e,t,r,o)=>{var n=o.sizing,o=o.resize,t=Xr(t),l=n.getWidths(t,n),s=n.pixelWidth(),{newSizes:o,delta:l}=o.calcRedestributedWidths(l,s,r.pixelDelta,n.isRelative);Gs(t,o,n),n.adjustTableWidth(l)},ba=(e,t)=>b(t,e=>0===e.column&&e.isLocked),ya=(t,e)=>b(e,e=>e.column+e.colspan>=t.grid.columns&&e.isLocked),xa=(e,t)=>{const r=so(e),o=Ys(t);return oe(o,(e,t)=>e+r[t.column].map(jr).getOr(0),0)},Ca=r=>(t,e)=>bs(t,e).filter(e=>!(r?ba:ya)(t,e)).map(e=>({details:e,pixelDelta:xa(t,e)})),Sa=r=>(t,e)=>ws(t,e).filter(e=>!(r?ba:ya)(t,e.cells)),Ta=ta("th"),Ra=ta("td"),Da=e((e,t,r,o)=>{const n=t[0].row,l=da(t),s=re(l,(e,t)=>({grid:Ls(e.grid,n,t.row+e.delta,r,o.getOrInit),delta:e.delta+1}),{grid:e,delta:0}).grid;return c(s,n,t[0].column)},bs,f,f,ea),Oa=e((e,t,r,o)=>{const n=da(t),l=n[n.length-1],s=l.row+l.rowspan,a=re(n,(e,t)=>Ls(e,s,t.row,r,o.getOrInit),e);return c(a,s,t[0].column)},bs,f,f,ea),ka=e((e,t,r,o)=>{const n=t.details,l=Ys(n),s=l[0].column,a=re(l,(e,t)=>({grid:Ws(e.grid,s,t.column+e.delta,r,o.getOrInit),delta:e.delta+1}),{grid:e,delta:0}).grid;return c(a,n[0].row,s)},Ca(!0),wa,f,ea),Ea=e((e,t,r,o)=>{const n=t.details,l=n[n.length-1],s=l.column+l.colspan,a=Ys(n),i=re(a,(e,t)=>Ws(e,s,t.column,r,o.getOrInit),e);return c(i,n[0].row,s)},Ca(!1),wa,f,ea),Na=e((e,t,r,o)=>{var n,t=Ys(t.details),e=(e=e,n=y(t,e=>e.column),S(e,e=>{var t=e.cells,t=re(n,(e,t)=>0<=t&&t<e.length?e.slice(0,t).concat(e.slice(t+1)):e,t);return 0<t.length?[mt(e.element,t,e.section,e.isNew)]:[]})),l=0<e.length?e[0].cells.length-1:0;return c(e,t[0].row,Math.min(t[0].column,l))},(t,e)=>ys(t,e).map(e=>({details:e,pixelDelta:-xa(t,e)})),wa,ca,ea),Ba=e((e,t,r,o)=>{var n=da(t),e=((e,t,r)=>{var{rows:e,cols:o}=F(e);return[...o,...e.slice(0,t),...e.slice(r+1)]})(e,n[0].row,n[n.length-1].row),n=0<e.length?e.length-1:0;return c(e,Math.min(t[0].row,n),t[0].column)},bs,f,ca,ea),_a=e((e,t,r,o)=>{var n=Ys(t),n=y(n,e=>e.column),e=Hs(e,n,!0,r,o.replaceOrInit);return c(e,t[0].row,t[0].column)},ys,f,f,Ta),za=e((e,t,r,o)=>{var n=Ys(t),n=y(n,e=>e.column),e=Hs(e,n,!1,r,o.replaceOrInit);return c(e,t[0].row,t[0].column)},ys,f,f,Ra),Aa=e(fa,ys,f,f,Ta),La=e(ga,ys,f,f,Ra),Wa=e(ha,ys,f,f,Ra),Ma=e((e,t,r,o)=>{e=qs(e,t,r,o.replaceOrInit);return c(e,t[0].row,t[0].column)},ys,f,f,Ta),ja=e((e,t,r,o)=>{e=qs(e,t,r,o.replaceOrInit);return c(e,t[0].row,t[0].column)},ys,f,f,Ra),Pa=e((e,t,r,o)=>{var n=t.cells,e=(aa(n),((e,r,o)=>{var n=F(e).rows;if(0!==n.length)for(let t=r.startRow;t<=r.finishRow;t++)for(let e=r.startCol;e<=r.finishCol;e++){const r=n[t],l=Vr(r,e).isLocked;Hr(r,e,W(o(),!1,l))}return e})(e,t.bounds,o.merge(n)));return ma(e,v.from(n[0]))},(t,e)=>e.mergable.filter(e=>xs(t,e.cells)),va,f,ra),Ia=e((e,t,r,o)=>{e=re(t,(e,t)=>Cs(e,t,r,o.unmerge(t)),e);return ma(e,v.from(t[0]))},(t,e)=>e.unmergable.filter(e=>xs(t,e)),va,f,ra),Fa=e((e,t,r,o)=>{var n=((e,t)=>{e=H(e);return gs(e,t,!0)})(t.clipboard,t.generators);return((e,y,t,x,C)=>{const r=Yr(y),S=(n=e,e=y,l=r,s=$r(e[0]),e=F(e).cols.length+n.row,a=k(s-n.column,e=>e+n.column),{row:e,column:ne(a,t=>ae(l,e=>e!==t)).getOr(s-1)}),T=F(t).rows,R=_s(S,T,r),o=(e=S,a=T,e.row>=(s=y).length||e.column>$r(s[0])?Rs.error("invalid start address out of table bounds, row: "+e.row+", column: "+e.column):(e=(s=s.slice(e.row))[0].cells.slice(e.column),t=$r(a[0]),a=a.length,Rs.value({rowDelta:s.length-a,colDelta:e.length-t})));var n,l,s,a;return o.map(e=>{var o,n,l,s,a,e={...e,colDelta:e.colDelta-R.length},e=Bs(y,e,x),t=Yr(e),t=_s(S,T,t);{var r=S,i=e,c=T,m=x,d=C;e=t;const u=r.row,f=r.column,g=u+c.length,h=f+$r(c[0])+e.length,p=ie(e,O);for(let r=u;r<g;r++){let t=0;for(let e=f;e<h;e++)if(p[e])t++;else{o=i,n=r,l=e,a=void 0,s=D(s=d,Vr(o[n],l).element),a=o[n],1<o.length&&1<$r(a)&&(0<l&&s(I(a,l-1))||l<a.cells.length-1&&s(I(a,l+1))||0<n&&s(I(o[n-1],l))||n<o.length-1&&s(I(o[n+1],l)))&&Cs(i,I(i[r],e),d,m.cell);const h=e-f-t,v=Vr(c[r-u],h),w=v.element,b=m.replace(w);Hr(i[r],e,W(b,!0,v.isLocked))}}return i}})})({row:t.row,column:t.column},e,n,t.generators,r).fold(()=>ma(e,v.some(t.element)),e=>c(e,t.row,t.column))},(t,r)=>er(r.element).bind(e=>ps(t,e).map(e=>({...e,generators:r.generators,clipboard:r.clipboard}))),va,f,ea),Ha=e((e,t,r,o)=>{var n=F(e).rows,l=t.cells[0].column,n=n[t.cells[0].row],n=pa(t.clipboard,t.generators,n),l=zs(l,e,n,t.generators,r);return c(l,t.cells[0].row,t.cells[0].column)},Sa(!0),f,f,ea),qa=e((e,t,r,o)=>{var n=F(e).rows,l=t.cells[t.cells.length-1].column+t.cells[t.cells.length-1].colspan,n=n[t.cells[0].row],n=pa(t.clipboard,t.generators,n),l=zs(l,e,n,t.generators,r);return c(l,t.cells[0].row,t.cells[0].column)},Sa(!1),f,f,ea),Va=e((e,t,r,o)=>{var n=F(e).rows,l=t.cells[0].row,n=n[l],n=pa(t.clipboard,t.generators,n),l=As(l,e,n,t.generators,r);return c(l,t.cells[0].row,t.cells[0].column)},ws,f,f,ea),$a=e((e,t,r,o)=>{var n=F(e).rows,l=t.cells[t.cells.length-1].row+t.cells[t.cells.length-1].rowspan,n=n[t.cells[0].row],n=pa(t.clipboard,t.generators,n),l=As(l,e,n,t.generators,r);return c(l,t.cells[0].row,t.cells[0].column)},ws,f,f,ea),Ua=(e,t)=>{const l=H(e);return bs(l,t).bind(e=>{const t=e[e.length-1],r=e[0].column,o=t.column+t.colspan,n=se(y(l.all,e=>C(e.cells,e=>e.column>=r&&e.column<o)));return Zl(n)}).getOr("")},Ga=(e,t)=>{e=H(e);return bs(e,t).bind(Zl).getOr("")},Ka=(e,t)=>{const n=H(e);return bs(n,t).bind(e=>{var t=e[e.length-1],e=e[0].row,t=t.row+t.rowspan,r=n.all.slice(e,t),e=y(r,e=>Xl(e).type),t=w(e,"header"),o=w(e,"footer");if(t||o){const r=w(e,"body");return!t||r||o?t||r||!o?v.none():v.some("footer"):v.some("header")}return v.some("body")}).getOr("")},Ya=(e,t)=>e.dispatch("NewRow",{node:t}),Ja=(e,t)=>e.dispatch("NewCell",{node:t}),Qa=(e,t,r)=>{e.dispatch("TableModified",{...r,table:t})},Xa={structure:!1,style:!0},q={structure:!0,style:!1},Za={structure:!0,style:!0},ei=(e,t)=>(jn(e)?mn:Pn(e)?cn:an)(t),ti=(c,m,d)=>{const t=e=>"table"===R(Kn(e)),u=_n(c),e=Wn(c)?f:Fl,r=(l,s,a,i)=>(t,e,o=!1)=>{Jn(t);var r=B.fromDom(c.getDoc()),r=kn(a,r,u),n={sizing:ei(c,t),resize:(Wn(c)?Gl:Kl)(),section:(e=>{switch(zn(c)){case"section":return ls();case"sectionCells":return ss();case"cells":return as();default:var t=e;switch(t=H(t),ue(t.all,e=>{e=Xl(e);return"header"===e.type?v.from(e.subType):v.none()}).getOr("section")){case"section":return rs();case"sectionCells":return os();case"cells":return ns()}return}})(t)};return s(t)?l(t,e,r,n).bind(e=>{m.refresh(t.dom),x(e.newRows,e=>{Ya(c,e.dom)}),x(e.newCells,e=>{Ja(c,e.dom)});r=t;var r,e=e.cursor.fold(()=>{var e=tr(r);return me(e).filter(ht).map(e=>{d.clearSelectedCells(r.dom);var t=c.dom.createRng();return t.selectNode(e.dom),c.selection.setRng(t),E(e,"data-mce-selected","1"),t})},e=>{var e=Pl(Il,e),t=c.dom.createRng();return t.setStart(e.element.dom,e.offset),t.setEnd(e.element.dom,e.offset),c.selection.setRng(t),d.clearSelectedCells(r.dom),v.some(t)});return ht(t)&&(Jn(t),o||Qa(c,t.dom,i)),e.map(e=>({rng:e,effect:i}))}):v.none()},o=r(Ba,e=>!t(c)||1<Yl(e).rows,f,q),n=r(Na,e=>!t(c)||1<Yl(e).columns,f,q);return{deleteRow:o,deleteColumn:n,insertRowsBefore:r(Da,O,f,q),insertRowsAfter:r(Oa,O,f,q),insertColumnsBefore:r(ka,O,e,q),insertColumnsAfter:r(Ea,O,e,q),mergeCells:r(Pa,O,f,q),unmergeCells:r(Ia,O,f,q),pasteColsBefore:r(Ha,O,f,q),pasteColsAfter:r(qa,O,f,q),pasteRowsBefore:r(Va,O,f,q),pasteRowsAfter:r($a,O,f,q),pasteCells:r(Fa,O,f,Za),makeCellsHeader:r(Ma,O,f,q),unmakeCellsHeader:r(ja,O,f,q),makeColumnsHeader:r(_a,O,f,q),unmakeColumnsHeader:r(za,O,f,q),makeRowsHeader:r(Aa,O,f,q),makeRowsBody:r(La,O,f,q),makeRowsFooter:r(Wa,O,f,q),getTableRowType:Ka,getTableCellType:Ga,getTableColType:Ua}},ri=(e,t,r)=>{var o=$t(e,t,1);1===r||o<=1?N(e,t):E(e,t,Math.min(r,o))},oi=(r,o)=>e=>{var t=e.column+e.colspan-1,e=e.column;return r<=t&&e<o},ni=Vs([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),li=(e,t,r)=>{var e=r.substring(0,r.length-e.length),o=parseFloat(e);return e===o.toString()?t(o):ni.invalid(r)},si={...ni,from:e=>Lt(e,"%")?li("%",ni.percent,e):Lt(e,"px")?li("px",ni.pixels,e):ni.invalid(e)},ai=(e,t,r)=>{const o=si.from(r),n=ae(e,e=>"0px"===e)?((e,t)=>{e=e.fold(()=>h(""),e=>h(e/t+"px"),()=>h(100/t+"%"));return k(t,e)})(o,e.length):(l=e,s=t,o.fold(()=>l,e=>{{var t=l,r=e;const o=r/s;return y(t,e=>si.from(e).fold(()=>e,e=>e*o+"px",e=>e/100*r+"px"))}},e=>{return t=l,r=s,y(t,e=>si.from(e).fold(()=>e,e=>e/r*100+"%",e=>e+"%"));var t,r}));var l,s;{var a,i;return 0===(r=n).length?r:(a=re(r,(e,t)=>{var r=si.from(t).fold(()=>({value:t,remainder:0}),e=>{return e=e,{value:(t=Math.floor(e))+"px",remainder:e-t};var t},e=>({value:e+"%",remainder:0}));return{output:[r.value].concat(e.output),remainder:e.remainder+r.remainder}},{output:[],remainder:0}),(i=a.output).slice(0,i.length-1).concat([ci(i[i.length-1],Math.round(a.remainder))]))}},ii=(e,t)=>0===e.length?t:re(e,(e,t)=>si.from(t).fold(h(0),p,p)+e,0),ci=(e,t)=>si.from(e).fold(h(e),e=>e+t+"px",e=>e+t+"%"),mi=si.from,di=e=>mi(e).fold(h("px"),h("px"),h("%")),ui=(c,e,t)=>{const m=H(c),i=m.all,d=ro(m),u=oo(m);e.each(e=>{var r,o,n,l,t=di(e),s=Mr(c),a=(a=m,i=c,en(a,i,Qo,tn)),i=ai(a,s,e);no(m)?(n=i,a=u,l=t,x(a,(e,t)=>{t=ii([n[t]],Jt());j(e.element,"width",t+l)})):(r=i,s=d,o=t,x(s,e=>{var t=r.slice(e.column,e.colspan+e.column),t=ii(t,Jt());j(e.element,"width",t+o)})),j(c,"width",e)}),t.each(e=>{var r,t,o,n,l=di(e),s=uo(c),a=(a=m,t=c,o=Eo,on(a,t,o,Xo,tn));r=ai(a,s,e),t=i,o=d,n=l,x(o,e=>{var t=r.slice(e.row,e.rowspan+e.row),t=ii(t,Qt());j(e.element,"height",t+n)}),x(t,(e,t)=>{j(e.element,"height",r[t])}),j(c,"height",e)})},fi=e=>qo(e).exists(e=>Ao.test(e)),gi=e=>qo(e).exists(e=>Lo.test(e)),hi=e=>qo(e).isNone(),pi=e=>{N(e,"width")},vi=e=>{var t=Ko(e);ui(e,v.some(t),v.none()),pi(e)},wi=e=>{t=e;var t=Mr(t)+"px";ui(e,v.some(t),v.none()),pi(e)},bi=e=>{Vt(e,"width");var t=rr(e),t=0<t.length?t:tr(e);x(t,e=>{Vt(e,"width"),pi(e)}),pi(e)},yi=(e,s,a,i)=>k(e,e=>{var t=s,r=a,o=i,n=e,l=B.fromTag("tr");for(let e=0;e<t;e++){const t=B.fromTag(n<r||e<o?"th":"td");e<o&&E(t,"scope","row"),n<r&&E(t,"scope","col"),A(t,B.fromTag("br")),A(l,t)}return l}),xi=(e,t)=>{e.selection.select(t.dom,!0),e.selection.collapse(!0)},Ci=(l,r,o,n,s)=>{t=(e=l).options,c=t.get("table_default_styles");const a=t.isSet("table_default_styles")?c:(t=e,e=c,In(t)||!Hn(t)?e:Pn(t)?{...e,width:Bn(t)}:{...e,width:"100%"}),i={styles:a,attributes:(t=(c=l).options,e=t.get("table_default_attributes"),t.isSet("table_default_attributes")?e:(t=c,c=e,In(t)||Hn(t)?c:Pn(t)?{...c,width:Bn(t)}:{...c,width:"100%"})),colGroups:Vn(l)};var e,t,c;return l.undoManager.ignore(()=>{var e,t=((e,t,r,o,n,l)=>{var s=B.fromTag("table"),a="cells"!==n,i=(It(s,l.styles),_e(s,l.attributes),l.colGroups&&A(s,(e=>{const t=B.fromTag("colgroup");return k(e,()=>A(t,B.fromTag("col"))),t})(t)),Math.min(e,r));if(a&&0<r){const e=B.fromTag("thead"),l=(A(s,e),yi(r,t,"sectionCells"===n?i:0,o));et(e,l)}l=B.fromTag("tbody"),A(s,l),n=yi(a?e-i:e,t,a?0:r,o);return et(l,n),s})(o,r,s,n,zn(l),i),t=(E(t,"data-mce-id","__mce"),t=t,e=B.fromTag("div"),t=B.fromDom(t.dom.cloneNode(!0)),A(e,t),e.dom.innerHTML);l.insertContent(t),l.addVisual()}),Et(Kn(l),'table[data-mce-id="__mce"]').map(e=>{return Pn(l)?wi(e):In(l)?bi(e):(jn(l)||(n=a.width,u(n)&&-1!==n.indexOf("%")))&&vi(e),Jn(e),N(e,"data-mce-id"),o=l,n=e,x(yt(n,"tr"),e=>{Ya(o,e.dom),x(yt(e,"th,td"),e=>{Ja(o,e.dom)})}),t=l,r=e,Et(r,"td,th").each(D(xi,t)),e.dom;var t,r,o,n}).getOrNull()};var Si=tinymce.util.Tools.resolve("tinymce.FakeClipboard");const Ti="x-tinymce/dom-table-",Ri=Ti+"rows",Di=Ti+"columns",Oi=e=>{e=Si.FakeClipboardItem(e);Si.write([e])},ki=t=>{var e=null!=(e=Si.read())?e:[];return ue(e,e=>v.from(e.getType(t)))},Ei=e=>{ki(e).isSome()&&Si.clear()},Ni=e=>{e.fold(_i,e=>Oi({[Ri]:e}))},Bi=()=>ki(Ri),_i=()=>Ei(Ri),zi=e=>{e.fold(Li,e=>Oi({[Di]:e}))},Ai=()=>ki(Di),Li=()=>Ei(Di),Wi=e=>Bl(Qn(e),Yn(e)).filter(el),Mi=(c,t)=>{const o=Yn(c),m=e=>P(e,o),a=r=>{return e=c,_l(Qn(e),Yn(e)).filter(el).bind(t=>m(t).map(e=>r(e,t)));var e},i=e=>{c.focus()},n=(r,o=!1)=>a((e,t)=>{t=El(zl(c),e,t);r(e,t,o).each(i)}),e=()=>a((e,t)=>{{var r=e,o=(e=El(zl(c),e,t),kn(f,B.fromDom(c.getDoc()),v.none()));const n=H(r);return bs(n,e).bind(e=>{var t=gs(n,o,!1),t=F(t).rows.slice(e[0].row,e[e.length-1].row+e[e.length-1].rowspan),e=S(t,e=>{var t=C(e.cells,e=>!e.isLocked);return 0<t.length?[{...e,cells:t}]:[]}),t=hs(e);return _t(0<t.length,t)}).map(e=>y(e,e=>{const r=nt(e.element);return x(e.cells,e=>{var t=lt(e.element);cs(t,"colspan",e.colspan,1),cs(t,"rowspan",e.rowspan,1),A(r,t)}),r}))}}),r=()=>a((e,t)=>{{var r=e;e=El(zl(c),e,t);const i=H(r);return ys(i,e).map(e=>{var r,o,t,n,l,s=e[e.length-1],e=e[0].column,s=s.column+s.colspan,a=(a=i,t=e,n=s,no(a)?(a=C(oo(a),oi(t,n)),a=y(a,e=>{e=lt(e.element);return ri(e,"span",n-t),e}),l=B.fromTag("colgroup"),et(l,a),[l]):[]),e=(l=i,r=e,o=s,y(l.all,e=>{var e=C(e.cells,oi(r,o)),e=y(e,e=>{e=lt(e.element);return ri(e,"colspan",o-r),e}),t=B.fromTag("tr");return et(t,e),t}));return[...a,...e]})}}),l=(s,e)=>e().each(e=>{const l=y(e,e=>lt(e));a((e,t)=>{var r,o=En(B.fromDom(c.getDoc())),n=(n=zl(c),r=l,o=o,{selection:xl(n),clipboard:r,generators:o});s(e,n).each(i)})}),s=o=>(e,t)=>{return r=t,(we(r,"type")?v.from(r.type):v.none()).each(e=>{n(o(e),t.no_events)});var r};T({mceTableSplitCells:()=>n(t.unmergeCells),mceTableMergeCells:()=>n(t.mergeCells),mceTableInsertRowBefore:()=>n(t.insertRowsBefore),mceTableInsertRowAfter:()=>n(t.insertRowsAfter),mceTableInsertColBefore:()=>n(t.insertColumnsBefore),mceTableInsertColAfter:()=>n(t.insertColumnsAfter),mceTableDeleteCol:()=>n(t.deleteColumn),mceTableDeleteRow:()=>n(t.deleteRow),mceTableCutCol:()=>r().each(e=>{zi(e),n(t.deleteColumn)}),mceTableCutRow:()=>e().each(e=>{Ni(e),n(t.deleteRow)}),mceTableCopyCol:()=>r().each(e=>zi(e)),mceTableCopyRow:()=>e().each(e=>Ni(e)),mceTablePasteColBefore:()=>l(t.pasteColsBefore,Ai),mceTablePasteColAfter:()=>l(t.pasteColsAfter,Ai),mceTablePasteRowBefore:()=>l(t.pasteRowsBefore,Bi),mceTablePasteRowAfter:()=>l(t.pasteRowsAfter,Bi),mceTableDelete:()=>Wi(c).each(e=>{P(e,o).filter(Y(o)).each(e=>{var t=B.fromText("");if(Je(e,t),L(e),c.dom.isEmpty(c.getBody()))c.setContent(""),c.selection.setCursorLocation();else{const e=c.dom.createRng();e.setStart(t.dom,0),e.setEnd(t.dom,0),c.selection.setRng(e),c.nodeChanged()}})}),mceTableCellToggleClass:(e,n)=>{a(e=>{const t=zl(c),r=ae(t,e=>c.formatter.match("tablecellclass",{value:n},e.dom)),o=r?c.formatter.remove:c.formatter.apply;x(t,e=>o("tablecellclass",{value:n},e.dom)),Qa(c,e.dom,Xa)})},mceTableToggleClass:(e,t)=>{a(e=>{c.formatter.toggle("tableclass",{value:t},e.dom),Qa(c,e.dom,Xa)})},mceTableToggleCaption:()=>{Wi(c).each(t=>{P(t,o).each(o=>{kt(o,"caption").fold(()=>{var e,t,r=B.fromTag("caption");A(r,B.fromText("Caption")),e=o,t=r,Ke(e,0).fold(()=>{A(e,t)},e=>{Ye(e,t)}),c.selection.setCursorLocation(r.dom,0)},e=>{g("caption")(t)&&je("td",o).each(e=>c.selection.setCursorLocation(e.dom,0)),L(e)}),Qa(c,o.dom,q)})})},mceTableSizingMode:(e,t)=>{return r=t,Wi(c).each(e=>{In(c)||Pn(c)||jn(c)||P(e,o).each(e=>{"relative"!==r||fi(e)?"fixed"!==r||gi(e)?"responsive"!==r||hi(e)||bi(e):wi(e):vi(e),Jn(e),Qa(c,e.dom,q)})});var r},mceTableCellType:s(e=>"th"===e?t.makeCellsHeader:t.unmakeCellsHeader),mceTableColType:s(e=>"th"===e?t.makeColumnsHeader:t.unmakeColumnsHeader),mceTableRowType:s(e=>{switch(e){case"header":return t.makeRowsHeader;case"footer":return t.makeRowsFooter;default:return t.makeRowsBody}})},(e,t)=>c.addCommand(t,e)),c.addCommand("mceInsertTable",(e,t)=>{{var[t,r,o,n={}]=[c,t.rows,t.columns,t.options];const l=e=>K(e)&&0<e;if(l(r)&&l(o)){const l=n.headerRows||0,s=n.headerColumns||0;void Ci(t,o,r,s,l)}else console.error("Invalid values for mceInsertTable - rows and columns values are required to insert a table.")}}),c.addCommand("mceTableApplyCellStyle",(e,t)=>{const o=e=>"tablecell"+e.toLowerCase().replace("-","");if($(t)){const i=C(zl(c),el);var r,n,l,s,a;0===i.length||(t=t,r=(e,t)=>c.formatter.has(o(t))&&u(e),s=a={},n=(e,t)=>{s[t]=e},l=f,T(t,(e,t)=>{(r(e,t)?n:l)(e,t)}),(e=>{for(const t in e)if(ge.call(e,t))return!1;return!0})(t=a))||(T(t,(t,e)=>{const r=o(e);x(i,e=>{""===t?c.formatter.remove(r,{value:null},e.dom,!0):c.formatter.apply(r,{value:t},e.dom)})}),m(i[0]).each(e=>Qa(c,e.dom,Xa)))}})},ji=Vs([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),V={before:ji.before,on:ji.on,after:ji.after,cata:(e,t,r,o)=>e.fold(t,r,o),getStart:e=>e.fold(p,p,p)},Pi=(e,t)=>({selection:e,kill:t}),Ii=(e,t)=>{e=e.document.createRange();return e.selectNode(t.dom),e},Fi=(e,t)=>{e=e.document.createRange();return e.selectNodeContents(t.dom),e},Hi=(e,t,r)=>{var o,e=e.document.createRange(),n=e;return t.fold(e=>{n.setStartBefore(e.dom)},(e,t)=>{n.setStart(e.dom,t)},e=>{n.setStartAfter(e.dom)}),o=e,r.fold(e=>{o.setEndBefore(e.dom)},(e,t)=>{o.setEnd(e.dom,t)},e=>{o.setEndAfter(e.dom)}),e},qi=(e,t,r,o,n)=>{e=e.document.createRange();return e.setStart(t.dom,r),e.setEnd(o.dom,n),e},Vi=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),$i=Vs([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ui=(e,t,r)=>t(B.fromDom(r.startContainer),r.startOffset,B.fromDom(r.endContainer),r.endOffset),Gi=(e,t)=>{n=e;var n,e=t.match({domRange:e=>({ltr:h(e),rtl:v.none}),relative:(e,t)=>({ltr:ir(()=>Hi(n,e,t)),rtl:ir(()=>v.some(Hi(n,t,e)))}),exact:(e,t,r,o)=>({ltr:ir(()=>qi(n,e,t,r,o)),rtl:ir(()=>v.some(qi(n,r,o,e,t)))})});{const r=(t=e).ltr();return r.collapsed?t.rtl().filter(e=>!1===e.collapsed).map(e=>$i.rtl(B.fromDom(e.endContainer),e.endOffset,B.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>Ui(0,$i.ltr,r)):Ui(0,$i.ltr,r)}},Ki=(l,e)=>Gi(l,e).match({ltr:(e,t,r,o)=>{var n=l.document.createRange();return n.setStart(e.dom,t),n.setEnd(r.dom,o),n},rtl:(e,t,r,o)=>{var n=l.document.createRange();return n.setStart(r.dom,o),n.setEnd(e.dom,t),n}}),Yi=($i.ltr,$i.rtl,(e,t,r,o)=>({start:e,soffset:t,finish:r,foffset:o})),Ji=(e,t,r,o)=>({start:V.on(e,t),finish:V.on(r,o)}),Qi=(e,t)=>{e=Ki(e,t);return Yi(B.fromDom(e.startContainer),e.startOffset,B.fromDom(e.endContainer),e.endOffset)},Xi=Ji,Zi=(r,e,o,t,n)=>z(o,t)?v.none():hl(o,t,e).bind(e=>{var t=e.boxes.getOr([]);return 1<t.length?(n(r,t,e.start,e.finish),v.some(Pi(v.some(Xi(o,0,o,pn(o))),!0))):v.none()}),ec=(e,t)=>({item:e,mode:t}),tc=(e,t,r,o=rc)=>e.property().parent(t).map(e=>ec(e,o)),rc=(e,t,r,o=oc)=>r.sibling(e,t).map(e=>ec(e,o)),oc=(e,t,r,o=oc)=>{e=e.property().children(t);return r.first(e).map(e=>ec(e,o))},nc=[{current:tc,next:rc,fallback:v.none()},{current:rc,next:oc,fallback:v.some(tc)},{current:oc,next:oc,fallback:v.some(rc)}],lc=(t,r,o,n,e=nc)=>ne(e,e=>e.current===o).bind(e=>e.current(t,r,n,e.next).orThunk(()=>e.fallback.bind(e=>lc(t,r,e,n)))),sc=(t,e,r,o,n,l)=>lc(t,e,o,n).bind(e=>l(e.item)?v.none():r(e.item)?v.some(e.item):sc(t,e.item,r,e.mode,n,l)),ac=t=>e=>0===t.property().children(e).length,ic=(e,t,r,o)=>sc(e,t,r,rc,{sibling:(e,t)=>e.query().prevSibling(t),first:e=>0<e.length?v.some(e[e.length-1]):v.none()},o),cc=(e,t,r,o)=>sc(e,t,r,rc,{sibling:(e,t)=>e.query().nextSibling(t),first:e=>0<e.length?v.some(e[0]):v.none()},o),mc=cl(),dc=(e,t)=>{return r=mc,e=e,t=t,ic(r,e,ac(r),t);var r},uc=(e,t)=>{return r=mc,e=e,t=t,cc(r,e,ac(r),t);var r},fc=Vs([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),gc=e=>M(e,"tr"),hc={...fc,verify:(l,e,t,r,s,a,o)=>M(r,"td,th",o).bind(n=>M(e,"td,th",o).map(o=>z(n,o)?z(r,n)&&pn(n)===s?a(o):fc.none("in same cell"):fl(gc,[n,o]).fold(()=>{return t=n,r=(e=l).getRect(o),(e=e.getRect(t)).right>r.left&&e.left<r.right?fc.success():a(o);var e,t,r},e=>a(o)))).getOr(fc.none("default")),cata:(e,t,r,o,n)=>e.fold(t,r,o,n)},pc=g("br"),vc=(e,t,r)=>t(e,r).bind(e=>ke(e)&&0===fn(e).trim().length?vc(e,t,r):v.some(e)),wc=(t,e,r,o)=>{return n=e,l=r,Ke(n,l).filter(pc).orThunk(()=>Ke(n,l-1).filter(pc)).bind(e=>o.traverse(e).fold(()=>vc(e,o.gather,t).map(o.relative),e=>{return n=e,qe(n).bind(t=>{const r=d(t);return e=r,o=n,le(e,D(z,o)).map(e=>({parent:t,children:r,element:n,index:e}));var e,o}).map(e=>V.on(e.parent,e.index));var n}));var n,l},bc=(e,t)=>({left:e.left,top:e.top+t,right:e.right,bottom:e.bottom+t}),yc=(e,t)=>({left:e.left,top:e.top-t,right:e.right,bottom:e.bottom-t}),xc=(e,t,r)=>({left:e.left+t,top:e.top+r,right:e.right+t,bottom:e.bottom+r}),Cc=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom}),Sc=(e,t)=>v.some(e.getRect(t)),Tc=(e,t,r)=>{return Oe(t)?Sc(e,t).map(Cc):ke(t)?(e=e,t=t,(0<=(r=r)&&r<pn(t)?e.getRangedRect(t,r,t,r+1):0<r?e.getRangedRect(t,r-1,t,r):v.none()).map(Cc)):v.none()},Rc=(e,t)=>Oe(t)?Sc(e,t).map(Cc):ke(t)?e.getRangedRect(t,0,t,pn(t)).map(Cc):v.none(),Dc=Vs([{none:[]},{retry:["caret"]}]),Oc=(t,e,r)=>Dt(e,la).fold(Q,e=>Rc(t,e).exists(e=>{return e=e,(t=r).left<e.left||Math.abs(e.right-t.left)<1||t.left>e.right;var t})),kc={point:e=>e.bottom,adjuster:(e,t,r,o,n)=>{var l=bc(n,5);return Math.abs(r.bottom-o.bottom)<1||r.top>n.bottom?Dc.retry(l):r.top===n.bottom?Dc.retry(bc(n,1)):Oc(e,t,n)?Dc.retry(xc(l,5,0)):Dc.none()},move:bc,gather:uc},Ec=(r,o,n,l,s)=>{return 0===s?v.some(l):(a=r,i=l.left,c=o.point(l),a.elementFromPoint(i,c).filter(e=>"table"===R(e)).isSome()?(a=r,i=o,c=n,e=l,t=s-1,Ec(a,i,c,i.move(e,5),t)):r.situsFromPoint(l.left,o.point(l)).bind(e=>e.start.fold(v.none,t=>Rc(r,t).bind(e=>o.adjuster(r,t,e,n,l).fold(v.none,e=>Ec(r,o,n,e,s-1))).orThunk(()=>v.some(l)),v.none)));var e,t,a,i,c},Nc=(t,r,e)=>{const o=t.move(e,5),n=Ec(r,t,e,o,100).getOr(o);return e=n,s=r,((l=t).point(e)>s.getInnerHeight()?v.some(l.point(e)-s.getInnerHeight()):l.point(e)<0?v.some(-l.point(e)):v.none()).fold(()=>r.situsFromPoint(n.left,t.point(n)),e=>(r.scrollBy(0,e),r.situsFromPoint(n.left,t.point(n)-e)));var l,s},Bc={tryUp:D(Nc,{point:e=>e.top,adjuster:(e,t,r,o,n)=>{var l=yc(n,5);return Math.abs(r.top-o.top)<1||r.bottom<n.top?Dc.retry(l):r.bottom===n.top?Dc.retry(yc(n,1)):Oc(e,t,n)?Dc.retry(xc(l,5,0)):Dc.none()},move:yc,gather:dc}),tryDown:D(Nc,kc),getJumpSize:h(5)},_c=(i,c,m)=>i.getSelection().bind(t=>{return e=c,r=t.finish,o=t.foffset,n=m,(pc(r)?(l=e,s=r,(a=n).traverse(s).orThunk(()=>vc(s,a.gather,l)).map(a.relative)):wc(e,r,o,n)).map(e=>({start:e,finish:e})).fold(()=>v.some(Ll(t.finish,t.foffset)),e=>{var e=i.fromSitus(e),e=hc.verify(i,t.finish,t.foffset,e.finish,e.foffset,m.failure,c);return hc.cata(e,e=>v.none(),()=>v.none(),e=>v.some(Ll(e,0)),e=>v.some(Ll(e,pn(e))))});var e,r,o,n,l,s,a}),zc=(r,o,n,l,s,a)=>{return 0===a?v.none():(t=r,e=n,i=l,c=s,Tc(t,e,i).bind(e=>Lc(t,c,e)).bind(e=>{var t=r.fromSitus(e),t=hc.verify(r,n,l,t.finish,t.foffset,s.failure,o);return hc.cata(t,()=>v.none(),()=>v.some(e),e=>z(n,e)&&0===l?Ac(r,n,l,yc,s):zc(r,o,e,0,s,a-1),e=>z(n,e)&&l===pn(e)?Ac(r,n,l,bc,s):zc(r,o,e,pn(e),s,a-1))}));var t,e,i,c},Ac=(t,e,r,o,n)=>Tc(t,e,r).bind(e=>Lc(t,n,o(e,Bc.getJumpSize()))),Lc=(e,t,r)=>{var o=zr().browser;return o.isChromium()||o.isSafari()||o.isFirefox()?t.retry(e,r):v.none()},Wc=(a,i,c,e,m)=>M(e,"td,th",i).bind(s=>M(s,"table",i).bind(e=>{return n=m,l=e,Rt(n,e=>qe(e).exists(e=>z(e,l)),void 0).isSome()?(t=a,r=i,o=c,_c(t,r,o).bind(e=>zc(t,r,e.element,e.offset,o,20).map(t.fromSitus)).bind(t=>M(t.finish,"td,th",i).map(e=>({start:s,finish:e,range:t})))):v.none();var t,r,o,n,l})),Mc=(e,t,r,o,n,l)=>l(o,t).orThunk(()=>Wc(e,t,r,o,n).map(e=>{e=e.range;return Pi(v.some(Xi(e.start,e.soffset,e.finish,e.foffset)),!0)})),jc=(e,o)=>M(e,"tr",o).bind(r=>M(r,"table",o).bind(e=>{var t=yt(e,"tr");return z(r,t[0])?(t=e,e=o,ic(mc,t,e=>yn(e).isSome(),e).map(e=>{var t=pn(e);return Pi(v.some(Xi(e,t,e,t)),!0)})):v.none()})),Pc=(e,o)=>M(e,"tr",o).bind(r=>M(r,"table",o).bind(e=>{var t=yt(e,"tr");return z(r,t[t.length-1])?(t=e,e=o,cc(mc,t,e=>bn(e).isSome(),e).map(e=>Pi(v.some(Xi(e,0,e,0)),!0))):v.none()})),Ic=(e,t,r,o,n,l,s)=>Wc(e,r,o,n,l).bind(e=>Zi(t,r,e.start,e.finish,s)),Fc=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},Hc=()=>{const t=(e=>{const t=Fc(v.none()),r=()=>t.get().each(e);return{clear:()=>{r(),t.set(v.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{r(),t.set(v.some(e))}}})(f);return{...t,on:e=>t.get().each(e)}},qc=(e,t)=>M(e,"td,th",t),Vc=e=>Ve(e).exists(Un),$c={traverse:Ge,gather:uc,relative:V.before,retry:Bc.tryDown,failure:hc.failedDown},Uc={traverse:Ue,gather:dc,relative:V.before,retry:Bc.tryUp,failure:hc.failedUp},Gc=t=>e=>e===t,Kc=Gc(38),Yc=Gc(40),Jc=e=>37<=e&&e<=40,Qc={isBackward:Gc(37),isForward:Gc(39)},Xc={isBackward:Gc(39),isForward:Gc(37)},Zc=Vs([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),em={domRange:Zc.domRange,relative:Zc.relative,exact:Zc.exact,exactFromRange:e=>Zc.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{e=e.match({domRange:e=>B.fromDom(e.startContainer),relative:(e,t)=>V.getStart(e),exact:(e,t,r,o)=>e});return B.fromDom(He(e).dom.defaultView)},range:Yi},tm=document.caretPositionFromPoint?(r,e,t)=>{var o,n;return v.from(null==(n=(o=r.dom).caretPositionFromPoint)?void 0:n.call(o,e,t)).bind(e=>{var t;return null===e.offsetNode?v.none():((t=r.dom.createRange()).setStart(e.offsetNode,e.offset),t.collapse(),v.some(t))})}:document.caretRangeFromPoint?(e,t,r)=>{var o;return v.from(null==(o=(e=e.dom).caretRangeFromPoint)?void 0:o.call(e,t,r))}:v.none,rm=(e,t)=>{var r=R(e);return"input"===r?V.after(e):w(["br","img"],r)?0===t?V.before(e):V.after(e):V.on(e,t)},om=e=>v.from(e.getSelection()),nm=(e,t)=>{om(e).each(e=>{e.removeAllRanges(),e.addRange(t)})},lm=(e,t,r,o,n)=>{t=qi(e,t,r,o,n);nm(e,t)},sm=(i,e)=>Gi(i,e).match({ltr:(e,t,r,o)=>{lm(i,e,t,r,o)},rtl:(n,l,s,a)=>{om(i).each(e=>{if(e.setBaseAndExtent)e.setBaseAndExtent(n.dom,l,s.dom,a);else if(e.extend)try{r=s,o=a,(t=e).collapse(n.dom,l),t.extend(r.dom,o)}catch(e){lm(i,s,a,n,l)}else lm(i,s,a,n,l);var t,r,o})}}),am=(e,t,r,o,n)=>{t=((e,t,r,o)=>{e=rm(e,t),t=rm(r,o);return em.relative(e,t)})(t,r,o,n);sm(e,t)},im=(e,t,r)=>{r=r,t=t.fold(V.before,rm,V.after),r=r.fold(V.before,rm,V.after);t=em.relative(t,r);sm(e,t)},cm=e=>{var t;return 0<e.rangeCount?(t=e.getRangeAt(0),e=e.getRangeAt(e.rangeCount-1),v.some(Yi(B.fromDom(t.startContainer),t.startOffset,B.fromDom(e.endContainer),e.endOffset))):v.none()},mm=e=>{var t,r,o,n,l,s,a,i,c,m,d;return null!==e.anchorNode&&null!==e.focusNode&&(t=B.fromDom(e.anchorNode),r=B.fromDom(e.focusNode),o=t,n=e.anchorOffset,l=r,s=e.focusOffset,m=o,d=n,a=l,i=s,(c=Fe(m).dom.createRange()).setStart(m.dom,d),c.setEnd(a.dom,i),m=c,d=z(o,l)&&n===s,m.collapsed)&&!d?v.some(Yi(t,e.anchorOffset,r,e.focusOffset)):cm(e)},dm=(e,t,r=!0)=>{r=(r?Fi:Ii)(e,t);nm(e,r)},um=e=>{return e=e,om(e).filter(e=>0<e.rangeCount).bind(mm).map(e=>em.exact(e.start,e.soffset,e.finish,e.foffset))},fm=l=>({elementFromPoint:(e,t)=>B.fromPoint(B.fromDom(l.document),e,t),getRect:e=>e.dom.getBoundingClientRect(),getRangedRect:(e,t,r,o)=>{e=em.exact(e,t,r,o);return t=l,r=e,t=Ki(t,r),0<(r=0<(r=t.getClientRects()).length?r[0]:t.getBoundingClientRect()).width||0<r.height?v.some(r).map(Vi):v.none()},getSelection:()=>um(l).map(e=>Qi(l,e)),fromSitus:e=>{e=em.relative(e.start,e.finish);return Qi(l,e)},situsFromPoint:(e,t)=>{return r=l,e=e,t=t,r=B.fromDom(r.document),tm(r,e,t).map(e=>Yi(B.fromDom(e.startContainer),e.startOffset,B.fromDom(e.endContainer),e.endOffset)).map(e=>Ji(e.start,e.soffset,e.finish,e.foffset));var r},clearSelection:()=>{var e;e=l,om(e).each(e=>e.removeAllRanges())},collapseSelection:(n=!1)=>{um(l).each(e=>e.fold(e=>e.collapse(n),(e,t)=>{e=n?e:t;im(l,e,e)},(e,t,r,o)=>{e=n?e:r,r=n?t:o;am(l,e,r,e,r)}))},setSelection:e=>{am(l,e.start,e.soffset,e.finish,e.foffset)},setRelativeSelection:(e,t)=>{im(l,e,t)},selectNode:e=>{dm(l,e,!1)},selectContents:e=>{dm(l,e)},getInnerHeight:()=>l.innerHeight,getScrollY:()=>{return e=void 0!==(e=B.fromDom(l.document))?e.dom:document,t=e.body.scrollLeft||e.documentElement.scrollLeft,e=e.body.scrollTop||e.documentElement.scrollTop,ho(t,e).top;var e,t},scrollBy:(e,t)=>{var r=B.fromDom(l.document);(r=(void 0!==r?r.dom:document).defaultView)&&r.scrollBy(e,t)}}),gm=(e,t)=>({rows:e,cols:t}),hm=e=>Dt(e,De).exists(Un),pm=(e,t)=>hm(e)||hm(t),vm=e=>void 0!==e.dom.classList,wm=(e,t)=>{vm(e)?e.dom.classList.add(t):(t=t,t=(e=>{e=ze(e,"class");return void 0===e||""===e?[]:e.split(" ")})(e=e).concat([t]),E(e,"class",t.join(" ")))},bm=(e,t)=>vm(e)&&e.dom.classList.contains(t),ym=()=>({tag:"none"}),xm=e=>({tag:"multiple",elements:e}),Cm=e=>({tag:"single",element:e}),Sm=e=>{var t,r,o,n,l=B.fromDom((e=>{if(ut()&&m(e.target)){var t=B.fromDom(e.target);if(Oe(t)&&m(t.dom.shadowRoot)&&e.composed&&e.composedPath){t=e.composedPath();if(t)return me(t)}}return v.from(e.target)})(e).getOr(e.target)),s=()=>e.stopPropagation(),a=()=>e.preventDefault(),i=(t=a,r=s,(...e)=>t(r.apply(null,e)));return o=e.clientX,n=e.clientY,{target:l,x:o,y:n,stop:s,prevent:a,kill:i,raw:e}},Tm=(e,t,r,o)=>{e.dom.removeEventListener(t,r,o)},Rm=O,Dm=(e,t,r)=>{return e=e,t=t,o=Rm,t=t,n=o,l=r=r,o=e=>{n(e)&&l(Sm(e))},(r=e).dom.addEventListener(t,o,!1),{unbind:D(Tm,r,t,o,!1)};var o,n,l},Om=Sm,km=e=>!bm(B.fromDom(e.target),"ephox-snooker-resizer-bar"),Em=(m,d)=>{e=kl.selectedSelector;const o={get:()=>bl(B.fromDom(m.getBody()),e).fold(()=>_l(Qn(m),Yn(m)).fold(ym,Cm),xm)},u=((a,t)=>{const r=e=>{N(e,a.selected),N(e,a.firstSelected),N(e,a.lastSelected)},i=e=>{E(e,a.selected,"1")},c=e=>{o(e),t()},o=e=>{e=yt(e,`${a.selectedSelector},${a.firstSelectedSelector},`+a.lastSelectedSelector);x(e,r)};return{clearBeforeUpdate:o,clear:c,selectRange:(e,t,r,o)=>{var n,l,s;c(e),x(t,i),E(r,a.firstSelected,"1"),E(o,a.lastSelected,"1"),n=t,l=r,s=o,P(l).each(e=>{var t,r,o=_n(m),o=kn(f,B.fromDom(m.getDoc()),o),e=((e,t,a)=>{const i=H(e);return bs(i,t).map(e=>{const t=gs(i,a,!1),r=F(t)["rows"],o=(l=e,s=r.slice(0,l[l.length-1].row+1),s=hs(s),S(s,e=>{e=e.cells.slice(0,l[l.length-1].column+1);return y(e,e=>e.element)})),n=((e,t)=>{e=e.slice(t[0].row+t[0].rowspan-1,e.length),e=hs(e);return S(e,e=>{e=e.cells.slice(t[0].column+t[0].colspan-1,e.cells.length);return y(e,e=>e.element)})})(r,e);var l,s;return{upOrLeftCells:o,downOrRightCells:n}})})(e,{selection:zl(m)},o);o=n,t=l,r=s,m.dispatch("TableSelectionChange",{cells:o,start:t,finish:r,otherCells:e})})},selectedSelector:a.selectedSelector,firstSelectedSelector:a.firstSelectedSelector,lastSelectedSelector:a.lastSelectedSelector}})(kl,()=>{m.dispatch("TableSelectionClear")});var e;return m.on("init",e=>{const r=m.getWin(),o=Kn(m),t=Yn(m),n=((e,t,r,o)=>{e=((l,s,t,a)=>{const r=Hc(),o=r.clear,n=n=>{r.on(e=>{a.clearBeforeUpdate(s),qc(n.target,t).each(o=>{hl(e,o,t).each(e=>{var t=e.boxes.getOr([]);if(1===t.length){const e=t[0],o="false"===Gn(e),r=Nt($n(n.target),e,z);o&&r&&(a.selectRange(s,t,e,e),l.selectContents(e))}else 1<t.length&&(a.selectRange(s,t,e.start,e.finish),l.selectContents(o))})})})};return{clearstate:o,mousedown:e=>{a.clear(s),qc(e.target,t).filter(Vc).each(r.set)},mouseover:e=>{n(e)},mouseup:e=>{n(e),o()}}})(fm(e),t,r,o);return{clearstate:e.clearstate,mousedown:e.mousedown,mouseover:e.mouseover,mouseup:e.mouseup}})(r,o,t,u),l=((e,u,f,g)=>{const m=fm(e),d=()=>(g.clear(u),v.none());return{keydown:(e,t,r,o,n,s)=>{const l=e.raw,a=l.which,i=!0===l.shiftKey,c=pl(u,g.selectedSelector).fold(()=>(Jc(a)&&!i&&g.clearBeforeUpdate(u),Jc(a)&&i&&!pm(t,o)?v.none:Yc(a)&&i?D(Ic,m,u,f,$c,o,t,g.selectRange):Kc(a)&&i?D(Ic,m,u,f,Uc,o,t,g.selectRange):Yc(a)?D(Mc,m,f,$c,o,t,Pc):Kc(a)?D(Mc,m,f,Uc,o,t,jc):v.none),l=>{var e=e=>()=>{return ue(e,e=>{return t=e.rows,e=e.cols,r=u,o=l,n=g,wl(o,t,e,n.firstSelectedSelector,n.lastSelectedSelector).map(e=>(n.clearBeforeUpdate(r),n.selectRange(r,e.boxes,e.start,e.finish),e.boxes));var t,r,o,n}).fold(()=>vl(u,g.firstSelectedSelector,g.lastSelectedSelector).map(e=>{var t=Yc(a)||s.isForward(a)?V.after:V.before;return m.setRelativeSelection(V.on(e.first,0),t(e.table)),g.clear(u),Pi(v.none(),!0)}),e=>v.some(Pi(v.none(),!0)))};return Jc(a)&&i&&!pm(t,o)?v.none:Yc(a)&&i?e([gm(1,0)]):Kc(a)&&i?e([gm(-1,0)]):s.isBackward(a)&&i?e([gm(0,-1),gm(-1,0)]):s.isForward(a)&&i?e([gm(0,1),gm(1,0)]):Jc(a)&&!i?d:v.none});return c()},keyup:(a,i,c,m,d)=>pl(u,g.selectedSelector).fold(()=>{var r,o,e,t,n,l=a.raw,s=l.which;return!0!==l.shiftKey||!Jc(s)||!pm(i,m)||(r=u,o=f,l=i,s=c,e=m,t=d,n=g.selectRange,z(l,e)&&s===t)?v.none():M(l,"td,th",o).bind(t=>M(e,"td,th",o).bind(e=>Zi(r,o,t,e,n)))},v.none)}})(r,o,t,u),s=((e,o,t,n)=>{const l=fm(e);return(e,r)=>{n.clearBeforeUpdate(o),hl(e,r,t).each(e=>{var t=e.boxes.getOr([]);n.selectRange(o,t,e.start,e.finish),l.selectContents(r),l.collapseSelection()})}})(r,o,t,u),a=(m.on("TableSelectorChange",e=>s(e.start,e.finish)),(e,t)=>{!0===e.raw.shiftKey&&(t.kill&&e.kill(),t.selection.each(e=>{e=em.relative(e.start,e.finish),e=Ki(r,e);m.selection.setRng(e)}))}),i=e=>0===e.button,c=(()=>{const n=Fc(B.fromDom(o)),l=Fc(0);return{touchEnd:e=>{var t,r,o=B.fromDom(e.target);(g("td")(o)||g("th")(o))&&(t=n.get(),r=l.get(),z(t,o))&&e.timeStamp-r<300&&(e.preventDefault(),s(o,o)),n.set(o),l.set(e.timeStamp)}}})();m.on("dragstart",e=>{n.clearstate()}),m.on("mousedown",e=>{i(e)&&km(e)&&n.mousedown(Om(e))}),m.on("mouseover",e=>{void 0!==e.buttons&&0==(1&e.buttons)||!km(e)||n.mouseover(Om(e))}),m.on("mouseup",e=>{i(e)&&km(e)&&n.mouseup(Om(e))}),m.on("touchend",c.touchEnd),m.on("keyup",e=>{const t=Om(e);if(t.raw.shiftKey&&Jc(t.raw.which)){const e=m.selection.getRng(),r=B.fromDom(e.startContainer),o=B.fromDom(e.endContainer);l.keyup(t,r,e.startOffset,o,e.endOffset).each(e=>{a(t,e)})}}),m.on("keydown",e=>{const t=Om(e);d.hide();var e=m.selection.getRng(),r=B.fromDom(e.startContainer),o=B.fromDom(e.endContainer),n=co(Qc,Xc)(B.fromDom(m.selection.getStart()));l.keydown(t,r,e.startOffset,o,e.endOffset,n).each(e=>{a(t,e)}),d.show()}),m.on("NodeChange",()=>{var e=m.selection,t=B.fromDom(e.getStart()),e=B.fromDom(e.getEnd());fl(P,[t,e]).fold(()=>u.clear(o),f)})}),m.on("PreInit",()=>{m.serializer.addTempAttr(kl.firstSelected),m.serializer.addTempAttr(kl.lastSelected)}),{getSelectedCells:()=>{var e,t=o.get(),r=h([]);switch(t.tag){case"none":return r();case"single":return[t.element.dom];case"multiple":return e=t.elements,y(e,e=>e.dom)}},clearSelectedCells:e=>u.clear(B.fromDom(e))}},Nm=e=>{let n=[];return{bind:e=>{if(void 0===e)throw new Error("Event bind error: undefined handler");n.push(e)},unbind:t=>{n=C(n,e=>e!==t)},trigger:(...r)=>{const o={};x(e,(e,t)=>{o[e]=r[t]}),x(n,e=>{e(o)})}}},Bm=e=>({registry:he(e,e=>({bind:e.bind,unbind:e.unbind})),trigger:he(e,e=>e.trigger)}),_m=e=>e.slice(0).sort(),zm=(t,e)=>{var e=C(e,e=>!w(t,e));if(0<e.length)throw e=e,new Error("Unsupported keys for object: "+_m(e).join(", "))},Am=e=>{var n=zm,l=e,s={validate:G,label:"function"};if(0===l.length)throw new Error("You must specify at least one required field.");e=l;if(!i(e))throw new Error("The required fields must be an array. Was: "+e+".");x(e,e=>{if(!u(e))throw new Error("The value "+e+" in the required fields was not a string.")});{e=l;const r=_m(e);ne(r,(e,t)=>t<r.length-1&&e===r[t+1]).each(e=>{throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+r.join(", ")+"].")})}return t=>{const r=fe(t);{var e,o;if(!ae(l,e=>w(r,e)))throw e=l,o=r,new Error("All required keys ("+_m(e).join(", ")+") were not specified. Specified keys were: "+_m(o).join(", ")+".")}n(l,r);e=C(l,e=>!s.validate(t[e],e));if(0<e.length)throw o=e,new Error("All values need to be of type: "+s.label+". Keys ("+_m(o).join(", ")+") were not.");return t}},Lm=Am(["compare","extract","mutate","sink"]),Wm=Am(["element","start","stop","destroy"]),Mm=Am(["forceDrop","drop","move","delayDrop"]),jm=()=>{r=Bm({move:Nm(["info"])});const e={onEvent:f,reset:f,events:r.registry},t=(()=>{let n=v.none();const l=Bm({move:Nm(["info"])});return{onEvent:(e,o)=>{o.extract(e).each(e=>{var t,r;t=o,r=e,e=n.map(e=>t.compare(e,r)),n=v.some(r),e.each(e=>{l.trigger.move(e)})})},reset:()=>{n=v.none()},events:l.registry}})();var r;let o=e;return{on:()=>{o.reset(),o=t},off:()=>{o.reset(),o=e},isOn:()=>o===t,onEvent:(e,t)=>{o.onEvent(e,t)},events:t.events}},Pm=e=>{const t=e.replace(/\./g,"-");return{resolve:e=>t+"-"+e}},Im=Pm("ephox-dragster").resolve;var Fm=Lm({compare:(e,t)=>ho(t.left-e.left,t.top-e.top),extract:e=>v.some(ho(e.x,e.y)),sink:(e,t)=>{const r=(e=>{const t={layerClass:Im("blocker"),...e},r=B.fromTag("div");return E(r,"role","presentation"),It(r,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),wm(r,Im("blocker")),wm(r,t.layerClass),{element:h(r),destroy:()=>{L(r)}}})(t),o=Dm(r.element(),"mousedown",e.forceDrop),n=Dm(r.element(),"mouseup",e.drop),l=Dm(r.element(),"mousemove",e.move),s=Dm(r.element(),"mouseout",e.delayDrop);return Wm({element:r.element,start:e=>{A(e,r.element())},stop:()=>{L(r.element())},destroy:()=>{r.destroy(),n.unbind(),l.unbind(),s.unbind(),o.unbind()}})},mutate:(e,t)=>{e.mutate(t.left,t.top)}});const Hm=Pm("ephox-snooker").resolve,qm=Hm("resizer-bar"),Vm=Hm("resizer-rows"),$m=Hm("resizer-cols"),Um=e=>{e=yt(e.parent(),"."+qm);x(e,L)},Gm=(t,e,r)=>{const o=t.origin();x(e,e=>{e.each(e=>{e=r(o,e);wm(e,qm),A(t.parent(),e)})})},Km=(e,t,r,o,n)=>{const l=vo(r),s=t.isResizable,a=0<o.length?Eo.positions(o,r):[],i=0<a.length?(o=e,c=s,S(o.all,(e,t)=>c(e.element)?[t]:[])):[];var c,m,d,u,f,g;o=t,u=C(a,(e,t)=>b(i,e=>t===e)),m=l,d=jr(r),Gm(o,u,(e,t)=>{r=t.row,n=m.left-e.left,t=t.y-e.top,e=d,o=B.fromTag("div"),It(o,{position:"absolute",left:n+"px",top:t-3.5+"px",height:"7px",width:e+"px"}),_e(o,{"data-row":r,role:"presentation"});var r,o,n=o;return wm(n,Vm),n});const h=0<n.length?Bo.positions(n,r):[],p=0<h.length?((r,o)=>{const t=[];return k(r.grid.columns,e=>{lo(r,e).map(e=>e.element).forall(o)&&t.push(e)}),C(t,t=>{var e=to(r,e=>e.column===t);return ae(e,e=>o(e.element))})})(e,s):[];o=t,u=C(h,(e,t)=>b(p,e=>t===e)),f=l,g=fo(r),Gm(o,u,(e,t)=>{r=t.col,t=t.x-e.left,e=f.top-e.top,o=g,n=B.fromTag("div"),It(n,{position:"absolute",left:t-3.5+"px",top:e+"px",height:o+"px",width:"7px"}),_e(n,{"data-column":r,role:"presentation"});var r,o,n,t=n;return wm(t,$m),t})},Ym=(e,t)=>{var r,o,n;Um(e),e.isResizable(t)&&(r=H(t),o=io(r),n=so(r),Km(r,e,t,o,n))},Jm=(e,t)=>{e=yt(e.parent(),"."+qm);x(e,t)},Qm=e=>{Jm(e,e=>{j(e,"display","none")})},Xm=e=>{Jm(e,e=>{j(e,"display","block")})},Zm=Hm("resizer-bar-dragging"),ed=n=>{const r=(()=>{const r=Bm({drag:Nm(["xDelta","yDelta","target"])});let o=v.none();var e=(()=>{const r=Bm({drag:Nm(["xDelta","yDelta"])});return{mutate:(e,t)=>{r.trigger.drag(e,t)},events:r.registry}})();return e.events.drag.bind(t=>{o.each(e=>{r.trigger.drag(t.xDelta,t.yDelta,e)})}),{assign:e=>{o=v.some(e)},get:()=>o,mutate:e.mutate,events:r.registry}})(),o=((e,t)=>{{var o=e,n=null!=(e=t.mode)?e:Fm;e=t;let r=!1;const l=Bm({start:Nm([]),stop:Nm([])}),s=jm(),a=()=>{m.stop(),s.isOn()&&(s.off(),l.trigger.stop())},i=(t=>{let r=null;const o=()=>{U(r)||(clearTimeout(r),r=null)};return{cancel:o,throttle:(...e)=>{o(),r=setTimeout(()=>{r=null,t.apply(null,e)},200)}}})(a),c=(s.events.move.bind(e=>{n.mutate(o,e.info)}),t=>(...e)=>{r&&t.apply(null,e)}),m=n.sink(Mm({forceDrop:a,drop:c(a),move:c(e=>{i.cancel(),s.onEvent(e,n)}),delayDrop:c(i.throttle)}),e);return{element:m.element,go:e=>{m.start(e),s.on(),l.trigger.start()},on:()=>{r=!0},off:()=>{r=!1},isActive:()=>r,destroy:()=>{m.destroy()},events:l.registry}}})(r,{});let l=v.none();const e=(e,t)=>v.from(ze(e,t)),s=(r.events.drag.bind(r=>{e(r.target,"data-row").each(e=>{var t=Yt(r.target,"top");j(r.target,"top",t+r.yDelta+"px")}),e(r.target,"data-column").each(e=>{var t=Yt(r.target,"left");j(r.target,"left",t+r.xDelta+"px")})}),(e,t)=>Yt(e,t)-$t(e,"data-initial-"+t,0)),a=(o.events.stop.bind(()=>{r.get().each(o=>{l.each(r=>{e(o,"data-row").each(e=>{var t=s(o,"top");N(o,"data-initial-top"),m.trigger.adjustHeight(r,t,parseInt(e,10))}),e(o,"data-column").each(e=>{var t=s(o,"left");N(o,"data-initial-left"),m.trigger.adjustWidth(r,t,parseInt(e,10))}),Ym(n,r)})})}),(e,t)=>{m.trigger.startAdjust(),r.assign(e),E(e,"data-initial-"+t,Yt(e,t)),wm(e,Zm),j(e,"opacity","0.2"),o.go(n.parent())}),t=Dm(n.parent(),"mousedown",e=>{var t=e.target;bm(t,Vm)&&a(e.target,"top"),t=e.target,bm(t,$m)&&a(e.target,"left")}),i=e=>z(e,n.view()),c=Dm(n.view(),"mouseover",e=>{var t=e.target;M(t,"table",i).filter(Un).fold(()=>{ht(e.target)&&Um(n)},e=>{o.isActive()&&(l=v.some(e),Ym(n,e))})}),m=Bm({adjustHeight:Nm(["table","delta","row"]),adjustWidth:Nm(["table","delta","column"]),startAdjust:Nm([])});return{destroy:()=>{t.unbind(),c.unbind(),o.destroy(),Um(n)},refresh:e=>{Ym(n,e)},on:o.on,off:o.off,hideBars:D(Qm,n),showBars:D(Xm,n),events:m.registry}},td=(e,n,l)=>{const c=Eo,s=Bo,t=ed(e),m=Bm({beforeResize:Nm(["table","type"]),afterResize:Nm(["table","type"]),startDrag:Nm([])});return t.events.adjustHeight.bind(e=>{var t,r,o,n,l,s,a,i=e.table;m.trigger.beforeResize(i,"row"),t=i,r=c.delta(e.delta,i),o=e.row,e=c,l=H(t),s=l,a=t,e=e,s=on(s,a,e,Uo,e=>e.getOrThunk(Qt)),a=y(s,(e,t)=>o===t?Math.max(r+e,Qt()):e),e=((e,r)=>{e=ro(e);return y(e,e=>{var t=Us(e.row,e.row+e.rowspan,r);return{element:e.element,height:t,rowspan:e.rowspan}})})(l,a),s=l,n=a,l=y(s.all,(e,t)=>({element:e.element,height:n[t]})),x(l,e=>{Io(e.element,e.height)}),x(e,e=>{Io(e.element,e.height)}),s=re(a,(e,t)=>e+t,0),Io(t,s),m.trigger.afterResize(i,"row")}),t.events.startAdjust.bind(e=>{m.trigger.startDrag()}),t.events.adjustWidth.bind(e=>{var t=e.table,r=(m.trigger.beforeResize(t,"col"),s.delta(e.delta,t)),o=l(t);Ks(t,r,e.column,n,o),m.trigger.afterResize(t,"col")}),{on:t.on,off:t.off,refreshBars:t.refresh,hideBars:t.hideBars,showBars:t.showBars,destroy:t.destroy,events:m.registry}},rd=e=>m(e)&&"TABLE"===e.nodeName,od="bar-",nd=e=>"false"!==ze(e,"data-mce-resize"),ld=a=>{const i=Hc(),c=Hc(),m=Hc();let d,u;const f=e=>ei(a,e),g=()=>(Ln(a)?Kl:Gl)();return a.on("init",()=>{n=a,e=nd;var e,t,r,o,n,l=n.inline?(r=B.fromDom(n.getBody()),o=B.fromTag("div"),It(o,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),A(pt(B.fromDom(document)),o),o=o,l=e,{parent:h(o),view:h(r),origin:h(ho(0,0)),isResizable:l}):(o=B.fromDom(n.getDoc()),r=e,t=Ee(o)?(t=o,B.fromDom(He(t).dom.documentElement)):o,{parent:h(t),view:h(o),origin:h(ho(0,0)),isResizable:r});if(m.set(l),n=a.options.get("object_resizing"),w(n.split(","),"table")&&Fn(a)){const m=g(),s=td(l,m,f);s.on(),s.events.startDrag.bind(e=>{i.set(a.selection.getRng())}),s.events.beforeResize.bind(e=>{var t,r,o,n=e.table.dom;t=a,r=n,o=Xn(n),n=Zn(n),e=od+e.type,t.dispatch("ObjectResizeStart",{target:r,width:o,height:n,origin:e})}),s.events.afterResize.bind(e=>{var t,r,o=e.table,n=o.dom;Jn(o),i.on(e=>{a.selection.setRng(e),a.focus()}),o=a,t=n,r=Xn(n),n=Zn(n),e=od+e.type,o.dispatch("ObjectResized",{target:t,width:r,height:n,origin:e}),a.undoManager.add()}),c.set(s)}}),a.on("ObjectResizeStart",e=>{var t,r=e.target;rd(r)&&(t=B.fromDom(r),x(a.dom.select(".mce-clonedresizable"),e=>{a.dom.addClass(e,"mce-"+An(a)+"-columns")}),!gi(t)&&Pn(a)?wi(t):!fi(t)&&jn(a)&&vi(t),hi(t)&&At(e.origin,od)&&vi(t),d=e.width,u=In(a)?"":((e,t)=>{e=e.dom.getStyle(t,"width")||e.dom.getAttrib(t,"width");return v.from(e).filter(Mt)})(a,r).getOr(""))}),a.on("ObjectResized",e=>{var t=e.target;if(rd(t)){var t=B.fromDom(t),r=e.origin;if(At(r,"corner-")){var o=t;var n=r;r=e.width;e=Lt(n,"e");if(""===u&&vi(o),r!==d&&""!==u){j(o,"width",u);const n=g(),l=f(o),s=Ln(a)||e?(e=o,Yl(e).columns-1):0;Ks(o,r-d,s,n,l)}else if(/^(\d+(\.\d+)?)%$/.test(u)){const a=parseFloat(u.replace("%",""));j(o,"width",r*a/d+"%")}/^(\d+(\.\d+)?)px$/.test(u)&&(n=o,e=H(n),no(e)||x(tr(n),e=>{var t=Ft(e,"width");j(e,"width",t),N(e,"width")}))}Jn(t),Qa(a,t.dom,Xa)}}),a.on("SwitchMode",()=>{c.on(e=>{a.mode.isReadOnly()?e.hideBars():e.showBars()})}),a.on("dragstart dragend",t=>{c.on(e=>{"dragstart"===t.type?(e.hideBars(),e.off()):(e.on(),e.showBars())})}),a.on("remove",()=>{c.on(e=>{e.destroy()}),m.on(e=>{e=e,a.inline&&L(e.parent())})}),{refresh:t=>{c.on(e=>e.refreshBars(B.fromDom(t)))},hide:()=>{c.on(e=>e.hideBars())},show:()=>{c.on(e=>e.showBars())}}};t.add("dom",e=>({table:(e=>{(t=e.options.register)("table_clone_elements",{processor:"string[]"}),t("table_use_colgroups",{processor:"boolean",default:!0}),t("table_header_type",{processor:e=>{var t=w(["section","cells","sectionCells","auto"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be one of: section, cells, sectionCells or auto."}},default:"section"}),t("table_sizing_mode",{processor:"string",default:"auto"}),t("table_default_attributes",{processor:"object",default:{border:"1"}}),t("table_default_styles",{processor:"object",default:{"border-collapse":"collapse"}}),t("table_column_resizing",{processor:e=>{var t=w(["preservetable","resizetable"],e);return t?{value:e,valid:t}:{valid:!1,message:"Must be preservetable, or resizetable."}},default:"preservetable"}),t("table_resize_bars",{processor:"boolean",default:!0}),t("table_style_by_css",{processor:"boolean",default:!0}),t("table_merge_content_on_paste",{processor:"boolean",default:!0});var t=ld(e),r=Em(e,t),t=ti(e,t,r);Mi(e,t);{var n=e,o=t;const l=Yn(n),s=o=>_l(Qn(n)).bind(r=>P(r,l).map(e=>{var t=El(zl(n),e,r);return o(e,t)})).getOr("");T({mceTableRowType:()=>s(o.getTableRowType),mceTableCellType:()=>s(o.getTableCellType),mceTableColType:()=>s(o.getTableColType)},(e,t)=>n.addQueryValueHandler(t,e))}return Al(e,t),{getSelectedCells:r.getSelectedCells,clearSelectedCells:r.clearSelectedCells}})(e)}))}();