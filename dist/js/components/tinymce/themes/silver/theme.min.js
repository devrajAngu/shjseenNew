!function(){"use strict";const o=Object.getPrototypeOf,n=(e,t,o)=>{return!!o(e,t.prototype)||(null==(o=e.constructor)?void 0:o.name)===t.name},t=o=>e=>{return t=typeof(e=e),(null===e?"null":"object"==t&&Array.isArray(e)?"array":"object"==t&&n(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t)===o;var t},r=t=>e=>typeof e===t,a=t=>e=>t===e,L=t("string"),v=t("object"),s=e=>{return e=e,t=Object,v(e)&&n(e,t,(e,t)=>o(e)===t);var t},c=t("array"),i=a(null),b=r("boolean"),P=a(void 0),U=e=>null==e,W=e=>!U(e),j=r("function"),h=r("number"),p=(o,n)=>{if(c(o)){for(let e=0,t=o.length;e<t;++e)if(!n(o[e]))return!1;return!0}return!1},S=()=>{},l=(t,o)=>(...e)=>t(o.apply(null,e)),T=e=>()=>e,w=e=>e,G=(e,t)=>e===t;function $(t,...o){return(...e)=>{e=o.concat(e);return t.apply(null,e)}}const q=t=>e=>!t(e),X=e=>()=>{throw new Error(e)},Y=e=>e(),K=T(!1),J=T(!0);class Q{constructor(e,t){this.tag=e,this.value=t}static some(e){return new Q(!0,e)}static none(){return Q.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?Q.some(e(this.value)):Q.none()}bind(e){return this.tag?e(this.value):Q.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:Q.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return W(e)?Q.some(e):Q.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}Q.singletonNone=new Q(!1);const Z=Array.prototype.slice,le=Array.prototype.indexOf,ce=Array.prototype.push,de=(e,t)=>le.call(e,t),ue=(e,t)=>{e=de(e,t);return-1===e?Q.none():Q.some(e)},me=(e,t)=>-1<de(e,t),ge=(o,n)=>{for(let e=0,t=o.length;e<t;e++)if(n(o[e],e))return!0;return!1},pe=(t,o)=>{var n=[];for(let e=0;e<t;e++)n.push(o(e));return n},he=(t,o)=>{var n=[];for(let e=0;e<t.length;e+=o){var r=Z.call(t,e,e+o);n.push(r)}return n},k=(t,o)=>{const n=t.length,r=new Array(n);for(let e=0;e<n;e++){const n=t[e];r[e]=o(n,e)}return r},ee=(o,n)=>{for(let e=0,t=o.length;e<t;e++)n(o[e],e)},fe=(o,n)=>{var r=[],a=[];for(let e=0,t=o.length;e<t;e++){var s=o[e];(n(s,e)?r:a).push(s)}return{pass:r,fail:a}},ve=(o,n)=>{var r=[];for(let e=0,t=o.length;e<t;e++){var a=o[e];n(a,e)&&r.push(a)}return r},be=(e,t,o)=>{var n,r,a=e;for(let e=a.length-1;0<=e;e--)n=a[e],r=e,o=t(o,n,r);return o},ye=(e,o,n)=>(ee(e,(e,t)=>{n=o(n,e,t)}),n),xe=(e,t)=>{var o=e,n=t,r=K;for(let e=0,t=o.length;e<t;e++){var a=o[e];if(n(a,e))return Q.some(a);if(r(a,e))break}return Q.none()},we=(o,n)=>{for(let e=0,t=o.length;e<t;e++)if(n(o[e],e))return Q.some(e);return Q.none()},Se=o=>{var n=[];for(let e=0,t=o.length;e<t;++e){if(!c(o[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+o);ce.apply(n,o[e])}return n},ke=(e,t)=>Se(k(e,t)),Ce=(o,n)=>{for(let e=0,t=o.length;e<t;++e)if(!0!==n(o[e],e))return!1;return!0},Oe=e=>{e=Z.call(e,0);return e.reverse(),e},_e=(e,t)=>ve(e,e=>!me(t,e)),Te=(o,n)=>{var r={};for(let e=0,t=o.length;e<t;e++){var a=o[e];r[String(a)]=n(a,e)}return r},Ee=e=>[e],Ae=(e,t)=>{e=Z.call(e,0);return e.sort(t),e},Me=(e,t)=>0<=t&&t<e.length?Q.some(e[t]):Q.none(),De=e=>Me(e,0),Be=e=>Me(e,e.length-1),Fe=j(Array.from)?Array.from:e=>Z.call(e),Ie=(t,o)=>{for(let e=0;e<t.length;e++){var n=o(t[e],e);if(n.isSome())return n}return Q.none()},Re=Object.keys,Ne=Object.hasOwnProperty,Ve=(o,n)=>{var r=Re(o);for(let e=0,t=r.length;e<t;e++){var a=r[e];n(o[a],a)}},ze=(e,o)=>He(e,(e,t)=>({k:t,v:o(e,t)})),He=(e,o)=>{const n={};return Ve(e,(e,t)=>{e=o(e,t);n[e.k]=e.v}),n},Le=o=>(e,t)=>{o[t]=e},Pe=(e,o,n,r)=>{Ve(e,(e,t)=>{(o(e,t)?n:r)(e,t)})},Ue=(e,t)=>{var o={};return Pe(e,t,Le(o),S),o},We=(e,o)=>{const n=[];return Ve(e,(e,t)=>{n.push(o(e,t))}),n},je=(o,n)=>{var r=Re(o);for(let e=0,t=r.length;e<t;e++){var a=r[e],s=o[a];if(n(s,a,o))return Q.some(s)}return Q.none()},Ge=e=>We(e,w),C=(e,t)=>$e(e,t)?Q.from(e[t]):Q.none(),$e=(e,t)=>Ne.call(e,t),qe=(e,t)=>$e(e,t)&&void 0!==e[t]&&null!==e[t],Xe=(e,t,o=G)=>e.exists(e=>o(e,t)),Ye=t=>{const o=[],n=e=>{o.push(e)};for(let e=0;e<t.length;e++)t[e].each(n);return o},Ke=(e,t,o)=>e.isSome()&&t.isSome()?Q.some(o(e.getOrDie(),t.getOrDie())):Q.none(),Je=(e,t)=>null!=e?Q.some(t(e)):Q.none(),Ze=(e,t)=>e?Q.some(t):Q.none(),Qe=(e,t,o)=>""===t||e.length>=t.length&&e.substr(o,o+t.length)===t,et=(e,t)=>{return o=e,n=t,Qe(o,n,0)?(o=t.length,e.substring(o)):e;var o,n},tt=(e,t,o=0,n)=>{e=e.indexOf(t,o);return-1!==e&&(!!P(n)||e+t.length<=n)},ot=(e,t)=>Qe(e,t,e.length-t.length),nt=(qo=/^\s+|\s+$/g,e=>e.replace(qo,"")),rt=e=>0<e.length,at=e=>void 0!==e.style&&j(e.style.getPropertyValue),st=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},it=(e,t)=>{t=(t||document).createElement(e);return st(t)},lt=(e,t)=>{t=(t||document).createTextNode(e);return st(t)},te=st,ct="undefined"!=typeof window?window:Function("return this;")(),dt=(e,o)=>{{var n=e.split(".");let t=null!=o?o:ct;for(let e=0;e<n.length&&null!=t;++e)t=t[n[e]];return t}},ut=Object.getPrototypeOf,mt=e=>{var t=dt("ownerDocument.defaultView",e);return v(e)&&((e=>{var t="HTMLElement";if(e=e,null==(e=dt("HTMLElement",e)))throw new Error(t+" not available on this browser");return e})(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(ut(e).constructor.name))},gt=e=>e.dom.nodeName.toLowerCase(),pt=t=>e=>e.dom.nodeType===t,ht=e=>ft(e)&&mt(e.dom),ft=pt(1),vt=pt(3),bt=pt(9),yt=pt(11),xt=t=>e=>ft(e)&&gt(e)===t,wt=(e,t)=>{var o=e.dom;if(1!==o.nodeType)return!1;{const e=o;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},St=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,kt=(e,t)=>e.dom===t.dom,Ct=(e,t)=>{e=e.dom,t=t.dom;return e!==t&&e.contains(t)},Ot=e=>te(e.dom.ownerDocument),_t=e=>bt(e)?e:Ot(e),Tt=e=>te(_t(e).dom.documentElement),Et=e=>te(_t(e).dom.defaultView),At=e=>Q.from(e.dom.parentNode).map(te),Mt=e=>Q.from(e.dom.parentElement).map(te),Dt=e=>Q.from(e.dom.offsetParent).map(te),Bt=e=>k(e.dom.childNodes,te),Ft=(e,t)=>{e=e.dom.childNodes;return Q.from(e[t]).map(te)},It=e=>Ft(e,0),Rt=(e,t)=>({element:e,offset:t}),Nt=(e,t)=>{var o=Bt(e);return 0<o.length&&t<o.length?Rt(o[t],0):Rt(e,t)},Vt=e=>yt(e)&&W(e.dom.host),zt=j(Element.prototype.attachShadow)&&j(Node.prototype.getRootNode),Ht=T(zt),Lt=zt?e=>te(e.dom.getRootNode()):_t,Pt=e=>Vt(e)?e:te(_t(e).dom.body),Ut=e=>{e=Lt(e);return Vt(e)?Q.some(e):Q.none()},Wt=e=>te(e.dom.host),jt=e=>{const t=vt(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;const o=t.ownerDocument;return Ut(te(t)).fold(()=>o.body.contains(t),(n=jt,r=Wt,e=>n(r(e))));var n,r},Gt=()=>$t(te(document)),$t=e=>{e=e.dom.body;if(null==e)throw new Error("Body is not available yet");return te(e)},qt=(e,t,o)=>{if(!(L(o)||b(o)||h(o)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,o+"")},O=(e,t,o)=>{qt(e.dom,t,o)},Xt=(e,t)=>{const o=e.dom;Ve(t,(e,t)=>{qt(o,t,e)})},Yt=(e,t)=>{e=e.dom.getAttribute(t);return null===e?void 0:e},Kt=(e,t)=>Q.from(Yt(e,t)),Jt=(e,t)=>{e=e.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(t)},Zt=(e,t)=>{e.dom.removeAttribute(t)},Qt=(e,t,o)=>{if(!L(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);at(e)&&e.style.setProperty(t,o)},eo=(e,t)=>{at(e)&&e.style.removeProperty(t)},oe=(e,t,o)=>{e=e.dom;Qt(e,t,o)},to=(e,t)=>{const o=e.dom;Ve(t,(e,t)=>{Qt(o,t,e)})},oo=(e,t)=>{const o=e.dom;Ve(t,(e,t)=>{e.fold(()=>{eo(o,t)},e=>{Qt(o,t,e)})})},no=(e,t)=>{var o=e.dom,n=window.getComputedStyle(o).getPropertyValue(t);return""!==n||jt(e)?n:ro(o,t)},ro=(e,t)=>at(e)?e.style.getPropertyValue(t):"",ao=(e,t)=>{e=e.dom,e=ro(e,t);return Q.from(e).filter(e=>0<e.length)},so=e=>{var t={},o=e.dom;if(at(o))for(let e=0;e<o.style.length;e++){var n=o.style.item(e);t[n]=o.style[n]}return t},io=(e,t,o)=>{e=it(e);return oe(e,t,o),ao(e,t).isSome()},lo=(e,t)=>{var o=e.dom;eo(o,t),Xe(Kt(e,"style").map(nt),"")&&Zt(e,"style")},co=e=>e.dom.offsetWidth,uo=(o,n)=>{const e=e=>{var t=n(e);if(t<=0||null===t){const n=no(e,o);return parseFloat(n)||0}return t},r=(o,e)=>ye(e,(e,t)=>{t=no(o,t),t=void 0===t?0:parseInt(t,10);return isNaN(t)?e:e+t},0);return{set:(e,t)=>{if(!h(t)&&!t.match(/^[0-9]+$/))throw new Error(o+".set accepts only positive integer values. Value was "+t);e=e.dom;at(e)&&(e.style[o]=t+"px")},get:e,getOuter:e,aggregate:r,max:(e,t,o)=>{e=r(e,o);return e<t?t-e:0}}},mo=uo("height",e=>{var t=e.dom;return jt(e)?t.getBoundingClientRect().height:t.offsetHeight}),go=e=>mo.get(e),po=e=>mo.getOuter(e),ho=(o,n)=>({left:o,top:n,translate:(e,t)=>ho(o+e,n+t)}),fo=ho,vo=(e,t)=>void 0!==e?e:void 0!==t?t:0,bo=e=>{var t,o,n=e.dom.ownerDocument,r=n.body,a=n.defaultView,n=n.documentElement;return r===e.dom?fo(r.offsetLeft,r.offsetTop):(t=vo(null==a?void 0:a.pageYOffset,n.scrollTop),a=vo(null==a?void 0:a.pageXOffset,n.scrollLeft),o=vo(n.clientTop,r.clientTop),n=vo(n.clientLeft,r.clientLeft),yo(e).translate(a-n,t-o))},yo=e=>{var t=e.dom,o=t.ownerDocument.body;return o===t?fo(o.offsetLeft,o.offsetTop):jt(e)?(o=t.getBoundingClientRect(),fo(o.left,o.top)):fo(0,0)},xo=uo("width",e=>e.dom.offsetWidth),wo=e=>xo.get(e),So=e=>xo.getOuter(e),ko=t=>{let o,n=!1;return(...e)=>(n||(n=!0,o=t.apply(null,e)),o)},Co=()=>Oo(0,0),Oo=(e,t)=>({major:e,minor:t}),_o={nu:Oo,detect:(e,t)=>{var t=String(t).toLowerCase();if(0===e.length)return Co();{var o=t;const n=((t,o)=>{for(let e=0;e<t.length;e++){var n=t[e];if(n.test(o))return n}})(e,o);return n?(t=e=>Number(o.replace(n,"$"+e)),Oo(t(1),t(2))):{major:0,minor:0}}},unknown:Co},To=(e,t)=>{const o=String(t).toLowerCase();return xe(e,e=>e.search(o))},Eo=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ao=t=>e=>tt(e,t),Mo=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>tt(e,"edge/")&&tt(e,"chrome")&&tt(e,"safari")&&tt(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Eo],search:e=>tt(e,"chrome")&&!tt(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>tt(e,"msie")||tt(e,"trident")},{name:"Opera",versionRegexes:[Eo,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ao("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ao("firefox")},{name:"Safari",versionRegexes:[Eo,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(tt(e,"safari")||tt(e,"mobile/"))&&tt(e,"applewebkit")}],Do=[{name:"Windows",search:Ao("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>tt(e,"iphone")||tt(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ao("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Ao("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ao("linux"),versionRegexes:[]},{name:"Solaris",search:Ao("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ao("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Ao("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Bo={browsers:T(Mo),oses:T(Do)},Fo="Chromium",Io="Firefox",Ro=e=>{const t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isEdge:n("Edge"),isChromium:n(Fo),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(Io),isSafari:n("Safari")}},No=()=>Ro({current:void 0,version:_o.unknown()}),Vo=Ro,zo=(T("Edge"),T(Fo),T("IE"),T("Opera"),T(Io),T("Safari"),"Windows"),Ho="Android",Lo="Solaris",Po="FreeBSD",Uo="ChromeOS",Wo=e=>{const t=e.current,o=e.version,n=e=>()=>t===e;return{current:t,version:o,isWindows:n(zo),isiOS:n("iOS"),isAndroid:n(Ho),isMacOS:n("macOS"),isLinux:n("Linux"),isSolaris:n(Lo),isFreeBSD:n(Po),isChromeOS:n(Uo)}},jo=()=>Wo({current:void 0,version:_o.unknown()}),Go=Wo,$o=(T(zo),T("iOS"),T(Ho),T("Linux"),T("macOS"),T(Lo),T(Po),T(Uo),e=>window.matchMedia(e).matches);var qo;let Xo=ko(()=>{{var t=navigator.userAgent,e=Q.from(navigator.userAgentData),o=$o,n,r,a,s,i,l,c;const d=Bo.browsers(),u=Bo.oses(),m=e.bind(e=>{return n=d,e=e,Ie(e.brands,t=>{const o=t.brand.toLowerCase();return xe(n,e=>{return o===(null==(e=e.brand)?void 0:e.toLowerCase())}).map(e=>({current:e.name,version:_o.nu(parseInt(t.version,10),0)}))});var n}).orThunk(()=>{return e=d,o=t,To(e,o).map(e=>{var t=_o.detect(e.versionRegexes,o);return{current:e.name,version:t}});var e,o}).fold(No,Vo),g=(e=u,c=t,To(e,c).map(e=>{var t=_o.detect(e.versionRegexes,c);return{current:e.name,version:t}}).fold(jo,Go)),p=(e=m,r=t,o=o,a=(n=g).isiOS()&&!0===/ipad/i.test(r),s=n.isiOS()&&!a,i=n.isiOS()||n.isAndroid(),l=i||o("(pointer:coarse)"),o=a||!s&&i&&o("(min-device-width:768px)"),i=s||i&&!o,e=e.isSafari()&&n.isiOS()&&!1===/safari/i.test(r),r=!i&&!o&&!e,{isiPad:T(a),isiPhone:T(s),isTablet:T(o),isPhone:T(i),isTouch:T(l),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:T(e),isDesktop:T(r)});return{browser:m,os:g,deviceType:p}}});const Yo=()=>Xo(),Ko=e=>{var t,o,n=te((e=>{if(Ht()&&W(e.target)){var t=te(e.target);if(ft(t)&&(t=t,W(t.dom.shadowRoot))&&e.composed&&e.composedPath){t=e.composedPath();if(t)return De(t)}}return Q.from(e.target)})(e).getOr(e.target)),r=()=>e.stopPropagation(),a=()=>e.preventDefault(),s=l(a,r);return t=e.clientX,o=e.clientY,{target:n,x:t,y:o,stop:r,prevent:a,kill:s,raw:e}},Jo=(e,t,o,n,r)=>{a=o,s=n;var a,s,o=e=>{a(e)&&s(Ko(e))};return e.dom.addEventListener(t,o,r),{unbind:$(Zo,e,t,o,r)}},Zo=(e,t,o,n)=>{e.dom.removeEventListener(t,o,n)},Qo=(t,o)=>{At(t).each(e=>{e.dom.insertBefore(o.dom,t.dom)})},en=(e,t)=>{var o;o=e,Q.from(o.dom.nextSibling).map(te).fold(()=>{At(e).each(e=>{on(e,t)})},e=>{Qo(e,t)})},tn=(t,o)=>{It(t).fold(()=>{on(t,o)},e=>{t.dom.insertBefore(o.dom,e.dom)})},on=(e,t)=>{e.dom.appendChild(t.dom)},nn=(t,e)=>{ee(e,e=>{on(t,e)})},rn=e=>{e.dom.textContent="",ee(Bt(e),e=>{an(e)})},an=e=>{e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},sn=e=>{var e=void 0!==e?e.dom:document,t=e.body.scrollLeft||e.documentElement.scrollLeft,e=e.body.scrollTop||e.documentElement.scrollTop;return fo(t,e)},ln=(e,t,o)=>{o=(void 0!==o?o.dom:document).defaultView;o&&o.scrollTo(e,t)},cn=(e,t,o,n)=>({x:e,y:t,width:o,height:n,right:e+o,bottom:t+n}),dn=e=>{const o=void 0===e?window:e,t=o.document,n=sn(te(t));return(e=>{e=void 0===e?window:e;return Yo().browser.isFirefox()?Q.none():Q.from(e.visualViewport)})(o).fold(()=>{var e=o.document.documentElement,t=e.clientWidth,e=e.clientHeight;return cn(n.left,n.top,t,e)},e=>cn(Math.max(e.pageLeft,n.left),Math.max(e.pageTop,n.top),e.width,e.height))},un=()=>te(document),mn=(o,e)=>o.view(e).fold(T([]),e=>{var t=o.owner(e),t=mn(o,t);return[e].concat(t)});var gn=Object.freeze({__proto__:null,view:e=>{return(e.dom===document?Q.none():Q.from(null==(e=e.dom.defaultView)?void 0:e.frameElement)).map(te)},owner:e=>Ot(e)});const pn=o=>{const e=un(),n=sn(e),t=(a=(r=gn).owner(o),r=mn(r,a),Q.some(r));var r,a;return t.fold($(bo,o),e=>{var t=yo(o),e=be(e,(e,t)=>{t=yo(t);return{left:e.left+t.left,top:e.top+t.top}},{left:0,top:0});return fo(e.left+t.left+n.left,e.top+t.top+n.top)})},hn=(e,t,o,n)=>({x:e,y:t,width:o,height:n,right:e+o,bottom:t+n}),fn=e=>{var t=bo(e),o=So(e),e=po(e);return hn(t.left,t.top,o,e)},vn=e=>{var t=pn(e),o=So(e),e=po(e);return hn(t.left,t.top,o,e)},bn=(e,t)=>{var o=Math.max(e.x,t.x),n=Math.max(e.y,t.y),r=Math.min(e.right,t.right),e=Math.min(e.bottom,t.bottom);return hn(o,n,r-o,e-n)},yn=()=>dn(window);var xn,wn=tinymce.util.Tools.resolve("tinymce.ThemeManager");const Sn=o=>{const e=e=>e(o),t=T(o),n=()=>r,r={tag:!0,inner:o,fold:(e,t)=>t(o),isValue:J,isError:K,map:e=>_.value(e(o)),mapError:n,bind:e,exists:e,forall:e,getOr:t,or:n,getOrThunk:t,orThunk:n,getOrDie:t,each:e=>{e(o)},toOptional:()=>Q.some(o)};return r},kn=o=>{const e=()=>t,t={tag:!1,inner:o,fold:(e,t)=>e(o),isValue:K,isError:J,map:e,mapError:e=>_.error(e(o)),bind:e,exists:K,forall:J,getOr:w,or:w,getOrThunk:Y,orThunk:Y,getOrDie:X(String(o)),each:S,toOptional:Q.none};return t},_={value:Sn,error:kn,fromOption:(e,t)=>e.fold(()=>kn(t),Sn)},Cn=((fl=xn=xn||{})[fl.Error=0]="Error",fl[fl.Value=1]="Value",(e,t,o)=>e.stype===xn.Error?t(e.serror):o(e.svalue)),On=e=>({stype:xn.Value,svalue:e}),_n=e=>({stype:xn.Error,serror:e}),Tn=On,En=_n,An=Cn,Mn=(e,t,o,n)=>({tag:"field",key:e,newKey:t,presence:o,prop:n}),Dn=(e,t,o)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return o(e.newKey,e.instantiator)}},Bn=r=>(...t)=>{if(0===t.length)throw new Error("Can't merge zero objects");var o={};for(let e=0;e<t.length;e++){var n=t[e];for(const t in n)$e(n,t)&&(o[t]=r(o[t],n[t]))}return o},Fn=Bn((e,t)=>s(e)&&s(t)?Fn(e,t):t),In=Bn((e,t)=>t),Rn=e=>({tag:"defaultedThunk",process:e}),Nn=e=>Rn(T(e)),Vn=e=>({tag:"mergeWithThunk",process:e}),zn=e=>{var t,e=(e=>{const t=[],o=[];return ee(e,e=>{Cn(e,e=>o.push(e),e=>t.push(e))}),{values:t,errors:o}})(e);return 0<e.errors.length?(t=e.errors,l(En,Se)(t)):Tn(e.values)},Hn=e=>v(e)&&100<Re(e).length?" removed due to size":JSON.stringify(e,null,2),Ln=(e,t)=>En([{path:e,getErrorInfo:t}]),Pn=n=>({extract:(e,t)=>{return(t=n(t)).stype===xn.Error?(o=t.serror,((e,t)=>Ln(e,T(t)))(e,o)):t;var o},toString:T("val")}),Un=Pn(Tn),Wn=(e,t,o,n)=>n(C(e,t).getOrThunk(()=>o(e))),jn=(t,o,n,r,a)=>{const s=e=>a.extract(o.concat([r]),e),e=e=>e.fold(()=>Tn(Q.none()),e=>{return e=a.extract(o.concat([r]),e),t=Q.some,e.stype===xn.Value?{stype:xn.Value,svalue:t(e.svalue)}:e;var t});switch(t.tag){case"required":return d=o,u=n,m=r,g=s,C(u,m).fold(()=>{return e=d,t=m,o=u,Ln(e,()=>'Could not find valid *required* value for "'+t+'" in '+Hn(o));var e,t,o},g);case"defaultedThunk":return Wn(n,r,t.process,s);case"option":return g=n,c=r,e(C(g,c));case"defaultedOptionThunk":return i=n,c=r,l=t.process,e(C(i,c).map(e=>!0===e?l(i):e));case"mergeWithThunk":return Wn(n,r,T({}),e=>{e=Fn(t.process(n),e);return s(e)})}var i,l,c,d,u,m,g},Gn=o=>({extract:(e,t)=>o().extract(e,t),toString:()=>o().toString()}),$n=e=>{const a=E(e),s=be(e,(t,e)=>Dn(e,e=>Fn(t,{[e]:!0}),T(t)),{});return{extract:(e,t)=>{var o,n=b(t)?[]:(n=t,Re(Ue(n,W))),r=ve(n,e=>!qe(s,e));return 0===r.length?a.extract(e,t):(t=e,o=r,Ln(t,()=>"There are unsupported fields: ["+o.join(", ")+"] specified"))},toString:a.toString}},E=n=>({extract:(e,t)=>{{var r=e,a=t;const s={},i=[];for(const o of n)Dn(o,(e,t,o,n)=>{o=jn(o,r,a,e,n);An(o,e=>{i.push(...e)},e=>{s[t]=e})},(e,t)=>{s[e]=t(a)});return 0<i.length?En(i):Tn(s)}},toString:()=>{return"obj{\n"+k(n,e=>Dn(e,(e,t,o,n)=>e+" -> "+n.toString(),(e,t)=>"state("+e+")")).join("\n")+"}"}}),qn=n=>({extract:(o,e)=>{e=k(e,(e,t)=>n.extract(o.concat(["["+t+"]"]),e));return zn(e)},toString:()=>"array("+n.toString()+")"}),Xn=(r,e)=>{const a=void 0!==e?e:w;return{extract:(e,t)=>{var o=[];for(const n of r){const r=n.extract(e,t);if(r.stype===xn.Value)return{stype:xn.Value,svalue:a(r.svalue)};o.push(r)}return zn(o)},toString:()=>"oneOf("+k(r,e=>e.toString()).join(", ")+")"}},Yn=(r,a)=>({extract:(e,t)=>{var o=Re(t),n=(n=e,o=o,qn(Pn(r)).extract(n,o));return(o=n).stype===xn.Value?(n=o.svalue,n=k(n,e=>Mn(e,e,{tag:"required",process:{}},a)),E(n).extract(e,t)):o},toString:()=>"setOf("+a.toString()+")"}),Kn=l(qn,E),Jn=T(Un),Zn=(o,n)=>Pn(e=>{var t=typeof e;return o(e)?Tn(e):En(`Expected type: ${n} but got: `+t)}),Qn=Zn(h,"number"),er=Zn(L,"string"),tr=Zn(b,"boolean"),or=Zn(j,"function"),nr=t=>{if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every(e=>nr(t[e]));default:return!1}},rr=Pn(e=>nr(e)?Tn(e):En("Expected value to be acceptable for sending via postMessage")),ar=(n,i)=>({extract:(o,s)=>C(s,n).fold(()=>{return e=o,t=n,Ln(e,()=>'Choice schema did not contain choice key: "'+t+'"');var e,t},e=>{return n=o,t=s,r=i,a=e,C(r,a).fold(()=>{return e=n,t=r,o=a,Ln(e,()=>'The chosen schema: "'+o+'" did not exist in branches: '+Hn(t));var e,t,o},e=>e.extract(n.concat(["branch: "+a]),t));var n,t,r,a}),toString:()=>"chooseOn("+n+"). Possible values: "+Re(i)}),sr=t=>Pn(e=>t(e).fold(En,Tn)),ir=(t,e)=>Yn(e=>t(e).fold(_n,On),e),lr=(e,t,o)=>{return o=o,o=(t=t.extract([e],o)).stype===xn.Error?{stype:xn.Error,serror:(e=t.serror,{input:o,errors:e})}:t,Cn(o,_.error,_.value)},cr=e=>e.fold(e=>{throw new Error(ur(e))},w),dr=(e,t,o)=>cr(lr(e,t,o)),ur=e=>"Errors: \n"+(e=>{e=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:T("... (only showing first ten failures)")}]):e;return k(e,e=>"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo())})(e.errors).join("\n")+"\n\nInput object: "+Hn(e.input),mr=(e,t)=>ar(e,ze(t,E)),gr=(e,t)=>{{const o=ko(t);return{extract:(e,t)=>o().extract(e,t),toString:()=>o().toString()}}},pr=Mn,hr=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),fr=t=>sr(e=>me(t,e)?_.value(e):_.error(`Unsupported value: "${e}", choose one of "${t.join(", ")}".`)),A=e=>pr(e,e,{tag:"required",process:{}},Jn()),vr=(e,t)=>pr(e,e,{tag:"required",process:{}},t),br=e=>vr(e,er),yr=(e,t)=>pr(e,e,{tag:"required",process:{}},fr(t)),xr=e=>vr(e,or),wr=(e,t)=>pr(e,e,{tag:"required",process:{}},E(t)),Sr=(e,t)=>pr(e,e,{tag:"required",process:{}},Kn(t)),kr=(e,t)=>pr(e,e,{tag:"required",process:{}},qn(t)),d=e=>pr(e,e,{tag:"option",process:{}},Jn()),Cr=(e,t)=>pr(e,e,{tag:"option",process:{}},t),Or=e=>Cr(e,Qn),_r=e=>Cr(e,er),Tr=(e,t)=>Cr(e,fr(t)),Er=e=>Cr(e,or),Ar=(e,t)=>Cr(e,qn(t)),Mr=(e,t)=>Cr(e,E(t)),M=(e,t)=>pr(e,e,Nn(t),Jn()),Dr=(e,t,o)=>pr(e,e,Nn(t),o),Br=(e,t)=>Dr(e,t,Qn),Fr=(e,t)=>Dr(e,t,er),Ir=(e,t,o)=>Dr(e,t,fr(o)),Rr=(e,t)=>Dr(e,t,tr),Nr=(e,t)=>Dr(e,t,or),Vr=(e,t,o)=>Dr(e,t,qn(o)),zr=(e,t,o)=>Dr(e,t,E(o)),D=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},Hr=a=>{if(!c(a))throw new Error("cases must be an array");if(0===a.length)throw new Error("there must be at least one case");const s=[],i={};return ee(a,(e,t)=>{var o=Re(e);if(1!==o.length)throw new Error("one and only one name per case");const n=o[0],r=e[n];if(void 0!==i[n])throw new Error("duplicate key detected:"+n);if("cata"===n)throw new Error("cannot have a case named cata (sorry)");if(!c(r))throw new Error("case arguments must be an array");s.push(n),i[n]=(...o)=>{var e=o.length;if(e!==r.length)throw new Error("Wrong number of arguments to case "+n+". Expected "+r.length+" ("+r+"), got "+e);return{fold:(...e)=>{if(e.length!==a.length)throw new Error("Wrong number of arguments to fold. Expected "+a.length+", got "+e.length);return e[t].apply(null,o)},match:e=>{const t=Re(e);if(s.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+s.join(",")+"\nActual: "+t.join(","));if(Ce(s,e=>me(t,e)))return e[n].apply(null,o);throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+s.join(", "))},log:e=>{console.log(e,{constructors:s,constructor:n,params:o})}}}}),i},Lr=(Hr([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),(e,t)=>({[e]:t})),Pr=e=>{{const t={};return ee(e,e=>{t[e.key]=e.value}),t}},Ur=e=>j(e)?e:K,Wr=(e,t,o)=>{let n=e.dom;for(var r=Ur(o);n.parentNode;){n=n.parentNode;const e=te(n),o=t(e);if(o.isSome())return o;if(r(e))break}return Q.none()},jr=(e,t,o)=>{const n=t(e),r=Ur(o);return n.orThunk(()=>r(e)?Q.none():Wr(e,t,r))},Gr=(e,t)=>kt(e.element,t.event.target),$r={can:J,abort:K,run:S},qr=e=>{if(qe(e,"can")||qe(e,"abort")||qe(e,"run"))return{...$r,...e};throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!")},Xr=T,Yr=Xr("touchstart"),Kr=Xr("touchmove"),Jr=Xr("touchend"),Zr=Xr("touchcancel"),Qr=Xr("mousedown"),ea=Xr("mousemove"),ta=Xr("mouseout"),oa=Xr("mouseup"),na=Xr("mouseover"),ra=Xr("focusin"),aa=Xr("focusout"),sa=Xr("keydown"),ia=Xr("keyup"),la=Xr("input"),ca=Xr("change"),da=Xr("click"),ua=Xr("transitioncancel"),ma=Xr("transitionend"),ga=Xr("transitionstart"),pa=Xr("selectstart"),ha=e=>T("alloy."+e),fa={tap:ha("tap")},va=ha("focus"),ba=ha("blur.post"),ya=ha("paste.post"),xa=ha("receive"),wa=ha("execute"),Sa=ha("focus.item"),ka=fa.tap,Ca=ha("longpress"),Oa=ha("sandbox.close"),_a=ha("typeahead.cancel"),Ta=ha("system.init"),Ea=ha("system.touchmove"),Aa=ha("system.touchend"),Ma=ha("system.scroll"),Da=ha("system.resize"),Ba=ha("system.attached"),Fa=ha("system.detached"),Ia=ha("system.dismissRequested"),Ra=ha("system.repositionRequested"),Na=ha("focusmanager.shifted"),Va=ha("slotcontainer.visibility"),za=ha("system.external.element.scroll"),Ha=ha("change.tab"),La=ha("dismiss.tab"),Pa=ha("highlight"),Ua=ha("dehighlight"),B=(e,t)=>{Ga(e,e.element,t,{})},F=(e,t,o)=>{Ga(e,e.element,t,o)},Wa=e=>{B(e,wa())},ja=(e,t,o)=>{Ga(e,t,o,{})},Ga=(e,t,o,n)=>{n={target:t,...n};e.getSystem().triggerEvent(o,t,n)},$a=(e,t,o,n)=>{e.getSystem().triggerEvent(o,t,n.event)},qa=e=>Pr(e),Xa=(e,t)=>({key:e,value:qr({abort:t})}),Ya=e=>({key:e,value:qr({run:(e,t)=>{t.event.prevent()}})}),ne=(e,t)=>({key:e,value:qr({run:t})}),Ka=(e,o,n)=>({key:e,value:qr({run:(e,t)=>{o.apply(void 0,[e,t].concat(n))}})}),Ja=e=>o=>({key:e,value:qr({run:(e,t)=>{Gr(e,t)&&o(e,t)}})}),Za=(e,t,o)=>{return n=e,r=t.partUids[o],ne(n,(e,t)=>{e.getSystem().getByUid(r).each(e=>{$a(e,e.element,n,t)})});var n,r},Qa=(e,r)=>ne(e,(t,e)=>{const o=e.event,n=t.getSystem().getByDom(o.target).getOrThunk(()=>jr(o.target,e=>t.getSystem().getByDom(e).toOptional(),K).getOr(t));r(t,n,e)}),es=e=>ne(e,(e,t)=>{t.cut()}),ts=(e,t)=>Ja(e)(t),os=Ja(Ba()),ns=Ja(Fa()),rs=Ja(Ta()),as=(ds=wa(),e=>ne(ds,e)),ss=e=>e.dom.innerHTML,is=(e,t)=>{const o=Ot(e).dom,n=te(o.createDocumentFragment()),r=(t=t,(a=(o||document).createElement("div")).innerHTML=t,Bt(te(a)));var a;nn(n,r),rn(e),on(e,n)},ls=e=>{return e=e,Vt(e)?"#shadow-root":(e=e,e=te(e.dom.cloneNode(!1)),t=it("div"),e=te(e.dom.cloneNode(!0)),on(t,e),ss(t));var t},cs=qa([{key:va(),value:qr({can:(e,t)=>{var o,n,t=t.event,r=t.originator,t=t.target;return e=e,o=r,n=t,!(kt(o,e.element)&&!kt(o,n)&&(console.warn(va()+" did not get interpreted by the desired target. \nOriginator: "+ls(r)+"\nTarget: "+ls(t)+"\nCheck the "+va()+" event handlers"),1))}})}]);var ds,us=Object.freeze({__proto__:null,events:cs});let ms=0;const I=e=>{var t=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++ms+String(t)},gs=T("alloy-id-"),ps=T("data-alloy-id"),hs=gs(),fs=ps(),vs=(e,t)=>{Object.defineProperty(e.dom,fs,{value:t,writable:!0})},bs=e=>{e=ft(e)?e.dom[fs]:null;return Q.from(e)},ys=e=>I(e),xs=w,ws=t=>{const o=e=>"The component must be in a context to execute: "+e+(t?"\n"+ls(t().element)+" is not in context.":""),e=e=>()=>{throw new Error(o(e))},n=e=>()=>{console.warn(o(e))};return{debugInfo:T("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),build:e("build"),buildOrPatch:e("buildOrPatch"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),isConnected:K}},Ss=ws(),ks=e=>k(e,e=>ot(e,"/*")?e.substring(0,e.length-2):e),Cs=(e,t)=>{const o=e.toString(),n=o.indexOf(")")+1,r=o.indexOf("("),a=o.substring(r+1,n-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:ks(a)}),e},Os=I("alloy-premade"),_s=e=>(Object.defineProperty(e.element.dom,Os,{value:e.uid,writable:!0}),Lr(Os,e)),Ts=e=>C(e,Os),Es=o=>{{var e=(e,...t)=>o(e.getApis(),e,...t);const t=o.toString(),n=t.indexOf(")")+1,r=t.indexOf("("),a=t.substring(r+1,n-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:"OVERRIDE",parameters:ks(a.slice(1))}),e}},As={init:()=>Ms({readState:T("No State required")})},Ms=e=>e,Ds=(e,r)=>{const a={};return Ve(e,(e,n)=>{Ve(e,(e,t)=>{var o=C(a,t).getOr([]);a[t]=o.concat([r(n,e)])})}),a},Bs=e=>({classes:P(e.classes)?[]:e.classes,attributes:P(e.attributes)?{}:e.attributes,styles:P(e.styles)?{}:e.styles}),Fs=e=>e.cHandler,Is=(e,t)=>({name:e,handler:t}),Rs=(e,t,o)=>{var t=t[o];return t?((r,e,a)=>{try{var t=Ae(e,(e,t)=>{var e=e.name,t=t.name,o=a.indexOf(e),n=a.indexOf(t);if(-1===o)throw new Error("The ordering for "+r+" does not have an entry for "+e+".\nOrder specified: "+JSON.stringify(a,null,2));if(-1===n)throw new Error("The ordering for "+r+" does not have an entry for "+t+".\nOrder specified: "+JSON.stringify(a,null,2));return o<n?-1:n<o?1:0});return _.value(t)}catch(r){return _.error([r])}})("Event: "+o,e,t).map(e=>{return o=k(e,e=>e.handler),t=n=o,{can:(...o)=>ye(n,(e,t)=>e&&t.can.apply(void 0,o),!0),abort:(...o)=>ye(t,(e,t)=>e||t.abort.apply(void 0,o),!1),run:(...t)=>{ee(o,e=>{e.run.apply(void 0,t)})}};var o,t,n}):(t=o,o=e,_.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(k(o,e=>e.name),null,2)]))},Ns="alloy.base.behaviour",Vs=E([pr("dom","dom",{tag:"required",process:{}},E([A("tag"),M("styles",{}),M("classes",[]),M("attributes",{}),d("value"),d("innerHtml")])),A("components"),A("uid"),M("events",{}),M("apis",{}),pr("eventOrder","eventOrder",(fl={[wa()]:["disabling",Ns,"toggling","typeaheadevents"],[va()]:[Ns,"focusing","keying"],[Ta()]:[Ns,"disabling","toggling","representing"],[la()]:[Ns,"representing","streaming","invalidating"],[Fa()]:[Ns,"representing","item-events","tooltipping"],[Qr()]:["focusing",Ns,"item-type-events"],[Yr()]:["focusing",Ns,"item-type-events"],[na()]:["item-type-events","tooltipping"],[xa()]:["receiving","reflecting","tooltipping"]},Vn(T(fl))),Jn()),d("domModification")]),zs=(e,t)=>{e=Yt(e,t);return void 0===e||""===e?[]:e.split(" ")},Hs=e=>void 0!==e.dom.classList,Ls=e=>zs(e,"class"),Ps=(e,t)=>{Hs(e)?e.dom.classList.add(t):(e=e,t=t,t=zs(e,"class").concat([t]),O(e,"class",t.join(" ")))},Us=(e,t)=>{var o,n,r;Hs(e)?e.dom.classList.remove(t):(o=e,n="class",r=t,0<(t=ve(zs(o,n),e=>e!==r)).length?O(o,n,t.join(" ")):Zt(o,n)),t=e,0===(Hs(t)?t.dom.classList:Ls(t)).length&&Zt(t,"class")},Ws=(e,t)=>Hs(e)&&e.dom.classList.contains(t),js=(t,e)=>{ee(e,e=>{Ps(t,e)})},Gs=(t,e)=>{ee(e,e=>{Us(t,e)})},$s=(t,e)=>Ce(e,e=>Ws(t,e)),qs=e=>e.dom.value,Xs=(e,t)=>{if(void 0===t)throw new Error("Value.set was undefined");e.dom.value=t},Ys=(e,t,o)=>{o.fold(()=>on(e,t),e=>{kt(e,t)||(Qo(e,t),an(e))})},Ks=(e,t,o)=>{t=k(t,o),o=Bt(e);return ee(o.slice(t.length),an),t},Js=(e,t,o,n)=>{var r,a=Ft(e,t),n=n(o,a),a=(o=e,t=t,r=a,Ft(o,t).map(t=>{var e;return r.exists(e=>!kt(e,t))?(e=r.map(gt).getOr("span"),e=it(e),Qo(t,e),e):t}));return Ys(e,n.element,a),n},Zs=(e,o)=>{var t,n=Re(e),r=Re(o),r=_e(r,n);return n=e,e={},t={},Pe(n,(e,t)=>!$e(o,t)||e!==o[t],Le(e),Le(t)),{toRemove:r,toSet:e}},Qs=(t,n)=>{g=n;const{class:e,style:o,...r}=ye(g.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),{toSet:a,toRemove:s}=Zs(t.attributes,r),i=so(n),{toSet:l,toRemove:c}=Zs(t.styles,i),d=(e=>{if(Hs(e)){var t=e.dom.classList,o=new Array(t.length);for(let e=0;e<t.length;e++){var n=t.item(e);null!==n&&(o[e]=n)}return o}return Ls(e)})(n),u=_e(d,t.classes),m=_e(t.classes,d);var g,p;return ee(s,e=>Zt(n,e)),Xt(n,a),js(n,m),Gs(n,u),ee(c,e=>lo(n,e)),to(n,l),t.innerHtml.fold(()=>{var o,e=t.domChildren;o=n,e=e,Ks(o,e,(e,t)=>{t=Ft(o,t);return Ys(o,e,t),e})},e=>{is(n,e)}),g=n,(p=t.value.getOrUndefined())!==qs(g)&&Xs(g,null!=p?p:""),n},ei=(o,e)=>{const t=()=>m,n=D(Ss),r=cr((x=o,lr("custom.definition",Vs,x))),a=(y=(e=>{const t=C(e,"behaviours").getOr({});return ke(Re(t),e=>{e=t[e];return W(e)?[e.me]:[]})})(x=o),b=x,x=y,y=k(x,e=>Mr(e.name(),[A("config"),M("state",As)])),y=lr("component.behaviours",E(y),b.behaviours).fold(e=>{throw new Error(ur(e)+"\nComplete spec:\n"+JSON.stringify(b,null,2))},w),{list:x,data:ze(y,e=>{e=e.map(e=>({config:e.config,state:e.state.init(e.config)}));return T(e)})}),s=a.list,i=a.data,l=((e,t,o)=>{var n={...(n=e).dom,uid:n.uid,domChildren:k(n.components,e=>e.element)};const r=e.domModification.fold(()=>Bs({}),Bs),i={"alloy.base.modification":r},a=0<t.length?((t,e,o)=>{const n={...i};ee(e,e=>{n[e.name()]=e.exhibit(t,o)});var e=Ds(n,(e,t)=>({name:e,modification:t})),r=e=>be(e,(e,t)=>({...t.modification,...e}),{}),a=be(e.classes,(e,t)=>t.modification.concat(e),[]),s=r(e.attributes),r=r(e.styles);return Bs({classes:a,attributes:s,styles:r})})(o,t,n):r;return e=a,{...o=n,attributes:{...o.attributes,...e.attributes},styles:{...o.styles,...e.styles},classes:o.classes.concat(e.classes)}})(r,s,i),c=(v=l,x=e.filter(e=>{return!(gt(e)!==v.tag||(t=v).innerHtml.isSome()&&0<t.domChildren.length||(t=e,$e(t.dom,Os)));var t}).bind(e=>{var t=v;try{var o=Qs(t,e);return Q.some(o)}catch(t){return Q.none()}}).getOrThunk(()=>{{var e=v;const o=it(e.tag);Xt(o,e.attributes),js(o,e.classes),to(o,e.styles),e.innerHtml.each(e=>is(o,e));var t=e.domChildren;return nn(o,t),e.value.each(e=>{Xs(o,e)}),o}}),vs(x,v.uid),x),d=(y=r,e=s,x=i,f={"alloy.base.behaviour":y.events},y=y.eventOrder,g=f,f=f=((e,t)=>{t={...g,...((e,t)=>{const o={};return ee(e,e=>{o[e.name()]=e.handlers(t)}),o})(t,e)};return Ds(t,Is)})(x,e),p=y,(0<(f=(e=>{const t=[],o=[];return ee(e,e=>{e.fold(e=>{t.push(e)},e=>{o.push(e)})}),{errors:t,values:o}})(We(f,(n,r)=>(1===n.length?_.value(n[0].handler):Rs(n,p,r)).map(e=>{const t=(e=>{const r=(e=>j(e)?{can:J,abort:K,run:e}:e)(e);return(e,t,...o)=>{const n=[e,t].concat(o);r.abort.apply(void 0,n)?t.stop():r.can.apply(void 0,n)&&r.run.apply(void 0,n)}})(e),o=n.length>1?ve(p[r],t=>ge(n,e=>e.name===t)).join(" > "):n[0].name;return Lr(r,((e,t)=>({handler:e,purpose:t}))(t,o))})))).errors.length?(h=f.errors,_.error(Se(h))):(h=f.values,f={},0===h.length?_.value(f):_.value(Fn(f,In.apply(void 0,h))))).getOrDie()),u=D(r.components),m={uid:o.uid,getSystem:n.get,config:e=>{var t=i;return(j(t[e.name()])?t[e.name()]:()=>{throw new Error("Could not find "+e.name()+" in "+JSON.stringify(o,null,2))})()},hasConfigured:e=>j(i[e.name()]),spec:o,readState:e=>i[e]().map(e=>e.state.readState()).getOr("not enabled"),getApis:()=>r.apis,connect:e=>{n.set(e)},disconnect:()=>{n.set(ws(t))},element:c,syncComponents:()=>{var e=Bt(c),e=ke(e,e=>n.get().getByDom(e).fold(()=>[],Ee));u.set(e)},components:u.get,events:d};var g,p,h,f,v,b,y,x;return m},ti=e=>{e=lt(e);return oi({element:e})},oi=e=>{const t=dr("external.component",$n([A("element"),d("uid")]),e),o=D(ws()),n=t.uid.getOrThunk(()=>ys("external")),r=(vs(t.element,n),{uid:n,getSystem:o.get,config:Q.none,hasConfigured:K,connect:e=>{o.set(e)},disconnect:()=>{o.set(ws(()=>r))},getApis:()=>({}),element:t.element,spec:e,readState:T("No state"),syncComponents:S,components:T([]),events:{}});return _s(r)},ni=ys,ri=(t,o)=>Ts(t).getOrThunk(()=>{return((e,t)=>{const{events:o,...n}=xs(e),r=((e,t)=>{const n=C(e,"components").getOr([]);return t.fold(()=>k(n,ai),o=>k(n,(e,t)=>ri(e,Ft(o,t))))})(n,t),a={...n,events:{...us,...o},components:r};return _.value(ei(a,t))})((e=t,$e(e,"uid")?t:{uid:ni(""),...t}),o).getOrDie();var e}),ai=e=>ri(e,Q.none()),si=_s;var ii,li=(e,t,o,n,r)=>e(o,n)?Q.some(o):j(r)&&r(o)?Q.none():t(o,n,r);const ci=(e,t,o)=>{let n=e.dom;for(var r=j(o)?o:K;n.parentNode;){n=n.parentNode;const e=te(n);if(t(e))return Q.some(e);if(r(e))break}return Q.none()},di=(e,t,o)=>li((e,t)=>t(e),ci,e,t,o),ui=(e,t,o)=>di(e,t,o).isSome(),mi=(e,t,o)=>ci(e,e=>wt(e,t),o),gi=(e,t)=>{return e=e,xe(e.dom.childNodes,e=>{return e=te(e),wt(e,t)}).map(te)},pi=(e,t)=>{return t=t,e=void 0===e?document:e.dom,St(e)?Q.none():Q.from(e.querySelector(t)).map(te)},hi=(e,t,o)=>li((e,t)=>wt(e,t),mi,e,t,o),fi="aria-controls",vi=()=>{const t=I(fi);return{id:t,link:e=>{O(e,fi,t)},unlink:e=>{Zt(e,fi)}}},bi=(t,e)=>{return ui(e,e=>kt(e,t.element),K)||(o=t,e=e,di(e,e=>{return!!ft(e)&&void 0!==(e=Yt(e,"id"))&&-1<e.indexOf(fi)}).bind(e=>{var t=Yt(e,"id"),e=Lt(e);return pi(e,`[${fi}="${t}"]`)}).exists(e=>bi(o,e)));var o},yi=((fl=ii=ii||{})[fl.STOP=0]="STOP",fl[fl.NORMAL=1]="NORMAL",fl[fl.LOGGING=2]="LOGGING",D({})),xi=["alloy/data/Fields","alloy/debugging/Debugging"],wi=(e,t,o)=>{var n=e,r=t,a=o;switch(C(yi.get(),n).orThunk(()=>{var e=Re(yi.get());return Ie(e,e=>-1<n.indexOf(e)?Q.some(yi.get()[e]):Q.none())}).getOr(ii.NORMAL)){case ii.NORMAL:return a(Si());case ii.LOGGING:var s=((t,o)=>{const n=[],r=(new Date).getTime();return{logEventCut:(e,t,o)=>{n.push({outcome:"cut",target:t,purpose:o})},logEventStopped:(e,t,o)=>{n.push({outcome:"stopped",target:t,purpose:o})},logNoParent:(e,t,o)=>{n.push({outcome:"no-parent",target:t,purpose:o})},logEventNoHandlers:(e,t)=>{n.push({outcome:"no-handlers-left",target:t})},logEventResponse:(e,t,o)=>{n.push({outcome:"response",purpose:o,target:t})},write:()=>{var e=(new Date).getTime();me(["mousemove","mouseover","mouseout",Ta()],t)||console.log(t,{event:t,time:e-r,target:o.dom,sequence:k(n,e=>me(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+ls(e.target)+")":e.outcome)})}}})(n,r),i=a(s);return s.write(),i;case ii.STOP:return!0}},Si=T({logEventCut:S,logEventStopped:S,logNoParent:S,logEventNoHandlers:S,logEventResponse:S,write:S}),ki=T([A("menu"),A("selectedMenu")]),Ci=T([A("item"),A("selectedItem")]),Oi=(T(E(Ci().concat(ki()))),T(E(Ci()))),_i=wr("initSize",[A("numColumns"),A("numRows")]),Ti=()=>wr("markers",[A("backgroundMenu")].concat(ki()).concat(Ci())),Ei=e=>wr("markers",k(e,A)),Ai=(e,t,o)=>{return void 0!==(n=new Error).stack&&(n=n.stack.split("\n"),xe(n,t=>0<t.indexOf("alloy")&&!ge(xi,e=>-1<t.indexOf(e))).getOr("unknown")),pr(t,t,o,sr(t=>_.value((...e)=>t.apply(void 0,e))));var n},e=e=>Ai(0,e,Nn(S)),Mi=e=>Ai(0,e,Nn(Q.none)),Di=e=>Ai(0,e,{tag:"required",process:{}}),Bi=e=>Ai(0,e,{tag:"required",process:{}}),Fi=(e,t)=>hr(e,T(t)),Ii=e=>hr(e,w),Ri=T(_i),Ni=(e,t,o,n,r,a,s,i=!1)=>({x:e,y:t,bubble:o,direction:n,placement:r,restriction:a,label:s+"-"+r,alwaysFit:i}),Vi=Hr([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),zi=Vi.southeast,Hi=Vi.southwest,Li=Vi.northeast,Pi=Vi.northwest,Ui=Vi.south,Wi=Vi.north,ji=Vi.east,Gi=Vi.west,$i=(e,t,o,n)=>{e+=t;return n<e?o:e<o?n:e},qi=(e,t,o)=>Math.min(Math.max(e,t),o),Xi=(o,t)=>Te(["left","right","top","bottom"],e=>C(t,e).map(e=>{var t=o;switch(e){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}})),Yi="layout",Ki=e=>e.x,Ji=(e,t)=>e.x+e.width/2-t.width/2,Zi=(e,t)=>e.x+e.width-t.width,Qi=(e,t)=>e.y-t.height,el=e=>e.y+e.height,tl=(e,t)=>e.y+e.height/2-t.height/2,ol=(e,t,o)=>Ni(Ki(e),el(e),o.southeast(),zi(),"southeast",Xi(e,{left:1,top:3}),Yi),nl=(e,t,o)=>Ni(Zi(e,t),el(e),o.southwest(),Hi(),"southwest",Xi(e,{right:0,top:3}),Yi),rl=(e,t,o)=>Ni(Ki(e),Qi(e,t),o.northeast(),Li(),"northeast",Xi(e,{left:1,bottom:2}),Yi),al=(e,t,o)=>Ni(Zi(e,t),Qi(e,t),o.northwest(),Pi(),"northwest",Xi(e,{right:0,bottom:2}),Yi),sl=(e,t,o)=>Ni(Ji(e,t),Qi(e,t),o.north(),Wi(),"north",Xi(e,{bottom:2}),Yi),il=(e,t,o)=>Ni(Ji(e,t),el(e),o.south(),Ui(),"south",Xi(e,{top:3}),Yi),ll=(e,t,o)=>Ni(e.x+e.width,tl(e,t),o.east(),ji(),"east",Xi(e,{left:0}),Yi),cl=(e,t,o)=>Ni(e.x-t.width,tl(e,t),o.west(),Gi(),"west",Xi(e,{right:1}),Yi),dl=()=>[ol,nl,rl,al,il,sl,ll,cl],ul=()=>[nl,ol,al,rl,il,sl,ll,cl],ml=()=>[rl,al,ol,nl,sl,il],gl=()=>[al,rl,nl,ol,sl,il],pl=()=>[ol,nl,rl,al,il,sl],hl=()=>[nl,ol,al,rl,il,sl];var fl=Object.freeze({__proto__:null,events:i=>qa([ne(xa(),(n,e)=>{const r=i.channels,t=Re(r),a=e,o=(e=t,(s=a).universal?e:ve(e,e=>me(s.channels,e)));var s;ee(o,e=>{var t=r[e],o=t.schema,e=dr("channel["+e+"] data\nReceiver: "+ls(n.element),o,a.data);t.onReceive(n,e)})})])}),vl=[vr("channels",ir(_.value,$n([Di("onReceive"),M("schema",Jn())])))];const bl=(o,n,r)=>rs((e,t)=>{r(e,o,n)}),yl=e=>({key:e,value:void 0}),xl=(o,e,d,t,n,r,a)=>{const s=e=>qe(e,d)?e[d]():Q.none(),i=ze(n,(e,t)=>{var r=d,a=e,s=t;{var e=(o,...e)=>{const n=[o].concat(e);return o.config({name:T(r)}).fold(()=>{throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+s)},e=>{var t=Array.prototype.slice.call(n,1);return a.apply(void 0,[o,e.config,e.state].concat(t))})},o=s;const n=a.toString(),i=n.indexOf(")")+1,l=n.indexOf("("),c=n.substring(l+1,i-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:o,parameters:ks(c.slice(0,1).concat(c.slice(3)))}),e}}),l={...ze(r,(e,t)=>Cs(e,t)),...i,revoke:$(yl,d),config:e=>{var t=dr(d+"-config",o,e);return{key:d,value:{config:t,me:l,configAsRaw:ko(()=>dr(d+"-config",o,e)),initialConfig:e,state:a}}},schema:T(e),exhibit:(e,o)=>Ke(s(e),C(t,"exhibit"),(e,t)=>t(o,e.config,e.state)).getOrThunk(()=>Bs({})),name:T(d),handlers:e=>s(e).map(e=>C(t,"events").getOr(()=>({}))(e.config,e.state)).getOr({})};return l},re=e=>Pr(e),wl=$n([A("fields"),A("name"),M("active",{}),M("apis",{}),M("state",As),M("extra",{})]),Sl=e=>{var t,o,n,r,a,s,e=dr("Creating behaviour: "+e.name,wl,e);return t=e.fields,o=e.name,n=e.active,r=e.apis,a=e.extra,e=e.state,s=$n(t),t=Mr(o,[(t=t,Cr("config",$n(t)))]),xl(s,t,o,n,r,a,e)},kl=$n([A("branchKey"),A("branches"),A("name"),M("active",{}),M("apis",{}),M("state",As),M("extra",{})]),Cl=e=>{var t,o,n,r,a,s,e=dr("Creating behaviour: "+e.name,kl,e);return t=mr(e.branchKey,e.branches),o=e.name,n=e.active,r=e.apis,a=e.extra,e=e.state,s=t,t=Mr(o,[Cr("config",t)]),xl(s,t,o,n,r,a,e)},Ol=T(void 0),_l=Sl({fields:vl,name:"receiving",active:fl});var Tl,vl=Object.freeze({__proto__:null,exhibit:(e,t)=>Bs({classes:[],styles:t.useFixed()?{}:{position:"relative"}})});const El=e=>e.dom.focus(),Al=e=>e.dom.blur(),Ml=e=>{var t=Lt(e).dom;return e.dom===t.activeElement},Dl=(e=un())=>Q.from(e.dom.activeElement).map(te),Bl=t=>Dl(Lt(t)).filter(e=>t.dom.contains(e.dom)),Fl=(e,o)=>{const n=Lt(o),t=Dl(n).bind(t=>{var e=e=>kt(t,e);if(e(o))return Q.some(o);{var n=e;const r=t=>{for(let e=0;e<t.childNodes.length;e++){var o=te(t.childNodes[e]);if(n(o))return Q.some(o);o=r(t.childNodes[e]);if(o.isSome())return o}return Q.none()};return r(o.dom)}}),r=e(o);return t.each(t=>{Dl(n).filter(e=>kt(e,t)).fold(()=>{El(t)},S)}),r},Il=(e,t,o,n,r)=>{var a=e=>e+"px";return{position:e,left:t.map(a),top:o.map(a),right:n.map(a),bottom:r.map(a)}},Rl=(e,t)=>{oo(e,{...e=t,position:Q.some(e.position)})},Nl=Hr([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Vl=(e,t,o,n,r,a)=>{const s=t.rect,i=s.x-o,l=s.y-n,c=r-(i+s.width),d=a-(l+s.height),u=Q.some(i),m=Q.some(l),g=Q.some(c),p=Q.some(d),h=Q.none();return t.direction.fold(()=>Il(e,u,m,h,h),()=>Il(e,h,m,g,h),()=>Il(e,u,h,h,p),()=>Il(e,h,h,g,p),()=>Il(e,u,m,h,h),()=>Il(e,u,h,h,p),()=>Il(e,u,m,h,h),()=>Il(e,h,m,g,h))},zl=(e,r)=>e.fold(()=>{var e=r.rect;return Il("absolute",Q.some(e.x),Q.some(e.y),Q.none(),Q.none())},(e,t,o,n)=>Vl("absolute",r,e,t,o,n),(e,t,o,n)=>Vl("fixed",r,e,t,o,n)),Hl=(e,t)=>{var o=$(pn,t),e=e.fold(o,o,()=>{var e=sn();return pn(t).translate(-e.left,-e.top)}),o=So(t),n=po(t);return hn(e.left,e.top,o,n)},Ll=(e,t,o)=>{const n=fo(t,o);return e.fold(T(n),T(n),()=>{var e=sn();return n.translate(-e.left,-e.top)})},Pl=(Nl.none,Nl.relative),Ul=Nl.fixed,Wl="data-alloy-placement",jl=e=>Kt(e,Wl),Gl=Hr([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),$l=(e,t,o,n)=>{const r=e.bubble,a=r.offset,d=(x=n,w=e.restriction,S=a,C=(k=(n,r)=>w[n].map(e=>{var t="top"===n||"bottom"===n,o=t?S.top:S.left,e=("left"===n||"top"===n?Math.max:Math.min)(e,r)+o;return t?qi(e,x.y,x.bottom):qi(e,x.x,x.right)}).getOr(r))("left",x.x),O=k("top",x.y),_=k("right",x.right),k=k("bottom",x.bottom),hn(C,O,_-C,k-O)),s=e.x+a.left,i=e.y+a.top,l=hn(s,i,t,o),{originInBounds:c,sizeInBounds:u,visibleW:m,visibleH:g}=(e=>{var{x:t,y:o,right:n,bottom:r}=d,{x:e,y:a,right:s,bottom:i,width:l,height:c}=e;return{originInBounds:t<=e&&e<=n&&o<=a&&a<=r,sizeInBounds:s<=n&&t<=s&&i<=r&&o<=i,visibleW:Math.min(l,t<=e?n-e:s-t),visibleH:Math.min(c,o<=a?r-a:i-o)}})(l),p=c&&u,h=p?l:(e=>{var{x:t,y:o,right:n,bottom:r}=d,{x:e,y:a,width:s,height:i}=e,l=Math.max(t,n-s),c=Math.max(o,r-i),e=qi(e,t,l),t=qi(a,o,c),l=Math.min(e+s,n)-e,a=Math.min(t+i,r)-t;return hn(e,t,l,a)})(l),f=0<h.width&&0<h.height,{maxWidth:v,maxHeight:b}=((e,t,o)=>{const n=T(t.bottom-o.y),r=T(o.bottom-t.y),a=(c=r,e.fold(c,c,n,n,c,n,r,r)),s=T(t.right-o.x),i=T(o.right-t.x),l=(c=i,e.fold(c,s,c,s,i,i,c,s));var c;return{maxWidth:l,maxHeight:a}})(e.direction,h,n),y={rect:h,maxHeight:b,maxWidth:v,direction:e.direction,placement:e.placement,classes:{on:r.classesOn,off:r.classesOff},layout:e.label,testY:i};var x,w,S,k,C,O,_;return p||e.alwaysFit?Gl.fit(y):Gl.nofit(y,m,g,f)},ql=e=>{const t=D(Q.none()),o=()=>t.get().each(e);return{clear:()=>{o(),t.set(Q.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{o(),t.set(Q.some(e))}}},Xl=()=>ql(e=>e.unbind()),Yl=()=>{const t=ql(S);return{...t,on:e=>t.get().each(e)}},Kl=J,Jl=(e,t,o)=>{return e=e,t=t,n=Kl,o=o,Jo(e,t,n,o,!1);var n},Zl=(e,t,o)=>{return e=e,t=t,n=Kl,o=o,Jo(e,t,n,o,!0);var n},Ql=Ko,ec=["top","bottom","right","left"],tc="data-alloy-transition-timer",oc=(e,t,o,n,r,a)=>{s=n,i=r;var s,i,l=a.exists(e=>{var t=s.mode;return"all"===t||e[t]!==i[t]});if(l||(a=e,d=n,$s(a,d.classes))){oe(e,"position",o.position);const a=Hl(t,e),g=zl(t,{...r,rect:a}),p=Te(ec,e=>g[e]);if(((n,e)=>{const r=e=>parseFloat(e).toFixed(3);return je(e,(e,t)=>{return t=n[t].map(r),e=e.map(r),o=G,!Ke(t,e,o).getOr(t.isNone()&&e.isNone());var o}).isSome()})(o,p)){if(oo(e,p),l){var c=e,d=n;js(c,d.classes),Kt(c,tc).each(e=>{clearTimeout(parseInt(e,10)),Zt(c,tc)});{var u=c,m=d;const h=Xl(),f=Xl();let t;const v=e=>{var t=null!=(t=e.raw.pseudoElement)?t:"";return kt(e.target,u)&&!rt(t)&&me(ec,e.raw.propertyName)},b=e=>{if(U(e)||v(e)){h.clear(),f.clear();const v=null==e?void 0:e.raw.type;!U(v)&&v!==ma()||(clearTimeout(t),Zt(u,tc),Gs(u,m.classes))}},y=Jl(u,ga(),e=>{v(e)&&(y.unbind(),h.set(Jl(u,ma(),b)),f.set(Jl(u,ua(),b)))}),x=(t=>{const e=e=>{e=no(t,e).split(/\s*,\s*/);return ve(e,rt)},n=e=>{var t;return L(e)&&/^[\d.]+/.test(e)?(t=parseFloat(e),ot(e,"ms")?t:1e3*t):0},r=e("transition-delay"),o=e("transition-duration");return ye(o,(e,t,o)=>{o=n(r[o])+n(t);return Math.max(e,o)},0)})(u);requestAnimationFrame(()=>{t=setTimeout(b,x+17),O(u,tc,t)})}}co(e)}}else Gs(e,n.classes)},nc=(e,t)=>{t=Math.floor(t);t=mo.max(e,t,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),oe(e,"max-height",t+"px")},rc=T((e,t)=>{nc(e,t),to(e,{"overflow-x":"hidden","overflow-y":"auto"})}),ac=T((e,t)=>{nc(e,t)}),sc=(e,t,o)=>void 0===e[t]?o:e[t],ic=(e,t,o,n)=>{var r,e=((e,t,o,n)=>{lo(t,"max-height"),lo(t,"max-width");var r={width:So(r=t),height:po(r)};{var c=t,d=(t=n.preference,e),u=r,m=o,g=n.bounds;const p=u.width,h=u.height,a=(e,r,a,s,i)=>{const t=e(d,u,m,c,g),l=$l(t,p,h,g);return l.fold(T(l),(e,t,o,n)=>(i===n?s<o||a<t:!i&&n)?l:Gl.nofit(r,a,s,i))};return ye(t,(e,t)=>{t=$(a,t);return e.fold(T(e),t)},Gl.nofit({rect:d,maxHeight:u.height,maxWidth:u.width,direction:zi(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:d.y},-1,-1,!1)).fold(w,w)}})(e,t,o,n);{var a=t,s=e,i=n;const l=zl(i.origin,s);i.transition.each(e=>{oc(a,i.origin,l,e,s,i.lastPlacement)}),Rl(a,l)}return o=t,r=e.placement,O(o,Wl,r),o=t,r=e.classes,Gs(o,r.off),js(o,r.on),(0,n.maxHeightFunction)(t,e.maxHeight),(0,n.maxWidthFunction)(t,e.maxWidth),{layout:e.layout,placement:e.placement}},lc=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],cc=(e,t,o,n=1)=>{const r=e*n,a=t*n,s=e=>C(o,e).getOr([]),i=(e,t,o)=>{var n=_e(lc,o);return{offset:fo(e,t),classesOn:ke(o,s),classesOff:ke(n,s)}};return{southeast:()=>i(-e,t,["top","alignLeft"]),southwest:()=>i(e,t,["top","alignRight"]),south:()=>i(-e/2,t,["top","alignCentre"]),northeast:()=>i(-e,-t,["bottom","alignLeft"]),northwest:()=>i(e,-t,["bottom","alignRight"]),north:()=>i(-e/2,-t,["bottom","alignCentre"]),east:()=>i(e,-t/2,["valignCentre","left"]),west:()=>i(-e,-t/2,["valignCentre","right"]),insetNortheast:()=>i(r,a,["top","alignLeft","inset"]),insetNorthwest:()=>i(-r,a,["top","alignRight","inset"]),insetNorth:()=>i(-r/2,a,["top","alignCentre","inset"]),insetSoutheast:()=>i(r,-a,["bottom","alignLeft","inset"]),insetSouthwest:()=>i(-r,-a,["bottom","alignRight","inset"]),insetSouth:()=>i(-r/2,-a,["bottom","alignCentre","inset"]),insetEast:()=>i(-r,-a/2,["valignCentre","right","inset"]),insetWest:()=>i(r,-a/2,["valignCentre","left","inset"])}},dc=()=>cc(0,0,{}),uc=w,mc=(t,o)=>e=>"rtl"===gc(e)?o:t,gc=e=>"rtl"===no(e,"direction")?"rtl":"ltr",pc=((fl=Tl=Tl||{}).TopToBottom="toptobottom",fl.BottomToTop="bottomtotop","data-alloy-vertical-dir"),hc=e=>ui(e,e=>ft(e)&&Yt(e,"data-alloy-vertical-dir")===Tl.BottomToTop),fc=()=>Mr("layouts",[A("onLtr"),A("onRtl"),d("onBottomLtr"),d("onBottomRtl")]),vc=(t,e,o,n,r,a,s)=>{var s=s.map(hc).getOr(!1),i=e.layouts.map(e=>e.onLtr(t)),l=e.layouts.map(e=>e.onRtl(t)),r=s?e.layouts.bind(e=>e.onBottomLtr.map(e=>e(t))).or(i).getOr(r):i.getOr(o),i=s?e.layouts.bind(e=>e.onBottomRtl.map(e=>e(t))).or(l).getOr(a):l.getOr(n);return mc(r,i)(t)};var fl=[A("hotspot"),d("bubble"),M("overrides",{}),fc(),Fi("placement",(e,t,o)=>{var n=t.hotspot,o=Hl(o,n.element),n=vc(e.element,t,pl(),hl(),ml(),gl(),Q.some(t.hotspot.element));return Q.some(uc({anchorBox:o,bubble:t.bubble.getOr(dc()),overrides:t.overrides,layouts:n}))})],bc=[A("x"),A("y"),M("height",0),M("width",0),M("bubble",dc()),M("overrides",{}),fc(),Fi("placement",(e,t,o)=>{o=Ll(o,t.x,t.y),o=hn(o.left,o.top,t.width,t.height),e=vc(e.element,t,dl(),ul(),dl(),ul(),Q.none());return Q.some(uc({anchorBox:o,bubble:t.bubble,overrides:t.overrides,layouts:e}))})];const yc=Hr([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),xc=e=>e.fold(w,(e,t,o)=>e.translate(-t,-o)),wc=e=>e.fold(w,w),Sc=e=>ye(e,(e,t)=>e.translate(t.left,t.top),fo(0,0)),kc=e=>{e=k(e,wc);return Sc(e)},Cc=yc.screen,Oc=yc.absolute,_c=(e,t,o)=>{var n=Ot(e.element),n=sn(n),e=((o,e)=>{e=Et(e.root).dom;return Q.from(e.frameElement).map(te).filter(e=>{var e=Ot(e),t=Ot(o.element);return kt(e,t)}).map(bo)})(e,o).getOr(n);return Oc(e,n.left,n.top)},Tc=(e,t,o,n)=>{e=Cc(fo(e,t));return Q.some({point:e,width:o,height:n})},Ec=(e,a,s,i,l)=>e.map(e=>{const t=[a,e.point],o=i.fold(()=>kc(t),()=>kc(t),()=>{var e=t;return e=k(e,xc),Sc(e)});var e={x:o.left,y:o.top,width:e.width,height:e.height},n=(s.showAbove?ml:pl)(),r=(s.showAbove?gl:hl)(),n=vc(l,s,n,r,n,r,Q.none());return uc({anchorBox:e,bubble:s.bubble.getOr(dc()),overrides:s.overrides,layouts:n})});var Ac=[A("node"),A("root"),d("bubble"),fc(),M("overrides",{}),M("showAbove",!1),Fi("placement",(o,n,r)=>{const a=_c(o,0,n);return n.node.filter(jt).bind(e=>{var e=e.dom.getBoundingClientRect(),e=Tc(e.left,e.top,e.width,e.height),t=n.node.getOr(o.element);return Ec(e,a,n,r,t)})})];const Mc=(e,t,o,n)=>({start:e,soffset:t,finish:o,foffset:n}),Dc=Hr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Bc=(Dc.before,Dc.on,Dc.after,Hr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}])),Fc={domRange:Bc.domRange,relative:Bc.relative,exact:Bc.exact,exactFromRange:e=>Bc.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{e=e.match({domRange:e=>te(e.startContainer),relative:(e,t)=>{return e.fold(w,w,w)},exact:(e,t,o,n)=>e});return Et(e)},range:Mc},Ic=(e,t,o)=>{var n,e=e.document.createRange(),r=e;return t.fold(e=>{r.setStartBefore(e.dom)},(e,t)=>{r.setStart(e.dom,t)},e=>{r.setStartAfter(e.dom)}),n=e,o.fold(e=>{n.setEndBefore(e.dom)},(e,t)=>{n.setEnd(e.dom,t)},e=>{n.setEndAfter(e.dom)}),e},Rc=(e,t,o,n,r)=>{e=e.document.createRange();return e.setStart(t.dom,o),e.setEnd(n.dom,r),e},Nc=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),Vc=Hr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),zc=(e,t,o)=>t(te(o.startContainer),o.startOffset,te(o.endContainer),o.endOffset),Hc=(a,e)=>(e=>{r=a;var r,e=e.match({domRange:e=>({ltr:T(e),rtl:Q.none}),relative:(e,t)=>({ltr:ko(()=>Ic(r,e,t)),rtl:ko(()=>Q.some(Ic(r,t,e)))}),exact:(e,t,o,n)=>({ltr:ko(()=>Rc(r,e,t,o,n)),rtl:ko(()=>Q.some(Rc(r,o,n,e,t)))})});{const t=e.ltr();return t.collapsed?e.rtl().filter(e=>!1===e.collapsed).map(e=>Vc.rtl(te(e.endContainer),e.endOffset,te(e.startContainer),e.startOffset)).getOrThunk(()=>zc(0,Vc.ltr,t)):zc(0,Vc.ltr,t)}})(e).match({ltr:(e,t,o,n)=>{var r=a.document.createRange();return r.setStart(e.dom,t),r.setEnd(o.dom,n),r},rtl:(e,t,o,n)=>{var r=a.document.createRange();return r.setStart(o.dom,n),r.setEnd(e.dom,t),r}}),Lc=(Vc.ltr,Vc.rtl,(e,t,o)=>ve(((e,t)=>{var o=j(t)?t:K;let n=e.dom;for(var r=[];null!==n.parentNode&&void 0!==n.parentNode;){const e=n.parentNode,t=te(e);if(r.push(t),!0===o(t))break;n=e}return r})(e,o),t)),Pc=(e,t)=>{return t=t,e=void 0===e?document:e.dom,St(e)?[]:k(e.querySelectorAll(t),te)},Uc=e=>{var t;return 0<e.rangeCount?(t=e.getRangeAt(0),e=e.getRangeAt(e.rangeCount-1),Q.some(Mc(te(t.startContainer),t.startOffset,te(e.endContainer),e.endOffset))):Q.none()},Wc=e=>{var t,o,n,r,a,s,i,l,c,d,u;return null!==e.anchorNode&&null!==e.focusNode&&(t=te(e.anchorNode),o=te(e.focusNode),n=t,r=e.anchorOffset,a=o,s=e.focusOffset,d=n,u=r,i=a,l=s,(c=Ot(d).dom.createRange()).setStart(d.dom,u),c.setEnd(i.dom,l),d=c,u=kt(n,a)&&r===s,d.collapsed)&&!u?Q.some(Mc(t,e.anchorOffset,o,e.focusOffset)):Uc(e)},jc=(e,t)=>{return e=Hc(e,t),0<(t=0<(t=e.getClientRects()).length?t[0]:e.getBoundingClientRect()).width||0<t.height?Q.some(t).map(Nc):Q.none()},Gc=(o=>{const t=e=>o(e)?Q.from(e.dom.nodeValue):Q.none();return{get:e=>{if(o(e))return t(e).getOr("");throw new Error("Can only get text value of a text node")},getOption:t,set:(e,t)=>{if(!o(e))throw new Error("Can only set raw text value of a text node");e.dom.nodeValue=t}}})(vt),$c=(e,t)=>({element:e,offset:t}),qc=(e,t)=>(vt(e)?$c:(e,t)=>{var o=Bt(e);if(0===o.length)return $c(e,t);if(t<o.length)return $c(o[t],0);{const e=o[o.length-1],t=(vt(e)?(o=e,Gc.get(o)):Bt(e)).length;return $c(e,t)}})(e,t),Xc=e=>void 0!==e.foffset,Yc=(t,e)=>e.getSelection.getOrThunk(()=>()=>{return e=t,Q.from(e.getSelection()).filter(e=>0<e.rangeCount).bind(Wc);var e})().map(e=>{var t,o;return Xc(e)?(t=qc(e.start,e.soffset),o=qc(e.finish,e.foffset),Fc.range(t.element,t.offset,o.element,o.offset)):e});var Kc=[d("getSelection"),A("root"),d("bubble"),fc(),M("overrides",{}),M("showAbove",!1),Fi("placement",(e,t,o)=>{const n=Et(t.root).dom,r=_c(e,0,t),a=Yc(n,t).bind(o=>{var e,t;return Xc(o)?(t=n,e=Fc.exactFromRange(o),(0<(t=Hc(t,e).getBoundingClientRect()).width||0<t.height?Q.some(t).map(Nc):Q.none()).orThunk(()=>{var e=lt("\ufeff"),t=(Qo(o.start,e),jc(n,Fc.exact(e,0,e,1)));return an(e),t}).bind(e=>Tc(e.left,e.top,e.width,e.height))):(e=ze(o,e=>e.dom.getBoundingClientRect()),t={left:Math.min(e.firstCell.left,e.lastCell.left),right:Math.max(e.firstCell.right,e.lastCell.right),top:Math.min(e.firstCell.top,e.lastCell.top),bottom:Math.max(e.firstCell.bottom,e.lastCell.bottom)},Tc(t.left,t.top,t.right-t.left,t.bottom-t.top))}),s=Yc(n,t).bind(e=>Xc(e)?ft(e.start)?Q.some(e.start):Mt(e.start):Q.some(e.firstCell)).getOr(e.element);return Ec(a,r,t,o,s)})];const Jc="link-layout",Zc=e=>e.x+e.width,Qc=(e,t)=>e.x-t.width,ed=(e,t)=>e.y-t.height+e.height,td=e=>e.y,od=(e,t,o)=>Ni(Zc(e),td(e),o.southeast(),zi(),"southeast",Xi(e,{left:0,top:2}),Jc),nd=(e,t,o)=>Ni(Qc(e,t),td(e),o.southwest(),Hi(),"southwest",Xi(e,{right:1,top:2}),Jc),rd=(e,t,o)=>Ni(Zc(e),ed(e,t),o.northeast(),Li(),"northeast",Xi(e,{left:0,bottom:3}),Jc),ad=(e,t,o)=>Ni(Qc(e,t),ed(e,t),o.northwest(),Pi(),"northwest",Xi(e,{right:1,bottom:3}),Jc),sd=()=>[od,nd,rd,ad],id=()=>[nd,od,ad,rd];var ld=[A("item"),fc(),M("overrides",{}),Fi("placement",(e,t,o)=>{o=Hl(o,t.item.element),e=vc(e.element,t,sd(),id(),sd(),id(),Q.none());return Q.some(uc({anchorBox:o,bubble:dc(),overrides:t.overrides,layouts:e}))})],Kc=mr("type",{selection:Kc,node:Ac,hotspot:fl,submenu:ld,makeshift:bc});const cd=[kr("classes",er),Ir("mode","all",["all","layout","placement"])],dd=[M("useFixed",K),d("getBounds")],ud=[vr("anchor",Kc),Mr("transition",cd)],md=(n,m,g,p,e,h)=>{const f=dr("placement.info",E(ud),e),r=f.anchor,a=p.element,v=g.get(p.uid);Fl(()=>{oe(a,"position","fixed");var e,t,o=ao(a,"visibility");oe(a,"visibility","hidden");const u=m.useFixed()?(t=document.documentElement,Ul(0,0,t.clientWidth,t.clientHeight)):(t=n,e=bo(t.element),t=t.element.dom.getBoundingClientRect(),Pl(e.left,e.top,t.width,t.height));r.placement(n,r,u).each(e=>{var t,o,n,r,a,s,i,l,c=h.orThunk(()=>m.getBounds.map(Y)),d=(t=u,e=e,c=c,o=p,n=v,r=f.transition,d={anchorBox:d=e.anchorBox,origin:t},t=o.element,o=e.bubble,a=e.layouts,n=n,c=c,e=e.overrides,r=r,i=sc(e,"maxHeightFunction",rc()),e=sc(e,"maxWidthFunction",S),l=d.anchorBox,c={bounds:(s=d=d.origin,c.fold(()=>s.fold(yn,yn,hn),t=>s.fold(T(t),T(t),()=>{var e=Ll(s,t.x,t.y);return hn(e.left,e.top,t.width,t.height)}))),origin:d,preference:a,maxHeightFunction:i,maxWidthFunction:e,lastPlacement:n,transition:r},ic(l,t,o,c));g.set(p.uid,d)}),o.fold(()=>{lo(a,"visibility")},e=>{oe(a,"visibility",e)}),ao(a,"left").isNone()&&ao(a,"top").isNone()&&ao(a,"right").isNone()&&ao(a,"bottom").isNone()&&Xe(ao(a,"position"),"fixed")&&lo(a,"position")},a)};Ac=Object.freeze({__proto__:null,position:(e,t,o,n,r)=>{var a=Q.none();md(e,t,o,n,r,a)},positionWithinBounds:md,getMode:(e,t,o)=>t.useFixed()?"fixed":"absolute",reset:(e,t,o,n)=>{const r=n.element;var a;ee(["position","left","right","top","bottom"],e=>lo(r,e)),a=r,Zt(a,Wl),o.clear(n.uid)}});const gd=Sl({fields:dd,name:"positioning",active:vl,apis:Ac,state:Object.freeze({__proto__:null,init:()=>{let o={};return Ms({readState:()=>o,clear:e=>{W(e)?delete o[e]:o={}},set:(e,t)=>{o[e]=t},get:e=>C(o,e)})}})}),pd=e=>e.getSystem().isConnected(),hd=e=>{B(e,Fa());e=e.components();ee(e,hd)},fd=e=>{var t=e.components();ee(t,fd),B(e,Ba())},vd=(e,t)=>{e.getSystem().addToWorld(t),jt(e.element)&&fd(t)},bd=e=>{hd(e),e.getSystem().removeFromWorld(e)},yd=(e,t)=>{on(e.element,t.element)},xd=(e,t)=>{wd(e,t,on)},wd=(e,t,o)=>{e.getSystem().addToWorld(t),o(e.element,t.element),jt(e.element)&&fd(t),e.syncComponents()},Sd=e=>{hd(e),an(e.element),e.getSystem().removeFromWorld(e)},kd=t=>{var e=At(t.element).bind(e=>t.getSystem().getByDom(e).toOptional());Sd(t),e.each(e=>{e.syncComponents()})},Cd=e=>{var t=e.components();ee(t,Sd),rn(e.element),e.syncComponents()},Od=(e,t)=>{Td(e,t,on)},_d=(e,t)=>{Td(e,t,en)},Td=(e,t,o)=>{o(e,t.element);o=Bt(t.element);ee(o,e=>{t.getByDom(e).each(fd)})},Ed=t=>{var e=Bt(t.element);ee(e,e=>{t.getByDom(e).each(hd)}),an(t.element)},Ad=(t,e,o,n)=>{o.get().each(e=>{Cd(t)});e=e.getAttachPoint(t),xd(e,t),e=t.getSystem().build(n);return xd(t,e),o.set(e),e},Md=(e,t,o,n)=>{o=Ad(e,t,o,n);return t.onOpen(e,o),o},Dd=(t,o,n)=>{n.get().each(e=>{Cd(t),kd(t),o.onClose(t,e),n.clear()})},Bd=(e,t,o)=>o.isOpen(),Fd=(e,t,o)=>{var n,r,a=t.getAttachPoint(e);oe(e.element,"position",gd.getMode(a)),n=e,a="visibility",r=t.cloakVisibilityAttr,ao(n.element,a).fold(()=>{Zt(n.element,r)},e=>{O(n.element,r,e)}),oe(n.element,a,"hidden")},Id=(e,t,o)=>{var n,r,a;a=e.element,ge(["top","left","right","bottom"],e=>ao(a,e).isSome())||lo(e.element,"position"),n=e,r="visibility",e=t.cloakVisibilityAttr,Kt(n.element,e).fold(()=>lo(n.element,r),e=>oe(n.element,r,e))};fl=Object.freeze({__proto__:null,cloak:Fd,decloak:Id,open:Md,openWhileCloaked:(e,t,o,n,r)=>{Fd(e,t),Md(e,t,o,n),r(),Id(e,t)},close:Dd,isOpen:Bd,isPartOf:(t,o,e,n)=>Bd(0,0,e)&&e.get().exists(e=>o.isPartOf(t,e,n)),getState:(e,t,o)=>o.get(),setContent:(e,t,o,n)=>o.get().map(()=>Ad(e,t,o,n))}),ld=Object.freeze({__proto__:null,events:(o,n)=>qa([ne(Oa(),(e,t)=>{Dd(e,o,n)})])}),bc=[e("onOpen"),e("onClose"),A("isPartOf"),A("getAttachPoint"),M("cloakVisibilityAttr","data-precloak-visibility")],Kc=Object.freeze({__proto__:null,init:()=>{var e=Yl(),t=T("not-implemented");return Ms({readState:t,isOpen:e.isSet,clear:e.clear,set:e.set,get:e.get})}});const m=Sl({fields:bc,name:"sandboxing",active:ld,apis:fl,state:Kc}),Rd=T("dismiss.popups"),Nd=T("reposition.popups"),Vd=T("mouse.released"),zd=$n([M("isExtraPart",K),Mr("fireEventInstead",[M("event",Ia())])]),Hd=e=>{const o=dr("Dismissal",zd,e);return{[Rd()]:{schema:$n([A("target")]),onReceive:(t,e)=>{!m.isOpen(t)||m.isPartOf(t,e.target)||o.isExtraPart(t,e.target)||o.fireEventInstead.fold(()=>m.close(t),e=>B(t,e.event))}}}},Ld=$n([Mr("fireEventInstead",[M("event",Ra())]),xr("doReposition")]),Pd=e=>{const o=dr("Reposition",Ld,e);return{[Nd()]:{onReceive:t=>{m.isOpen(t)&&o.fireEventInstead.fold(()=>o.doReposition(t),e=>B(t,e.event))}}}},Ud=(e,t,o)=>{t.store.manager.onLoad(e,t,o)},Wd=(e,t,o)=>{t.store.manager.onUnload(e,t,o)};vl=Object.freeze({__proto__:null,onLoad:Ud,onUnload:Wd,setValue:(e,t,o,n)=>{t.store.manager.setValue(e,t,o,n)},getValue:(e,t,o)=>t.store.manager.getValue(e,t,o),getState:(e,t,o)=>o}),Ac=Object.freeze({__proto__:null,events:(o,n)=>{var e=o.resetOnDom?[os((e,t)=>{Ud(e,o,n)}),ns((e,t)=>{Wd(e,o,n)})]:[bl(o,n,Ud)];return qa(e)}}),bc=()=>{const e=D(null);return Ms({set:e.set,get:e.get,isNotSet:()=>null===e.get(),clear:()=>{e.set(null)},readState:()=>({mode:"memory",value:e.get()})})},ld=()=>{const a=D({}),s=D({});return Ms({readState:()=>({mode:"dataset",dataByValue:a.get(),dataByText:s.get()}),lookup:e=>C(a.get(),e).orThunk(()=>C(s.get(),e)),update:e=>{const t=a.get(),o=s.get(),n={},r={};ee(e,t=>{n[t.value]=t,C(t,"meta").each(e=>{C(e,"text").each(e=>{r[e]=t})})}),a.set({...t,...n}),s.set({...o,...r})},clear:()=>{a.set({}),s.set({})}})},fl=Object.freeze({__proto__:null,memory:bc,dataset:ld,manual:()=>Ms({readState:S}),init:e=>e.store.manager.state(e)});const jd=(e,t,o,n)=>{var r=t.store;o.update([n]),r.setValue(e,n),t.onSetValue(e,n)};Kc=[d("initialValue"),A("getFallbackEntry"),A("getDataKey"),A("setValue"),Fi("manager",{setValue:jd,getValue:(e,t,o)=>{const n=t.store,r=n.getDataKey(e);return o.lookup(r).getOrThunk(()=>n.getFallbackEntry(r))},onLoad:(t,o,n)=>{o.store.initialValue.each(e=>{jd(t,o,n,e)})},onUnload:(e,t,o)=>{o.clear()},state:ld})],ld=[A("getValue"),M("setValue",S),d("initialValue"),Fi("manager",{setValue:(e,t,o,n)=>{t.store.setValue(e,n),t.onSetValue(e,n)},getValue:(e,t,o)=>t.store.getValue(e),onLoad:(t,o,e)=>{o.store.initialValue.each(e=>{o.store.setValue(t,e)})},onUnload:S,state:As.init})],bc=[d("initialValue"),Fi("manager",{setValue:(e,t,o,n)=>{o.set(n),t.onSetValue(e,n)},getValue:(e,t,o)=>o.get(),onLoad:(e,t,o)=>{t.store.initialValue.each(e=>{o.isNotSet()&&o.set(e)})},onUnload:(e,t,o)=>{o.clear()},state:bc})],bc=[Dr("store",{mode:"memory"},mr("mode",{memory:bc,manual:ld,dataset:Kc})),e("onSetValue"),M("resetOnDom",!1)];const y=Sl({fields:bc,name:"representing",active:Ac,apis:vl,extra:{setValueFrom:(e,t)=>{t=y.getValue(t);y.setValue(e,t)}},state:fl}),Gd=(n,e)=>zr(n,{},k(e,e=>{return t=e.name(),o="Cannot configure "+e.name()+" for "+n,pr(t,t,{tag:"option",process:{}},Pn(e=>En("The field: "+t+" is forbidden. "+o)));var t,o}).concat([hr("dump",w)])),$d=e=>e.dump,qd=(e,t)=>({...re(t),...e.dump}),Xd=Gd,Yd=qd,Kd="placeholder",Jd=Hr([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Zd=e=>$e(e,"uiType"),Qd=(n,r,a,s)=>{return e=n,t=a,o=s,(Zd(t)&&t.uiType===Kd?(l=t,c=o,(i=e).exists(e=>e!==l.owner)?Jd.single(!0,T(l)):C(c,l.name).fold(()=>{throw new Error("Unknown placeholder component: "+l.name+"\nKnown: ["+Re(c)+"]\nNamespace: "+i.getOr("none")+"\nSpec: "+JSON.stringify(l,null,2))},e=>e.replace())):Jd.single(!1,T(t))).fold((e,t)=>{var t=Zd(a)?t(r,a.config,a.validated):t(r),o=C(t,"components").getOr([]),o=ke(o,e=>Qd(n,r,e,s));return[{...t,components:o}]},(e,t)=>{if(Zd(a)){const e=t(r,a.config,a.validated);return a.validated.preprocess.getOr(w)(e)}return t(r)});var e,t,o,i,l,c},eu=Jd.single,tu=Jd.multiple,ou=T(Kd),nu=Hr([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),ru=M("factory",{sketch:w}),au=M("schema",[]),su=A("name"),iu=pr("pname","pname",Rn(e=>"<alloy."+I(e.name)+">"),Jn()),lu=hr("schema",()=>[d("preprocess")]),cu=M("defaults",T({})),du=M("overrides",T({})),uu=E([ru,au,su,iu,cu,du]),mu=E([ru,au,su,cu,du]),gu=E([ru,au,su,iu,cu,du]),pu=E([ru,lu,su,A("unit"),iu,cu,du]),hu=e=>e.fold(Q.some,Q.none,Q.some,Q.some),fu=e=>{var t=e=>e.name;return e.fold(t,t,t,t)},vu=(t,o)=>e=>{e=dr("Converting part type",o,e);return t(e)},bu=vu(nu.required,uu),yu=vu(nu.external,mu),xu=vu(nu.optional,gu),wu=vu(nu.group,pu),Su=T("entirety");ld=Object.freeze({__proto__:null,required:bu,external:yu,optional:xu,group:wu,asNamedPart:hu,name:fu,asCommon:e=>e.fold(w,w,w,w),original:Su});const ku=(e,t,o,n)=>Fn(t.defaults(e,o,n),o,{uid:e.partUids[t.name]},t.overrides(e,o,n)),Cu=(r,e)=>{const a={};return ee(e,e=>{hu(e).each(o=>{e=r,t=o.pname;const n={uiType:ou(),owner:e,name:t};var e,t;a[o.name]=e=>{var t=dr("Part: "+o.name+" in "+r,E(o.schema),e);return{...n,config:e,validated:t}}})}),a},Ou=(e,t,o)=>({uiType:ou(),owner:e,name:t,config:o,validated:{}}),_u=e=>ke(e,e=>e.fold(Q.none,Q.some,Q.none,Q.none).map(e=>wr(e.name,e.schema.concat([Ii(Su())]))).toArray()),Tu=e=>k(e,fu),Eu=(e,t,o)=>{{var n=t;t=o;const a={},r={};return ee(t,e=>{e.fold(n=>{a[n.pname]=eu(!0,(e,t,o)=>n.factory.sketch(ku(e,n,t,o)))},e=>{var t=n.parts[e.name];r[e.name]=T(e.factory.sketch(ku(n,e,t[Su()]),t))},n=>{a[n.pname]=eu(!1,(e,t,o)=>n.factory.sketch(ku(e,n,t,o)))},r=>{a[r.pname]=tu(!0,(t,e,o)=>{var n=t[r.name];return k(n,e=>r.factory.sketch(Fn(r.defaults(t,e,o),e,r.overrides(t,e))))})})}),{internals:T(a),externals:T(r)}}},Au=(e,t,o)=>{return n=Q.some(e),e=(r=t).components,t=o,t=ze(t,(t,o)=>{{var n=o,r=t;let e=!1;return{name:T(n),required:()=>r.fold((e,t)=>e,(e,t)=>e),used:()=>e,replace:()=>{if(e)throw new Error("Trying to use the same placeholder more than once: "+n);return e=!0,r}}}}),a=n,s=r,e=e,i=t,e=ke(e,e=>Qd(a,s,e,i)),Ve(t,e=>{if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(r.components,null,2))}),e;var n,r,a,s,i},Mu=(e,t,o)=>{t=t.partUids[o];return e.getSystem().getByUid(t).toOptional()},Du=(e,t,o)=>Mu(e,t,o).getOrDie("Could not find part: "+o),Bu=(e,t,o)=>{const n={},r=t.partUids,a=e.getSystem();return ee(o,e=>{n[e]=T(a.getByUid(r[e]))}),n},Fu=(e,t)=>{const o=e.getSystem();return ze(t.partUids,(e,t)=>T(o.getByUid(e)))},Iu=e=>Re(e.partUids),Ru=(e,t,o)=>{const n={},r=t.partUids,a=e.getSystem();return ee(o,e=>{n[e]=T(a.getByUid(r[e]).getOrDie())}),n},Nu=(t,e)=>{e=Tu(e);return Pr(k(e,e=>({key:e,value:t+"-"+e})))},Vu=t=>pr("partUids","partUids",Vn(e=>Nu(e.uid,t)),Jn());Kc=Object.freeze({__proto__:null,generate:Cu,generateOne:Ou,schemas:_u,names:Tu,substitutes:Eu,components:Au,defaultUids:Nu,defaultUidsSchema:Vu,getAllParts:Fu,getAllPartNames:Iu,getPart:Mu,getPartOrDie:Du,getParts:Bu,getPartsOrDie:Ru});const zu=(e,t,o,n,r)=>{r=r;n=(0<(n=n).length?[wr("parts",n)]:[]).concat([A("uid"),M("dom",{}),M("components",[]),Ii("originalSpec"),M("debug.sketcher",{})]).concat(r);return dr(e+" [SpecSchema]",$n(n.concat(t)),o)},Hu=(e,t,o,n,r)=>{var r=Lu(r),a=_u(o),s=Vu(o),t=zu(e,t,r,a,[s]),a=Eu(0,t,o);return n(t,Au(e,t,a.internals()),r,a.externals())},Lu=e=>{return t=e,$e(t,"uid")?e:{...e,uid:ys("uid")};var t},Pu=$n([A("name"),A("factory"),A("configFields"),M("apis",{}),M("extraApis",{})]),Uu=$n([A("name"),A("factory"),A("configFields"),A("partFields"),M("apis",{}),M("extraApis",{})]),Wu=e=>{const r=dr("Sketcher for "+e.name,Pu,e),t=ze(r.apis,Es),o=ze(r.extraApis,(e,t)=>Cs(e,t));return{name:r.name,configFields:r.configFields,sketch:e=>{var t=r.name,o=r.configFields,n=r.factory;return e=Lu(e),n(zu(t,o,e,[],[]),e)},...t,...o}},ju=e=>{const t=dr("Sketcher for "+e.name,Uu,e),o=Cu(t.name,t.partFields),n=ze(t.apis,Es),r=ze(t.extraApis,(e,t)=>Cs(e,t));return{name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:e=>Hu(t.name,t.configFields,t.partFields,t.factory,e),parts:o,...n,...r}},Gu=e=>xt("input")(e)&&"radio"!==Yt(e,"type")||xt("textarea")(e);bc=Object.freeze({__proto__:null,getCurrent:(e,t,o)=>t.find(e)});const $u=[A("find")],R=Sl({fields:$u,name:"composing",apis:bc}),qu=["input","button","textarea","select"],Xu=(e,t,o)=>{(t.disabled()?em:tm)(e,t)},Yu=(e,t)=>!0===t.useNative&&me(qu,gt(e.element)),Ku=e=>{O(e.element,"disabled","disabled")},Ju=e=>{Zt(e.element,"disabled")},Zu=e=>{O(e.element,"aria-disabled","true")},Qu=e=>{O(e.element,"aria-disabled","false")},em=(t,e,o)=>{e.disableClass.each(e=>{Ps(t.element,e)}),(Yu(t,e)?Ku:Zu)(t),e.onDisabled(t)},tm=(t,e,o)=>{e.disableClass.each(e=>{Us(t.element,e)}),(Yu(t,e)?Ju:Qu)(t),e.onEnabled(t)},om=(e,t)=>{return Yu(e,t)?(t=e,Jt(t.element,"disabled")):(t=e,"true"===Yt(t.element,"aria-disabled"))};Ac=Object.freeze({__proto__:null,enable:tm,disable:em,isDisabled:om,onLoad:Xu,set:(e,t,o,n)=>{(n?em:tm)(e,t)}}),vl=Object.freeze({__proto__:null,exhibit:(e,t)=>Bs({classes:t.disabled()?t.disableClass.toArray():[]}),events:(o,e)=>qa([Xa(wa(),(e,t)=>om(e,o)),bl(o,e,Xu)])}),fl=[Nr("disabled",K),M("useNative",!0),d("disableClass"),e("onDisabled"),e("onEnabled")];const ae=Sl({fields:fl,name:"disabling",active:vl,apis:Ac}),nm=(o,n,e,r)=>{var t=Pc(o.element,"."+n.highlightClass);ee(t,t=>{ge(r,e=>kt(e.element,t))||(Us(t,n.highlightClass),o.getSystem().getByDom(t).each(e=>{n.onDehighlight(o,e),B(e,Ua())}))})},rm=(e,t,o,n)=>{nm(e,t,0,[n]),am(0,t,0,n)||(Ps(n.element,t.highlightClass),t.onHighlight(e,n),B(n,Pa()))},am=(e,t,o,n)=>Ws(n.element,t.highlightClass),sm=(t,e,o)=>pi(t.element,"."+e.itemClass).bind(e=>t.getSystem().getByDom(e).toOptional()),im=(t,e,o)=>{e=Pc(t.element,"."+e.itemClass);return(0<e.length?Q.some(e[e.length-1]):Q.none()).bind(e=>t.getSystem().getByDom(e).toOptional())},lm=(t,o,e,n)=>{const r=Pc(t.element,"."+o.itemClass);return we(r,e=>Ws(e,o.highlightClass)).bind(e=>{e=$i(e,n,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()})},cm=(t,e,o)=>{e=Pc(t.element,"."+e.itemClass);return Ye(k(e,e=>t.getSystem().getByDom(e).toOptional()))};var dm,bc=Object.freeze({__proto__:null,dehighlightAll:(e,t,o)=>nm(e,t,0,[]),dehighlight:(e,t,o,n)=>{am(0,t,0,n)&&(Us(n.element,t.highlightClass),t.onDehighlight(e,n),B(n,Ua()))},highlight:rm,highlightFirst:(t,o,e)=>{sm(t,o).each(e=>{rm(t,o,0,e)})},highlightLast:(t,o,e)=>{im(t,o).each(e=>{rm(t,o,0,e)})},highlightAt:(t,o,e,n)=>{((e,t,o)=>{t=Pc(e.element,"."+t.itemClass);return Q.from(t[o]).fold(()=>_.error(new Error("No element found with index "+o)),e.getSystem().getByDom)})(t,o,n).fold(e=>{throw e},e=>{rm(t,o,0,e)})},highlightBy:(t,o,e,n)=>{var r=cm(t,o);xe(r,n).each(e=>{rm(t,o,0,e)})},isHighlighted:am,getHighlighted:(t,e,o)=>pi(t.element,"."+e.highlightClass).bind(e=>t.getSystem().getByDom(e).toOptional()),getFirst:sm,getLast:im,getPrevious:(e,t,o)=>lm(e,t,0,-1),getNext:(e,t,o)=>lm(e,t,0,1),getCandidates:cm}),fl=[A("highlightClass"),A("itemClass"),e("onHighlight"),e("onDehighlight")];const x=Sl({fields:fl,name:"highlighting",apis:bc}),um=[8],mm=[9],gm=[13],pm=[27],hm=[32],fm=[37],vm=[38],bm=[39],ym=[40],xm=(e,t,o)=>{var n=Oe(e.slice(0,t)),e=Oe(e.slice(t+1));return xe(n.concat(e),o)},wm=(e,t,o)=>{e=Oe(e.slice(0,t));return xe(e,o)},Sm=(e,t,o)=>{var n=e.slice(0,t),e=e.slice(t+1);return xe(e.concat(n),o)},km=(e,t,o)=>{e=e.slice(t+1);return xe(e,o)},u=t=>e=>{e=e.raw;return me(t,e.which)},Cm=e=>t=>Ce(e,e=>e(t)),Om=e=>!0===e.raw.shiftKey,_m=e=>!0===e.raw.ctrlKey,Tm=q(Om),g=(e,t)=>({matches:e,classification:t}),Em=(e,t,o)=>{t.exists(t=>o.exists(e=>kt(e,t)))||F(e,Na(),{prevFocus:t,newFocus:o})},Am=()=>{const n=e=>Bl(e.element);return{get:n,set:(e,t)=>{var o=n(e),t=(e.getSystem().triggerFocus(t,e.element),n(e));Em(e,o,t)}}},Mm=((vl=dm=dm||{}).OnFocusMode="onFocus",vl.OnEnterOrSpaceMode="onEnterOrSpace",vl.OnApiMode="onApi",(e,t,o,n,i)=>{const l=(t,o,e,n,r)=>{return e=e(t,o,n,r),a=o.event,xe(e,e=>e.matches(a)).map(e=>e.classification).bind(e=>e(t,o,n,r));var a},r={schema:()=>e.concat([M("focusManager",Am()),Dr("focusInside","onFocus",sr(e=>me(["onFocus","onEnterOrSpace","onApi"],e)?_.value(e):_.error("Invalid value for focusInside"))),Fi("handler",r),Fi("state",t),Fi("sendFocusIn",i)]),processKey:l,toEvents:(a,s)=>{var e=a.focusInside!==dm.OnFocusMode?Q.none():i(a).map(o=>ne(va(),(e,t)=>{o(e,a,s),t.stop()})),t=[ne(sa(),(n,r)=>{l(n,r,o,a,s).fold(()=>{var t,o,e;t=n,o=r,e=u(hm.concat(gm))(o.event),a.focusInside===dm.OnEnterOrSpaceMode&&e&&Gr(t,o)&&i(a).each(e=>{e(t,a,s),o.stop()})},e=>{r.stop()})}),ne(ia(),(e,t)=>{l(e,t,n,a,s).each(e=>{t.stop()})})];return qa(e.toArray().concat(t))}};return r}),Dm=e=>{const t=[d("onEscape"),d("onEnter"),M("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),M("firstTabstop",0),M("useTabstopAt",J),d("visibilitySelector")].concat([e]),l=(e,t)=>{e=e.visibilitySelector.bind(e=>hi(t,e)).getOr(t);return 0<go(e)},c=(e,t)=>t.focusManager.get(e).bind(e=>hi(e,t.selector)),o=(t,o,e)=>{((e,t)=>{e=Pc(e.element,t.selector),e=ve(e,e=>l(t,e));return Q.from(e[t.firstTabstop])})(t,o).each(e=>{o.focusManager.set(t,e)})},r=(r,e,a,s)=>{const i=Pc(r.element,a.selector);return c(r,a).bind(e=>we(i,$(kt,e)).bind(e=>{return t=r,o=i,n=a,s(o,e,e=>{return t=n,e=e,l(t,e)&&t.useTabstopAt(e);var t}).fold(()=>n.cyclic?Q.some(!0):Q.none(),e=>(n.focusManager.set(t,e),Q.some(!0)));var t,o,n}))},a=(e,t,o)=>{var n=o.cyclic?xm:wm;return r(e,0,o,n)},s=(e,t,o)=>{var n=o.cyclic?Sm:km;return r(e,0,o,n)},n=T([g(Cm([Om,u(mm)]),a),g(u(mm),s),g(Cm([Tm,u(gm)]),(t,o,e)=>e.onEnter.bind(e=>e(t,o)))]),i=T([g(u(pm),(t,o,e)=>e.onEscape.bind(e=>e(t,o))),g(u(mm),(o,n,r)=>c(o,r).filter(e=>!r.useTabstopAt(e)).bind(e=>{return e=t=e,(At(e).bind(It).exists(e=>kt(e,t))?a:s)(o,n,r);var t}))]);return Mm(t,As.init,n,i,()=>Q.some(o))};Ac=Dm(hr("cyclic",K)),fl=Dm(hr("cyclic",J));const Bm=(e,t,o)=>{return Gu(o)&&u(hm)(t.event)?Q.none():(t=e,e=o,ja(t,e,wa()),Q.some(!0))},Fm=(e,t)=>Q.some(!0),Im=[M("execute",Bm),M("useSpace",!1),M("useEnter",!0),M("useControlEnter",!1),M("useDown",!1)],Rm=(e,t,o)=>o.execute(e,t,e.element);var bc=Mm(Im,As.init,(e,t,o,n)=>{var e=o.useSpace&&!Gu(e.element)?hm:[],r=o.useEnter?gm:[],a=o.useDown?ym:[],e=e.concat(r).concat(a);return[g(u(e),Rm)].concat(o.useControlEnter?[g(Cm([_m,u(gm)]),Rm)]:[])},(e,t,o,n)=>o.useSpace&&!Gu(e.element)?[g(u(hm),Fm)]:[],()=>Q.none()),vl=()=>{const o=Yl();return Ms({readState:()=>o.get().map(e=>({numRows:String(e.numRows),numColumns:String(e.numColumns)})).getOr({numRows:"?",numColumns:"?"}),setGridSize:(e,t)=>{o.set({numRows:e,numColumns:t})},getNumRows:()=>o.get().map(e=>e.numRows),getNumColumns:()=>o.get().map(e=>e.numColumns)})},Nm=Object.freeze({__proto__:null,flatgrid:vl,init:e=>e.state(e)});const Vm=a=>(e,t,o,n)=>{var r=a(e.element);return Pm(r,e,t,o,n)},zm=(e,t)=>{e=mc(e,t);return Vm(e)},Hm=(e,t)=>{t=mc(t,e);return Vm(t)},Lm=r=>(e,t,o,n)=>Pm(r,e,t,o,n),Pm=(t,o,e,n,r)=>n.focusManager.get(o).bind(e=>t(o.element,e,n,r)).map(e=>(n.focusManager.set(o,e),!0)),Um=Lm,Wm=Lm,jm=Lm,Gm=e=>{return!((e=e.dom).offsetWidth<=0&&e.offsetHeight<=0)},$m=(e,t,o)=>{var n,e=Pc(e,o);return n=ve(e,Gm),we(n,e=>kt(e,t)).map(e=>({index:e,candidates:n}))},qm=(e,t)=>we(e,e=>kt(t,e)),Xm=(t,e,o,n)=>n(Math.floor(e/o),e%o).bind(e=>{e=e.row*o+e.column;return 0<=e&&e<t.length?Q.some(t[e]):Q.none()}),Ym=(n,e,r,a,s)=>Xm(n,e,a,(e,t)=>{var o=e===r-1?n.length-e*a:a,t=$i(t,s,0,o-1);return Q.some({row:e,column:t})}),Km=(n,e,r,a,s)=>Xm(n,e,a,(e,t)=>{var e=$i(e,s,0,r-1),o=e===r-1?n.length-e*a:a,t=qi(t,0,o-1);return Q.some({row:e,column:t})}),Jm=[A("selector"),M("execute",Bm),Mi("onEscape"),M("captureTab",!1),Ri()],Zm=(t,o,e)=>{pi(t.element,o.selector).each(e=>{o.focusManager.set(t,e)})},Qm=r=>(e,t,o,n)=>$m(e,t,o.selector).bind(e=>r(e.candidates,e.index,n.getNumRows().getOr(o.initSize.numRows),n.getNumColumns().getOr(o.initSize.numColumns))),eg=(e,t,o)=>o.captureTab?Q.some(!0):Q.none(),tg=Qm((e,t,o,n)=>Ym(e,t,o,n,-1)),og=Qm((e,t,o,n)=>Ym(e,t,o,n,1)),ng=Qm((e,t,o,n)=>Km(e,t,o,n,-1)),rg=Qm((e,t,o,n)=>Km(e,t,o,n,1)),ag=T([g(u(fm),zm(tg,og)),g(u(bm),Hm(tg,og)),g(u(vm),Um(ng)),g(u(ym),Wm(rg)),g(Cm([Om,u(mm)]),eg),g(Cm([Tm,u(mm)]),eg),g(u(hm.concat(gm)),(t,o,n,e)=>{return(r=n).focusManager.get(t).bind(e=>hi(e,r.selector)).bind(e=>n.execute(t,o,e));var r})]),sg=T([g(u(pm),(e,t,o)=>o.onEscape(e,t)),g(u(hm),Fm)]);vl=Mm(Jm,vl,ag,sg,()=>Q.some(Zm));const ig=(e,t,o,r,a)=>{const s=(o,e,n)=>a(o,e,r,0,n.length-1,n[e],e=>{return t=n[e],"button"===gt(t)&&"disabled"===Yt(t,"disabled")?s(o,e,n):Q.from(n[e]);var t});return $m(e,o,t).bind(e=>{var t=e.index,e=e.candidates;return s(t,t,e)})},lg=(e,t,o,n)=>ig(e,t,o,n,(e,t,o,n,r,a,s)=>{t=qi(t+o,n,r);return t===e?Q.from(a):s(t)}),cg=(e,t,o,n)=>ig(e,t,o,n,(e,t,o,n,r,a,s)=>{t=$i(t,o,n,r);return t===e?Q.none():s(t)}),dg=[A("selector"),M("getInitial",Q.none),M("execute",Bm),Mi("onEscape"),M("executeOnMove",!1),M("allowVertical",!0),M("allowHorizontal",!0),M("cycles",!0)],ug=(t,o,n)=>{return(r=n).focusManager.get(t).bind(e=>hi(e,r.selector)).bind(e=>n.execute(t,o,e));var r},mg=(t,o,e)=>{o.getInitial(t).orThunk(()=>pi(t.element,o.selector)).each(e=>{o.focusManager.set(t,e)})},gg=(e,t,o)=>(o.cycles?cg:lg)(e,o.selector,t,-1),pg=(e,t,o)=>(o.cycles?cg:lg)(e,o.selector,t,1),hg=r=>(e,t,o,n)=>r(e,t,o,n).bind(()=>o.executeOnMove?ug(e,t,o):Q.some(!0)),fg=T([g(u(hm),Fm),g(u(pm),(e,t,o)=>o.onEscape(e,t))]);var vg=Mm(dg,As.init,(e,t,o,n)=>{var r=[...o.allowHorizontal?fm:[]].concat(o.allowVertical?vm:[]),o=[...o.allowHorizontal?bm:[]].concat(o.allowVertical?ym:[]);return[g(u(r),hg(zm(gg,pg))),g(u(o),hg(Hm(gg,pg))),g(u(gm),ug),g(u(hm),ug)]},fg,()=>Q.some(mg));const bg=(e,t,o)=>Q.from(e[t]).bind(e=>Q.from(e[o]).map(e=>({rowIndex:t,columnIndex:o,cell:e}))),yg=(e,t,o,n)=>{var r=e[t].length,o=$i(o,n,0,r-1);return bg(e,t,o)},xg=(e,t,o,n)=>{o=$i(o,n,0,e.length-1),n=e[o].length,t=qi(t,0,n-1);return bg(e,o,t)},wg=(e,t,o,n)=>{var r=e[t].length,o=qi(o+n,0,r-1);return bg(e,t,o)},Sg=(e,t,o,n)=>{o=qi(o+n,0,e.length-1),n=e[o].length,t=qi(t,0,n-1);return bg(e,o,t)},kg=[wr("selectors",[A("row"),A("cell")]),M("cycles",!0),M("previousSelector",Q.none),M("execute",Bm)],Cg=(t,o,e)=>{o.previousSelector(t).orThunk(()=>{var e=o.selectors;return pi(t.element,e.cell)}).each(e=>{o.focusManager.set(t,e)})},Og=(e,t)=>(o,n,a)=>{const s=a.cycles?e:t;return hi(n,a.selectors.row).bind(e=>{var t=Pc(e,a.selectors.cell);return qm(t,n).bind(n=>{const r=Pc(o,a.selectors.row);return qm(r,e).bind(e=>{o=r,t=a;var t,o=k(o,e=>Pc(e,t.selectors.cell));return s(o,e,n).map(e=>e.cell)})})})},_g=Og((e,t,o)=>yg(e,t,o,-1),(e,t,o)=>wg(e,t,o,-1)),Tg=Og((e,t,o)=>yg(e,t,o,1),(e,t,o)=>wg(e,t,o,1)),Eg=Og((e,t,o)=>xg(e,o,t,-1),(e,t,o)=>Sg(e,o,t,-1)),Ag=Og((e,t,o)=>xg(e,o,t,1),(e,t,o)=>Sg(e,o,t,1)),Mg=T([g(u(fm),zm(_g,Tg)),g(u(bm),Hm(_g,Tg)),g(u(vm),Um(Eg)),g(u(ym),Wm(Ag)),g(u(hm.concat(gm)),(t,o,n)=>Bl(t.element).bind(e=>n.execute(t,o,e)))]),Dg=T([g(u(hm),Fm)]);var Bg=Mm(kg,As.init,Mg,Dg,()=>Q.some(Cg));const Fg=[A("selector"),M("execute",Bm),M("moveOnTab",!1)],Ig=(t,o,n)=>n.focusManager.get(t).bind(e=>n.execute(t,o,e)),Rg=(t,o,e)=>{pi(t.element,o.selector).each(e=>{o.focusManager.set(t,e)})},Ng=(e,t,o)=>cg(e,o.selector,t,-1),Vg=(e,t,o)=>cg(e,o.selector,t,1),zg=T([g(u(vm),jm(Ng)),g(u(ym),jm(Vg)),g(Cm([Om,u(mm)]),(e,t,o,n)=>o.moveOnTab?jm(Ng)(e,t,o,n):Q.none()),g(Cm([Tm,u(mm)]),(e,t,o,n)=>o.moveOnTab?jm(Vg)(e,t,o,n):Q.none()),g(u(gm),Ig),g(u(hm),Ig)]),Hg=T([g(u(hm),Fm)]);var Lg=Mm(Fg,As.init,zg,Hg,()=>Q.some(Rg)),Pg=[Mi("onSpace"),Mi("onEnter"),Mi("onShiftEnter"),Mi("onLeft"),Mi("onRight"),Mi("onTab"),Mi("onShiftTab"),Mi("onUp"),Mi("onDown"),Mi("onEscape"),M("stopSpaceKeyup",!1),d("focusIn")],Pg=Mm(Pg,As.init,(e,t,o)=>[g(u(hm),o.onSpace),g(Cm([Tm,u(gm)]),o.onEnter),g(Cm([Om,u(gm)]),o.onShiftEnter),g(Cm([Om,u(mm)]),o.onShiftTab),g(Cm([Tm,u(mm)]),o.onTab),g(u(vm),o.onUp),g(u(ym),o.onDown),g(u(fm),o.onLeft),g(u(bm),o.onRight),g(u(hm),o.onSpace)],(e,t,o)=>[...o.stopSpaceKeyup?[g(u(hm),Fm)]:[],g(u(pm),o.onEscape)],e=>e.focusIn);const Ug=Ac.schema(),Wg=fl.schema(),jg=vg.schema(),Gg=vl.schema(),$g=Bg.schema(),qg=bc.schema(),Xg=Lg.schema(),Yg=Pg.schema(),se=Cl({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Ug,cyclic:Wg,flow:jg,flatgrid:Gg,matrix:$g,execution:qg,menu:Xg,special:Yg}),name:"keying",active:{events:(e,t)=>e.handler.toEvents(e,t)},apis:{focusIn:(t,o,n)=>{o.sendFocusIn(o).fold(()=>{t.getSystem().triggerFocus(t.element,t.element)},e=>{e(t,o,n)})},setGridSize:(e,t,o,n,r)=>{var a;a=o,qe(a,"setGridSize")?o.setGridSize(n,r):console.error("Layout does not support setGridSize")}},state:Nm}),Kg=(n,r)=>{Fl(()=>{var t,e,o;e=(t=n).components(),o=t,ee(o.components(),e=>an(e.element)),rn(o.element),o.syncComponents(),o=k(r,n.getSystem().build),e=_e(e,o),ee(e,e=>{hd(e),t.getSystem().removeFromWorld(e)}),ee(o,e=>{pd(e)?yd(t,e):(t.getSystem().addToWorld(e),yd(t,e),jt(t.element)&&fd(e))}),t.syncComponents()},n.element)},Jg=(i,l)=>{Fl(()=>{{var t=i,e=l;const a=t.components(),s=ke(e,e=>Ts(e).toArray());ee(a,e=>{me(s,e)||bd(e)}),o=i.element,e=l,n=i.getSystem().buildOrPatch;var o,n,e=Ks(o,e,(e,t)=>Js(o,t,e,n)),r=_e(a,e);ee(r,e=>{pd(e)&&bd(e)}),ee(e,e=>{pd(e)||vd(t,e)}),t.syncComponents()}},i.element)},Zg=(e,t,o,n)=>{bd(t);t=Js(e.element,o,n,e.getSystem().buildOrPatch);vd(e,t),e.syncComponents()},Qg=(e,t,o)=>{o=e.getSystem().build(o);wd(e,o,t)},ep=(e,t,r,o)=>{kd(t),Qg(e,(e,t)=>{var o,n;o=e,n=t,e=r,Ft(o,e).fold(()=>{on(o,n)},e=>{Qo(e,n)})},o)},tp=(e,t)=>e.components(),op=(o,n,e,r,a)=>{var t=tp(o);return Q.from(t[r]).map(t=>(a.fold(()=>kd(t),e=>{(n.reuseDom?Zg:ep)(o,t,r,e)}),t))};Ac=Object.freeze({__proto__:null,append:(e,t,o,n)=>{Qg(e,on,n)},prepend:(e,t,o,n)=>{Qg(e,tn,n)},remove:(e,t,o,n)=>{e=tp(e);xe(e,e=>kt(n.element,e.element)).each(kd)},replaceAt:op,replaceBy:(t,o,e,n,r)=>{var a=tp(t);return we(a,n).bind(e=>op(t,o,0,e,r))},set:(e,t,o,n)=>(t.reuseDom?Jg:Kg)(e,n),contents:tp});const N=Sl({fields:[Rr("reuseDom",!0)],name:"replacing",apis:Ac}),V=(e,t)=>{return{key:e,value:{config:{},me:((e,t)=>{t=qa(t);return Sl({fields:[A("enabled")],name:e,active:{events:T(t)}})})(e,t),configAsRaw:T({}),initialConfig:{},state:As}}},np=(e,t)=>{t.ignore||(El(e.element),t.onFocus(e))};fl=Object.freeze({__proto__:null,focus:np,blur:(e,t)=>{t.ignore||Al(e.element)},isFocused:e=>Ml(e.element)}),vg=Object.freeze({__proto__:null,exhibit:(e,t)=>{t=t.ignore?{}:{attributes:{tabindex:"-1"}};return Bs(t)},events:o=>qa([ne(va(),(e,t)=>{np(e,o),t.stop()})].concat(o.stopMousedown?[ne(Qr(),(e,t)=>{t.event.prevent()})]:[]))}),vl=[e("onFocus"),M("stopMousedown",!1),M("ignore",!1)];const z=Sl({fields:vl,name:"focusing",active:vg,apis:fl}),rp=(e,t,o,n)=>{var r,a,s,i=o.get();o.set(n),a=e,s=o,t.toggleClass.each(e=>{(s.get()?Ps:Us)(a.element,e)}),(r=t.aria).update(e,r,o.get()),i!==n&&t.onToggled(e,n)},ap=(e,t,o)=>{rp(e,t,o,!o.get())},sp=(e,t,o)=>{rp(e,t,o,t.selected)};Bg=Object.freeze({__proto__:null,onLoad:sp,toggle:ap,isOn:(e,t,o)=>o.get(),on:(e,t,o)=>{rp(e,t,o,!0)},off:(e,t,o)=>{rp(e,t,o,!1)},set:rp}),bc=Object.freeze({__proto__:null,exhibit:()=>Bs({}),events:(e,t)=>{o=e,n=t,r=ap;var o,n,r,a=as(e=>{r(e,o,n)}),t=bl(e,t,sp);return qa(Se([e.toggleOnExecute?[a]:[],[t]]))}});const ip=(e,t,o)=>{O(e.element,"aria-expanded",o)};var lp,Lg=[M("selected",!1),d("toggleClass"),M("toggleOnExecute",!0),e("onToggled"),Dr("aria",{mode:"none"},mr("mode",{pressed:[M("syncWithExpanded",!1),Fi("update",(e,t,o)=>{O(e.element,"aria-pressed",o),t.syncWithExpanded&&ip(e,0,o)})],checked:[Fi("update",(e,t,o)=>{O(e.element,"aria-checked",o)})],expanded:[Fi("update",ip)],selected:[Fi("update",(e,t,o)=>{O(e.element,"aria-selected",o)})],none:[Fi("update",S)]}))];const f=Sl({fields:Lg,name:"toggling",active:bc,apis:Bg,state:{init:()=>{const t=D(!1);return{get:()=>t.get(),set:e=>t.set(e),clear:()=>t.set(!1),readState:()=>t.get()}}}}),cp=()=>{var e=(e,t)=>{t.stop(),Wa(e)};return[ne(da(),e),ne(ka(),e),es(Yr()),es(Qr())]},dp=e=>qa(Se([e.map(o=>as((e,t)=>{o(e),t.stop()})).toArray(),cp()])),up="alloy.item-hover",mp="alloy.item-focus",gp="alloy.item-toggled",pp=e=>{(Bl(e.element).isNone()||z.isFocused(e))&&(z.isFocused(e)||z.focus(e),F(e,up,{item:e}))},hp=e=>{F(e,mp,{item:e})},fp=T(up),vp=T(mp),bp=T(gp),yp=[A("data"),A("components"),A("dom"),M("hasSubmenu",!1),d("toggling"),Xd("itemBehaviours",[f,z,se,y]),M("ignoreFocus",!1),M("domModification",{}),Fi("builder",e=>{return{dom:e.dom,domModification:{...e.domModification,attributes:{role:e.toggling.map(e=>e.exclusive?"menuitemradio":"menuitemcheckbox").getOr("menuitem"),...e.domModification.attributes,"aria-haspopup":e.hasSubmenu,...e.hasSubmenu?{"aria-expanded":!1}:{}}},behaviours:Yd(e.itemBehaviours,[e.toggling.fold(f.revoke,e=>{return f.config((o=e,{aria:{mode:"checked"},...Ue(o,(e,t)=>"exclusive"!==t),onToggled:(e,t)=>{j(o.onToggled)&&o.onToggled(e,t),e=e,t=t,F(e,gp,{item:e,state:t})}}));var o}),z.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:e=>{hp(e)}}),se.config({mode:"execution"}),y.config({store:{mode:"memory",initialValue:e.data}}),V("item-type-events",[...cp(),ne(na(),pp),ne(Sa(),z.focus)])]),components:e.components,eventOrder:e.eventOrder}}),M("eventOrder",{})],xp=[A("dom"),A("components"),Fi("builder",e=>{return{dom:e.dom,components:e.components,events:qa([(e=Sa(),ne(e,(e,t)=>{t.stop()}))])}})],wp=T("item-widget"),Sp=T([bu({name:"widget",overrides:t=>({behaviours:re([y.config({store:{mode:"manual",getValue:e=>t.data,setValue:S}})])})})]),kp=[A("uid"),A("data"),A("components"),A("dom"),M("autofocus",!1),M("ignoreFocus",!1),Xd("widgetBehaviours",[y,z,se]),M("domModification",{}),Vu(Sp()),Fi("builder",o=>{const e=Eu(wp(),o,Sp()),t=Au(wp(),o,e.internals()),n=e=>Mu(e,o,"widget").map(e=>(se.focusIn(e),e)),r=(e,t)=>(Gu(t.event.target)||o.autofocus&&t.setSource(e.element),Q.none());return{dom:o.dom,components:t,domModification:o.domModification,events:qa([as((e,t)=>{n(e).each(e=>{t.stop()})}),ne(na(),pp),ne(Sa(),(e,t)=>{o.autofocus?n(e):z.focus(e)})]),behaviours:Yd(o.widgetBehaviours,[y.config({store:{mode:"memory",initialValue:o.data}}),z.config({ignore:o.ignoreFocus,onFocus:e=>{hp(e)}}),se.config({mode:"special",focusIn:o.autofocus?e=>{n(e)}:Ol(),onLeft:r,onRight:r,onEscape:(e,t)=>z.isFocused(e)||o.autofocus?(o.autofocus&&t.setSource(e.element),Q.none()):(z.focus(e),Q.some(!0))})])}})],Cp=mr("type",{widget:kp,item:yp,separator:xp}),Op=T([wu({factory:{sketch:e=>{e=dr("menu.spec item",Cp,e);return e.builder(e)}},name:"items",unit:"item",defaults:(e,t)=>$e(t,"uid")?t:{...t,uid:ys("item")},overrides:(e,t)=>({type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}})})]),_p=T([A("value"),A("items"),A("dom"),A("components"),M("eventOrder",{}),Gd("menuBehaviours",[x,y,R,se]),Dr("movement",{mode:"menu",moveOnTab:!0},mr("mode",{grid:[Ri(),Fi("config",(e,t)=>({mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}))],matrix:[Fi("config",(e,t)=>({mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},previousSelector:t.previousSelector,focusManager:e.focusManager})),A("rowSelector"),M("previousSelector",Q.none)],menu:[M("moveOnTab",!0),Fi("config",(e,t)=>({mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}))]})),vr("markers",Oi()),M("fakeFocus",!1),M("focusManager",Am()),e("onHighlight"),e("onDehighlight")]),Tp=T("alloy.menu-focus"),Ep=ju({name:"Menu",configFields:_p(),partFields:Op(),factory:(e,t,o,n)=>({uid:e.uid,dom:e.dom,markers:e.markers,behaviours:qd(e.menuBehaviours,[x.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight,onDehighlight:e.onDehighlight}),y.config({store:{mode:"memory",initialValue:e.value}}),R.config({find:Q.some}),se.config(e.movement.config(e,e.movement))]),events:qa([ne(vp(),(t,o)=>{var e=o.event;t.getSystem().getByDom(e.target).each(e=>{x.highlight(t,e),o.stop(),F(t,Tp(),{menu:t,item:e})})}),ne(fp(),(e,t)=>{t=t.event.item;x.highlight(e,t)}),ne(bp(),(e,t)=>{var o,n,{item:t,state:r}=t.event;r&&"menuitemradio"===Yt(t.element,"role")&&(o=e,n=t,r=Pc(o.element,'[role="menuitemradio"][aria-checked="true"]'),ee(r,e=>{kt(e,n.element)||o.getSystem().getByDom(e).each(e=>{f.off(e)})}))})]),components:t,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}})}),Ap=(o,n,r,e)=>C(r,e).bind(e=>C(o,e).bind(e=>{var t=Ap(o,n,r,e);return Q.some([e].concat(t))})).getOr([]),Mp=e=>"prepared"===e.type?Q.some(e.menu):Q.none(),Dp=()=>{const i=D({}),r=D({}),l=D({}),c=Yl(),a=D({}),d=e=>t(e).bind(Mp),t=e=>C(r.get(),e),o=e=>C(i.get(),e);return{setMenuBuilt:(e,t)=>{r.set({...r.get(),[e]:{type:"prepared",menu:t}})},setContents:(e,t,o,n)=>{c.set(e),i.set(o),r.set(t),a.set(n);e=((e,t)=>{const o={},n=(Ve(e,(e,t)=>{ee(e,e=>{o[e]=t})}),t),r=He(t,(e,t)=>({k:e,v:t})),a=ze(r,(e,t)=>[t].concat(Ap(o,n,r,t)));return ze(o,e=>C(a,e).getOr([e]))})(n,o);l.set(e)},expand:o=>C(i.get(),o).map(e=>{var t=C(l.get(),o).getOr([]);return[e].concat(t)}),refresh:e=>C(l.get(),e),collapse:e=>C(l.get(),e).bind(e=>1<e.length?Q.some(e.slice(1)):Q.none()),lookupMenu:t,lookupItem:o,otherMenus:e=>{var t=a.get();return _e(Re(t),e)},getPrimary:()=>c.get().bind(d),getMenus:()=>r.get(),clear:()=>{i.set({}),r.set({}),l.set({}),c.clear()},isClear:()=>c.get().isNone(),getTriggeringPath:(e,s)=>{const a=ve(o(e).toArray(),e=>d(e).isSome());return C(l.get(),e).bind(e=>{const o=Oe(a.concat(e));var t=ke(o,(e,t)=>{return n=e,r=s,a=o.slice(0,t+1),d(n).bind(t=>{return o=n,je(i.get(),(e,t)=>e===o).bind(e=>r(e).map(e=>({triggeredMenu:t,triggeringItem:e,triggeringPath:a})));var o}).fold(()=>Xe(c.get(),e)?[]:[Q.none()],e=>[Q.some(e)]);var n,r,a}),n=[];for(let e=0;e<t.length;e++){var r=t[e];if(!r.isSome())return Q.none();n.push(r.getOrDie())}return Q.some(n)})}}},Bp=Mp,Fp=I("tiered-menu-item-highlight"),Ip=I("tiered-menu-item-dehighlight"),Rp=((Pg=lp=lp||{})[Pg.HighlightMenuAndItem=0]="HighlightMenuAndItem",Pg[Pg.HighlightJustMenu=1]="HighlightJustMenu",Pg[Pg.HighlightNone=2]="HighlightNone",T("collapse-item")),Np=Wu({name:"TieredMenu",configFields:[Bi("onExecute"),Bi("onEscape"),Di("onOpenMenu"),Di("onOpenSubmenu"),e("onRepositionMenu"),e("onCollapseMenu"),M("highlightOnOpen",lp.HighlightMenuAndItem),wr("data",[A("primary"),A("menus"),A("expansions")]),M("fakeFocus",!1),e("onHighlightItem"),e("onDehighlightItem"),e("onHover"),Ti(),A("dom"),M("navigateOnHover",!0),M("stayInDom",!1),Gd("tmenuBehaviours",[se,x,R,N]),M("eventOrder",{})],apis:{collapseMenu:(e,t)=>{e.collapseMenu(t)},highlightPrimary:(e,t)=>{e.highlightPrimary(t)},repositionMenus:(e,t)=>{e.repositionMenus(t)}},factory:(l,e)=>{const r=Yl(),c=Dp(),d=e=>y.getValue(e).value,s=x.highlight,i=(t,o)=>{s(t,o),x.getHighlighted(o).orThunk(()=>x.getFirst(o)).each(e=>{l.fakeFocus?x.highlight(o,e):ja(t,e.element,Sa())})},a=(t,e)=>Ye(k(e,e=>t.lookupMenu(e).bind(e=>"prepared"===e.type?Q.some(e.menu):Q.none()))),u=(t,e,o)=>{e=a(e,e.otherMenus(o));ee(e,e=>{Gs(e.element,[l.markers.backgroundMenu]),l.stayInDom||N.remove(t,e)})},m=(e,o)=>{n=e;var n,e=r.get().getOrThunk(()=>{const o={},e=Pc(n.element,"."+l.markers.item),t=ve(e,e=>"true"===Yt(e,"aria-haspopup"));return ee(t,e=>{n.getSystem().getByDom(e).each(e=>{var t=d(e);o[t]=e})}),r.set(o),o});Ve(e,(e,t)=>{t=me(o,t);O(e.element,"aria-expanded",t)})},g=(o,n,r)=>Q.from(r[0]).bind(e=>n.lookupMenu(e).bind(e=>{var t;return"notbuilt"===e.type?Q.none():(e=e.menu,t=a(n,r.slice(1)),ee(t,e=>{Ps(e.element,l.markers.backgroundMenu)}),jt(e.element)||N.append(o,si(e)),Gs(e.element,[l.markers.backgroundMenu]),i(o,e),u(o,n,r),Q.some(e))}));let p;var t;(t=p=p||{})[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent";const h=(a,s,i=p.HighlightSubmenu)=>{var e;return s.hasConfigured(ae)&&ae.isDisabled(s)?Q.some(s):(e=d(s),c.expand(e).bind(r=>(m(a,r),Q.from(r[0]).bind(n=>c.lookupMenu(n).bind(e=>{t=a,o=n;var t,o="notbuilt"===(e=e).type?(t=t.getSystem().build(e.nbMenu()),c.setMenuBuilt(o,t),t):e.menu;return jt(o.element)||N.append(a,si(o)),l.onOpenSubmenu(a,s,o,Oe(r)),i===p.HighlightSubmenu?(x.highlightFirst(o),g(a,c,r)):(x.dehighlightAll(o),Q.some(s))})))))},o=(t,o)=>{var e=d(o);return c.collapse(e).bind(e=>(m(t,e),g(t,c,e).map(e=>(l.onCollapseMenu(t,o,e),e))))},n=o=>(t,e)=>hi(e.getSource(),"."+l.markers.item).bind(e=>t.getSystem().getByDom(e).toOptional().bind(e=>o(t,e).map(J))),f=qa([ne(Tp(),(t,o)=>{var e=o.event.item;c.lookupItem(d(e)).each(()=>{var e=o.event.menu,e=(x.highlight(t,e),d(o.event.item));c.refresh(e).each(e=>u(t,c,e))})}),as((t,e)=>{e=e.event.target;t.getSystem().getByDom(e).each(e=>{0===d(e).indexOf("collapse-item")&&o(t,e),h(t,e,p.HighlightSubmenu).fold(()=>{l.onExecute(t,e)},S)})}),os((t,e)=>{var n,r,o,a;n=t,r=l.data.primary,o=l.data.menus,o=ze(o,(e,t)=>{var o=()=>Ep.sketch({...e,value:t,markers:l.markers,fakeFocus:l.fakeFocus,onHighlight:(e,t)=>{F(e,Fp,{menuComp:e,itemComp:t})},onDehighlight:(e,t)=>{F(e,Ip,{menuComp:e,itemComp:t})},focusManager:(l.fakeFocus?()=>{const n=e=>x.getHighlighted(e).map(e=>e.element);return{get:n,set:(t,e)=>{var o=n(t),e=(t.getSystem().getByDom(e).fold(S,e=>{x.highlight(t,e)}),n(t));Em(t,o,e)}}}:Am)()});return t===r?{type:"prepared",menu:n.getSystem().build(o())}:{type:"notbuilt",nbMenu:o}}),a=ze(l.data.menus,(e,t)=>ke(e.items,e=>"separator"===e.type?[]:[e.data.value])),c.setContents(l.data.primary,o,l.data.expansions,a),c.getPrimary().each(e=>{N.append(t,si(e)),l.onOpenMenu(t,e),l.highlightOnOpen===lp.HighlightMenuAndItem?i(t,e):l.highlightOnOpen===lp.HighlightJustMenu&&s(t,e)})}),ne(Fp,(e,t)=>{l.onHighlightItem(e,t.event.menuComp,t.event.itemComp)}),ne(Ip,(e,t)=>{l.onDehighlightItem(e,t.event.menuComp,t.event.itemComp)}),...l.navigateOnHover?[ne(fp(),(e,t)=>{var t=t.event.item,o=e,n=t;n=d(n),c.refresh(n).bind(e=>(m(o,e),g(o,c,e))),h(e,t,p.HighlightParent),l.onHover(e,t)})]:[]]),v=e=>x.getHighlighted(e).bind(x.getHighlighted),b={collapseMenu:t=>{v(t).each(e=>{o(t,e)})},highlightPrimary:t=>{c.getPrimary().each(e=>{i(t,e)})},repositionMenus:o=>{c.getPrimary().bind(t=>v(o).bind(e=>{const t=d(e),o=Ge(c.getMenus()),n=Ye(k(o,Bp));return c.getTriggeringPath(t,e=>{return t=n,o=e,Ie(t,e=>{return e.getSystem().isConnected()?(e=x.getCandidates(e),xe(e,e=>d(e)===o)):Q.none()});var t,o})}).map(e=>({primary:t,triggeringPath:e}))).fold(()=>{var e;e=o,Q.from(e.components()[0]).filter(e=>"menu"===Yt(e.element,"role")).each(e=>{l.onRepositionMenu(o,e,[])})},({primary:e,triggeringPath:t})=>{l.onRepositionMenu(o,e,t)})}};return{uid:l.uid,dom:l.dom,markers:l.markers,behaviours:qd(l.tmenuBehaviours,[se.config({mode:"special",onRight:n((e,t)=>Gu(t.element)?Q.none():h(e,t,p.HighlightSubmenu)),onLeft:n((e,t)=>Gu(t.element)?Q.none():o(e,t)),onEscape:n((e,t)=>o(e,t).orThunk(()=>l.onEscape(e,t).map(()=>e))),focusIn:(t,e)=>{c.getPrimary().each(e=>{ja(t,e.element,Sa())})}}),x.config({highlightClass:l.markers.selectedMenu,itemClass:l.markers.menu}),R.config({find:e=>x.getHighlighted(e)}),N.config({})]),eventOrder:l.eventOrder,apis:b,events:f}},extraApis:{tieredData:(e,t,o)=>({primary:e,menus:t,expansions:o}),singleData:(e,t)=>({primary:e,menus:Lr(e,t),expansions:{}}),collapseItem:e=>({value:I(Rp()),meta:{text:e}})}}),Vp=Wu({name:"InlineView",configFields:[A("lazySink"),e("onShow"),e("onHide"),Er("onEscape"),Gd("inlineBehaviours",[m,y,_l]),Mr("fireDismissalEventInstead",[M("event",Ia())]),Mr("fireRepositionEventInstead",[M("event",Ra())]),M("getRelated",Q.none),M("isExtraPart",K),M("eventOrder",Q.none)],factory:(a,e)=>{const r=(e,t,o,n)=>{const r=a.lazySink(e).getOrDie();m.openWhileCloaked(e,t,()=>gd.positionWithinBounds(r,e,o,n())),y.setValue(e,Q.some({mode:"position",config:o,getBounds:n}))},n=(e,t,o,n)=>{t=((e,t,r,o,a)=>{const s=()=>e.lazySink(t),n="horizontal"===o.type?{layouts:{onLtr:()=>pl(),onRtl:()=>hl()}}:{},i=e=>2===e.length?n:{};return Np.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightOnOpen:o.menu.highlightOnOpen,fakeFocus:o.menu.fakeFocus,onEscape:()=>(m.close(t),e.onEscape.map(e=>e(t)),Q.some(!0)),onExecute:()=>Q.some(!0),onOpenMenu:(e,t)=>{gd.positionWithinBounds(s().getOrDie(),t,r,a())},onOpenSubmenu:(e,t,o,n)=>{var r=s().getOrDie();gd.position(r,o,{anchor:{type:"submenu",item:t,...i(n)}})},onRepositionMenu:(e,t,o)=>{const n=s().getOrDie();gd.positionWithinBounds(n,t,r,a()),ee(o,e=>{var t=i(e.triggeringPath);gd.position(n,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem,...t}})})}})})(a,e,t,o,n);m.open(e,t),y.setValue(e,Q.some({mode:"menu",menu:t}))},t=o=>{m.isOpen(o)&&y.getValue(o).each(e=>{switch(e.mode){case"menu":m.getState(o).each(Np.repositionMenus);break;case"position":var t=a.lazySink(o).getOrDie();gd.positionWithinBounds(t,o,e.config,e.getBounds())}})},o={setContent:(e,t)=>{m.setContent(e,t)},showAt:(e,t,o)=>{var n=Q.none;r(e,t,o,n)},showWithinBounds:r,showMenuAt:(e,t,o)=>{n(e,t,o,Q.none)},showMenuWithinBounds:n,hide:e=>{m.isOpen(e)&&(y.setValue(e,Q.none()),m.close(e))},getContent:e=>m.getState(e),reposition:t,isOpen:m.isOpen};return{uid:a.uid,dom:a.dom,behaviours:qd(a.inlineBehaviours,[m.config({isPartOf:(e,t,o)=>{return bi(t,o)||(n=o,a.getRelated(e).exists(e=>bi(e,n)));var n},getAttachPoint:e=>a.lazySink(e).getOrDie(),onOpen:e=>{a.onShow(e)},onClose:e=>{a.onHide(e)}}),y.config({store:{mode:"memory",initialValue:Q.none()}}),_l.config({channels:{...Hd({isExtraPart:e.isExtraPart,...a.fireDismissalEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({})}),...Pd({...a.fireRepositionEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({}),doReposition:t})}})]),eventOrder:a.eventOrder,apis:o}},apis:{showAt:(e,t,o,n)=>{e.showAt(t,o,n)},showWithinBounds:(e,t,o,n,r)=>{e.showWithinBounds(t,o,n,r)},showMenuAt:(e,t,o,n)=>{e.showMenuAt(t,o,n)},showMenuWithinBounds:(e,t,o,n,r)=>{e.showMenuWithinBounds(t,o,n,r)},hide:(e,t)=>{e.hide(t)},isOpen:(e,t)=>e.isOpen(t),getContent:(e,t)=>e.getContent(t),setContent:(e,t,o)=>{e.setContent(t,o)},reposition:(e,t)=>{e.reposition(t)}}});var zp=tinymce.util.Tools.resolve("tinymce.util.Delay");const Hp=Wu({name:"Button",factory:e=>{var t=dp(e.action),o=e.dom.tag,n=t=>C(e.dom,"attributes").bind(e=>C(e,t));return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:Yd(e.buttonBehaviours,[z.config({}),se.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:"button"===o?{type:n("type").getOr("button"),...n("role").map(e=>({role:e})).getOr({})}:{role:e.role.getOr(n("role").getOr("button"))}},eventOrder:e.eventOrder}},configFields:[M("uid",void 0),A("dom"),M("components",[]),Xd("buttonBehaviours",[z,se]),d("action"),d("role"),M("eventOrder",{})]}),ie=e=>{const t=void 0!==e.uid&&qe(e,"uid")?e.uid:ys("memento");return{get:e=>e.getSystem().getByUid(t).getOrDie(),getOpt:e=>e.getSystem().getByUid(t).toOptional(),asSpec:()=>({...e,uid:t})}};var Lp=tinymce.util.Tools.resolve("tinymce.util.I18n");const Pp={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},Up="temporary-placeholder",Wp=e=>()=>C(e,Up).getOr("!not found!"),jp=(e,t)=>{var o,n=e.toLowerCase();if(Lp.isRtl()){o=n;const e=ot(o,"-rtl")?o:o+"-rtl";return $e(t,e)?e:n}return n},Gp=(e,t)=>C(t,jp(e,t)),$p=(e,t)=>{t=t();return Gp(e,t).getOrThunk(Wp(t))},qp=()=>V("add-focusable",[os(e=>{gi(e.element,"svg").each(e=>O(e,"focusable","false"))})]),Xp=(e,t,o,n)=>{r=t;var r=!!Lp.isRtl()&&$e(Pp,r)?["tox-icon--flip"]:[],t=C(o,jp(t,o)).or(n).getOrThunk(Wp(o));return{dom:{tag:e.tag,attributes:null!=(n=e.attributes)?n:{},classes:e.classes.concat(r),innerHtml:t},behaviours:re([...null!=(o=e.behaviours)?o:[],qp()])}},Yp=(e,t,o,n=Q.none())=>Xp(t,e,o(),n),Kp={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Jp=Wu({name:"Notification",factory:n=>{const o=ie({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:re([N.config({})])}),r=e=>({dom:{tag:"div",classes:["tox-bar"],styles:{width:e+"%"}}}),a=e=>({dom:{tag:"div",classes:["tox-text"],innerHtml:e+"%"}}),s=ie({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(0)]},a(0)],behaviours:re([N.config({})])}),e={updateProgress:(e,t)=>{e.getSystem().isConnected()&&s.getOpt(e).each(e=>{N.set(e,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(t)]},a(t)])})},updateText:(e,t)=>{e.getSystem().isConnected()&&(e=o.get(e),N.set(e,[ti(t)]))}},t=Se([n.icon.toArray(),n.level.toArray(),n.level.bind(e=>Q.from(Kp[e])).toArray()]),i=ie(Hp.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[Yp("close",{tag:"span",classes:["tox-icon"],attributes:{"aria-label":n.translationProvider("Close")}},n.iconProvider)],action:e=>{n.onAction(e)}})),l=(e=>{const t=(0,n.iconProvider)(),o=xe(e,e=>$e(t,jp(e,t)));return Xp({tag:"div",classes:["tox-notification__icon"]},o.getOr(Up),t,Q.none())})(t),c=[l,{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:re([N.config({})])}];return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map(e=>["tox-notification","tox-notification--in","tox-notification--"+e]).getOr(["tox-notification","tox-notification--in"])},behaviours:re([z.config({}),V("notification-events",[ne(ra(),e=>{i.getOpt(e).each(z.focus)})])]),components:c.concat(n.progress?[s.asSpec()]:[]).concat(n.closeButton?[i.asSpec()]:[]),apis:e}},configFields:[d("level"),A("progress"),d("icon"),A("onAction"),A("text"),A("iconProvider"),A("translationProvider"),Rr("closeButton",!0)],apis:{updateProgress:(e,t,o)=>{e.updateProgress(t,o)},updateText:(e,t,o)=>{e.updateText(t,o)}}});var Zp,Qp,eh=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),th=tinymce.util.Tools.resolve("tinymce.EditorManager"),oh=tinymce.util.Tools.resolve("tinymce.Env");(Nm=Zp=Zp||{}).default="wrap",Nm.floating="floating",Nm.sliding="sliding",Nm.scrolling="scrolling",(Ac=Qp=Qp||{}).auto="auto",Ac.top="top",Ac.bottom="bottom";const nh=t=>e=>e.options.get(t),rh=t=>e=>Q.from(t(e)),ah=e=>{const t=oh.deviceType.isPhone(),o=oh.deviceType.isTablet()||t,n=e.options.register,r=e=>L(e)||!1===e,a=e=>L(e)||h(e);n("skin",{processor:e=>L(e)||!1===e,default:"oxide"}),n("skin_url",{processor:"string"}),n("height",{processor:a,default:Math.max(e.getElement().offsetHeight,400)}),n("width",{processor:a,default:eh.DOM.getStyle(e.getElement(),"width")}),n("min_height",{processor:"number",default:100}),n("min_width",{processor:"number"}),n("max_height",{processor:"number"}),n("max_width",{processor:"number"}),n("style_formats",{processor:"object[]"}),n("style_formats_merge",{processor:"boolean",default:!1}),n("style_formats_autohide",{processor:"boolean",default:!1}),n("line_height_formats",{processor:"string",default:"1 1.1 1.2 1.3 1.4 1.5 2"}),n("font_family_formats",{processor:"string",default:"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"}),n("font_size_formats",{processor:"string",default:"8pt 10pt 12pt 14pt 18pt 24pt 36pt"}),n("font_size_input_default_unit",{processor:"string",default:"pt"}),n("block_formats",{processor:"string",default:"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"}),n("content_langs",{processor:"object[]"}),n("removed_menuitems",{processor:"string",default:""}),n("menubar",{processor:e=>L(e)||b(e),default:!t}),n("menu",{processor:"object",default:{}}),n("toolbar",{processor:e=>b(e)||L(e)||c(e)?{value:e,valid:!0}:{valid:!1,message:"Must be a boolean, string or array."},default:!0}),pe(9,e=>{n("toolbar"+(e+1),{processor:"string"})}),n("toolbar_mode",{processor:"string",default:o?"scrolling":"floating"}),n("toolbar_groups",{processor:"object",default:{}}),n("toolbar_location",{processor:"string",default:Qp.auto}),n("toolbar_persist",{processor:"boolean",default:!1}),n("toolbar_sticky",{processor:"boolean",default:e.inline}),n("toolbar_sticky_offset",{processor:"number",default:0}),n("fixed_toolbar_container",{processor:"string",default:""}),n("fixed_toolbar_container_target",{processor:"object"}),n("ui_mode",{processor:"string",default:"combined"}),n("file_picker_callback",{processor:"function"}),n("file_picker_validator_handler",{processor:"function"}),n("file_picker_types",{processor:"string"}),n("typeahead_urls",{processor:"boolean",default:!0}),n("anchor_top",{processor:r,default:"#top"}),n("anchor_bottom",{processor:r,default:"#bottom"}),n("draggable_modal",{processor:"boolean",default:!1}),n("statusbar",{processor:"boolean",default:!0}),n("elementpath",{processor:"boolean",default:!0}),n("branding",{processor:"boolean",default:!0}),n("promotion",{processor:"boolean",default:!0}),n("resize",{processor:e=>"both"===e||b(e),default:!oh.deviceType.isTouch()}),n("sidebar_show",{processor:"string"}),n("help_accessibility",{processor:"boolean",default:e.hasPlugin("help")})},sh=nh("readonly"),ih=nh("height"),lh=nh("width"),ch=rh(nh("min_width")),dh=rh(nh("min_height")),uh=rh(nh("max_width")),mh=rh(nh("max_height")),gh=rh(nh("style_formats")),ph=nh("style_formats_merge"),hh=nh("style_formats_autohide"),fh=nh("content_langs"),vh=nh("removed_menuitems"),bh=nh("toolbar_mode"),yh=nh("toolbar_groups"),xh=nh("toolbar_location"),wh=nh("fixed_toolbar_container"),Sh=nh("fixed_toolbar_container_target"),kh=nh("toolbar_persist"),Ch=nh("toolbar_sticky_offset"),Oh=nh("menubar"),_h=nh("toolbar"),Th=nh("file_picker_callback"),Eh=nh("file_picker_validator_handler"),Ah=nh("font_size_input_default_unit"),Mh=nh("file_picker_types"),Dh=nh("typeahead_urls"),Bh=nh("anchor_top"),Fh=nh("anchor_bottom"),Ih=nh("draggable_modal"),Rh=nh("statusbar"),Nh=nh("elementpath"),Vh=nh("branding"),zh=nh("resize"),Hh=nh("paste_as_text"),Lh=nh("sidebar_show"),Ph=nh("promotion"),Uh=nh("help_accessibility"),Wh=e=>!1===e.options.get("skin"),jh=e=>!1!==e.options.get("menubar"),Gh=e=>{const t=e.options.get("skin_url");if(Wh(e))return t;if(t)return e.documentBaseURI.toAbsolute(t);{const t=e.options.get("skin");return th.baseURL+"/skins/ui/"+t}},$h=e=>e.options.get("line_height_formats").split(" "),qh=e=>{var t=_h(e),o=L(t),n=c(t)&&0<t.length;return!Yh(e)&&(n||o||!0===t)},Xh=t=>{var e=pe(9,e=>t.options.get("toolbar"+(e+1))),e=ve(e,L);return Ze(0<e.length,e)},Yh=t=>Xh(t).fold(()=>{var e=_h(t);return p(e,L)&&0<e.length},J),Kh=e=>xh(e)===Qp.bottom,Jh=e=>{var t;return e.inline?0<(t=null!=(t=wh(e))?t:"").length?pi(Gt(),t):(t=Sh(e),W(t)?Q.some(te(t)):Q.none()):Q.none()},Zh=e=>e.inline&&Jh(e).isSome(),Qh=e=>Jh(e).getOrThunk(()=>Pt(Lt(te(e.getElement())))),ef=e=>e.inline&&!jh(e)&&!qh(e)&&!Yh(e),tf=e=>(e.options.get("toolbar_sticky")||e.inline)&&!Zh(e)&&!ef(e),of=e=>!Zh(e)&&"split"===e.options.get("ui_mode"),nf=e=>{e=e.options.get("menu");return ze(e,e=>({...e,items:e.items}))};vl=Object.freeze({__proto__:null,get ToolbarMode(){return Zp},get ToolbarLocation(){return Qp},register:ah,getSkinUrl:Gh,isReadOnly:sh,isSkinDisabled:Wh,getHeightOption:ih,getWidthOption:lh,getMinWidthOption:ch,getMinHeightOption:dh,getMaxWidthOption:uh,getMaxHeightOption:mh,getUserStyleFormats:gh,shouldMergeStyleFormats:ph,shouldAutoHideStyleFormats:hh,getLineHeightFormats:$h,getContentLanguages:fh,getRemovedMenuItems:vh,isMenubarEnabled:jh,isMultipleToolbars:Yh,isToolbarEnabled:qh,isToolbarPersist:kh,getMultipleToolbarsOption:Xh,getUiContainer:Qh,useFixedContainer:Zh,isSplitUiMode:of,getToolbarMode:bh,isDraggableModal:Ih,isDistractionFree:ef,isStickyToolbar:tf,getStickyToolbarOffset:Ch,getToolbarLocation:xh,isToolbarLocationBottom:Kh,getToolbarGroups:yh,getMenus:nf,getMenubar:Oh,getToolbar:_h,getFilePickerCallback:Th,getFilePickerTypes:Mh,useTypeaheadUrls:Dh,getAnchorTop:Bh,getAnchorBottom:Fh,getFilePickerValidatorHandler:Eh,getFontSizeInputDefaultUnit:Ah,useStatusBar:Rh,useElementPath:Nh,promotionEnabled:Ph,useBranding:Vh,getResize:zh,getPasteAsText:Hh,getSidebarShow:Lh,useHelpAccessibility:Uh});const rf="[data-mce-autocompleter]",af=e=>hi(e,rf);(vg=zx=zx||{})[vg.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",vg[vg.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var sf=zx;const lf="tox-menu-nav__js",cf="tox-collection__item",df="tox-swatch",uf={normal:lf,color:df},mf="tox-collection__item--enabled",gf="tox-collection__item-icon",pf="tox-collection__item-label",hf="tox-collection__item-caret",ff="tox-collection__item--active",vf="tox-collection__item-container",bf="tox-collection__item-container--row",yf=e=>C(uf,e).getOr(lf),xf=e=>"color"===e?"tox-swatches":"tox-menu",wf=e=>({backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:xf(e),tieredMenu:"tox-tiered-menu"}),Sf=e=>{var t=wf(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:yf(e)}},kf=(e,t,o)=>{o=wf(o);return{tag:"div",classes:Se([[o.menu,`tox-menu-${t}-column`],e?[o.hasIcons]:[]])}},Cf=[Ep.parts.items({})],Of=(e,t,o)=>{var n=wf(o);return{dom:{tag:"div",classes:Se([[n.tieredMenu]])},markers:Sf(o)}},_f=T([d("data"),M("inputAttributes",{}),M("inputStyles",{}),M("tag","input"),M("inputClasses",[]),e("onSetValue"),M("styles",{}),M("eventOrder",{}),Gd("inputBehaviours",[y,z]),M("selectOnFocus",!0)]),Tf=e=>re([z.config({onFocus:e.selectOnFocus?e=>{var e=e.element,t=qs(e);e.dom.setSelectionRange(0,t.length)}:S})]),Ef=e=>({tag:e.tag,attributes:{type:"text",...e.inputAttributes},styles:e.inputStyles,classes:e.inputClasses}),Af=Wu({name:"Input",configFields:_f(),factory:(e,t)=>{return{uid:e.uid,dom:Ef(e),components:[],behaviours:(o=e,{...Tf(o),...qd(o.inputBehaviours,[y.config({store:{mode:"manual",...o.data.map(e=>({initialValue:e})).getOr({}),getValue:e=>qs(e.element),setValue:(e,t)=>{qs(e.element)!==t&&Xs(e.element,t)}},onSetValue:o.onSetValue})])}),eventOrder:e.eventOrder};var o}}),Mf=I("refetch-trigger-event"),Df=I("redirect-menu-item-interaction"),Bf="tox-menu__searcher",Ff=t=>pi(t.element,"."+Bf).bind(e=>t.getSystem().getByDom(e).toOptional()),If=Ff,Rf=e=>({fetchPattern:y.getValue(e),selectionStart:e.element.dom.selectionStart,selectionEnd:e.element.dom.selectionEnd}),Nf=t=>{var e=(e,t)=>(t.cut(),Q.none()),o=(e,t)=>{t={interactionEvent:t.event,eventType:t.event.raw.type};return F(e,Df,t),Q.some(!0)},n="searcher-events";return{dom:{tag:"div",classes:[cf]},components:[Af.sketch({inputClasses:[Bf,"tox-textfield"],inputAttributes:{...t.placeholder.map(e=>({placeholder:t.i18n(e)})).getOr({}),type:"search","aria-autocomplete":"list"},inputBehaviours:re([V(n,[ne(la(),e=>{B(e,Mf)}),ne(sa(),(e,t)=>{"Escape"===t.event.raw.key&&t.stop()})]),se.config({mode:"special",onLeft:e,onRight:e,onSpace:e,onEnter:o,onEscape:o,onUp:o,onDown:o})]),eventOrder:{keydown:[n,se.name()]}})]}},Vf="tox-collection--results__js",zf=e=>{var t;return e.dom?{...e,dom:{...e.dom,attributes:{...null!=(t=e.dom.attributes)?t:{},id:I("aria-item-search-result-id"),"aria-selected":"false"}}}:e},Hf=(t,o)=>e=>{e=he(e,o);return k(e,e=>({dom:t,components:e}))},Lf=(e,o)=>{const n=[];let r=[];return ee(e,(e,t)=>{(!o(e,t)||(0<r.length&&n.push(r),r=[],$e(e.dom,"innerHtml"))||e.components&&0<e.components.length)&&r.push(e)}),0<r.length&&n.push(r),k(n,e=>({dom:{tag:"div",classes:["tox-collection__group"]},components:e}))},Pf=(t,o,n)=>Ep.parts.items({preprocess:e=>{e=k(e,n);return"auto"!==t&&1<t?Hf({tag:"div",classes:["tox-collection__group"]},t)(e):Lf(e,(e,t)=>"separator"===o[t].type)}}),Uf=(e,t,o=0)=>({dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[Pf(e,t,w)]}),Wf=e=>ge(e,e=>"icon"in e&&void 0!==e.icon),jf=e=>(console.error(ur(e)),console.log(e),Q.none()),Gf=(e,t,o,n,r)=>{a=o;var a,s={dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Ep.parts.items({preprocess:e=>Lf(e,(e,t)=>"separator"===a[t].type)})]};return{value:e,dom:s.dom,components:s.components,items:o}},$f=(e,t,o,n,r)=>{if("color"===r.menuType){a=n;const t={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Ep.parts.items({preprocess:"auto"!==a?Hf({tag:"div",classes:["tox-swatches__row"]},a):w})]}]};return{value:e,dom:t.dom,components:t.components,items:o}}var a,s,i,l;if("normal"===r.menuType&&"auto"===n){const t=Uf(n,o);return{value:e,dom:t.dom,components:t.components,items:o}}if("normal"===r.menuType||"searchable"===r.menuType){const t="searchable"!==r.menuType?Uf(n,o):"search-with-field"===r.searchMode.searchMode?(a=n,s=o,i=r.searchMode,l=I("aria-controls-search-results"),{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===a?["tox-collection--list"]:["tox-collection--grid"])},components:[Nf({i18n:Lp.translate,placeholder:i.placeholder}),{dom:{tag:"div",classes:[...1===a?["tox-collection--list"]:["tox-collection--grid"],Vf],attributes:{id:l}},components:[Pf(a,s,zf)]}]}):(i=n,l=o,s=I("aria-controls-search-results"),{dom:{tag:"div",classes:["tox-menu","tox-collection",Vf].concat(1===i?["tox-collection--list"]:["tox-collection--grid"]),attributes:{id:s}},components:[Pf(i,l,zf)]});return{value:e,dom:t.dom,components:t.components,items:o}}if("listpreview"!==r.menuType||"auto"===n)return{value:e,dom:kf(t,n,r.menuType),components:Cf,items:o};{r=n;const t={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Ep.parts.items({preprocess:Hf({tag:"div",classes:["tox-collection__group"]},r)})]};return{value:e,dom:t.dom,components:t.components,items:o}}},qf=br("type"),Xf=br("name"),Yf=br("label"),Kf=br("text"),Jf=br("title"),Zf=br("icon"),Qf=br("value"),ev=xr("fetch"),tv=xr("getSubmenuItems"),ov=xr("onAction"),nv=xr("onItemAction"),rv=Nr("onSetup",()=>S),av=_r("name"),sv=_r("text"),iv=_r("icon"),lv=_r("tooltip"),cv=_r("label"),dv=_r("shortcut"),uv=Er("select"),mv=Rr("active",!1),gv=Rr("borderless",!1),pv=Rr("enabled",!0),hv=Rr("primary",!1),fv=e=>M("columns",e),vv=M("meta",{}),bv=Nr("onAction",S),yv=e=>Fr("type",e),xv=e=>pr("name","name",Rn(()=>I(e+"-name")),er),wv=E([qf,sv]),Sv=E([yv("autocompleteitem"),mv,pv,vv,Qf,sv,iv]),kv=[pv,lv,iv,sv,rv],Cv=E([qf,ov].concat(kv)),Ov=e=>lr("toolbarbutton",Cv,e),_v=[mv].concat(kv),Tv=E(_v.concat([qf,ov])),Ev=e=>lr("ToggleButton",Tv,e),Av=[Nr("predicate",K),Ir("scope","node",["node","editor"]),Ir("position","selection",["node","selection","line"])],Mv=kv.concat([yv("contextformbutton"),hv,ov,hr("original",w)]),Dv=_v.concat([yv("contextformbutton"),hv,ov,hr("original",w)]),Bv=kv.concat([yv("contextformbutton")]),Fv=_v.concat([yv("contextformtogglebutton")]),Iv=mr("type",{contextformbutton:Mv,contextformtogglebutton:Dv}),Rv=E([yv("contextform"),Nr("initValue",T("")),cv,kr("commands",Iv),Cr("launch",mr("type",{contextformbutton:Bv,contextformtogglebutton:Fv}))].concat(Av)),Nv=E([yv("contexttoolbar"),br("items")].concat(Av)),Vv=[qf,br("src"),_r("alt"),Vr("classes",[],er)],zv=E(Vv),Hv=[qf,Kf,av,Vr("classes",["tox-collection__item-label"],er)],Lv=E(Hv),Pv=Gn(()=>ar("type",{cardimage:zv,cardtext:Lv,cardcontainer:Uv})),Uv=E([qf,Fr("direction","horizontal"),Fr("align","left"),Fr("valign","middle"),kr("items",Pv)]),Wv=[pv,sv,dv,pr("value","value",Rn(()=>I("menuitem-value")),Jn()),vv],jv=E([qf,cv,kr("items",Pv),rv,bv].concat(Wv)),Gv=E([qf,mv,iv].concat(Wv)),$v=[qf,br("fancytype"),bv],qv=[M("initData",{})].concat($v),Xv=[Er("select"),zr("initData",{},[Rr("allowCustomColors",!0),Fr("storageKey","default"),Ar("colors",Jn())])].concat($v),Yv=mr("fancytype",{inserttable:qv,colorswatch:Xv}),Kv=E([qf,rv,bv,iv].concat(Wv)),Jv=E([qf,tv,rv,iv].concat(Wv)),Zv=E([qf,iv,mv,rv,ov].concat(Wv)),Qv=(e,o,t)=>{const n=Pc(e.element,"."+t);if(0<n.length){const e=we(n,e=>{var e=e.dom.getBoundingClientRect().top,t=n[0].dom.getBoundingClientRect().top;return Math.abs(e-t)>o}).getOr(n.length);return Q.some({numColumns:e,numRows:Math.ceil(n.length/e)})}return Q.none()},eb=e=>{return t=I("unnamed-events"),e=e,re([V(t,e)]);var t},tb=I("tooltip.exclusive"),ob=I("tooltip.show"),nb=I("tooltip.hide"),rb=(e,t,o)=>{e.getSystem().broadcastOn([tb],{})};fl=Object.freeze({__proto__:null,hideAllExclusive:rb,setComponents:(e,t,o,n)=>{o.getTooltip().each(e=>{e.getSystem().isConnected()&&N.set(e,n)})}}),Lg=Object.freeze({__proto__:null,events:(r,a)=>{const o=t=>{a.getTooltip().each(e=>{kd(e),r.onHide(t,e),a.clearTooltip()}),a.clearTimer()};return qa(Se([[ne(ob,n=>{a.resetTimer(()=>{var t,e,o;t=n,a.isShowing()||(rb(t),e=r.lazySink(t).getOrDie(),o=t.getSystem().build({dom:r.tooltipDom,components:r.tooltipComponents,events:qa("normal"===r.mode?[ne(na(),e=>{B(t,ob)}),ne(ta(),e=>{B(t,nb)})]:[]),behaviours:re([N.config({})])}),a.setTooltip(o),xd(e,o),r.onShow(t,o),gd.position(e,o,{anchor:r.anchor(t)}))},r.delay)}),ne(nb,e=>{a.resetTimer(()=>{o(e)},r.delay)}),ne(xa(),(e,t)=>{t.universal||me(t.channels,tb)&&o(e)}),ns(e=>{o(e)})],"normal"===r.mode?[ne(ra(),e=>{B(e,ob)}),ne(ba(),e=>{B(e,nb)}),ne(na(),e=>{B(e,ob)}),ne(ta(),e=>{B(e,nb)})]:[ne(Pa(),(e,t)=>{B(e,ob)}),ne(Ua(),e=>{B(e,nb)})]]))}}),bc=[A("lazySink"),A("tooltipDom"),M("exclusive",!0),M("tooltipComponents",[]),M("delay",300),Ir("mode","normal",["normal","follow-highlight"]),M("anchor",e=>({type:"hotspot",hotspot:e,layouts:{onLtr:T([il,sl,ol,rl,nl,al]),onRtl:T([il,sl,ol,rl,nl,al])}})),e("onHide"),e("onShow")],Bg=Object.freeze({__proto__:null,init:()=>{const o=Yl(),e=Yl(),n=()=>{o.on(clearTimeout)},t=T("not-implemented");return Ms({getTooltip:e.get,isShowing:e.isSet,setTooltip:e.set,clearTooltip:e.clear,clearTimer:n,resetTimer:(e,t)=>{n(),o.set(setTimeout(e,t))},readState:t})}});const ab=Sl({fields:bc,name:"tooltipping",active:Lg,state:Bg,apis:fl}),sb="silver.readonly",ib=E([vr("readonly",tr)]),lb=(e,t)=>{const o=e.mainUi.outerContainer.element,n=[e.mainUi.mothership,...e.uiMotherships];t&&ee(n,e=>{e.broadcastOn([Rd()],{target:o})}),ee(n,e=>{e.broadcastOn([sb],{readonly:t})})},cb=(e,t)=>{e.on("init",()=>{e.mode.isReadOnly()&&lb(t,!0)}),e.on("SwitchMode",()=>lb(t,e.mode.isReadOnly())),sh(e)&&e.mode.set("readonly")},db=()=>_l.config({channels:{[sb]:{schema:ib,onReceive:(e,t)=>{ae.set(e,t.readonly)}}}}),ub=e=>ae.config({disabled:e}),mb=e=>ae.config({disabled:e,disableClass:"tox-tbtn--disabled"}),gb=e=>ae.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1}),pb=(e,t)=>{const o=e.getApi(t);return e=>{e(o)}},hb=(t,o)=>os(e=>{pb(t,e)(e=>{e=t.onSetup(e);j(e)&&o.set(e)})}),fb=(t,o)=>ns(e=>pb(t,e)(o.get())),vb={[wa()]:["disabling","alloy.base.behaviour","toggling","item-events"]},bb=Ye,yb=(e,t,o,n)=>{var r,a,s=D(S);return{type:"item",dom:t.dom,components:bb(t.optComponents),data:e.data,eventOrder:vb,hasSubmenu:e.triggersSubmenu,itemBehaviours:re([V("item-events",[(r=e,a=o,as((e,t)=>{pb(r,e)(r.onAction),r.triggersSubmenu||a!==sf.CLOSE_ON_EXECUTE||(e.getSystem().isConnected()&&B(e,Oa()),t.stop())})),hb(e,s),fb(e,s)]),(t=()=>!e.enabled||n.isDisabled(),ae.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})),db(),N.config({})].concat(e.itemBehaviours))}},xb=e=>({value:e.value,meta:{text:e.text.getOr(""),...e.meta}}),wb=e=>{const t=oh.os.isMacOS()||oh.os.isiOS(),o=t?{alt:"⌥",ctrl:"⌃",shift:"⇧",meta:"⌘",access:"⌃⌥"}:{meta:"Ctrl",access:"Shift+Alt"},n=e.split("+"),r=k(n,e=>{var t=e.toLowerCase().trim();return $e(o,t)?o[t]:e});return t?r.join(""):r.join("+")},Sb=(e,t,o=[gf])=>Yp(e,{tag:"div",classes:o},t),kb=e=>({dom:{tag:"div",classes:[pf]},components:[ti(Lp.translate(e))]}),Cb=(e,t)=>({dom:{tag:"div",classes:t,innerHtml:e}}),Ob=(e,t)=>({dom:{tag:"div",classes:[pf]},components:[{dom:{tag:e.tag,styles:e.styles},components:[ti(Lp.translate(t))]}]}),_b=e=>({dom:{tag:"div",classes:["tox-collection__item-accessory"]},components:[ti(wb(e))]}),Tb=e=>Sb("checkmark",e,["tox-collection__item-checkmark"]),Eb=e=>{e=e.map(e=>({attributes:{title:Lp.translate(e),id:I("menu-item")}})).getOr({});return{tag:"div",classes:[lf,cf],...e}},Ab=(e,t,o,n=Q.none())=>{if("color"===e.presets){var r,a=e,s=t,i=n;const u=a.ariaLabel,m=a.value,g=a.iconContent.map(e=>{var t=s.icons,o=i;return t=t(),Gp(e,t).or(o).getOrThunk(Wp(t))});return{dom:(df,a=g.getOr(""),r={tag:"div",attributes:u.map(e=>({title:s.translate(e)})).getOr({}),classes:["tox-swatch"]},"custom"===m?{...r,tag:"button",classes:[...r.classes,"tox-swatches__picker-btn"],innerHtml:a}:"remove"===m?{...r,classes:[...r.classes,"tox-swatch--remove"],innerHtml:a}:W(m)?{...r,attributes:{...r.attributes,"data-mce-color":m},styles:{"background-color":m},innerHtml:a}:r),optComponents:[]}}{var l=e,c=t,a=o,d=n;const p={tag:"div",classes:[gf]},h=a?l.iconContent.map(e=>Yp(e,p,c.icons,d)).orThunk(()=>Q.some({dom:p})):Q.none(),f=l.checkMark,v=Q.from(l.meta).fold(()=>kb,e=>$e(e,"style")?$(Ob,e.style):kb),b=l.htmlContent.fold(()=>l.textContent.map(v),e=>Q.some(Cb(e,[pf])));return{dom:Eb(l.ariaLabel),optComponents:[h,b,l.shortcutContent.map(_b),f,l.caret]}}},Mb=(e,t)=>C(e,"tooltipWorker").map(o=>[ab.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:e=>({type:"submenu",item:e,overrides:{maxHeightFunction:ac}}),mode:"follow-highlight",onShow:(t,e)=>{o(e=>{ab.setComponents(t,[oi({element:te(e)})])})}})]).getOr([]),Db=(e,t)=>{e=Lp.translate(e);var o=eh.DOM.encode(e);if(0<t.length){const e=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return o.replace(e,e=>`<span class="tox-autocompleter-highlight">${e}</span>`)}return o},Bb=(e,a)=>k(e,e=>{switch(e.type){case"cardcontainer":return t=e,o=Bb(e.items,a),n="vertical"===t.direction?"tox-collection__item-container--column":bf,r="left"===t.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",{dom:{tag:"div",classes:[vf,n,r,(()=>{switch(t.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}})()]},components:o};case"cardimage":return n=e.src,{dom:{tag:"img",classes:e.classes,attributes:{src:n,alt:e.alt.getOr("")}}};case"cardtext":r=e.name.exists(e=>me(a.cardText.highlightOn,e))?Q.from(a.cardText.matchText).getOr(""):"";return Cb(Db(e.text,r),e.classes)}var t,o,n,r}),Fb=Cu(wp(),Sp()),Ib=e=>({value:zb(e)}),Rb=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Nb=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Vb=e=>Rb.test(e)||Nb.test(e),zb=e=>et(e,"#").toUpperCase(),Hb=e=>{e=e.toString(16);return(1===e.length?"0"+e:e).toUpperCase()},Lb=e=>{e=Hb(e.red)+Hb(e.green)+Hb(e.blue);return Ib(e)},Pb=Math.min,Ub=Math.max,Wb=Math.round,jb=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,Gb=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,$b=(e,t,o,n)=>({red:e,green:t,blue:o,alpha:n}),qb=e=>{var t=parseInt(e,10);return t.toString()===e&&0<=t&&t<=255},Xb=e=>{let t,o,n;var r=(e.hue||0)%360,a=e.saturation/100,e=e.value/100,a=Ub(0,Pb(a,1)),e=Ub(0,Pb(e,1));if(0===a)t=o=n=Wb(255*e);else{var r=r/60,s=e*a,i=s*(1-Math.abs(r%2-1)),a=e-s;switch(Math.floor(r)){case 0:t=s,o=i,n=0;break;case 1:t=i,o=s,n=0;break;case 2:t=0,o=s,n=i;break;case 3:t=0,o=i,n=s;break;case 4:t=i,o=0,n=s;break;case 5:t=s,o=0,n=i;break;default:t=o=n=0}t=Wb(255*(t+a)),o=Wb(255*(o+a)),n=Wb(255*(n+a))}return $b(t,o,n,1)},Yb=e=>{var e=(e=>{e={value:e.value.replace(Rb,(e,t,o,n)=>t+t+o+o+n+n)},e=Nb.exec(e.value);return null===e?["FFFFFF","FF","FF","FF"]:e})(e),t=parseInt(e[1],16),o=parseInt(e[2],16),e=parseInt(e[3],16);return $b(t,o,e,1)},Kb=(e,t,o,n)=>{e=parseInt(e,10),t=parseInt(t,10),o=parseInt(o,10),n=parseFloat(n);return $b(e,t,o,n)},Jb=e=>{var t;return"transparent"===e?Q.some($b(0,0,0,0)):null!==(t=jb.exec(e))?Q.some(Kb(t[1],t[2],t[3],"1")):null!==(t=Gb.exec(e))?Q.some(Kb(t[1],t[2],t[3],t[4])):Q.none()},Zb=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,Qb=$b(255,0,0,1),ey=(e,t)=>{e.dispatch("ResizeContent",t)},ty=(e,t)=>{e.dispatch("TextColorChange",t)},oy=(e,t)=>()=>{e(),t()},ny=t=>ay(t,"NodeChange",e=>{e.setEnabled(t.selection.isEditable())}),ry=(a,s)=>e=>{const t=ny(a)(e),o=(n=a,r=s,(t=>{const o=Xl(),e=()=>{t.setActive(n.formatter.match(r));var e=n.formatter.formatChanged(r,t.setActive);o.set(e)};return n.initialized?e():n.once("init",e),()=>{n.off("init",e),o.clear()}})(e));var n,r;return()=>{t(),o()}},ay=(n,r,a)=>e=>{const t=()=>a(e),o=()=>{a(e),n.on(r,t)};return n.initialized?o():n.once("init",o),()=>{n.off("init",o),n.off(r,t)}},sy=t=>e=>()=>{t.undoManager.transact(()=>{t.focus(),t.execCommand("mceToggleFormat",!1,e.format)})},iy=(e,t)=>()=>e.execCommand(t);var ly=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");const cy={},dy=o=>C(cy,o).getOrThunk(()=>{var e="tinymce-custom-colors-"+o,t=ly.getItem(e);if(U(t)){const o=ly.getItem("tinymce-custom-colors");ly.setItem(e,W(o)?o:"[]")}t=(t=>{const e=ly.getItem(t),o=L(e)?JSON.parse(e):[],n=10-(r=o).length<0?r.slice(0,10):r;var r;const a=e=>{n.splice(e,1)};return{add:e=>{ue(n,e).each(a),n.unshift(e),10<n.length&&n.pop(),ly.setItem(t,JSON.stringify(n))},state:()=>n.slice(0)}})(e);return cy[o]=t}),uy=(e,t)=>{dy(e).add(t)},my=(e,t,o)=>({hue:e,saturation:t,value:o}),gy=e=>{let t,o,n=0;var r=e.red/255,a=e.green/255,e=e.blue/255,s=Math.min(r,Math.min(a,e)),i=Math.max(r,Math.max(a,e));return s===i?(n=s,my(0,0,100*n)):(t=60*((r===s?3:e===s?1:5)-(r===s?a-e:e===s?r-a:e-r)/(i-s)),o=(i-s)/i,n=i,my(Math.round(t),Math.round(100*o),Math.round(100*n)))},py=e=>Lb(Xb(e)),hy=r=>{return e=r,(Vb(e)?Q.some({value:zb(e)}):Q.none()).orThunk(()=>Jb(r).map(Lb)).getOrThunk(()=>{var e=document.createElement("canvas"),t=(e.height=1,e.width=1,e.getContext("2d")),e=(t.clearRect(0,0,e.width,e.height),t.fillStyle="#FFFFFF",t.fillStyle=r,t.fillRect(0,0,1,1),t.getImageData(0,0,1,1).data),t=e[0],o=e[1],n=e[2],e=e[3];return Lb($b(t,o,n,e))});var e},fy="forecolor",vy="hilitecolor",by=t=>e=>e.options.get(t),yy="#000000",xy=(e,t)=>(t===fy&&e.options.isSet("color_map_foreground")?by("color_map_foreground"):t===vy&&e.options.isSet("color_map_background")?by("color_map_background"):by("color_map"))(e),wy=(e,t="default")=>Math.max(5,Math.ceil(Math.sqrt(xy(e,t).length))),Sy=(e,t)=>{var o=by("color_cols")(e),t=wy(e,t);return o===wy(e)?t:o},ky=(e,t="default")=>Math.round((t===fy?by("color_cols_foreground"):t===vy?by("color_cols_background"):by("color_cols"))(e)),Cy=by("custom_colors"),Oy=by("color_default_foreground"),_y=by("color_default_background"),Ty=(e,t)=>{e=te(e.selection.getStart()),t="hilitecolor"===t?jr(e,e=>{return ft(e)?(e=no(e,"background-color"),Ze(Jb(e).exists(e=>0!==e.alpha),e)):Q.none()}).getOr("rgba(0, 0, 0, 0)"):no(e,"color");return Jb(t).map(e=>"#"+Lb(e).value)},Ey=e=>{var t="choiceitem",o={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return e?[o,{type:t,text:"Custom color",icon:"color-picker",value:"custom"}]:[o]},Ay=(t,o,e,n)=>{"custom"===e?Ny(t)(e=>{e.each(e=>{uy(o,e),t.execCommand("mceApplyTextcolor",o,e),n(e)})},Ty(t,o).getOr(yy)):"remove"===e?(n(""),t.execCommand("mceRemoveTextcolor",o)):(n(e),t.execCommand("mceApplyTextcolor",o,e))},My=(e,t,o)=>{return e.concat((e=t,k(dy(e).state(),e=>({type:"choiceitem",text:e,icon:"checkmark",value:e})).concat(Ey(o))))},Dy=(t,o,n)=>e=>{e(My(t,o,n))},By=(e,t,o)=>{e.setIconFill("forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",o)},Fy=(o,n)=>e=>{var t=Ty(o,n);return Xe(t,e.toUpperCase())},Iy=(o,n,r,e,a)=>{o.ui.registry.addSplitButton(n,{tooltip:e,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:Fy(o,r),columns:ky(o,r),fetch:Dy(xy(o,r),r,Cy(o)),onAction:e=>{Ay(o,r,a.get(),S)},onItemAction:(e,t)=>{Ay(o,r,t,e=>{a.set(e),ty(o,{name:n,color:e})})},onSetup:t=>{By(t,n,a.get());const e=e=>{e.name===n&&By(t,e.name,e.color)};return o.on("TextColorChange",e),oy(ny(o)(t),()=>{o.off("TextColorChange",e)})}})},Ry=(t,o,n,e,r)=>{t.ui.registry.addNestedMenuItem(o,{text:e,icon:"forecolor"===o?"text-color":"highlight-bg-color",onSetup:e=>(By(e,o,r.get()),ny(t)(e)),getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"colorswatch",select:Fy(t,n),initData:{storageKey:n},onAction:e=>{Ay(t,n,e.value,e=>{r.set(e),ty(t,{name:o,color:e})})}}]})},Ny=r=>(o,e)=>{let n=!1;r.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:e},onAction:(e,t)=>{"hex-valid"===t.name&&(n=t.value)},onSubmit:e=>{var t=e.getData().colorpicker;n?(o(Q.from(t)),e.close()):r.windowManager.alert(r.translate(["Invalid hex color code: {0}",t]))},onClose:S,onCancel:()=>{o(Q.none())}})},Vy=(e,t,o,n,r,a,s,i)=>{var l,c,d,u,m,g,p,h=Wf(t),t=(l=t,c=o,d=n,u="color"!==r?"normal":"color",m=a,g=s,p=i,Ye(k(l,e=>{return"choiceitem"===e.type?(e=e,lr("choicemenuitem",Gv,e).fold(jf,e=>Q.some(((t,e,o,n,r,a,s,i=!0)=>{o=Ab({presets:o,textContent:e?t.text:Q.none(),htmlContent:Q.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:e?t.shortcut:Q.none(),checkMark:e?Q.some(Tb(s.icons)):Q.none(),caret:Q.none(),value:t.value},s,i);return Fn(yb({data:xb(t),enabled:t.enabled,getApi:t=>({setActive:e=>{f.set(t,e)},isActive:()=>f.isOn(t),isEnabled:()=>!ae.isDisabled(t),setEnabled:e=>ae.set(t,!e)}),onAction:e=>n(t.value),onSetup:e=>(e.setActive(r),S),triggersSubmenu:!1,itemBehaviours:[]},o,a,s),{toggling:{toggleClass:mf,toggleOnExecute:!1,selected:t.active,exclusive:!0}})})(e,1===d,u,c,g(e.value),m,p,Wf(l))))):Q.none()})));return $f(e,h,t,n,{menuType:r})},zy=(e,t)=>{var o=Sf(t);return 1===e?{mode:"menu",moveOnTab:!0}:"auto"===e?{mode:"grid",selector:"."+o.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===t?"tox-swatches__row":"tox-collection__group"),previousSelector:e=>"color"===t?pi(e.element,"[aria-checked=true]"):Q.none()}},Hy=I("cell-over"),Ly=I("cell-execute"),Py=(e,t)=>ti(t+"x"+e),Uy={inserttable:(r,e)=>{n=e;const t=(e,t)=>n.shared.providers.translate(t+` columns, ${e} rows`),i=(o=>{var e=[];for(let t=0;t<10;t++){const r=[];for(let e=0;e<10;e++){var n=o(t+1,e+1);r.push(((t,o,e)=>{const n=e=>F(e,Ly,{row:t,col:o}),r=(e,t)=>{t.stop(),n(e)};return ai({dom:{tag:"div",attributes:{role:"button","aria-label":e}},behaviours:re([V("insert-table-picker-cell",[ne(na(),z.focus),ne(wa(),n),ne(da(),r),ne(ka(),r)]),f.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),z.config({onFocus:e=>F(e,Hy,{row:t,col:o})})])})})(t,e,n))}e.push(r)}return e})(t),o=Py(0,0),l=ie({dom:{tag:"span",classes:["tox-insert-table-picker__label"]},components:[o],behaviours:re([N.config({})])});var n;return{type:"widget",data:{value:I("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Fb.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:(e=i,ke(e,e=>k(e,si)).concat(l.asSpec())),behaviours:re([V("insert-table-picker",[os(e=>{N.set(l.get(e),[o])}),Qa(Hy,(e,t,o)=>{var{row:o,col:n}=o.event,r=i,a=o,s=n;for(let t=0;t<10;t++)for(let e=0;e<10;e++)f.set(r[t][e],t<=a&&e<=s);N.set(l.get(e),[Py(o+1,n+1)])}),Qa(Ly,(e,t,o)=>{var{row:o,col:n}=o.event;r.onAction({numRows:o+1,numColumns:n+1}),B(e,Oa())})]),se.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:(t,e)=>{var o=((e,t)=>{const o=e.initData.allowCustomColors&&t.colorinput.hasCustomColors();return e.initData.colors.fold(()=>My(t.colorinput.getColors(e.initData.storageKey),e.initData.storageKey,o),e=>e.concat(Ey(o)))})(t,e),n=e.colorinput.getColorCols(t.initData.storageKey),o={...Vy(I("menu-value"),o,e=>{t.onAction({value:e})},n,"color",sf.CLOSE_ON_EXECUTE,t.select.getOr(K),e.shared.providers),markers:Sf("color"),movement:zy(n,"color")};return{type:"widget",data:{value:I("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Fb.widget(Ep.sketch(o))]}}},Wy=e=>({type:"separator",dom:{tag:"div",classes:[cf,"tox-collection__group-heading"]},components:e.text.map(ti).toArray()});var jy,Pg=Object.freeze({__proto__:null,getCoupled:(e,t,o,n)=>o.getOrCreate(e,t,n),getExistingCoupled:(e,t,o,n)=>o.getExisting(e,t,n)}),Nm=[vr("others",ir(_.value,Jn()))],Ac=Object.freeze({__proto__:null,init:()=>{const r={},a=(e,t)=>{if(0===Re(e.others).length)throw new Error("Cannot find any known coupled components");return C(r,t)},e=T({});return Ms({readState:e,getExisting:(e,t,o)=>a(t,o).orThunk(()=>(C(t.others,o).getOrDie("No information found for coupled component: "+o),Q.none())),getOrCreate:(t,o,n)=>a(o,n).getOrThunk(()=>{var e=C(o.others,n).getOrDie("No information found for coupled component: "+n)(t),e=t.getSystem().build(e);return r[n]=e})})}});const Gy=Sl({fields:Nm,name:"coupling",apis:Pg,state:Ac}),$y=e=>{let o=Q.none(),t=[];const n=e=>{r()?a(e):t.push(e)},r=()=>o.isSome(),a=t=>{o.each(e=>{setTimeout(()=>{t(e)},0)})};return e(e=>{r()||(o=Q.some(e),ee(t,a),t=[])}),{get:n,map:o=>$y(t=>{n(e=>{t(o(e))})}),isReady:r}},qy={nu:$y,pure:t=>$y(e=>{e(t)})},Xy=e=>{setTimeout(()=>{throw e},0)},Yy=o=>{const e=e=>{o().then(e,Xy)};return{map:e=>Yy(()=>o().then(e)),bind:t=>Yy(()=>o().then(e=>t(e).toPromise())),anonBind:e=>Yy(()=>o().then(()=>e.toPromise())),toLazy:()=>qy.nu(e),toCached:()=>{let e=null;return Yy(()=>e=null===e?o():e)},toPromise:o,get:e}},Ky=e=>Yy(()=>new Promise(e)),Jy=e=>Yy(()=>Promise.resolve(e)),Zy=T("sink"),Qy=T(xu({name:Zy(),overrides:T({dom:{tag:"div"},behaviours:re([gd.config({useFixed:J})]),events:qa([es(sa()),es(Qr()),es(da())])})})),ex=(e,t)=>{const o=e.getHotspot(t).getOr(t),n=e.getAnchorOverrides();return e.layouts.fold(()=>({type:"hotspot",hotspot:o,overrides:n}),e=>({type:"hotspot",hotspot:o,overrides:n,layouts:e}))},tx=(e,t,o,n,r,a,s)=>{return((e,t,r,o,a,n,s)=>{t=t;const i=(0,e.fetch)(o).map(t),l=rx(o,e);return i.map(e=>e.bind(e=>Q.from(Np.sketch({...n.menu(),uid:ys(""),data:e,highlightOnOpen:s,onOpenMenu:(e,t)=>{var o=l().getOrDie();gd.position(o,t,{anchor:r}),m.decloak(a)},onOpenSubmenu:(e,t,o)=>{var n=l().getOrDie();gd.position(n,o,{anchor:{type:"submenu",item:t}}),m.decloak(a)},onRepositionMenu:(e,t,o)=>{const n=l().getOrDie();gd.position(n,t,{anchor:r}),ee(o,e=>{gd.position(n,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem}})})},onEscape:()=>(z.focus(o),m.close(a),Q.some(!0))}))))})(e,t,ex(e,o),o,n,r,s).map(e=>(e.fold(()=>{m.isOpen(n)&&m.close(n)},e=>{m.cloak(n),m.open(n,e),a(n)}),n))},ox=(e,t,o,n,r,a,s)=>(m.close(n),Jy(n)),nx=(e,t,o,n,r,a)=>{var s=Gy.getCoupled(o,"sandbox");return(m.isOpen(s)?ox:tx)(e,t,o,s,n,r,a)},rx=(t,e)=>t.getSystem().getByUid(e.uid+"-"+Zy()).map(e=>()=>_.value(e)).getOrThunk(()=>e.lazySink.fold(()=>()=>_.error(new Error("No internal sink is specified, nor could an external sink be found")),e=>()=>e(t))),ax=e=>{m.getState(e).each(e=>{Np.repositionMenus(e)})},sx=(s,i,l)=>{const c=vi(),e=rx(i,s);return{dom:{tag:"div",classes:s.sandboxClasses,attributes:{id:c.id,role:"listbox"}},behaviours:Yd(s.sandboxBehaviours,[y.config({store:{mode:"memory",initialValue:i}}),m.config({onOpen:(e,t)=>{var o,n,r,a=ex(s,i);c.link(i.element),s.matchWidth&&(o=a.hotspot,n=t,r=s.useMinWidth,n=R.getCurrent(n).getOr(n),o=wo(o.element),r?oe(n.element,"min-width",o+"px"):(r=n.element,n=o,xo.set(r,n))),s.onOpen(a,e,t),void 0!==l&&void 0!==l.onOpen&&l.onOpen(e,t)},onClose:(e,t)=>{c.unlink(i.element),void 0!==l&&void 0!==l.onClose&&l.onClose(e,t)},isPartOf:(e,t,o)=>bi(t,o)||bi(i,o),getAttachPoint:()=>e().getOrDie()}),R.config({find:e=>m.getState(e).bind(e=>R.getCurrent(e))}),_l.config({channels:{...Hd({isExtraPart:K}),...Pd({doReposition:ax})}})])}},ix=e=>{e=Gy.getCoupled(e,"sandbox");ax(e)},lx=()=>[M("sandboxClasses",[]),Xd("sandboxBehaviours",[R,_l,m,y])],cx=T([A("dom"),A("fetch"),e("onOpen"),Mi("onExecute"),M("getHotspot",Q.some),M("getAnchorOverrides",T({})),fc(),Gd("dropdownBehaviours",[f,Gy,se,z]),A("toggleClass"),M("eventOrder",{}),d("lazySink"),M("matchWidth",!1),M("useMinWidth",!1),d("role")].concat(lx())),dx=T([yu({schema:[Ti(),M("fakeFocus",!1)],name:"menu",defaults:e=>({onExecute:e.onExecute})}),Qy()]),ux=ju({name:"Dropdown",configFields:cx(),partFields:dx(),factory:(n,e,t,r)=>{const o=e=>{m.getState(e).each(e=>{Np.highlightPrimary(e)})},a=(e,t,o)=>nx(n,w,e,r,t,o),s={expand:e=>{f.isOn(e)||a(e,S,lp.HighlightNone).get(S)},open:e=>{f.isOn(e)||a(e,S,lp.HighlightMenuAndItem).get(S)},refetch:t=>Gy.getExistingCoupled(t,"sandbox").fold(()=>a(t,S,lp.HighlightMenuAndItem).map(S),e=>tx(n,w,t,e,r,S,lp.HighlightMenuAndItem).map(S)),isOpen:f.isOn,close:e=>{f.isOn(e)&&a(e,S,lp.HighlightMenuAndItem).get(S)},repositionMenus:e=>{f.isOn(e)&&ix(e)}},i=(e,t)=>(Wa(e),Q.some(!0));return{uid:n.uid,dom:n.dom,components:e,behaviours:qd(n.dropdownBehaviours,[f.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),Gy.config({others:{sandbox:e=>sx(n,e,{onOpen:()=>f.on(e),onClose:()=>f.off(e)})}}),se.config({mode:"special",onSpace:i,onEnter:i,onDown:(e,t)=>{if(ux.isOpen(e)){const t=Gy.getCoupled(e,"sandbox");o(t)}else ux.open(e);return Q.some(!0)},onEscape:(e,t)=>ux.isOpen(e)?(ux.close(e),Q.some(!0)):Q.none()}),z.config({})]),events:dp(Q.some(e=>{a(e,o,lp.HighlightMenuAndItem).get(S)})),eventOrder:{...n.eventOrder,[wa()]:["disabling","toggling","alloy.base.behaviour"]},apis:s,domModification:{attributes:{"aria-haspopup":"true",...n.role.fold(()=>({}),e=>({role:e})),..."button"===n.dom.tag?{type:C(n.dom,"attributes").bind(e=>C(e,"type")).getOr("button")}:{}}}}},apis:{open:(e,t)=>e.open(t),refetch:(e,t)=>e.refetch(t),expand:(e,t)=>e.expand(t),close:(e,t)=>e.close(t),isOpen:(e,t)=>e.isOpen(t),repositionMenus:(e,t)=>e.repositionMenus(t)}}),mx=(e,n,r)=>{If(e).each(t=>{var o,e;o=t,e=r,Kt(e.element,"id").each(e=>O(o.element,"aria-activedescendant",e)),(Ws((e=n).element,Vf)?Q.some(e.element):pi(e.element,"."+Vf)).each(e=>{Kt(e,"id").each(e=>O(t.element,"aria-controls",e))})}),O(r.element,"aria-selected","true")},gx=(e,t,o)=>{O(o.element,"aria-selected","false")},px=((vg=jy=jy||{})[vg.ContentFocus=0]="ContentFocus",vg[vg.UiFocus=1]="UiFocus",(e,t,n,o,r)=>{const a=n.shared.providers,s=e=>r?{...e,shortcut:Q.none(),icon:e.text.isSome()?Q.none():e.icon}:e;switch(e.type){case"menuitem":return c=e,lr("menuitem",Kv,c).fold(jf,e=>Q.some(((e,t,o,n=!0)=>{n=Ab({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:Q.none(),ariaLabel:e.text,caret:Q.none(),checkMark:Q.none(),shortcutContent:e.shortcut},o,n);return yb({data:xb(e),getApi:t=>({isEnabled:()=>!ae.isDisabled(t),setEnabled:e=>ae.set(t,!e)}),enabled:e.enabled,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},n,t,o)})(s(e),t,a,o)));case"nestedmenuitem":return c=e,lr("nestedmenuitem",Jv,c).fold(jf,e=>Q.some(((e,t,o,n=!0,r=!1)=>{r=r?(r=o.icons,Sb("chevron-down",r,[hf])):(r=o.icons,Sb("chevron-right",r,[hf])),r=Ab({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:Q.none(),ariaLabel:e.text,caret:Q.some(r),checkMark:Q.none(),shortcutContent:e.shortcut},o,n);return yb({data:xb(e),getApi:o=>({isEnabled:()=>!ae.isDisabled(o),setEnabled:e=>ae.set(o,!e),setIconFill:(e,t)=>{pi(o.element,`svg path[class="${e}"], rect[class="${e}"]`).each(e=>{O(e,"fill",t)})}}),enabled:e.enabled,onAction:S,onSetup:e.onSetup,triggersSubmenu:!0,itemBehaviours:[]},r,t,o)})(s(e),t,a,o,r)));case"togglemenuitem":return l=e,lr("togglemenuitem",Zv,l).fold(jf,e=>Q.some(((e,t,o,n=!0)=>{n=Ab({iconContent:e.icon,textContent:e.text,htmlContent:Q.none(),ariaLabel:e.text,checkMark:Q.some(Tb(o.icons)),caret:Q.none(),shortcutContent:e.shortcut,presets:"normal",meta:e.meta},o,n);return Fn(yb({data:xb(e),enabled:e.enabled,getApi:t=>({setActive:e=>{f.set(t,e)},isActive:()=>f.isOn(t),isEnabled:()=>!ae.isDisabled(t),setEnabled:e=>ae.set(t,!e)}),onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},n,t,o),{toggling:{toggleClass:mf,toggleOnExecute:!1,selected:e.active}})})(s(e),t,a,o)));case"separator":return l=e,lr("separatormenuitem",wv,l).fold(jf,e=>Q.some(Wy(e)));case"fancymenuitem":return i=e,lr("fancymenuitem",Yv,i).fold(jf,e=>{return t=e,o=n,C(Uy,t.fancytype).map(e=>e(t,o));var t,o});default:return console.error("Unknown item in general menu",e),Q.none()}var i,l,c}),hx=(e,s,i,t,l,c,d)=>{const n=1===t,r=!n||Wf(e);return Ye(k(e,e=>{switch(e.type){case"separator":return o=e,lr("Autocompleter.Separator",wv,o).fold(jf,e=>Q.some(Wy(e)));case"cardmenuitem":return o=e,lr("cardmenuitem",jv,o).fold(jf,t=>{return Q.some((e={...t,onAction:e=>{t.onAction(e),i(t.value,t.meta)}},o=l,n=c,r={itemBehaviours:Mb(t.meta,c),cardText:{matchText:s,highlightOn:d}},a={dom:Eb(e.label),optComponents:[Q.some({dom:{tag:"div",classes:[vf,bf]},components:Bb(e.items,r)})]},yb({data:xb({text:Q.none(),...e}),enabled:e.enabled,getApi:o=>({isEnabled:()=>!ae.isDisabled(o),setEnabled:t=>{ae.set(o,!t),ee(Pc(o.element,"*"),e=>{o.getSystem().getByDom(e).each(e=>{e.hasConfigured(ae)&&ae.set(e,!t)})})}}),onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:Q.from(r.itemBehaviours).getOr([])},a,o,n.providers)));var e,o,n,r,a});default:return t=e,lr("Autocompleter.Item",Sv,t).fold(jf,e=>Q.some(((t,o,e,n,r,a,s=!0)=>{e=Ab({presets:"normal",textContent:Q.none(),htmlContent:e?t.text.map(e=>Db(e,o)):Q.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:Q.none(),checkMark:Q.none(),caret:Q.none(),value:t.value},a.providers,s,t.icon);return yb({data:xb(t),enabled:t.enabled,getApi:T({}),onAction:e=>n(t.value,t.meta),onSetup:T(S),triggersSubmenu:!1,itemBehaviours:Mb(t.meta,a)},e,r,a.providers)})(e,s,n,i,l,c,r)))}var t,o}))},fx=(e,t,o,n,r,a)=>{const s=Wf(t),i=Ye(k(t,e=>{var t=e=>{return px(e,o,n,(e=e,r?!$e(e,"text"):s),r)};return"nestedmenuitem"===e.type&&e.getSubmenuItems().length<=0?t({...e,enabled:!1}):t(e)})),l="no-search"===a.searchMode?{menuType:"normal"}:{menuType:"searchable",searchMode:a};return(r?Gf:$f)(e,s,i,1,l)},vx=e=>Np.singleData(e.value,e),bx=(s,r)=>{const i=D(!1),t=D(!1),a=ai(Vp.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:re([V("dismissAutocompleter",[ne(Ia(),()=>d())])]),lazySink:r.getSink})),e=()=>Vp.isOpen(a),o=t.get,l=()=>{e()&&Vp.hide(a)},c=()=>Vp.getContent(a).bind(e=>Me(e.components(),0)),d=()=>s.execCommand("mceAutocompleterClose"),n=e=>{var o,n,t=(e=>{const t=Ie(e,e=>Q.from(e.columns)).getOr(1);return ke(e,a=>{var e=a.items;return hx(e,a.matchText,(o,n)=>{var r,e=s.selection.getRng();r=s.dom,e=e,af(te(e.startContainer)).map(e=>{var t=r.createRng();return t.selectNode(e.dom),t}).each(e=>{var t={hide:()=>d(),reload:e=>{l(),s.execCommand("mceAutocompleterReload",!1,{fetchOptions:e})}};i.set(!0),a.onAction(t,e,o,n),i.set(!1)})},t,sf.BUBBLE_TO_SANDBOX,r,a.highlightOn)})})(e);0<t.length?(o=e,n=t,e=te(s.getBody()),pi(e,rf).each(e=>{var t=Ie(o,e=>Q.from(e.columns)).getOr(1);Vp.showMenuAt(a,{anchor:{type:"node",root:te(s.getBody()),node:Q.from(e)}},((e,t,o,n)=>{const r=zy(t,n),a=Sf(n);return{data:vx({...e,movement:r,menuBehaviours:eb("auto"!==t?[]:[os((o,e)=>{Qv(o,4,a.item).each(({numColumns:e,numRows:t})=>{se.setGridSize(o,t,e)})})])}),menu:{markers:Sf(n),fakeFocus:o===jy.ContentFocus}}})($f("autocompleter-value",!0,n,t,{menuType:"normal"}),t,jy.ContentFocus,"normal"))}),c().each(x.highlightFirst)):l()};s.on("AutocompleterStart",({lookupData:e})=>{t.set(!0),i.set(!1),n(e)}),s.on("AutocompleterUpdate",({lookupData:e})=>n(e)),s.on("AutocompleterEnd",()=>{l(),t.set(!1),i.set(!1)});{var u={cancelIfNecessary:d,isMenuOpen:e,isActive:o,isProcessingAction:i.get,getMenu:c},m=s;const g=(e,t)=>{F(e,sa(),{raw:t})},p=()=>u.getMenu().bind(x.getHighlighted);m.on("keydown",t=>{var e=t.which;u.isActive()&&(u.isMenuOpen()?13===e?(p().each(Wa),t.preventDefault()):40===e?(p().fold(()=>{u.getMenu().each(x.highlightFirst)},e=>{g(e,t)}),t.preventDefault(),t.stopImmediatePropagation()):37!==e&&38!==e&&39!==e||p().each(e=>{g(e,t),t.preventDefault(),t.stopImmediatePropagation()}):13!==e&&38!==e&&40!==e||u.cancelIfNecessary())}),m.on("NodeChange",e=>{u.isActive()&&!u.isProcessingAction()&&af(te(e.element)).isNone()&&u.cancelIfNecessary()})}},yx=["visible","hidden","clip"],xx=e=>0<nt(e).length&&!me(yx,e),wx=e=>{var t;return!!ht(e)&&(t=no(e,"overflow-x"),e=no(e,"overflow-y"),xx(t)||xx(e))},Sx=(e,t)=>{if(of(e)){e=t;const o=Lc(e,wx),n=0===o.length?Ut(e).map(Wt).map(e=>Lc(e,wx)).getOr([]):o;return De(n).map(e=>({element:e,others:n.slice(1)}))}return Q.none()},kx=e=>{var t=[...k(e.others,fn),yn()];return e=fn(e.element),t=t,ye(t,(e,t)=>bn(e,t),e)},Cx=(e,t,o)=>hi(e,t,o).isSome(),Ox=(t,o)=>{let n=null;return{cancel:()=>{null!==n&&(clearTimeout(n),n=null)},schedule:(...e)=>{n=setTimeout(()=>{t.apply(null,e),n=null},o)}}},_x=e=>{e=e.raw;return void 0===e.touches||1!==e.touches.length?Q.none():Q.some(e.touches[0])},Tx=(t,e)=>{const o={stopBackspace:!0,...e},n=(o=>{const r=Yl(),n=D(!1),a=Ox(e=>{o.triggerEvent(Ca(),e),n.set(!0)},400),s=Pr([{key:Yr(),value:t=>(_x(t).each(e=>{a.cancel();e={x:e.clientX,y:e.clientY,target:t.target};a.schedule(t),n.set(!1),r.set(e)}),Q.none())},{key:Kr(),value:e=>(a.cancel(),_x(e).each(n=>{r.on(e=>{var t,o;t=n,e=e,o=Math.abs(t.clientX-e.x),t=Math.abs(t.clientY-e.y),(5<o||5<t)&&r.clear()})}),Q.none())},{key:Jr(),value:t=>(a.cancel(),r.get().filter(e=>kt(e.target,t.target)).map(e=>n.get()?(t.prevent(),!1):o.triggerEvent(ka(),t)))}]);return{fireIfReady:(t,e)=>C(s,e).bind(e=>e(t))}})(o),r=k(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),e=>Jl(t,e,t=>{n.fireIfReady(t,e).each(e=>{e&&t.kill()}),o.triggerEvent(e,t)&&t.kill()})),a=Yl(),s=Jl(t,"paste",t=>{n.fireIfReady(t,"paste").each(e=>{e&&t.kill()}),o.triggerEvent("paste",t)&&t.kill(),a.set(setTimeout(()=>{o.triggerEvent(ya(),t)},0))}),i=Jl(t,"keydown",e=>{var t;o.triggerEvent("keydown",e)?e.kill():!o.stopBackspace||(t=e).raw.which!==um[0]||me(["input","textarea"],gt(t.target))||Cx(t.target,'[contenteditable="true"]')||e.prevent()}),l=Jl(t,"focusin",e=>{o.triggerEvent("focusin",e)&&e.kill()}),c=Yl(),d=Jl(t,"focusout",e=>{o.triggerEvent("focusout",e)&&e.kill(),c.set(setTimeout(()=>{o.triggerEvent(ba(),e)},0))});return{unbind:()=>{ee(r,e=>{e.unbind()}),i.unbind(),l.unbind(),d.unbind(),s.unbind(),a.on(clearTimeout),c.on(clearTimeout)}}},Ex=(e,t)=>{e=C(e,"target").getOr(t);return D(e)},Ax=Hr([{stopped:[]},{resume:["element"]},{complete:[]}]),Mx=(e,n,t,o,r,a)=>{const s=e(n,o),i=((e,t)=>{const o=D(!1),n=D(!1);return{stop:()=>{o.set(!0)},cut:()=>{n.set(!0)},isStopped:o.get,isCut:n.get,event:e,setSource:t.set,getSource:t.get}})(t,r);return s.fold(()=>(a.logEventNoHandlers(n,o),Ax.complete()),t=>{const o=t.descHandler;return Fs(o)(i),i.isStopped()?(a.logEventStopped(n,t.element,o.purpose),Ax.stopped()):i.isCut()?(a.logEventCut(n,t.element,o.purpose),Ax.complete()):At(t.element).fold(()=>(a.logNoParent(n,t.element,o.purpose),Ax.complete()),e=>(a.logEventResponse(n,t.element,o.purpose),Ax.resume(e)))})},Dx=(t,o,n,e,r,a)=>Mx(t,o,n,e,r,a).fold(J,e=>Dx(t,o,n,e,r,a),K),Bx=(e,t,o,n,r)=>{var a=Ex(o,n);return Dx(e,t,o,n,a,r)},Fx=()=>{const s=(()=>{const a={};return{registerId:(n,r,e)=>{Ve(e,(e,t)=>{var o=void 0!==a[t]?a[t]:{};o[r]={cHandler:$.apply(void 0,[(e=e).handler].concat(n)),purpose:e.purpose},a[t]=o})},unregisterId:o=>{Ve(a,(e,t)=>{$e(e,o)&&delete e[o]})},filterByType:e=>C(a,e).map(e=>We(e,(e,t)=>({id:t,descHandler:e}))).getOr([]),find:(e,t,o)=>C(a,t).bind(n=>jr(o,e=>{return t=n,o=e,bs(o).bind(e=>C(t,e)).map(e=>({element:o,descHandler:e}));var t,o},e))}})(),i={},l=e=>{bs(e.element).each(e=>{delete i[e],s.unregisterId(e)})};return{find:(e,t,o)=>s.find(e,t,o),filter:e=>s.filterByType(e),register:e=>{t=(o=e).element;var o,t=bs(t).getOrThunk(()=>{return e=o.element,t=I(hs+"uid-"),vs(e,t),t;var e,t});if(qe(i,t)){var n=e,r=t,a=i[r];if(a!==n)throw new Error('The tagId "'+r+'" is already used by: '+ls(a.element)+"\nCannot use it for: "+ls(n.element)+"\nThe conflicting element is"+(jt(a.element)?" ":" not ")+"already in the DOM");l(n)}r=[e];s.registerId(r,t,e.events),i[t]=e},unregister:l,getById:e=>C(i,e)}},Ix=Wu({name:"Container",factory:e=>{const{attributes:t,...o}=e.dom;return{uid:e.uid,dom:{tag:"div",attributes:{role:"presentation",...t},...o},components:e.components,behaviours:$d(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[M("components",[]),Gd("containerBehaviours",[]),M("events",{}),M("domModification",{}),M("eventOrder",{})]}),Rx=o=>{const n=t=>At(o.element).fold(J,e=>kt(t,e)),r=Fx(),l=(e,t)=>r.find(n,e,t),e=Tx(o.element,{triggerEvent:(r,a)=>wi(r,a.target,e=>{return t=l,o=r,n=a,e=e,Bx(t,o,n,n.target,e);var t,o,n})}),a={debugInfo:T("real"),triggerEvent:(t,o,n)=>{wi(t,o,e=>Bx(l,t,n,o,e))},triggerFocus:(s,i)=>{bs(s).fold(()=>{El(s)},e=>{wi(va(),s,e=>{return t=l,o=va(),n={originator:i,kill:S,prevent:S,target:s},r=s,e=e,a=Ex(n,r),Mx(t,o,n,r,a,e),!1;var t,o,n,r,a})})},triggerEscape:(e,t)=>{a.triggerEvent("keydown",e.element,t.event)},getByUid:e=>p(e),getByDom:e=>h(e),build:ai,buildOrPatch:ri,addToGui:e=>{i(e)},removeFromGui:e=>{c(e)},addToWorld:e=>{t(e)},removeFromWorld:e=>{s(e)},broadcast:e=>{u(e)},broadcastOn:(e,t)=>{m(e,t)},broadcastEvent:(e,t)=>{g(e,t)},isConnected:J},t=e=>{e.connect(a),vt(e.element)||(r.register(e),ee(e.components(),t),a.triggerEvent(Ta(),e.element,{target:e.element}))},s=e=>{vt(e.element)||(ee(e.components(),s),r.unregister(e)),e.disconnect()},i=e=>{xd(o,e)},c=e=>{kd(e)},d=t=>{var e=r.filter(xa());ee(e,e=>{e=e.descHandler;Fs(e)(t)})},u=e=>{d({universal:!0,data:e})},m=(e,t)=>{d({universal:!1,channels:e,data:t})},g=(e,t)=>{{e=r.filter(e);const o=(e=>{const t=D(!1);return{stop:()=>{t.set(!0)},cut:S,isStopped:t.get,isCut:K,event:e,setSource:X("Cannot set source of a broadcasted event"),getSource:X("Cannot get source of a broadcasted event")}})(t);return ee(e,e=>{e=e.descHandler;Fs(e)(o)}),o.isStopped()}},p=e=>r.getById(e).fold(()=>_.error(new Error('Could not find component with uid: "'+e+'" in system.')),_.value),h=e=>{e=bs(e).getOr("not found");return p(e)};return t(o),{root:o,element:o.element,destroy:()=>{e.unbind(),an(o.element)},add:i,remove:c,getByUid:p,getByDom:h,addToWorld:t,removeFromWorld:s,broadcast:u,broadcastOn:m,broadcastEvent:g}},Nx=T([M("prefix","form-field"),Gd("fieldBehaviours",[R,y])]),Vx=T([xu({schema:[A("dom")],name:"label"}),xu({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[A("text")],name:"aria-descriptor"}),bu({factory:{sketch:e=>{var t=((e,o)=>{const n={};return Ve(e,(e,t)=>{me(o,t)||(n[t]=e)}),n})(e,["factory"]);return e.factory.sketch(t)}},schema:[A("factory")],name:"field"})]),H=ju({name:"FormField",configFields:Nx(),partFields:Vx(),factory:(r,e,t,o)=>{var n=qd(r.fieldBehaviours,[R.config({find:e=>Mu(e,r,"field")}),y.config({store:{mode:"manual",getValue:e=>R.getCurrent(e).bind(y.getValue),setValue:(e,t)=>{R.getCurrent(e).each(e=>{y.setValue(e,t)})}}})]),a=qa([os((e,t)=>{const n=Bu(e,r,["label","field","aria-descriptor"]);n.field().each(o=>{const t=I(r.prefix);n.label().each(e=>{O(e.element,"for",t),O(o.element,"id",t)}),n["aria-descriptor"]().each(e=>{var t=I(r.prefix);O(e.element,"id",t),O(o.element,"aria-describedby",t)})})})]);return{uid:r.uid,dom:r.dom,components:e,behaviours:n,events:a,apis:{getField:e=>Mu(e,r,"field"),getLabel:e=>Mu(e,r,"label")}}},apis:{getField:(e,t)=>e.getField(t),getLabel:(e,t)=>e.getLabel(t)}});var zx=Object.freeze({__proto__:null,exhibit:(e,t)=>Bs({attributes:Pr([{key:t.tabAttr,value:"true"}])})}),bc=[M("tabAttr","data-alloy-tabstop")];const Hx=Sl({fields:bc,name:"tabstopping",active:zx});var Lx=tinymce.util.Tools.resolve("tinymce.html.Entities");const Px=(e,t,o,n)=>{e=e,t=t,o=o,n=n;o={dom:Ux(o),components:e.toArray().concat([t]),fieldBehaviours:re(n)};return H.sketch(o)},Ux=e=>({tag:"div",classes:["tox-form__group"].concat(e)}),Wx=(e,t)=>H.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[ti(t.translate(e))]}),jx=I("form-component-change"),Gx=I("form-close"),$x=I("form-cancel"),qx=I("form-action"),Xx=I("form-submit"),Yx=I("form-block"),Kx=I("form-unblock"),Jx=I("form-tabchange"),Zx=I("form-resize"),Qx=["input","textarea"],ew=e=>{e=gt(e);return me(Qx,e)},tw=(e,t)=>{var o=t.getRoot(e).getOr(e.element);Us(o,t.invalidClass),t.notify.each(t=>{ew(e.element)&&O(e.element,"aria-invalid",!1),t.getContainer(e).each(e=>{is(e,t.validHtml)}),t.onValid(e)})},ow=(t,e,o,n)=>{var r=e.getRoot(t).getOr(t.element);Ps(r,e.invalidClass),e.notify.each(e=>{ew(t.element)&&O(t.element,"aria-invalid",!0),e.getContainer(t).each(e=>{is(e,n)}),e.onInvalid(t,n)})},nw=(t,e,o)=>e.validator.fold(()=>Jy(_.value(!0)),e=>e.validate(t)),rw=(t,o,e)=>(o.notify.each(e=>{e.onValidate(t)}),nw(t,o).map(e=>t.getSystem().isConnected()?e.fold(e=>(ow(t,o,0,e),_.error(e)),e=>(tw(t,o),_.value(e))):_.error("No longer in system")));Lg=Object.freeze({__proto__:null,markValid:tw,markInvalid:ow,query:nw,run:rw,isInvalid:(e,t)=>{e=t.getRoot(e).getOr(e.element);return Ws(e,t.invalidClass)}}),Bg=Object.freeze({__proto__:null,events:(t,e)=>t.validator.map(e=>qa([ne(e.onEvent,e=>{rw(e,t).get(w)})].concat(e.validateOnLoad?[os(e=>{rw(e,t).get(S)})]:[]))).getOr({})}),fl=[A("invalidClass"),M("getRoot",Q.none),Mr("notify",[M("aria","alert"),M("getContainer",Q.none),M("validHtml",""),e("onValid"),e("onInvalid"),e("onValidate")]),Mr("validator",[A("validate"),M("onEvent","input"),M("validateOnLoad",!0)])];const aw=Sl({fields:fl,name:"invalidating",active:Bg,apis:Lg,extra:{validation:t=>e=>{e=y.getValue(e);return Jy(t(e))}}}),sw=Sl({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:()=>qa([Xa(pa(),J)]),exhibit:()=>Bs({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})})}),iw=I("color-input-change"),lw=I("color-swatch-change"),cw=I("color-picker-cancel"),dw=xu({schema:[A("dom")],name:"label"}),uw=t=>xu({name:t+"-edge",overrides:e=>e.model.manager.edgeActions[t].fold(()=>({}),n=>({events:qa([Ka(Yr(),(e,t,o)=>n(e,o),[e]),Ka(Qr(),(e,t,o)=>n(e,o),[e]),Ka(ea(),(e,t,o)=>{o.mouseIsDown.get()&&n(e,o)},[e])])}))}),mw=uw("top-left"),gw=uw("top"),pw=uw("top-right"),hw=uw("right"),fw=uw("bottom-right"),vw=uw("bottom"),bw=uw("bottom-left");Nm=[dw,uw("left"),hw,gw,vw,mw,pw,bw,fw,bu({name:"thumb",defaults:T({dom:{styles:{position:"absolute"}}}),overrides:e=>({events:qa([Za(Yr(),e,"spectrum"),Za(Kr(),e,"spectrum"),Za(Jr(),e,"spectrum"),Za(Qr(),e,"spectrum"),Za(ea(),e,"spectrum"),Za(oa(),e,"spectrum")])})}),bu({schema:[hr("mouseIsDown",()=>D(!1))],name:"spectrum",overrides:o=>{const n=o.model.manager,r=(t,e)=>n.getValueFromEvent(e).map(e=>n.setValueFrom(t,o,e));return{behaviours:re([se.config({mode:"special",onLeft:e=>n.onLeft(e,o),onRight:e=>n.onRight(e,o),onUp:e=>n.onUp(e,o),onDown:e=>n.onDown(e,o)}),z.config({})]),events:qa([ne(Yr(),r),ne(Kr(),r),ne(Qr(),r),ne(ea(),(e,t)=>{o.mouseIsDown.get()&&r(e,t)})])}}})];const yw=T("slider.change.value"),xw=e=>{var t=e.event.raw;if(-1!==t.type.indexOf("touch")){const e=t;return void 0!==e.touches&&1===e.touches.length?Q.some(e.touches[0]).map(e=>fo(e.clientX,e.clientY)):Q.none()}{const e=t;return void 0!==e.clientX?Q.some(e).map(e=>fo(e.clientX,e.clientY)):Q.none()}},ww=e=>e.model.minX,Sw=e=>e.model.minY,kw=e=>e.model.minX-1,Cw=e=>e.model.minY-1,Ow=e=>e.model.maxX,_w=e=>e.model.maxY,Tw=e=>e.model.maxX+1,Ew=e=>e.model.maxY+1,Aw=(e,t,o)=>t(e)-o(e),Mw=e=>Aw(e,Ow,ww),Dw=e=>Aw(e,_w,Sw),Bw=e=>Mw(e)/2,Fw=e=>Dw(e)/2,Iw=e=>e.stepSize,Rw=e=>e.snapToGrid,Nw=e=>e.snapStart,Vw=e=>e.rounded,zw=(e,t)=>void 0!==e[t+"-edge"],Hw=e=>zw(e,"left"),Lw=e=>zw(e,"right"),Pw=e=>zw(e,"top"),Uw=e=>zw(e,"bottom"),Ww=e=>e.model.value.get(),jw=(e,t)=>({x:e,y:t}),Gw=(e,t)=>{F(e,yw(),{value:t})},$w=(e,t,o,n)=>e<t?e:o<e?o:e===t?t-1:Math.max(t,e-n),qw=(e,t,o,n)=>o<e?e:e<t?t:e===o?o+1:Math.min(o,e+n),Xw=(e,t,o)=>Math.max(t,Math.min(o,e)),Yw=e=>{const{min:t,max:o,range:n,value:r,step:a,snap:s,snapStart:i,rounded:l,hasMinEdge:c,hasMaxEdge:d,minBound:u,maxBound:m,screenRange:g}=e,p=c?t-1:t,h=d?o+1:o;if(r<u)return p;if(m<r)return h;{x=u;const e=Math.min(m,Math.max(r,x))-x,c=Xw(e/g*n+t,p,h);return s&&c>=t&&c<=o?(f=c,v=t,b=o,y=a,i.fold(()=>{var e=Math.round((f-v)/y)*y;return Xw(v+e,v-1,b+1)},e=>{var t=Math.round((f-e)%y/y),o=Math.floor((f-e)/y),n=Math.floor((b-e)/y),n=e+Math.min(n,o+t)*y;return Math.max(e,n)})):l?Math.round(c):c}var f,v,b,y,x},Kw=e=>{var{min:e,max:t,range:o,value:n,hasMinEdge:r,hasMaxEdge:a,maxBound:s,maxOffset:i,centerMinEdge:l,centerMaxEdge:c}=e;return n<e?r?0:l:t<n?a?s:c:(n-e)/o*i},Jw="top",Zw="right",Qw="bottom",e0="left",t0=e=>e.element.dom.getBoundingClientRect(),o0=(e,t)=>e[t],n0=e=>{e=t0(e);return o0(e,e0)},r0=e=>{e=t0(e);return o0(e,Zw)},a0=e=>{e=t0(e);return o0(e,Jw)},s0=e=>{e=t0(e);return o0(e,Qw)},i0=e=>{e=t0(e);return o0(e,"width")},l0=e=>{e=t0(e);return o0(e,"height")},c0=(e,t,o)=>(e+t)/2-o,d0=(e,t)=>{var e=t0(e),t=t0(t),o=o0(e,e0),e=o0(e,Zw),t=o0(t,e0);return c0(o,e,t)},u0=(e,t)=>{var e=t0(e),t=t0(t),o=o0(e,Jw),e=o0(e,Qw),t=o0(t,Jw);return c0(o,e,t)},m0=(e,t)=>{F(e,yw(),{value:t})},g0=(e,t,o)=>{o={min:ww(t),max:Ow(t),range:Mw(t),value:o,step:Iw(t),snap:Rw(t),snapStart:Nw(t),rounded:Vw(t),hasMinEdge:Hw(t),hasMaxEdge:Lw(t),minBound:n0(e),maxBound:r0(e),screenRange:i0(e)};return Yw(o)},p0=o=>(e,t)=>((e,t)=>{t=(0<o?qw:$w)(Ww(t),ww(t),Ow(t),Iw(t));return m0(e,t),Q.some(t)})(e,t).map(J),h0=(e,t,o,n,r,a)=>{s=t,a=a,o=o,n=n,r=r,i=i0(s),n=n.bind(e=>Q.some(d0(e,s))).getOr(0),r=r.bind(e=>Q.some(d0(e,s))).getOr(i),o={min:ww(a),max:Ow(a),range:Mw(a),value:o,hasMinEdge:Hw(a),hasMaxEdge:Lw(a),minBound:n0(s),minOffset:0,maxBound:r0(s),maxOffset:i,centerMinEdge:n,centerMaxEdge:r};var s,i,a=Kw(o);return n0(t)-n0(e)+a},f0=p0(-1),v0=p0(1),b0=Q.none,y0=Q.none,x0={"top-left":Q.none(),top:Q.none(),"top-right":Q.none(),right:Q.some((e,t)=>{Gw(e,Tw(t))}),"bottom-right":Q.none(),bottom:Q.none(),"bottom-left":Q.none(),left:Q.some((e,t)=>{Gw(e,kw(t))})};Pg=Object.freeze({__proto__:null,setValueFrom:(e,t,o)=>{t=g0(e,t,o);return m0(e,t),t},setToMin:(e,t)=>{t=ww(t);m0(e,t)},setToMax:(e,t)=>{t=Ow(t);m0(e,t)},findValueOfOffset:g0,getValueFromEvent:e=>xw(e).map(e=>e.left),findPositionOfValue:h0,setPositionFromValue:(e,t,o,n)=>{var r=Ww(o),r=h0(e,n.getSpectrum(e),r,n.getLeftEdge(e),n.getRightEdge(e),o),n=wo(t.element)/2;oe(t.element,"left",r-n+"px")},onLeft:f0,onRight:v0,onUp:b0,onDown:y0,edgeActions:x0});const w0=(e,t)=>{F(e,yw(),{value:t})},S0=(e,t,o)=>{o={min:Sw(t),max:_w(t),range:Dw(t),value:o,step:Iw(t),snap:Rw(t),snapStart:Nw(t),rounded:Vw(t),hasMinEdge:Pw(t),hasMaxEdge:Uw(t),minBound:a0(e),maxBound:s0(e),screenRange:l0(e)};return Yw(o)},k0=o=>(e,t)=>((e,t)=>{t=(0<o?qw:$w)(Ww(t),Sw(t),_w(t),Iw(t));return w0(e,t),Q.some(t)})(e,t).map(J),C0=(e,t,o,n,r,a)=>{s=t,a=a,o=o,n=n,r=r,i=l0(s),n=n.bind(e=>Q.some(u0(e,s))).getOr(0),r=r.bind(e=>Q.some(u0(e,s))).getOr(i),o={min:Sw(a),max:_w(a),range:Dw(a),value:o,hasMinEdge:Pw(a),hasMaxEdge:Uw(a),minBound:a0(s),minOffset:0,maxBound:s0(s),maxOffset:i,centerMinEdge:n,centerMaxEdge:r};var s,i,a=Kw(o);return a0(t)-a0(e)+a},O0=Q.none,_0=Q.none,T0=k0(-1),E0=k0(1),A0={"top-left":Q.none(),top:Q.some((e,t)=>{Gw(e,Cw(t))}),"top-right":Q.none(),right:Q.none(),"bottom-right":Q.none(),bottom:Q.some((e,t)=>{Gw(e,Ew(t))}),"bottom-left":Q.none(),left:Q.none()};Ac=Object.freeze({__proto__:null,setValueFrom:(e,t,o)=>{t=S0(e,t,o);return w0(e,t),t},setToMin:(e,t)=>{t=Sw(t);w0(e,t)},setToMax:(e,t)=>{t=_w(t);w0(e,t)},findValueOfOffset:S0,getValueFromEvent:e=>xw(e).map(e=>e.top),findPositionOfValue:C0,setPositionFromValue:(e,t,o,n)=>{var r=Ww(o),r=C0(e,n.getSpectrum(e),r,n.getTopEdge(e),n.getBottomEdge(e),o),n=go(t.element)/2;oe(t.element,"top",r-n+"px")},onLeft:O0,onRight:_0,onUp:T0,onDown:E0,edgeActions:A0});const M0=(e,t)=>{F(e,yw(),{value:t})},D0=(e,t)=>({x:e,y:t}),B0=(a,s)=>(e,t)=>{return o=s,e=e,t=t,n=0<a?qw:$w,r=o?Ww(t).x:n(Ww(t).x,ww(t),Ow(t),Iw(t)),o=o?n(Ww(t).y,Sw(t),_w(t),Iw(t)):Ww(t).y,M0(e,D0(r,o)),Q.some(r).map(J);var o,n,r},F0=B0(-1,!1),I0=B0(1,!1),R0=B0(-1,!0),N0=B0(1,!0),V0={"top-left":Q.some((e,t)=>{Gw(e,jw(kw(t),Cw(t)))}),top:Q.some((e,t)=>{Gw(e,jw(Bw(t),Cw(t)))}),"top-right":Q.some((e,t)=>{Gw(e,jw(Tw(t),Cw(t)))}),right:Q.some((e,t)=>{Gw(e,jw(Tw(t),Fw(t)))}),"bottom-right":Q.some((e,t)=>{Gw(e,jw(Tw(t),Ew(t)))}),bottom:Q.some((e,t)=>{Gw(e,jw(Bw(t),Ew(t)))}),"bottom-left":Q.some((e,t)=>{Gw(e,jw(kw(t),Ew(t)))}),left:Q.some((e,t)=>{Gw(e,jw(kw(t),Fw(t)))})};vg=Object.freeze({__proto__:null,setValueFrom:(e,t,o)=>{var n=g0(e,t,o.left),t=S0(e,t,o.top),o=D0(n,t);return M0(e,o),o},setToMin:(e,t)=>{var o=ww(t),t=Sw(t);M0(e,D0(o,t))},setToMax:(e,t)=>{var o=Ow(t),t=_w(t);M0(e,D0(o,t))},getValueFromEvent:e=>xw(e),setPositionFromValue:(e,t,o,n)=>{var r=Ww(o),a=h0(e,n.getSpectrum(e),r.x,n.getLeftEdge(e),n.getRightEdge(e),o),r=C0(e,n.getSpectrum(e),r.y,n.getTopEdge(e),n.getBottomEdge(e),o),n=wo(t.element)/2,e=go(t.element)/2;oe(t.element,"left",a-n+"px"),oe(t.element,"top",r-e+"px")},onLeft:F0,onRight:I0,onUp:R0,onDown:N0,edgeActions:V0});const z0=ju({name:"Slider",configFields:[M("stepSize",1),M("onChange",S),M("onChoose",S),M("onInit",S),M("onDragStart",S),M("onDragEnd",S),M("snapToGrid",!1),M("rounded",!0),d("snapStart"),vr("model",mr("mode",{x:[M("minX",0),M("maxX",100),hr("value",e=>D(e.mode.minX)),A("getInitialValue"),Fi("manager",Pg)],y:[M("minY",0),M("maxY",100),hr("value",e=>D(e.mode.minY)),A("getInitialValue"),Fi("manager",Ac)],xy:[M("minX",0),M("maxX",100),M("minY",0),M("maxY",100),hr("value",e=>D({x:e.mode.minX,y:e.mode.minY})),A("getInitialValue"),Fi("manager",vg)]})),Gd("sliderBehaviours",[se,y]),hr("mouseIsDown",()=>D(!1))],partFields:Nm,factory:(r,e,t,o)=>{const a=e=>Du(e,r,"thumb"),s=e=>Du(e,r,"spectrum"),n=e=>Mu(e,r,"left-edge"),i=e=>Mu(e,r,"right-edge"),l=e=>Mu(e,r,"top-edge"),c=e=>Mu(e,r,"bottom-edge"),d=r.model,u=d.manager,m=(e,t)=>{u.setPositionFromValue(e,t,r,{getLeftEdge:n,getRightEdge:i,getTopEdge:l,getBottomEdge:c,getSpectrum:s})},g=(e,t)=>{d.value.set(t);t=a(e);m(e,t)},p=o=>{var e=r.mouseIsDown.get();r.mouseIsDown.set(!1),e&&Mu(o,r,"thumb").each(e=>{var t=d.value.get();r.onChoose(o,e,t)})},h=(e,t)=>{t.stop(),r.mouseIsDown.set(!0),r.onDragStart(e,a(e))},f=(e,t)=>{t.stop(),r.onDragEnd(e,a(e)),p(e)};return{uid:r.uid,dom:r.dom,components:e,behaviours:qd(r.sliderBehaviours,[se.config({mode:"special",focusIn:e=>Mu(e,r,"spectrum").map(se.focusIn).map(J)}),y.config({store:{mode:"manual",getValue:e=>d.value.get(),setValue:g}}),_l.config({channels:{[Vd()]:{onReceive:p}}})]),events:qa([ne(yw(),(e,t)=>{var o;e=e,t=t.event.value,g(e,t),o=a(e),r.onChange(e,o,t),Q.some(!0)}),os((e,t)=>{var o=d.getInitialValue(),o=(d.value.set(o),a(e)),n=(m(e,o),s(e));r.onInit(e,o,n,d.value.get())}),ne(Yr(),h),ne(Jr(),f),ne(Qr(),h),ne(oa(),f)]),apis:{resetToMin:e=>{u.setToMin(e,r)},resetToMax:e=>{u.setToMax(e,r)},setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:(e,t,o)=>{e.setValue(t,o)},resetToMin:(e,t)=>{e.resetToMin(t)},resetToMax:(e,t)=>{e.resetToMax(t)},refresh:(e,t)=>{e.refresh(t)}}}),H0=I("rgb-hex-update"),L0=I("slider-update"),P0=I("palette-update"),U0=[Gd("formBehaviours",[y])],W0=e=>"<alloy.field."+e+">",j0=(n,e)=>({uid:n.uid,dom:n.dom,components:e,behaviours:qd(n.formBehaviours,[y.config({store:{mode:"manual",getValue:e=>{e=Fu(e,n);return ze(e,(e,n)=>e().bind(e=>{return t=R.getCurrent(e),o=new Error(`Cannot find a current component to extract the value from for form part '${n}': `+ls(e.element)),t.fold(()=>_.error(o),_.value);var t,o}).map(y.getValue))},setValue:(o,e)=>{Ve(e,(t,e)=>{Mu(o,n,e).each(e=>{R.getCurrent(e).each(e=>{y.setValue(e,t)})})})}}})]),apis:{getField:(e,t)=>Mu(e,n,t).bind(R.getCurrent)}}),G0={getField:Es((e,t,o)=>e.getField(t,o)),sketch:e=>{var t=(()=>{const o=[];return{field:(e,t)=>(o.push(e),Ou("form",W0(e),t)),record:T(o)}})(),e=e(t),t=t.record(),t=k(t,e=>bu({name:e,pname:W0(e)}));return Hu("form",U0,t,j0,e)}},$0=I("valid-input"),q0=I("invalid-input"),X0=I("validating-input"),Y0="colorcustom.rgb.",K0=(u,m,g,p)=>{const h=(e,t,o,n,r)=>{var a,s,i=u(Y0+"range"),n=[H.parts.label({dom:{tag:"label",attributes:{"aria-label":n}},components:[ti(o)]}),H.parts.field({data:r,factory:Af,inputAttributes:{type:"text",..."hex"===t?{"aria-live":"polite"}:{}},inputClasses:[m("textfield")],inputBehaviours:re([(a=t,s=e,aw.config({invalidClass:m("invalid"),notify:{onValidate:e=>{F(e,X0,{type:a})},onValid:e=>{F(e,$0,{type:a,value:y.getValue(e)})},onInvalid:e=>{F(e,q0,{type:a,value:y.getValue(e)})}},validator:{validate:e=>{e=y.getValue(e),e=s(e)?_.value(!0):_.error(u("aria.input.invalid"));return Jy(e)},validateOnLoad:!1}})),Hx.config({})]),onSetValue:e=>{aw.isInvalid(e)&&aw.run(e).get(S)}})],o="hex"!==t?[H.parts["aria-descriptor"]({text:i})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:n.concat(o)}},f=(e,t)=>{var o=t.red,n=t.green,t=t.blue;y.setValue(e,{red:o,green:n,blue:t})},v=ie({dom:{tag:"div",classes:[m("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),b=(e,t)=>{v.getOpt(e).each(e=>{oe(e.element,"background-color","#"+t.value)})},e=Wu({factory:()=>{const o={red:D(Q.some(255)),green:D(Q.some(255)),blue:D(Q.some(255)),hex:D(Q.some("ffffff"))},s=e=>o[e].get(),i=(e,t)=>{o[e].set(t)},l=e=>{var t=e.red,o=e.green,e=e.blue;i("red",Q.some(t)),i("green",Q.some(o)),i("blue",Q.some(e))},t=(e,t)=>{t=t.event;"hex"!==t.type?i(t.type,Q.none()):p(e)},n=(e,t)=>{var o,t=t.event;{var n,r,a;"hex"===t.type?(a=e,o=t.value,g(a),o=Ib(o),i("hex",Q.some(o.value)),r=Yb(o),f(a,r),l(r),F(a,H0,{hex:o}),b(a,o)):(n=e,r=t.type,a=t.value,a=parseInt(a,10),i(r,Q.some(a)),s("red").bind(o=>s("green").bind(t=>s("blue").map(e=>$b(o,t,e,1)))).each(e=>{e=((t,e)=>{const o=Lb(e);return G0.getField(t,"hex").each(e=>{z.isFocused(e)||y.setValue(t,{hex:o.value})}),o})(n,e);F(n,H0,{hex:e}),b(n,e)}))}},e=e=>({label:u(Y0+e+".label"),description:u(Y0+e+".description")}),r=e("red"),a=e("green"),c=e("blue"),d=e("hex");return Fn(G0.sketch(e=>({dom:{tag:"form",classes:[m("rgb-form")],attributes:{"aria-label":u("aria.color.picker")}},components:[e.field("red",H.sketch(h(qb,"red",r.label,r.description,255))),e.field("green",H.sketch(h(qb,"green",a.label,a.description,255))),e.field("blue",H.sketch(h(qb,"blue",c.label,c.description,255))),e.field("hex",H.sketch(h(Vb,"hex",d.label,d.description,"ffffff"))),v.asSpec()],formBehaviours:re([aw.config({invalidClass:m("form-invalid")}),V("rgb-form-events",[ne($0,n),ne(q0,t),ne(X0,t)])])})),{apis:{updateHex:(e,t)=>{y.setValue(e,{hex:t.value});var o=e,n=t;n=Yb(n),f(o,n),l(n),b(e,t)}}})},name:"RgbForm",configFields:[],apis:{updateHex:(e,t,o)=>{e.updateHex(t,o)}},extraApis:{}});return e},J0=(h,f)=>{return Wu({name:"ColourPicker",configFields:[A("dom"),M("onValidHex",S),M("onInvalidHex",S)],factory:e=>{const o=K0(h,f,e.onValidHex,e.onInvalidHex),n=(n=>{const r=z0.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),a=z0.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:`<div class=${n("sv-palette-inner-thumb")} role="presentation"></div>`}}),s=(e,t)=>{var{width:o,height:n}=e,e=e.getContext("2d");null!==e&&(e.fillStyle=t,e.fillRect(0,0,o,n),(t=e.createLinearGradient(0,0,o,0)).addColorStop(0,"rgba(255,255,255,1)"),t.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=t,e.fillRect(0,0,o,n),(t=e.createLinearGradient(0,0,0,n)).addColorStop(0,"rgba(0,0,0,0)"),t.addColorStop(1,"rgba(0,0,0,1)"),e.fillStyle=t,e.fillRect(0,0,o,n))};return Wu({factory:e=>{var t=T({x:0,y:0}),o=re([R.config({find:Q.some}),z.config({})]);return z0.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:t},rounded:!1,components:[r,a],onChange:(e,t,o)=>{F(e,P0,{value:o})},onInit:(e,t,o,n)=>{s(o.element.dom,Zb(Qb))},sliderBehaviours:o})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:(e,t,o)=>{o=o,t=t.components()[0].element.dom,o=my(o,100,100),o=Xb(o),s(t,Zb(o))},setThumb:(e,t,o)=>{o=gy(Yb(o)),z0.setValue(t,{x:o.saturation,y:100-o.value})}},extraApis:{}})})(f),s={paletteRgba:D(Qb),paletteHue:D(0)},r=ie((m=f,g=z0.parts.spectrum({dom:{tag:"div",classes:[m("hue-slider-spectrum")],attributes:{role:"presentation"}}}),p=z0.parts.thumb({dom:{tag:"div",classes:[m("hue-slider-thumb")],attributes:{role:"presentation"}}}),z0.sketch({dom:{tag:"div",classes:[m("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:T(0)},components:[g,p],sliderBehaviours:re([z.config({})]),onChange:(e,t,o)=>{F(e,L0,{value:o})}}))),a=ie(n.sketch({})),i=ie(o.sketch({})),t=(e,t,o)=>{a.getOpt(e).each(e=>{n.setHue(e,o)})},l=(e,t)=>{i.getOpt(e).each(e=>{o.updateHex(e,t)})},c=(e,t,o)=>{r.getOpt(e).each(e=>{z0.setValue(e,100-o/360*100)})},d=(e,t)=>{a.getOpt(e).each(e=>{n.setThumb(e,t)})},u=(t,o,n,e)=>{var r=o,a=n;r=Yb(r),s.paletteRgba.set(r),s.paletteHue.set(a),ee(e,e=>{e(t,o,n)})};var m,g,p;return{uid:e.uid,dom:e.dom,components:[a.asSpec(),r.asSpec(),i.asSpec()],behaviours:re([V("colour-picker-events",[ne(H0,(()=>{const n=[t,c,d];return(e,t)=>{var t=t.event.hex,o=(o=t,gy(Yb(o)));u(e,t,o.hue,n)}})()),ne(P0,(()=>{const n=[l];return(e,t)=>{var t=t.event.value,o=s.paletteHue.get(),t=my(o,t.x,100-t.y),t=py(t);u(e,t,o,n)}})()),ne(L0,(()=>{const n=[t,l];return(e,t)=>{var t=(100-t.event.value)/100*360,o=s.paletteRgba.get(),o=gy(o),o=my(t,o.saturation,o.value),o=py(o);u(e,o,t,n)}})())]),R.config({find:e=>i.getOpt(e)}),se.config({mode:"acyclic"})])}}})},Z0=()=>R.config({find:Q.some}),Q0=e=>R.config({find:t=>Ft(t.element,e).bind(e=>t.getSystem().getByDom(e).toOptional())}),eS=E([M("preprocess",w),M("postprocess",w)]),tS=(e,t,o)=>y.config({store:{mode:"manual",...e.map(e=>({initialValue:e})).getOr({}),getValue:t,setValue:o}}),oS=(e,t,o)=>tS(e,e=>t(e.element),(e,t)=>o(e.element,t)),nS=e=>y.config({store:{mode:"memory",initialValue:e}}),rS={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"};var aS=tinymce.util.Tools.resolve("tinymce.Resource"),sS=tinymce.util.Tools.resolve("tinymce.util.Tools");const iS=(t,o)=>{let n=null;const r=()=>{i(n)||(clearTimeout(n),n=null)};return{cancel:r,throttle:(...e)=>{r(),n=setTimeout(()=>{n=null,t.apply(null,e)},o)}}},lS=I("alloy-fake-before-tabstop"),cS=I("alloy-fake-after-tabstop"),dS=e=>({dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:re([z.config({ignore:!0}),Hx.config({})])}),uS=(e,t)=>({dom:{tag:"div",classes:["tox-navobj",...e.getOr([])]},components:[dS([lS]),t,dS([cS])],behaviours:re([Q0(1)])}),mS=(e,t)=>{F(e,sa(),{raw:{which:9,shiftKey:t}})},gS=(e,t)=>{t=t.element;Ws(t,lS)?mS(e,!0):Ws(t,cS)&&mS(e,!1)},pS=e=>Cx(e,["."+lS,"."+cS].join(","),K),hS=I("update-dialog"),fS=I("update-title"),vS=I("update-body"),bS=I("update-footer"),yS=I("body-send-message"),xS=I("dialog-focus-shifted"),wS=Yo().browser,SS=wS.isSafari(),kS=wS.isFirefox(),CS=SS||kS,OS=wS.isChromium(),_S=({scrollTop:e,scrollHeight:t,clientHeight:o})=>Math.ceil(e)+o>=t,TS=(e,t)=>e.scrollTo(0,"bottom"===t?99999999:t),ES=(e,i,t)=>{const l=e.dom;Q.from(l.contentDocument).fold(t,e=>{let t=0;a=i,s=(r=e).body;const o=Q.from(!/^<!DOCTYPE (html|HTML)/.test(a)&&(!OS&&!SS||W(s)&&(0!==s.scrollTop||1<Math.abs(s.scrollHeight-s.clientHeight)))?s:r.documentElement).map(e=>(t=e.scrollTop,e)).forall(_S),n=()=>{var e=l.contentWindow;W(e)&&(o?TS(e,"bottom"):!o&&CS&&0!==t&&TS(e,t))};var r,a,s;SS&&l.addEventListener("load",n,{once:!0}),e.open(),e.write(i),e.close(),SS||n()})},AS=Ze(CS,SS?500:200).map(e=>{{var n=ES,r=e;let t=null,o=null;return{cancel:()=>{i(t)||(clearTimeout(t),t=null,o=null)},throttle:(...e)=>{o=e,i(t)&&(t=setTimeout(()=>{var e=o;t=null,o=null,n.apply(null,e)},r))}}}}),MS=I("toolbar.button.execute"),DS=I("common-button-display-events"),BS={[wa()]:["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],[Ba()]:["toolbar-button-events",DS],[Qr()]:["focusing","alloy.base.behaviour",DS]},FS=e=>oe(e.element,"width",no(e.element,"width")),IS=(e,t,o)=>Yp(e,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:o},t),RS=(e,t)=>IS(e,t,[]),NS=(e,t)=>IS(e,t,[N.config({})]),VS=(e,t,o)=>({dom:{tag:"span",classes:[t+"__select-label"]},components:[ti(o.translate(e))],behaviours:re([N.config({})])}),zS=I("update-menu-text"),HS=I("update-menu-icon"),LS=(n,t,r)=>{const e=D(S),a=n.text.map(e=>ie(VS(e,t,r.providers))),s=n.icon.map(e=>ie(NS(e,r.providers.icons))),o=(e,t)=>{e=y.getValue(e);return z.focus(e),F(e,"keydown",{raw:t.event.raw}),ux.close(e),Q.some(!0)},i=n.role.fold(()=>({}),e=>({role:e})),l=n.tooltip.fold(()=>({}),e=>{e=r.providers.translate(e);return{title:e,"aria-label":e}}),c=Yp("chevron-down",{tag:"div",classes:[t+"__select-chevron"]},r.providers.icons),d=I("common-button-display-events"),u=ie(ux.sketch({...n.uid?{uid:n.uid}:{},...i,dom:{tag:"button",classes:[t,t+"--select"].concat(k(n.classes,e=>t+"--"+e)),attributes:{...l}},components:bb([s.map(e=>e.asSpec()),a.map(e=>e.asSpec()),Q.some(c)]),matchWidth:!0,useMinWidth:!0,onOpen:(e,t,o)=>{n.searchable&&(o=o,If(o).each(e=>z.focus(e)))},dropdownBehaviours:re([...n.dropdownBehaviours,ub(()=>n.disabled||r.providers.isDisabled()),db(),sw.config({}),N.config({}),V("dropdown-events",[hb(n,e),fb(n,e)]),V(d,[os((e,t)=>FS(e))]),V("menubutton-update-display-text",[ne(zS,(t,o)=>{a.bind(e=>e.getOpt(t)).each(e=>{N.set(e,[ti(r.providers.translate(o.event.text))])})}),ne(HS,(t,o)=>{s.bind(e=>e.getOpt(t)).each(e=>{N.set(e,[NS(o.event.icon,r.providers.icons)])})})])]),eventOrder:Fn(BS,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"],[Ba()]:["toolbar-button-events","dropdown-events",d]}),sandboxBehaviours:re([se.config({mode:"special",onLeft:o,onRight:o}),V("dropdown-sandbox-events",[ne(Mf,(e,t)=>{{const o=y.getValue(e),n=Ff(e).map(Rf);ux.refetch(o).get(()=>{const e=Gy.getCoupled(o,"sandbox");n.each(o=>Ff(e).each(e=>{return e=e,t=o,y.setValue(e,t.fetchPattern),e.element.dom.selectionStart=t.selectionStart,void(e.element.dom.selectionEnd=t.selectionEnd);var t}))})}t.stop()}),ne(Df,(e,t)=>{var r,a;a=t,e=r=e,m.getState(e).bind(x.getHighlighted).bind(x.getHighlighted).each(e=>{var t,o,n;t=r,e=e.element,o=a.event.eventType,n={...a.event.interactionEvent,target:e},t.getSystem().triggerEvent(o,e,n)}),t.stop()})])]),lazySink:r.getSink,toggleClass:t+"--active",parts:{menu:{...Of(0,n.columns,n.presets),fakeFocus:n.searchable,onHighlightItem:mx,onCollapseMenu:(t,e,o)=>{x.getHighlighted(o).each(e=>{mx(t,o,e)})},onDehighlightItem:gx}},getAnchorOverrides:()=>({maxHeightFunction:(e,t)=>{rc()(e,t-10)}}),fetch:e=>Ky($(n.fetch,e))}));return u.asSpec()},PS=e=>"separator"===e.type,US={type:"separator"},WS=(e,a)=>{e=((e,n)=>{e=ye(e,(e,t)=>{return o=t,L(o)?""===t?e:"|"===t?0<e.length&&!PS(e[e.length-1])?e.concat([US]):e:$e(n,t.toLowerCase())?e.concat([n[t.toLowerCase()]]):e:e.concat([t]);var o},[]);return 0<e.length&&PS(e[e.length-1])&&e.pop(),e})(L(e)?e.split(" "):e,a);return be(e,(e,t)=>{var o,n,r;return r=t,$e(r,"getSubmenuItems")?(r=t,n=C(r,"value").getOrThunk(()=>I("generated-menu-item")),n=Fn({value:n},r),r=a,o=(n=n).getSubmenuItems(),o=WS(o,r),r={item:n,menus:Fn(o.menus,{[n.value]:o.items}),expansions:Fn(o.expansions,{[n.value]:n.value})},{menus:Fn(e.menus,r.menus),items:[r.item,...e.items],expansions:Fn(e.expansions,r.expansions)}):{...e,items:[t,...e.items]}},{menus:{},expansions:{},items:[]})},jS=(e,o,n,t)=>{var r=I("primary-menu"),e=WS(e,n.shared.providers.menuItems());if(0===e.items.length)return Q.none();const a=t.search.fold(()=>({searchMode:"no-search"}),e=>({searchMode:"search-with-field",placeholder:e.placeholder})),s=fx(r,e.items,o,n,t.isHorizontalMenu,a),i=t.search.fold(()=>({searchMode:"no-search"}),e=>({searchMode:"search-with-results"})),l=ze(e.menus,(e,t)=>fx(t,e,o,n,!1,i)),c=Fn(l,Lr(r,s));return Q.from(Np.tieredData(r,c,e.expansions))},GS=e=>!$e(e,"items"),$S="data-value",qS=(t,o,e,n)=>k(e,e=>GS(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===n,onAction:()=>{y.setValue(t,e.value),F(t,jx,{name:o}),z.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:()=>qS(t,o,e.items,n)}),XS=(e,t)=>Ie(e,e=>GS(e)?Ze(e.value===t,e):XS(e.items,t)),YS=Wu({name:"HtmlSelect",configFields:[A("options"),Gd("selectBehaviours",[z,y]),M("selectClasses",[]),M("selectAttributes",{}),d("data")],factory:(n,e)=>{var t=k(n.options,e=>({dom:{tag:"option",value:e.value,innerHtml:e.text}})),o=n.data.map(e=>Lr("initialValue",e)).getOr({});return{uid:n.uid,dom:{tag:"select",classes:n.selectClasses,attributes:n.selectAttributes},components:t,behaviours:qd(n.selectBehaviours,[z.config({}),y.config({store:{mode:"manual",getValue:e=>qs(e.element),setValue:(t,o)=>{var e=De(n.options);xe(n.options,e=>e.value===o).isSome()?Xs(t.element,o):-1===t.element.dom.selectedIndex&&""===o&&e.each(e=>Xs(t.element,e.value))},...o}})])}}}),KS=T([M("field1Name","field1"),M("field2Name","field2"),Di("onLockedChange"),Ei(["lockClass"]),M("locked",!1),Xd("coupledFieldBehaviours",[R,y])]),JS=(e,a)=>bu({factory:H,name:e,overrides:r=>({fieldBehaviours:re([V("coupled-input-behaviour",[ne(la(),o=>{var e,t,n;e=o,t=r,n=a,Mu(e,t,n).bind(R.getCurrent).each(t=>{Mu(o,r,"lock").each(e=>{f.isOn(e)&&r.onLockedChange(o,t,e)})})})])])})}),ZS=T([JS("field1","field2"),JS("field2","field1"),bu({factory:Hp,schema:[A("dom")],name:"lock",overrides:e=>({buttonBehaviours:re([f.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])})})]),QS=ju({name:"FormCoupledInputs",configFields:KS(),partFields:ZS(),factory:(o,e,t,n)=>({uid:o.uid,dom:o.dom,components:e,behaviours:Yd(o.coupledFieldBehaviours,[R.config({find:Q.some}),y.config({store:{mode:"manual",getValue:e=>{e=Ru(e,o,["field1","field2"]);return{[o.field1Name]:y.getValue(e.field1()),[o.field2Name]:y.getValue(e.field2())}},setValue:(e,t)=>{e=Ru(e,o,["field1","field2"]);qe(t,o.field1Name)&&y.setValue(e.field1(),t[o.field1Name]),qe(t,o.field2Name)&&y.setValue(e.field2(),t[o.field2Name])}}})]),apis:{getField1:e=>Mu(e,o,"field1"),getField2:e=>Mu(e,o,"field2"),getLock:e=>Mu(e,o,"lock")}}),apis:{getField1:(e,t)=>e.getField1(t),getField2:(e,t)=>e.getField2(t),getLock:(e,t)=>e.getLock(t)}}),ek=e=>{var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(e);if(null===t)return _.error(e);{const e=parseFloat(t[1]),o=t[2];return _.value({value:e,unit:o})}},tk=(e,t)=>{const o={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},n=e=>$e(o,e);return e.unit===t?Q.some(e.value):n(e.unit)&&n(t)?o[e.unit]===o[t]?Q.some(e.value):Q.some(e.value/o[e.unit]*o[t]):Q.none()},ok=e=>Q.none(),nk=(o,t)=>{var e=o.label.map(e=>Wx(e,t)),n=[ae.config({disabled:()=>o.disabled||t.isDisabled()}),db(),se.config({mode:"execution",useEnter:!0!==o.multiline,useControlEnter:!0===o.multiline,execute:e=>(B(e,Xx),Q.some(!0))}),V("textfield-change",[ne(la(),(e,t)=>{F(e,jx,{name:o.name})}),ne(ya(),(e,t)=>{F(e,jx,{name:o.name})})]),Hx.config({})],r=o.validation.map(o=>aw.config({getRoot:e=>Mt(e.element),invalidClass:"tox-invalid",validator:{validate:e=>{var e=y.getValue(e),t=o.validator(e);return Jy(!0===t?_.value(e):_.error(t))},validateOnLoad:o.validateOnLoad}})).toArray(),a={...o.placeholder.fold(T({}),e=>({placeholder:t.translate(e)})),...o.inputMode.fold(T({}),e=>({inputmode:e}))},a=H.parts.field({tag:!0===o.multiline?"textarea":"input",...o.data.map(e=>({data:e})).getOr({}),inputAttributes:a,inputClasses:[o.classname],inputBehaviours:re(Se([n,r])),selectOnFocus:!1,factory:Af}),n=o.multiline?{dom:{tag:"div",classes:["tox-textarea-wrap"]},components:[a]}:a,r=(o.flex?["tox-form__group--stretched"]:[]).concat(o.maximized?["tox-form-group--maximize"]:[]),a=[ae.config({disabled:()=>o.disabled||t.isDisabled(),onDisabled:e=>{H.getField(e).each(ae.disable)},onEnabled:e=>{H.getField(e).each(ae.enable)}}),db()];return Px(e,n,r,a)},rk=(t,e)=>e.getAnimationRoot.fold(()=>t.element,e=>e(t)),ak=e=>e.dimension.property,sk=(e,t)=>e.dimension.getDimension(t),ik=(e,t)=>{e=rk(e,t);Gs(e,[t.shrinkingClass,t.growingClass])},lk=(e,t)=>{Us(e.element,t.openClass),Ps(e.element,t.closedClass),oe(e.element,ak(t),"0px"),co(e.element)},ck=(e,t)=>{Us(e.element,t.closedClass),Ps(e.element,t.openClass),lo(e.element,ak(t))},dk=(e,t,o,n)=>{o.setCollapsed(),oe(e.element,ak(t),sk(t,e.element)),ik(e,t),lk(e,t),t.onStartShrink(e),t.onShrunk(e)},uk=(e,t,o,n)=>{n=n.getOrThunk(()=>sk(t,e.element)),o.setCollapsed(),oe(e.element,ak(t),n),co(e.element),o=rk(e,t);Us(o,t.growingClass),Ps(o,t.shrinkingClass),lk(e,t),t.onStartShrink(e)},mk=(e,t,o)=>{var n=sk(t,e.element);("0px"===n?dk:uk)(e,t,o,Q.some(n))},gk=(e,t,o)=>{const n=rk(e,t),r=Ws(n,t.shrinkingClass),a=sk(t,e.element);ck(e,t);var s=sk(t,e.element);(r?()=>{oe(e.element,ak(t),a),co(e.element)}:()=>{lk(e,t)})(),Us(n,t.shrinkingClass),Ps(n,t.growingClass),ck(e,t),oe(e.element,ak(t),s),o.setExpanded(),t.onStartGrow(e)},pk=(e,t,o)=>{e=rk(e,t);return!0===Ws(e,t.growingClass)},hk=(e,t,o)=>{e=rk(e,t);return!0===Ws(e,t.shrinkingClass)};bc=Object.freeze({__proto__:null,refresh:(e,t,o)=>{if(o.isExpanded()){lo(e.element,ak(t));const o=sk(t,e.element);oe(e.element,ak(t),o)}},grow:(e,t,o)=>{o.isExpanded()||gk(e,t,o)},shrink:(e,t,o)=>{o.isExpanded()&&mk(e,t,o)},immediateShrink:(e,t,o)=>{o.isExpanded()&&dk(e,t,o)},hasGrown:(e,t,o)=>o.isExpanded(),hasShrunk:(e,t,o)=>o.isCollapsed(),isGrowing:pk,isShrinking:hk,isTransitioning:(e,t,o)=>pk(e,t)||hk(e,t),toggleGrow:(e,t,o)=>{(o.isExpanded()?mk:gk)(e,t,o)},disableTransitions:ik,immediateGrow:(e,t,o)=>{o.isExpanded()||(ck(e,t),oe(e.element,ak(t),sk(t,e.element)),ik(e,t),o.setExpanded(),t.onStartGrow(e),t.onGrown(e))}}),zx=Object.freeze({__proto__:null,exhibit:(e,t,o)=>{var n=t.expanded;return Bs(n?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:Lr(t.dimension.property,"0px")})},events:(o,n)=>qa([ts(ma(),(e,t)=>{t.event.raw.propertyName===o.dimension.property&&(ik(e,o),n.isExpanded()&&lo(e.element,o.dimension.property),(n.isExpanded()?o.onGrown:o.onShrunk)(e))})])}),fl=[A("closedClass"),A("openClass"),A("shrinkingClass"),A("growingClass"),d("getAnimationRoot"),e("onShrunk"),e("onStartShrink"),e("onGrown"),e("onStartGrow"),M("expanded",!1),vr("dimension",mr("property",{width:[Fi("property","width"),Fi("getDimension",e=>wo(e)+"px")],height:[Fi("property","height"),Fi("getDimension",e=>go(e)+"px")]}))];const fk=Sl({fields:fl,name:"sliding",active:zx,apis:bc,state:Object.freeze({__proto__:null,init:e=>{const t=D(e.expanded);return Ms({isExpanded:()=>!0===t.get(),isCollapsed:()=>!1===t.get(),setCollapsed:$(t.set,!1),setExpanded:$(t.set,!0),readState:()=>"expanded: "+t.get()})}})}),vk=o=>({isEnabled:()=>!ae.isDisabled(o),setEnabled:e=>ae.set(o,!e),setActive:e=>{var t=o.element;e?(Ps(t,"tox-tbtn--enabled"),O(t,"aria-pressed",!0)):(Us(t,"tox-tbtn--enabled"),Zt(t,"aria-pressed"))},isActive:()=>Ws(o.element,"tox-tbtn--enabled"),setText:e=>{F(o,zS,{text:e})},setIcon:e=>F(o,HS,{icon:e})}),bk=(n,e,r,t,o=!0)=>LS({text:n.text,icon:n.icon,tooltip:n.tooltip,searchable:n.search.isSome(),role:t,fetch:(e,t)=>{var o={pattern:n.search.isSome()?(o=e,Gy.getExistingCoupled(o,"sandbox").bind(Ff).map(Rf).map(e=>e.fetchPattern).getOr("")):""};n.fetch(e=>{t(jS(e,sf.CLOSE_ON_EXECUTE,r,{isHorizontalMenu:!1,search:n.search}))},o,vk(e))},onSetup:n.onSetup,getApi:vk,columns:1,presets:"normal",classes:[],dropdownBehaviours:[...o?[Hx.config({})]:[]]},e,r.shared),yk=(t,r,a)=>{return e=>{e(k(t,e=>{var t,o,n=e.text.fold(()=>({}),e=>({text:e}));return{type:e.type,active:!1,...n,onAction:e=>{var t=!e.isActive();e.setActive(t),o.storage.set(t),a.shared.getSink().each(e=>{r().getOpt(e).each(e=>{El(e.element),F(e,qx,{name:o.name,value:o.storage.get()})})})},onSetup:(t=o=e,e=>{e.setActive(t.storage.get())})}}))}},xk=e=>({dom:{tag:"span",classes:["tox-tree__label"],attributes:{title:e,"aria-label":e}},components:[ti(e)]}),wk=I("leaf-label-event-id"),Sk=({leaf:o,onLeafAction:t,visible:n,treeId:r,selectedId:a,backstage:s})=>{const e=o.menu.map(e=>bk(e,"tox-mbtn",s,Q.none(),n)),i=[xk(o.title)];return e.each(e=>i.push(e)),Hp.sketch({dom:{tag:"div",classes:["tox-tree--leaf__label","tox-trbtn"].concat(n?["tox-tree--leaf__label--visible"]:[])},components:i,role:"treeitem",action:e=>{t(o.id),e.getSystem().broadcastOn(["update-active-item-"+r],{value:o.id})},eventOrder:{[sa()]:[wk,"keying"]},buttonBehaviours:re([...n?[Hx.config({})]:[],f.config({toggleClass:"tox-trbtn--enabled",toggleOnExecute:!1,aria:{mode:"selected"}}),_l.config({channels:{["update-active-item-"+r]:{onReceive:(e,t)=>{(t.value===o.id?f.on:f.off)(e)}}}}),V(wk,[os((t,e)=>{a.each(e=>{(e===o.id?f.on:f.off)(t)})}),ne(sa(),(t,e)=>{var o="ArrowLeft"===e.event.raw.code,n="ArrowRight"===e.event.raw.code;o?(mi(t.element,".tox-tree--directory").each(e=>{t.getSystem().getByDom(e).each(t=>{gi(e,".tox-tree--directory__label").each(e=>{t.getSystem().getByDom(e).each(z.focus)})})}),e.stop()):n&&e.stop()})])])})},kk=I("directory-label-event-id"),Ck=({directory:n,visible:e,noChildren:t,backstage:o})=>{const r=n.menu.map(e=>bk(e,"tox-mbtn",o,Q.none())),a=[{dom:{tag:"div",classes:["tox-chevron"]},components:[(s=o.shared.providers.icons,s=s,Yp("chevron-right",{tag:"span",classes:["tox-tree__icon-wrap","tox-icon"],behaviours:[]},s))]},xk(n.title)];var s;r.each(e=>{a.push(e)});const i=o=>{mi(o.element,".tox-tree--directory").each(e=>{o.getSystem().getByDom(e).each(e=>{var t=!f.isOn(e);f.toggle(e),F(o,"expand-tree-node",{expanded:t,node:n.id})})})};return Hp.sketch({dom:{tag:"div",classes:["tox-tree--directory__label","tox-trbtn"].concat(e?["tox-tree--directory__label--visible"]:[])},components:a,action:i,eventOrder:{[sa()]:[kk,"keying"]},buttonBehaviours:re([...e?[Hx.config({})]:[],V(kk,[ne(sa(),(o,n)=>{const r="ArrowRight"===n.event.raw.code,a="ArrowLeft"===n.event.raw.code;r&&t&&n.stop(),(r||a)&&mi(o.element,".tox-tree--directory").each(e=>{o.getSystem().getByDom(e).each(t=>{!f.isOn(t)&&r||f.isOn(t)&&a?(i(o),n.stop()):a&&!f.isOn(t)&&(mi(t.element,".tox-tree--directory").each(e=>{gi(e,".tox-tree--directory__label").each(e=>{t.getSystem().getByDom(e).each(z.focus)})}),n.stop())})})})])])})},Ok=({children:e,onLeafAction:t,visible:o,treeId:n,expandedIds:r,selectedId:a,backstage:s})=>({dom:{tag:"div",classes:["tox-tree--directory__children"]},components:e.map(e=>"leaf"===e.type?Sk({leaf:e,selectedId:a,onLeafAction:t,visible:o,treeId:n,backstage:s}):Tk({directory:e,expandedIds:r,selectedId:a,onLeafAction:t,labelTabstopping:o,treeId:n,backstage:s})),behaviours:re([fk.config({dimension:{property:"height"},closedClass:"tox-tree--directory__children--closed",openClass:"tox-tree--directory__children--open",growingClass:"tox-tree--directory__children--growing",shrinkingClass:"tox-tree--directory__children--shrinking",expanded:o}),N.config({})])}),_k=I("directory-event-id"),Tk=({directory:e,onLeafAction:r,labelTabstopping:t,treeId:a,backstage:s,expandedIds:o,selectedId:i})=>{const l=e["children"],c=D(o),n=o.includes(e.id);return{dom:{tag:"div",classes:["tox-tree--directory"],attributes:{role:"treeitem"}},components:[Ck({directory:e,visible:t,noChildren:0===e.children.length,backstage:s}),Ok({children:l,expandedIds:o,selectedId:i,onLeafAction:r,visible:n,treeId:a,backstage:s})],behaviours:re([V(_k,[os((e,t)=>{f.set(e,n)}),ne("expand-tree-node",(e,t)=>{const{expanded:o,node:n}=t.event;c.set(o?[...c.get(),n]:c.get().filter(e=>e!==n))})]),f.config({...0<e.children.length?{aria:{mode:"expanded"}}:{},toggleClass:"tox-tree--directory--expanded",onToggled:(e,t)=>{var o,e=e.components()[1],n=(o=t,l.map(e=>"leaf"===e.type?Sk({leaf:e,selectedId:i,onLeafAction:r,visible:o,treeId:a,backstage:s}):Tk({directory:e,expandedIds:c.get(),selectedId:i,onLeafAction:r,labelTabstopping:o,treeId:a,backstage:s})));t?fk.grow(e):fk.shrink(e),N.set(e,n)}})])}},Ek=I("tree-event-id");Bg=Object.freeze({__proto__:null,events:(e,t)=>{var o=e.stream.streams.setup(e,t);return qa([ne(e.event,o),ns(()=>t.cancel())].concat(e.cancelEvent.map(e=>[ne(e,()=>t.cancel())]).getOr([])))}}),Lg=e=>{const t=D(null);return Ms({readState:()=>({timer:null!==t.get()?"set":"unset"}),setTimer:e=>{t.set(e)},cancel:()=>{var e=t.get();null!==e&&e.cancel()}})},Pg=Object.freeze({__proto__:null,throttle:Lg,init:e=>e.stream.streams.state(e)}),Ac=[vr("stream",mr("mode",{throttle:[A("delay"),M("stopEvent",!0),Fi("streams",{setup:(e,t)=>{const o=e.stream,n=iS(e.onStream,o.delay);return t.setTimer(n),(e,t)=>{n.throttle(e,t),o.stopEvent&&t.stop()}},state:Lg})]})),M("event","input"),d("cancelEvent"),Di("onStream")];const Ak=Sl({fields:Ac,name:"streaming",active:Bg,state:Pg}),Mk=(e,t,o)=>{o=y.getValue(o);y.setValue(t,o),Bk(t)},Dk=(e,t)=>{var e=e.element,o=qs(e),n=e.dom;"number"!==Yt(e,"type")&&t(n,o)},Bk=e=>{Dk(e,(e,t)=>e.setSelectionRange(t.length,t.length))},Fk=T("alloy.typeahead.itemexecute"),Ik=T([d("lazySink"),A("fetch"),M("minChars",5),M("responseTime",1e3),e("onOpen"),M("getHotspot",Q.some),M("getAnchorOverrides",T({})),M("layouts",Q.none()),M("eventOrder",{}),zr("model",{},[M("getDisplayText",e=>void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.value),M("selectsOver",!0),M("populateFromBrowse",!0)]),e("onSetValue"),Mi("onExecute"),e("onItemExecute"),M("inputClasses",[]),M("inputAttributes",{}),M("inputStyles",{}),M("matchWidth",!0),M("useMinWidth",!1),M("dismissOnBlur",!0),Ei(["openClass"]),d("initialData"),Gd("typeaheadBehaviours",[z,y,Ak,se,f,Gy]),hr("lazyTypeaheadComp",()=>D(Q.none)),hr("previewing",()=>D(!0))].concat(_f()).concat(lx())),Rk=T([yu({schema:[Ti()],name:"menu",overrides:n=>({fakeFocus:!0,onHighlightItem:(e,t,o)=>{n.previewing.get()?n.lazyTypeaheadComp.get().each(e=>{((e,t,n)=>{if(e.selectsOver){const o=y.getValue(t),r=e.getDisplayText(o),a=y.getValue(n);return 0===e.getDisplayText(a).indexOf(r)?Q.some(()=>{var e,o;Mk(0,t,n),e=t,o=r.length,Dk(e,(e,t)=>e.setSelectionRange(o,t.length))}):Q.none()}return Q.none()})(n.model,e,o).fold(()=>{n.model.selectsOver?(x.dehighlight(t,o),n.previewing.set(!0)):n.previewing.set(!1)},e=>{e(),n.previewing.set(!1)})}):n.lazyTypeaheadComp.get().each(t=>{n.model.populateFromBrowse&&Mk(n.model,t,o),Kt(o.element,"id").each(e=>O(t.element,"aria-activedescendant",e))})},onExecute:(e,t)=>n.lazyTypeaheadComp.get().map(e=>(F(e,Fk(),{item:t}),!0)),onHover:(e,t)=>{n.previewing.set(!1),n.lazyTypeaheadComp.get().each(e=>{n.model.populateFromBrowse&&Mk(n.model,e,t)})}})})]),Nk=ju({name:"Typeahead",configFields:Ik(),partFields:Rk(),factory:(r,e,t,a)=>{const o=(e,t,o)=>{r.previewing.set(!1);const n=Gy.getCoupled(e,"sandbox");if(m.isOpen(n))R.getCurrent(n).each(e=>{x.getHighlighted(e).fold(()=>{o(e)},()=>{$a(n,e.element,"keydown",t)})});else{const t=e=>{R.getCurrent(e).each(o)};tx(r,s(e),e,n,a,t,lp.HighlightMenuAndItem).get(S)}},n=Tf(r),s=o=>e=>e.map(e=>{var t=Ge(e.menus),t=ke(t,e=>ve(e.items,e=>"item"===e.type));return y.getState(o).update(k(t,e=>e.data)),e}),i=e=>R.getCurrent(e),l="typeaheadevents",c=[z.config({}),y.config({onSetValue:r.onSetValue,store:{mode:"dataset",getDataKey:e=>qs(e.element),getFallbackEntry:e=>({value:e,meta:{}}),setValue:(e,t)=>{Xs(e.element,r.model.getDisplayText(t))},...r.initialData.map(e=>Lr("initialValue",e)).getOr({})}}),Ak.config({stream:{mode:"throttle",delay:r.responseTime,stopEvent:!1},onStream:(e,t)=>{const o=Gy.getCoupled(e,"sandbox");if(z.isFocused(e)&&qs(e.element).length>=r.minChars){const t=i(o).bind(e=>x.getHighlighted(e).map(y.getValue));r.previewing.set(!0);tx(r,s(e),e,o,a,e=>{i(o).each(e=>{t.fold(()=>{r.model.selectsOver&&x.highlightFirst(e)},t=>{x.highlightBy(e,e=>y.getValue(e).value===t.value),x.getHighlighted(e).orThunk(()=>(x.highlightFirst(e),Q.none()))})})},lp.HighlightJustMenu).get(S)}},cancelEvent:_a()}),se.config({mode:"special",onDown:(e,t)=>(o(e,t,x.highlightFirst),Q.some(!0)),onEscape:e=>{e=Gy.getCoupled(e,"sandbox");return m.isOpen(e)?(m.close(e),Q.some(!0)):Q.none()},onUp:(e,t)=>(o(e,t,x.highlightLast),Q.some(!0)),onEnter:t=>{var e,o=Gy.getCoupled(t,"sandbox"),n=m.isOpen(o);return n&&!r.previewing.get()?i(o).bind(e=>x.getHighlighted(e)).map(e=>(F(t,Fk(),{item:e}),!0)):(e=y.getValue(t),B(t,_a()),r.onExecute(o,t,e),n&&m.close(o),Q.some(!0))}}),f.config({toggleClass:r.markers.openClass,aria:{mode:"expanded"}}),Gy.config({others:{sandbox:e=>sx(r,e,{onOpen:()=>f.on(e),onClose:()=>{r.lazyTypeaheadComp.get().each(e=>Zt(e.element,"aria-activedescendant")),f.off(e)}})}}),V(l,[os(e=>{r.lazyTypeaheadComp.set(Q.some(e))}),ns(e=>{r.lazyTypeaheadComp.set(Q.none())}),as(e=>{var t=S;nx(r,s(e),e,a,t,lp.HighlightMenuAndItem).get(S)}),ne(Fk(),(e,t)=>{var o=Gy.getCoupled(e,"sandbox");Mk(r.model,e,t.event.item),B(e,_a()),r.onItemExecute(e,o,t.event.item,y.getValue(e)),m.close(o),Bk(e)})].concat(r.dismissOnBlur?[ne(ba(),e=>{e=Gy.getCoupled(e,"sandbox");Bl(e.element).isNone()&&m.close(e)})]:[]))],d={[Fa()]:[y.name(),Ak.name(),l],...r.eventOrder};return{uid:r.uid,dom:Ef(Fn(r,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:{...n,...qd(r.typeaheadBehaviours,c)},eventOrder:d}}}),Vk=a=>({...a,toCached:()=>Vk(a.toCached()),bindFuture:t=>Vk(a.bind(e=>e.fold(e=>Jy(_.error(e)),e=>t(e)))),bindResult:t=>Vk(a.map(e=>e.bind(t))),mapResult:t=>Vk(a.map(e=>e.map(t))),mapError:t=>Vk(a.map(e=>e.mapError(t))),foldResult:(t,o)=>a.map(e=>e.fold(t,o)),withTimeout:(e,r)=>Vk(Ky(t=>{let o=!1;const n=setTimeout(()=>{o=!0,t(_.error(r()))},e);a.get(e=>{o||(clearTimeout(n),t(e))})}))}),zk=(e,t,o=[],n,r,a)=>{t=t.fold(()=>({}),e=>({action:e})),o={buttonBehaviours:re([ub(()=>!e.enabled||a.isDisabled()),db(),Hx.config({}),V("button press",[Ya("click"),Ya("mousedown")])].concat(o)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]},...t},t=Fn(o,{dom:n});return Fn(t,{components:r})},Hk=(e,t,o,n=[])=>{var r={tag:"button",classes:["tox-tbtn"],attributes:e.tooltip.map(e=>({"aria-label":o.translate(e),title:o.translate(e)})).getOr({})},a=e.icon.map(e=>RS(e,o.icons)),a=bb([a]);return zk(e,t,n,r,a,o)},Lk=e=>{switch(e){case"primary":return["tox-button"];case"toolbar":return["tox-tbtn"];default:return["tox-button","tox-button--secondary"]}},Pk=(e,t,o,n=[],r=[])=>{const a=o.translate(e.text),s=e.icon.map(e=>RS(e,o.icons)),i=[s.getOrThunk(()=>ti(a))],l=e.buttonType.getOr(e.primary||e.borderless?"primary":"secondary"),c=[...Lk(l),...s.isSome()?["tox-button--icon"]:[],...e.borderless?["tox-button--naked"]:[],...r];return zk(e,t,n,{tag:"button",classes:c,attributes:{title:a}},i,o)},Uk=(e,t,o,n=[],r=[])=>{e=Pk(e,Q.some(t),o,n,r);return Hp.sketch(e)},Wk=(t,o)=>e=>{"custom"===o?F(e,qx,{name:t,value:{}}):"submit"===o?B(e,Xx):"cancel"===o?B(e,$x):console.error("Unknown button type: ",o)},jk=(t,e,o)=>{if("menu"===e){const e=()=>c,i=t,l={...t,type:"menubutton",search:Q.none(),onSetup:e=>(e.setEnabled(t.enabled),S),fetch:yk(i.items,e,o)},c=ie(bk(l,"tox-tbtn",o,Q.none()));return c.asSpec()}var n,r;if("custom"===e||"cancel"===e||"submit"===e)return n=Wk(t.name,e),r={...t,borderless:!1},Uk(r,n,o.shared.providers,[]);if("togglebutton"!==e)throw console.error("Unknown footer button type: ",e),new Error("Unknown footer button type");{var a=t,s=o.shared.providers;const d=a.icon.map(e=>NS(e,s.icons)).map(ie),u=a.buttonType.getOr(a.primary?"primary":"secondary"),m={...a,name:null!=(r=a.name)?r:"",primary:"primary"===u,tooltip:Q.from(a.tooltip),enabled:null!=(r=a.enabled)&&r,borderless:!1},g=m.tooltip.map(e=>({"aria-label":s.translate(e),title:s.translate(e)})).getOr({}),p=Lk(null!=u?u:"secondary"),h=a.icon.isSome()&&a.text.isSome(),f={tag:"button",classes:[...p.concat(a.icon.isSome()?["tox-button--icon"]:[]),...a.active?["tox-button--enabled"]:[],...h?["tox-button--icon-and-text"]:[]],attributes:g},v=s.translate(a.text.getOr("")),b=ti(v),y=[...bb([d.map(e=>e.asSpec())]),...a.text.isSome()?[b]:[]],x=zk(m,Q.some(o=>{F(o,qx,{name:a.name,value:{setIcon:t=>{d.map(e=>e.getOpt(o).each(e=>{N.set(e,[NS(t,s.icons)])}))}}})}),[],f,y,s);return Hp.sketch(x)}},Gk={type:"separator"},$k=e=>({type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:S}),qk=(e,t)=>({type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:S}),Xk=(e,t)=>{return o=e,e=t,t=ve(e,e=>e.type===o),k(t,$k);var o},Yk=(e,t)=>{const o=e.toLowerCase();return ve(t,e=>{var t=(void 0!==e.meta&&void 0!==e.meta.text?e.meta:e).text,e=null!=(e=e.value)?e:"";return tt(t.toLowerCase(),o)||tt(e.toLowerCase(),o)})},Kk=I("aria-invalid"),Jk=(e,t)=>{e.dom.checked=t},Zk=e=>e.dom.checked,Qk=a=>(t,o,n,r)=>C(o,"name").fold(()=>a(o,r,Q.none()),e=>t.field(e,a(o,r,C(n,e)))),eC={bar:Qk((e,t)=>{return e=e,t=t.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:k(e.items,t.interpreter)}}),collection:Qk((e,t,o)=>{{var s=e,i=t.shared.providers;e=o;const n=s.label.map(e=>Wx(e,i)),r=n=>(t,o)=>{hi(o.event.target,"[data-collection-item-value]").each(e=>{n(t,o,e,Yt(e,"data-collection-item-value"))})},a=r((e,t,o,n)=>{t.stop(),i.isDisabled()||F(e,qx,{name:s.name,value:n})}),l=[ne(na(),r((e,t,o)=>{El(o)})),ne(da(),a),ne(ka(),a),ne(ra(),r((e,t,o)=>{pi(e.element,"."+ff).each(e=>{Us(e,ff)}),Ps(o,ff)})),ne(aa(),r(e=>{pi(e.element,"."+ff).each(e=>{Us(e,ff)})})),as(r((e,t,o,n)=>{F(e,qx,{name:s.name,value:n})}))],c=(e,t)=>k(Pc(e.element,".tox-collection__item"),t),d=H.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==s.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:w},behaviours:re([ae.config({disabled:i.isDisabled,onDisabled:e=>{c(e,e=>{Ps(e,"tox-collection__item--state-disabled"),O(e,"aria-disabled",!0)})},onEnabled:e=>{c(e,e=>{Us(e,"tox-collection__item--state-disabled"),Zt(e,"aria-disabled")})}}),db(),N.config({}),y.config({store:{mode:"memory",initialValue:e.getOr([])},onSetValue:(o,e)=>{var t=o;e=k(e,e=>{const t=Lp.translate(e.text),o=1===s.columns?`<div class="tox-collection__item-label">${t}</div>`:"",n=`<div class="tox-collection__item-icon">${e.icon}</div>`,r={_:" "," - ":" ","-":" "},a=t.replace(/\_| \- |\-/g,e=>r[e]);return`<div class="tox-collection__item${i.isDisabled()?" tox-collection__item--state-disabled":""}" tabindex="-1" data-collection-item-value="${Lx.encodeAllRaw(e.value)}" title="${a}" aria-label="${a}">${n}${o}</div>`}),e="auto"!==s.columns&&1<s.columns?he(e,s.columns):[e],e=k(e,e=>`<div class="tox-collection__group">${e.join("")}</div>`),is(t.element,e.join("")),"auto"===s.columns&&Qv(o,5,"tox-collection__item").each(({numRows:e,numColumns:t})=>{se.setGridSize(o,e,t)}),B(o,Zx)}}),Hx.config({}),se.config(1===(e=s.columns)?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===e?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:"."+cf}}),V("collection-events",l)]),eventOrder:{[wa()]:["disabling","alloy.base.behaviour","collection-events"]}});return Px(n,d,["tox-form__group--collection"],[])}}),alertbanner:Qk((e,t)=>{return o=e,e=t.shared.providers,t=$p(o.icon,e.icons),Ix.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+o.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:o.url?void 0:t},components:o.url?[Hp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:t,attributes:{title:e.translate(o.iconTooltip)}},action:e=>F(e,qx,{name:"alert-banner",value:o.url}),buttonBehaviours:re([qp()])})]:void 0},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:e.translate(o.text)}}]});var o}),input:Qk((e,t,o)=>{return e=e,t=t.shared.providers,o=o,nk({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:!e.enabled,classname:"tox-textfield",validation:Q.none(),maximized:e.maximized,data:o},t)}),textarea:Qk((e,t,o)=>{return e=e,t=t.shared.providers,o=o,nk({name:e.name,multiline:!0,label:e.label,inputMode:Q.none(),placeholder:e.placeholder,flex:!0,disabled:!e.enabled,classname:"tox-textarea",validation:Q.none(),maximized:e.maximized,data:o},t)}),label:Qk((e,t)=>{return e=e,t=t.shared,{dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"label",classes:[o="tox-label",..."center"===e.align?[o+"--center"]:[],..."end"===e.align?[o+"--end"]:[]]},components:[ti(t.providers.translate(e.label))]},...k(e.items,t.interpreter)],behaviours:re([Z0(),N.config({}),(o=Q.none(),oS(o,ss,is)),se.config({mode:"acyclic"})])};var o}),iframe:(bO=(e,t,o)=>{{var n=t.shared.providers,r=o;const a="tox-dialog__iframe",s=e.transparent?[]:[a+"--opaque"],i=e.border?["tox-navobj-bordered"]:[],l={...e.label.map(e=>({title:e})).getOr({}),...r.map(e=>({srcdoc:e})).getOr({}),...e.sandboxed?{sandbox:"allow-scripts allow-same-origin"}:{}},c=((e,n)=>{const r=D(e.getOr(""));return{getValue:e=>r.get(),setValue:(e,t)=>{if(r.get()!==t){const r=e.element,o=()=>O(r,"srcdoc",t);n?AS.fold(T(ES),e=>e.throttle)(r,t,o):o()}r.set(t)}}})(r,e.streamContent),d=e.label.map(e=>Wx(e,n)),u=H.parts.field({factory:{sketch:e=>uS(Q.from(i),{uid:e.uid,dom:{tag:"iframe",attributes:l,classes:[a,...s]},behaviours:re([Hx.config({}),z.config({}),tS(r,c.getValue,c.setValue),_l.config({channels:{[xS]:{onReceive:(o,e)=>{e.newFocus.each(t=>{Mt(o.element).each(e=>{(kt(o.element,t)?Ps:Us)(e,"tox-navobj-bordered-focus")})})}}}})])})}});return Px(d,u,["tox-form__group--stretched"],[])}},(e,t,o,n)=>{t=Fn(t,{source:"dynamic"});return Qk(bO)(e,t,o,n)}),button:Qk((e,t)=>{return e=e,t=t.shared.providers,o=Wk(e.name,"custom"),n=Q.none(),e=H.parts.field({factory:Hp,...Pk(e,Q.some(o),t,[nS(""),Z0()])}),Px(n,e,[],[]);var o,n}),checkbox:Qk((e,t,o)=>{return n=e,r=t.shared.providers,e=o,t=e=>(e.element.dom.click(),Q.some(!0)),e=H.parts.field({factory:{sketch:w},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:re([Z0(),ae.config({disabled:()=>!n.enabled||r.isDisabled(),onDisabled:e=>{Mt(e.element).each(e=>Ps(e,"tox-checkbox--disabled"))},onEnabled:e=>{Mt(e.element).each(e=>Us(e,"tox-checkbox--disabled"))}}),Hx.config({}),z.config({}),oS(e,Zk,Jk),se.config({mode:"special",onEnter:t,onSpace:t,stopSpaceKeyup:!0}),V("checkbox-events",[ne(ca(),(e,t)=>{F(e,jx,{name:n.name})})])])}),t=H.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"]},components:[ti(r.translate(n.label))],behaviours:re([sw.config({})])}),o=e=>Yp("checked"===e?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+e]},r.icons),o=ie({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[o("checked"),o("unchecked")]}),H.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[e,o.asSpec(),t],fieldBehaviours:re([ae.config({disabled:()=>!n.enabled||r.isDisabled()}),db()])});var n,r}),colorinput:Qk((e,t,o)=>{{var n=e,r=t.shared,a=t.colorinput,s,i;e=o;const l=H.parts.field({factory:Af,inputClasses:["tox-textfield"],data:e,onSetValue:e=>aw.run(e).get(S),inputBehaviours:re([ae.config({disabled:r.providers.isDisabled}),db(),Hx.config({}),aw.config({invalidClass:"tox-textbox-field-invalid",getRoot:e=>Mt(e.element),notify:{onValid:e=>{var t=y.getValue(e);F(e,iw,{color:t})}},validator:{validateOnLoad:!1,validate:e=>{const t=y.getValue(e);if(0===t.length)return Jy(_.value(!0));{const e=it("span");oe(e,"background-color",t);var o=ao(e,"background-color").fold(()=>_.error("blah"),e=>_.value(t));return Jy(o)}}}})]),selectOnFocus:!1}),c=n.label.map(e=>Wx(e,r.providers)),d=(e,t)=>{F(e,lw,{value:t})},u=ie((s={dom:{tag:"span",attributes:{"aria-label":r.providers.translate("Color swatch")}},layouts:{onRtl:()=>[nl,ol,il],onLtr:()=>[ol,nl,il]},components:[],fetch:Dy(a.getColors(n.storageKey),n.storageKey,a.hasCustomColors()),columns:a.getColorCols(n.storageKey),presets:"color",onItemAction:(e,o)=>{u.getOpt(e).each(t=>{"custom"===o?a.colorPicker(e=>{e.fold(()=>B(t,cw),e=>{d(t,e),uy(n.storageKey,e)})},"#ffffff"):d(t,"remove"===o?"":o)})}},i=r,ux.sketch({dom:s.dom,components:s.components,toggleClass:"mce-active",dropdownBehaviours:re([ub(i.providers.isDisabled),db(),sw.config({}),Hx.config({})]),layouts:s.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:i.getSink,fetch:t=>Ky(e=>s.fetch(e)).map(e=>Q.from(vx(Fn(Vy(I("menu-value"),e,e=>{s.onItemAction(t,e)},s.columns,s.presets,sf.CLOSE_ON_EXECUTE,K,i.providers),{movement:zy(s.columns,s.presets)})))),parts:{menu:Of(0,0,s.presets)}})));return H.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:c.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[l,u.asSpec()]}]),fieldBehaviours:re([V("form-field-events",[ne(iw,(e,t)=>{u.getOpt(e).each(e=>{oe(e.element,"background-color",t.event.color)}),F(e,jx,{name:n.name})}),ne(lw,(t,o)=>{H.getField(t).each(e=>{y.setValue(e,o.event.value),R.getCurrent(t).each(z.focus)})}),ne(cw,(t,e)=>{H.getField(t).each(e=>{R.getCurrent(t).each(z.focus)})})])])})}}),colorpicker:Qk((e,t,o)=>{{t=t.shared.providers;const r=e=>"tox-"+e,a=J0((n=t,e=>n.translate(rS[e])),r),s=ie(a.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:e=>{F(e,qx,{name:"hex-valid",value:!0})},onInvalidHex:e=>{F(e,qx,{name:"hex-valid",value:!1})}}));var n;return{dom:{tag:"div"},components:[s.asSpec()],behaviours:re([tS(o,e=>{e=s.get(e);return R.getCurrent(e).bind(e=>y.getValue(e).hex).map(e=>"#"+et(e,"#")).getOr("")},(e,t)=>{const o=Q.from(/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(t)).bind(e=>Me(e,1)),n=s.get(e);R.getCurrent(n).fold(()=>{console.log("Can not find form")},e=>{y.setValue(e,{hex:o.getOr("")}),G0.getField(e,"hex").each(e=>{B(e,la())})})}),Z0()])}}}),dropzone:Qk((e,t,o)=>{{var n=e,r=t.shared.providers,a=o;const s=(e,t)=>{t.stop()},i=e=>(t,o)=>{ee(e,e=>{e(t,o)})},l=(e,t)=>{ae.isDisabled(e)||(t=t.event.raw,d(e,null==(e=t.dataTransfer)?void 0:e.files))},c=(e,t)=>{t=t.event.raw.target;d(e,t.files)},d=(e,t)=>{t&&(y.setValue(e,((e,t)=>{const o=sS.explode(t.getOption("images_file_types"));return ve(Fe(e),t=>ge(o,e=>ot(t.name.toLowerCase(),"."+e.toLowerCase())))})(t,r)),F(e,jx,{name:n.name}))},u=ie({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:re([V("input-file-events",[es(da()),es(ka())])])}),m=n.label.map(e=>Wx(e,r)),g=H.parts.field({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:re([nS(a.getOr([])),Z0(),ae.config({}),f.config({toggleClass:"dragenter",toggleOnExecute:!1}),V("dropzone-events",[ne("dragenter",i([s,f.toggle])),ne("dragleave",i([s,f.toggle])),ne("dragover",s),ne("drop",i([s,l])),ne(ca(),c)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p"},components:[ti(r.translate("Drop an image here"))]},Hp.sketch({dom:{tag:"button",styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[ti(r.translate("Browse for an image")),u.asSpec()],action:e=>{u.get(e).element.dom.click()},buttonBehaviours:re([Hx.config({}),ub(r.isDisabled),db()])})]}]})}});return Px(m,g,["tox-form__group--stretched"],[])}}),grid:Qk((e,t)=>{return e=e,t=t.shared,{dom:{tag:"div",classes:["tox-form__grid",`tox-form__grid--${e.columns}col`]},components:k(e.items,t.interpreter)}}),listbox:Qk((e,t,o)=>{{var n=e,r=t;e=o;const a=r.shared.providers,s=e.bind(e=>XS(n.items,e)).orThunk(()=>De(n.items).filter(GS)),i=n.label.map(e=>Wx(e,a)),l=H.parts.field({dom:{},factory:{sketch:e=>LS({uid:e.uid,text:s.map(e=>e.text),icon:Q.none(),tooltip:n.label,role:Q.none(),fetch:(e,t)=>{e=qS(e,n.name,n.items,y.getValue(e));t(jS(e,sf.CLOSE_ON_EXECUTE,r,{isHorizontalMenu:!1,search:Q.none()}))},onSetup:T(S),getApi:T({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Hx.config({}),tS(s.map(e=>e.value),e=>Yt(e.element,$S),(t,e)=>{XS(n.items,e).each(e=>{O(t.element,$S,e.value),F(t,zS,{text:e.text})})})]},"tox-listbox",r.shared)}}),c={dom:{tag:"div",classes:["tox-listboxfield"]},components:[l]};return H.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Se([i.toArray(),[c]]),fieldBehaviours:re([ae.config({disabled:T(!n.enabled),onDisabled:e=>{H.getField(e).each(ae.disable)},onEnabled:e=>{H.getField(e).each(ae.enable)}})])})}}),selectbox:Qk((e,t,o)=>{return n=e,r=t.shared.providers,e=o,t=k(n.items,e=>({text:r.translate(e.text),value:e.value})),o=n.label.map(e=>Wx(e,r)),e=H.parts.field({dom:{},...e.map(e=>({data:e})).getOr({}),selectAttributes:{size:n.size},options:t,factory:YS,selectBehaviours:re([ae.config({disabled:()=>!n.enabled||r.isDisabled()}),Hx.config({}),V("selectbox-change",[ne(ca(),(e,t)=>{F(e,jx,{name:n.name})})])])}),t=1<n.size?Q.none():Q.some(Yp("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},r.icons)),e={dom:{tag:"div",classes:["tox-selectfield"]},components:Se([[e],t.toArray()])},H.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Se([o.toArray(),[e]]),fieldBehaviours:re([ae.config({disabled:()=>!n.enabled||r.isDisabled(),onDisabled:e=>{H.getField(e).each(ae.disable)},onEnabled:e=>{H.getField(e).each(ae.enable)}}),db()])});var n,r}),sizeinput:Qk((e,t)=>{{var r=e,a=t.shared.providers;let n=ok;const s=I("ratio-event"),o=e=>Yp(e,{tag:"span",classes:["tox-icon","tox-lock-icon__"+e]},a.icons),i=QS.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:a.translate(r.label.getOr("Constrain proportions"))}},components:[o("lock"),o("unlock")],buttonBehaviours:re([ae.config({disabled:()=>!r.enabled||a.isDisabled()}),db(),Hx.config({})])}),l=e=>({dom:{tag:"div",classes:["tox-form__group"]},components:e}),c=o=>H.parts.field({factory:Af,inputClasses:["tox-textfield"],inputBehaviours:re([ae.config({disabled:()=>!r.enabled||a.isDisabled()}),db(),Hx.config({}),V("size-input-events",[ne(ra(),(e,t)=>{F(e,s,{isField1:o})}),ne(ca(),(e,t)=>{F(e,jx,{name:r.name})})])]),selectOnFocus:!1}),d=e=>({dom:{tag:"label",classes:["tox-label"]},components:[ti(a.translate(e))]}),u=QS.parts.field1(l([H.parts.label(d("Width")),c(!0)])),m=QS.parts.field2(l([H.parts.label(d("Height")),c(!1)]));return QS.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[u,m,l([d(" "),i])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:(e,t,o)=>{ek(y.getValue(e)).each(e=>{n(e).each(e=>{y.setValue(t,(e=>{var t,o={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4};let n=e.value.toFixed((t=e.unit)in o?o[t]:1);return(n=-1!==n.indexOf(".")?n.replace(/\.?0*$/,""):n)+e.unit})(e))})})},coupledFieldBehaviours:re([ae.config({disabled:()=>!r.enabled||a.isDisabled(),onDisabled:e=>{QS.getField1(e).bind(H.getField).each(ae.disable),QS.getField2(e).bind(H.getField).each(ae.disable),QS.getLock(e).each(ae.disable)},onEnabled:e=>{QS.getField1(e).bind(H.getField).each(ae.enable),QS.getField2(e).bind(H.getField).each(ae.enable),QS.getLock(e).each(ae.enable)}}),db(),V("size-input-events2",[ne(s,(e,t)=>{var t=t.event.isField1,o=t?QS.getField1(e):QS.getField2(e),t=t?QS.getField2(e):QS.getField1(e),e=o.map(y.getValue).getOr(""),o=t.map(y.getValue).getOr("");n=((e,t)=>{e=ek(e).toOptional(),t=ek(t).toOptional();return Ke(e,t,(e,n)=>tk(e,n.unit).map(e=>n.value/e).map(e=>{return t=e,o=n.unit,e=>tk(e,o).map(e=>({value:e*t,unit:o}));var t,o}).getOr(ok)).getOr(ok)})(e,o)})])])})}}),slider:Qk((e,t,o)=>{return n=e,e=t.shared.providers,t=o,e=z0.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[ti(e.translate(n.label))]}),o=z0.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),r=z0.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}}),z0.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:n.min,maxX:n.max,getInitialValue:T(t.getOrThunk(()=>(Math.abs(n.max)-Math.abs(n.min))/2))},components:[e,o,r],sliderBehaviours:re([Z0(),z.config({})]),onChoose:(e,t,o)=>{F(e,jx,{name:n.name,value:o})}});var n,r}),urlinput:Qk((e,t,o)=>{{var r=e,n=t,a=t.urlinput;e=o;const s=n.shared.providers,i=e=>{e=y.getValue(e);a.addToHistory(e.value,r.filetype)},l={...e.map(e=>({initialData:e})).getOr({}),dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":Kk,type:"url"},minChars:0,responseTime:0,fetch:e=>{e=((n,e,r)=>{const t=y.getValue(e),a=null!=(e=null==(e=null==t?void 0:t.meta)?void 0:e.text)?e:t.value;return r.getLinkInformation().fold(()=>[],e=>{var t,o=Yk(a,(o=r.getHistory(n),k(o,e=>qk(e,e))));return"file"===n?(e=[o,Yk(a,(t=e,Xk("header",t.targets))),Yk(a,Se([(t=e,Q.from(t.anchorTop).map(e=>qk("<top>",e)).toArray()),(t=e,Xk("anchor",t.targets)),(t=e,Q.from(t.anchorBottom).map(e=>qk("<bottom>",e)).toArray())]))],ye(e,(e,t)=>0===e.length||0===t.length?e.concat(t):e.concat(Gk,t),[])):o})})(r.filetype,e,a),e=jS(e,sf.BUBBLE_TO_SANDBOX,n,{isHorizontalMenu:!1,search:Q.none()});return Jy(e)},getHotspot:e=>h.getOpt(e),onSetValue:(e,t)=>{e.hasConfigured(aw)&&aw.run(e).get(S)},typeaheadBehaviours:re([...a.getValidationHandler().map(n=>aw.config({getRoot:e=>Mt(e.element),invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:(e,t)=>{u.getOpt(e).each(e=>{O(e.element,"title",s.translate(t))})}},validator:{validate:e=>{const t=y.getValue(e);return Vk(Ky(o=>{n({type:r.filetype,url:t.value},e=>{var t;"invalid"===e.status?(t=_.error(e.message),o(t)):(t=_.value(e.message),o(t))})}))},validateOnLoad:!1}})).toArray(),ae.config({disabled:()=>!r.enabled||s.isDisabled()}),Hx.config({}),V("urlinput-events",[ne(la(),e=>{var t=qs(e.element),o=t.trim();o!==t&&Xs(e.element,o),"file"===r.filetype&&F(e,jx,{name:r.name})}),ne(ca(),e=>{F(e,jx,{name:r.name}),i(e)}),ne(ya(),e=>{F(e,jx,{name:r.name}),i(e)})])]),eventOrder:{[la()]:["streaming","urlinput-events","invalidating"]},model:{getDisplayText:e=>e.value,selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:Of(0,0,"normal")},onExecute:(e,t,o)=>{F(t,Xx,{})},onItemExecute:(e,t,o,n)=>{i(e),F(e,jx,{name:r.name})}},c=H.parts.field({...l,factory:Nk}),d=r.label.map(e=>Wx(e,s)),u=ie(((e,t,o=e)=>Yp("warning",{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+e],attributes:{title:s.translate("invalid"),"aria-live":"polite",...t.fold(()=>({}),e=>({id:e}))}},s.icons))("invalid",Q.some(Kk))),m=ie({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[u.asSpec()]}),g=a.getUrlPicker(r.filetype),p=I("browser.url.event"),h=ie({dom:{tag:"div",classes:["tox-control-wrap"]},components:[c,m.asSpec()],behaviours:re([ae.config({disabled:()=>!r.enabled||s.isDisabled()})])}),f=ie(Uk({name:r.name,icon:Q.some("browse"),text:r.label.getOr(""),enabled:r.enabled,primary:!1,buttonType:Q.none(),borderless:!0},e=>B(e,p),s,[],["tox-browse-url"]));return H.sketch({dom:Ux([]),components:d.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Se([[h.asSpec()],g.map(()=>f.asSpec()).toArray()])}]),fieldBehaviours:re([ae.config({disabled:()=>!r.enabled||s.isDisabled(),onDisabled:e=>{H.getField(e).each(ae.disable),f.getOpt(e).each(ae.disable)},onEnabled:e=>{H.getField(e).each(ae.enable),f.getOpt(e).each(ae.enable)}}),db(),V("url-input-events",[ne(p,n=>{R.getCurrent(n).each(t=>{const e=y.getValue(t),o={fieldname:r.name,...e};g.each(e=>{e(o).get(e=>{y.setValue(t,e),F(n,jx,{name:r.name})})})})})])])})}}),customeditor:Qk(o=>{const n=Yl(),t=ie({dom:{tag:o.tag}}),r=Yl();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:re([V("custom-editor-events",[os(e=>{t.getOpt(e).each(t=>{var e;e=o,($e(e,"init")?o.init(t.element.dom):aS.load(o.scriptId,o.scriptUrl).then(e=>e(t.element.dom,o.settings))).then(t=>{r.on(e=>{t.setValue(e)}),r.clear(),n.set(t)})})})]),tS(Q.none(),()=>n.get().fold(()=>r.get().getOr(""),e=>e.getValue()),(e,t)=>{n.get().fold(()=>r.set(t),e=>e.setValue(t))}),Z0()]),components:[t.asSpec()]}}),htmlpanel:Qk(e=>"presentation"===e.presets?Ix.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html}}):Ix.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:e.html,attributes:{role:"document"}},containerBehaviours:re([Hx.config({}),z.config({})])})),imagepreview:Qk((e,t,o)=>{{const n=D(o.getOr({url:""})),r=ie({dom:{tag:"img",classes:["tox-imagepreview__image"],attributes:o.map(e=>({src:e.url})).getOr({})}}),d=ie({dom:{tag:"div",classes:["tox-imagepreview__container"],attributes:{role:"presentation"}},components:[r.asSpec()]}),a={};return e.height.each(e=>a.height=e),e=o.map(e=>({url:e.url,zoom:Q.from(e.zoom),cachedWidth:Q.from(e.cachedWidth),cachedHeight:Q.from(e.cachedHeight)})),{dom:{tag:"div",classes:["tox-imagepreview"],styles:a,attributes:{role:"presentation"}},components:[d.asSpec()],behaviours:re([Z0(),tS(e,()=>n.get(),(l,t)=>{const c={url:t.url},o=(t.zoom.each(e=>c.zoom=e),t.cachedWidth.each(e=>c.cachedWidth=e),t.cachedHeight.each(e=>c.cachedHeight=e),n.set(c),()=>{const{cachedWidth:e,cachedHeight:t,zoom:o}=c;if(!P(e)&&!P(t)){if(P(o)){n=l.element,r=e,a=t,s=wo(n),n=go(n);const o=Math.min(s/r,n/a,1);c.zoom=o}const i=((e,t,o,n,r)=>{o*=r,n*=r,r=Math.max(0,e/2-o/2),e=Math.max(0,t/2-n/2);return{left:r.toString()+"px",top:e.toString()+"px",width:o.toString()+"px",height:n.toString()+"px"}})(wo(l.element),go(l.element),e,t,c.zoom);d.getOpt(l).each(e=>{to(e.element,i)})}var n,r,a,s});r.getOpt(l).each(e=>{var a,e=e.element;t.url!==Yt(e,"src")&&(O(e,"src",t.url),Us(l.element,"tox-imagepreview__loaded")),o(),a=e,new Promise((e,t)=>{const o=()=>{r(),e(a)},n=[Jl(a,"load",o),Jl(a,"error",()=>{r(),t("Unable to load data from image: "+a.dom.src)})],r=()=>ee(n,e=>e.unbind());a.dom.complete&&o()}).then(e=>{l.getSystem().isConnected()&&(Ps(l.element,"tox-imagepreview__loaded"),c.cachedWidth=e.dom.naturalWidth,c.cachedHeight=e.dom.naturalHeight,o())})})})])}}}),table:Qk((e,t)=>{{var o=t.shared.providers;const n=e=>({dom:{tag:"td",innerHtml:o.translate(e)}});return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(t=e.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:k(t,e=>({dom:{tag:"th",innerHtml:o.translate(e)}}))}]}),(t=e.cells,{dom:{tag:"tbody"},components:k(t,e=>({dom:{tag:"tr"},components:k(e,n)}))})],behaviours:re([Hx.config({}),z.config({})])}}}),tree:Qk((e,t)=>{{var n=e,r=t;const a=n.onLeafAction.getOr(S),s=n.onToggleExpand.getOr(S),o=n.defaultExpandedIds,i=D(o),l=D(n.defaultSelectedId),c=I("tree-id"),d=(t,o)=>n.items.map(e=>"leaf"===e.type?Sk({leaf:e,selectedId:t,onLeafAction:a,visible:!0,treeId:c,backstage:r}):Tk({directory:e,selectedId:t,onLeafAction:a,expandedIds:o,labelTabstopping:!0,treeId:c,backstage:r}));return{dom:{tag:"div",classes:["tox-tree"],attributes:{role:"tree"}},components:d(l.get(),i.get()),behaviours:re([se.config({mode:"flow",selector:".tox-tree--leaf__label--visible, .tox-tree--directory__label--visible",cycles:!1}),V(Ek,[ne("expand-tree-node",(e,t)=>{const{expanded:o,node:n}=t.event;i.set(o?[...i.get(),n]:i.get().filter(e=>e!==n)),s(i.get(),{expanded:o,node:n})})]),_l.config({channels:{["update-active-item-"+c]:{onReceive:(e,t)=>{l.set(Q.some(t.value)),N.set(e,d(Q.some(t.value),i.get()))}}}}),N.config({})])}}}),panel:Qk((e,t)=>{return t=t,{dom:{tag:"div",classes:(e=e).classes},components:k(e.items,t.shared.interpreter)}})},tC={field:(e,t)=>t,record:T([])},oC=(t,e,o,n)=>{const r=Fn(n,{shared:{interpreter:e=>nC(t,e,o,r)}});return nC(t,e,o,r)},nC=(t,o,n,r)=>C(eC,o.type).fold(()=>(console.error(`Unknown factory type "${o.type}", defaulting to container: `,o),o),e=>e(t,o,n,r)),rC=(e,t,o)=>nC(tC,e,t,o),aC="layout-inset",sC=(e,t)=>e.x+e.width/2-t.width/2,iC=(e,t)=>e.x+e.width-t.width,lC=(e,t)=>e.y+e.height-t.height,cC=(e,t)=>e.y+e.height/2-t.height/2,dC=(e,t,o)=>Ni(iC(e,t),lC(e,t),o.insetSouthwest(),Pi(),"southwest",Xi(e,{right:0,bottom:3}),aC),uC=(e,t,o)=>Ni(e.x,lC(e,t),o.insetSoutheast(),Li(),"southeast",Xi(e,{left:1,bottom:3}),aC),mC=(e,t,o)=>Ni(iC(e,t),e.y,o.insetNorthwest(),Hi(),"northwest",Xi(e,{right:0,top:2}),aC),gC=(e,t,o)=>Ni(e.x,e.y,o.insetNortheast(),zi(),"northeast",Xi(e,{left:1,top:2}),aC),pC=(e,t,o)=>Ni(sC(e,t),e.y,o.insetNorth(),Ui(),"north",Xi(e,{top:2}),aC),hC=(e,t,o)=>Ni(sC(e,t),lC(e,t),o.insetSouth(),Wi(),"south",Xi(e,{bottom:3}),aC),fC=(e,t,o)=>Ni(iC(e,t),cC(e,t),o.insetEast(),Gi(),"east",Xi(e,{right:0}),aC),vC=(e,t,o)=>Ni(e.x,cC(e,t),o.insetWest(),ji(),"west",Xi(e,{left:1}),aC),bC=e=>{switch(e){case"north":return pC;case"northeast":return gC;case"northwest":return mC;case"south":return hC;case"southeast":return uC;case"southwest":return dC;case"east":return fC;case"west":return vC}},yC=(e,t,o,n,r)=>jl(n).map(bC).getOr(pC)(e,t,o,n,r),xC=e=>{switch(e){case"north":return hC;case"northeast":return uC;case"northwest":return dC;case"south":return pC;case"southeast":return gC;case"southwest":return mC;case"east":return vC;case"west":return fC}},wC=(e,t,o,n,r)=>jl(n).map(xC).getOr(pC)(e,t,o,n,r),SC={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},kC=(e,t,o)=>{const n={maxHeightFunction:ac()};return()=>o()?{type:"node",root:Pt(Lt(e())),node:Q.from(e()),bubble:cc(12,12,SC),layouts:{onRtl:()=>[gC],onLtr:()=>[mC]},overrides:n}:{type:"hotspot",hotspot:t(),bubble:cc(-12,12,SC),layouts:{onRtl:()=>[ol,nl,il],onLtr:()=>[nl,ol,il]},overrides:n}},CC=(e,t,o,n)=>{const r={maxHeightFunction:ac()};return()=>n()?{type:"node",root:Pt(Lt(t())),node:Q.from(t()),bubble:cc(12,12,SC),layouts:{onRtl:()=>[pC],onLtr:()=>[pC]},overrides:r}:e?{type:"node",root:Pt(Lt(t())),node:Q.from(t()),bubble:cc(0,-po(t()),SC),layouts:{onRtl:()=>[sl],onLtr:()=>[sl]},overrides:r}:{type:"hotspot",hotspot:o(),bubble:cc(0,0,SC),layouts:{onRtl:()=>[sl],onLtr:()=>[sl]},overrides:r}},OC=(e,t,o)=>()=>o()?{type:"node",root:Pt(Lt(e())),node:Q.from(e()),layouts:{onRtl:()=>[pC],onLtr:()=>[pC]}}:{type:"hotspot",hotspot:t(),layouts:{onRtl:()=>[il],onLtr:()=>[il]}},_C=(n,e)=>()=>({type:"selection",root:e(),getSelection:()=>{const e=n.selection.getRng(),t=n.model.table.getSelectedCells();if(1<t.length){const n=t[0],e=t[t.length-1],o={firstCell:te(n),lastCell:te(e)};return Q.some(o)}return Q.some(Fc.range(te(e.startContainer),e.startOffset,te(e.endContainer),e.endOffset))}}),TC=t=>e=>({type:"node",root:t(),node:e}),EC=e=>qe(e,"items"),AC=e=>qe(e,"format"),MC=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],DC=e=>ye(e,(e,t)=>{var o,n;return $e(t,"items")?(n=DC(t.items),{customFormats:e.customFormats.concat(n.customFormats),formats:e.formats.concat([{title:t.title,items:n.formats}])}):$e(t,"inline")||(n=t,$e(n,"block"))||(o=t,$e(o,"selector"))?(o="custom-"+(L(t.name)?t.name:t.title.toLowerCase()),{customFormats:e.customFormats.concat([{name:o,format:t}]),formats:e.formats.concat([{title:t.title,format:o,icon:t.icon}])}):{...e,formats:e.formats.concat(t)}},{customFormats:[],formats:[]}),BC=t=>gh(t).map(e=>{e=((t,e)=>{const o=DC(e),n=e=>{ee(e,e=>{t.formatter.has(e.name)||t.formatter.register(e.name,e.format)})};return t.formatter?n(o.customFormats):t.on("init",()=>{n(o.customFormats)}),o.formats})(t,e);return ph(t)?MC.concat(e):e}).getOr(MC),FC=(e,t,o)=>({...e,type:"formatter",isSelected:t(e.format),getStylePreview:o(e.format)}),IC=(r,e,a,s)=>{const i=e=>k(e,e=>{return EC(e)?(o=e,n=i(o.items),{...o,type:"submenu",getStyleItems:T(n)}):AC(e)?(o=e,FC(o,a,s)):(e=>{e=Re(e);return 1===e.length&&me(e,"title")})(e)?{...e,type:"separator"}:(n=e,e=L(n.name)?n.name:I(n.title),t="custom-"+e,n={...n,type:"formatter",format:t,isSelected:a(t),getStylePreview:s(t)},r.formatter.register(e,n),n);var t,o,n});return i(e)},RC=sS.trim,NC=o=>e=>{if(t=e,W(t)&&1===t.nodeType){if(e.contentEditable===o)return!0;if(e.getAttribute("data-mce-contenteditable")===o)return!0}var t;return!1},VC=NC("true"),zC=NC("false"),HC=(e,t,o,n,r)=>({type:e,title:t,url:o,level:n,attach:r}),LC=e=>e.innerText||e.textContent,PC=e=>e&&"A"===e.nodeName&&void 0!==(e.id||e.name)&&WC(e),UC=e=>e&&/^(H[1-6])$/.test(e.nodeName),WC=e=>(e=>{let t=e;for(;t=t.parentNode;){const e=t.contentEditable;if(e&&"inherit"!==e)return VC(t)}return!1})(e)&&!zC(e),jC=e=>UC(e)&&WC(e),GC=e=>{var t;const o=e.id||I("h");return HC("header",null!=(t=LC(e))?t:"","#"+o,(t=e,UC(t)?parseInt(t.nodeName.substr(1),10):0),()=>{e.id=o})},$C=e=>{var t=e.id||e.name,e=LC(e);return HC("anchor",e||"#"+t,"#"+t,0,S)},qC=e=>0<RC(e.title).length,XC=e=>{e=e;var t,e=k(Pc(te(e),"h1,h2,h3,h4,h5,h6,a:not([href])"),e=>e.dom);return ve((t=e,k(ve(t,jC),GC).concat((t=e,k(ve(t,PC),$C)))),qC)},YC="tinymce-url-history",KC=e=>L(e)&&/^https?/.test(e),JC=e=>v(e)&&je(e,e=>{return!(c(e=e)&&e.length<=5&&Ce(e,KC))}).isNone(),ZC=()=>{var e=ly.getItem(YC);if(null===e)return{};let t;try{t=JSON.parse(e)}catch(e){if(e instanceof SyntaxError)return console.log("Local storage "+YC+" was not valid JSON",e),{};throw e}return JC(t)?t:(console.log("Local storage "+YC+" was not valid format",t),{})},QC=e=>{var t=ZC();return C(t,e).getOr([])},eO=(t,e)=>{if(KC(t)){var o=ZC(),n=C(o,e).getOr([]),n=ve(n,e=>e!==t),e=(o[e]=[t].concat(n).slice(0,5),o);if(!JC(e))throw new Error("Bad format for history:\n"+JSON.stringify(e));ly.setItem(YC,JSON.stringify(e))}},tO=e=>!!e,oO=e=>ze(sS.makeMap(e,/[, ]/),tO),nO=e=>Q.from(Th(e)),rO=e=>Q.from(e).filter(L).getOrUndefined(),aO=n=>({getHistory:QC,addToHistory:eO,getLinkInformation:()=>{return e=n,Dh(e)?Q.some({targets:XC(e.getBody()),anchorTop:rO(Bh(e)),anchorBottom:rO(Fh(e))}):Q.none();var e},getValidationHandler:()=>{return e=n,Q.from(Eh(e));var e},getUrlPicker:e=>{return e=a=e,o=(e=>{const t=Q.from(Mh(e)).filter(tO).map(oO);return nO(e).fold(K,e=>t.fold(J,e=>0<Re(e).length&&e))})(t=r=n),(b(o)?o?nO(t):Q.none():o[e]?nO(t):Q.none()).map(n=>t=>Ky(o=>{var e={filetype:a,fieldname:t.fieldname,...Q.from(t.meta).getOr({})};n.call(r,(e,t)=>{if(!L(e))throw new Error("Expected value to be string");if(void 0!==t&&!v(t))throw new Error("Expected meta to be a object");o({value:e,meta:t})},t.value,e)}));var r,a,t,o}}),sO=Kc,iO=ld,lO=T([M("shell",!1),A("makeItem"),M("setupItem",S),Xd("listBehaviours",[N])]),cO=xu({name:"items",overrides:()=>({behaviours:re([N.config({})])})}),dO=T([cO]),uO=ju({name:T("CustomList")(),configFields:lO(),partFields:dO(),factory:(s,e,t,o)=>{e=s.shell?{behaviours:[N.config({})],components:[]}:{behaviours:[],components:e};return{uid:s.uid,dom:s.dom,components:e.components,behaviours:qd(s.listBehaviours,e.behaviours),apis:{setItems:(r,a)=>{var e=r;(s.shell?Q.some(e):Mu(e,s,"items")).fold(()=>{throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},t=>{var e=N.contents(t),o=a.length,n=o-e.length,n=0<n?pe(n,()=>s.makeItem()):[],e=e.slice(o),o=(ee(e,e=>N.remove(t,e)),ee(n,e=>N.append(t,e)),N.contents(t));ee(o,(e,t)=>{s.setupItem(r,e,a[t],t)})})}}}},apis:{setItems:(e,t,o)=>{e.setItems(t,o)}}}),mO=T([A("dom"),M("shell",!0),Gd("toolbarBehaviours",[N])]),gO=T([xu({name:"groups",overrides:()=>({behaviours:re([N.config({})])})})]),pO=ju({name:"Toolbar",configFields:mO(),partFields:gO(),factory:(o,e,t,n)=>{e=o.shell?{behaviours:[N.config({})],components:[]}:{behaviours:[],components:e};return{uid:o.uid,dom:o.dom,components:e.components,behaviours:qd(o.toolbarBehaviours,e.behaviours),apis:{setGroups:(e,t)=>{(o.shell?Q.some(e):Mu(e,o,"groups")).fold(()=>{throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},e=>{N.set(e,t)})},refresh:S},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)}}}),hO=S,fO=K,vO=T([]);var bO,yO=Object.freeze({__proto__:null,setup:hO,isDocked:fO,getBehaviours:vO});const xO=e=>(Xe(ao(e,"position"),"fixed")?Q.none():Dt(e)).orThunk(()=>{const t=it("span");return At(e).bind(e=>{on(e,t);e=Dt(t);return an(t),e})}),wO=e=>xO(e).map(bo).getOrThunk(()=>fo(0,0)),SO=(e,t)=>{var o=e.element;Ps(o,t.transitionClass),Us(o,t.fadeOutClass),Ps(o,t.fadeInClass),t.onShow(e)},kO=(e,t)=>{var o=e.element;Ps(o,t.transitionClass),Us(o,t.fadeInClass),Ps(o,t.fadeOutClass),t.onHide(e)},CO=(e,t)=>e.y>=t.y,OO=(e,t)=>e.bottom<=t.bottom,_O=(e,t,o)=>({location:"top",leftX:t,topY:o.bounds.y-e.y}),TO=(e,t,o)=>({location:"bottom",leftX:t,bottomY:e.bottom-o.bounds.bottom}),EO=e=>e.box.x-e.win.x,AO=(n,r,e)=>e.getInitialPos().map(e=>{t=e,o=r.optScrollEnv.fold(T(t.bounds.y),e=>e.scrollElmTop+(t.bounds.y-e.currentScrollTop));var t,o=fo(t.bounds.x,o);return{box:hn(o.left,o.top,wo(n),go(n)),location:e.location}}),MO=(e,t,o,n,r)=>{a=t,o=o.optScrollEnv.fold(T(a.y),e=>a.y+e.currentScrollTop-e.scrollElmTop);var a,o=fo(a.x,o),o=hn(o.left,o.top,t.width,t.height);n.setInitialPos({style:so(e),position:no(e,"position")||"static",bounds:o,location:r.location})},DO=(a,s,e)=>e.getInitialPos().bind(e=>{var t;switch(o.clearInitialPos(),e.position){case"static":return Q.some({morph:"static"});case"absolute":const o=xO(a).getOr(Gt()),n=fn(o),r=null!=(t=o.dom.scrollTop)?t:0;return Q.some({morph:"absolute",positionCss:Il("absolute",C(e.style,"left").map(e=>s.x-n.x),C(e.style,"top").map(e=>s.y-n.y+r),C(e.style,"right").map(e=>n.right-s.right),C(e.style,"bottom").map(e=>n.bottom-s.bottom))});default:return Q.none()}}),BO=e=>{switch(e.location){case"top":return Q.some({morph:"fixed",positionCss:Il("fixed",Q.some(e.leftX),Q.some(e.topY),Q.none(),Q.none())});case"bottom":return Q.some({morph:"fixed",positionCss:Il("fixed",Q.some(e.leftX),Q.none(),Q.none(),Q.some(e.bottomY))});default:return Q.none()}},FO=(e,t,o)=>{var n,r,a,s,i,l,c,d,e=e.element;return Xe(ao(e,"position"),"fixed")?(l=a=e,c=s=t,d=i=o,AO(l,c,d).filter(({box:e})=>{return t=d.getModes(),o=e,n=c,Ce(t,e=>{switch(e){case"bottom":return OO(o,n.bounds);case"top":return CO(o,n.bounds)}});var t,o,n}).bind(({box:e})=>DO(l,e,d)).orThunk(()=>s.optScrollEnv.bind(e=>AO(a,s,i)).bind(({box:e,location:t})=>{var o=yn(),e=EO({win:o,box:e}),t=("top"===t?_O:TO)(o,e,s);return BO(t)}))):(e=e,t=t,o=o,n=fn(e),r=yn(),"top"===(r=((e,t,o)=>{const n=t.win,r=t.box,a=EO(t);return Ie(e,e=>{switch(e){case"bottom":return OO(r,o.bounds)?Q.none():Q.some(TO(n,a,o));case"top":return CO(r,o.bounds)?Q.none():Q.some(_O(n,a,o));default:return Q.none()}}).getOr({location:"no-dock"})})(o.getModes(),{win:r,box:n},t)).location||"bottom"===r.location?(MO(e,n,t,o,r),BO(r)):Q.none())},IO=(t,e,o)=>{o.setDocked(!1),ee(["left","right","top","bottom","position"],e=>lo(t.element,e)),e.onUndocked(t)},RO=(e,t,o,n)=>{var r="fixed"===n.position;o.setDocked(r),Rl(e.element,n),(r?t.onDocked:t.onUndocked)(e)},NO=(n,e,r,a,s=!1)=>{e.contextual.each(o=>{o.lazyContext(n).each(e=>{t=a.bounds;var t,e=e.y<t.bottom&&e.bottom>t.y;e!==r.isVisible()&&(r.setVisible(e),s&&!e?(js(n.element,[o.fadeOutClass]),o.onHide(n)):(e?SO:kO)(n,o))})})},VO=(e,t,o,n,r)=>{NO(e,t,o,n,!0),RO(e,t,o,r.positionCss)},zO=(e,t,o)=>{if(e.getSystem().isConnected()){var s=e,i=t,l=o;const c=i.lazyViewport(s);NO(s,i,l,c),FO(s,c,l).each(e=>{var t=s,o=i,n=l,r=c,a=e;switch(a.morph){case"static":return void IO(t,o,n);case"absolute":return void RO(t,o,n,a.positionCss);case"fixed":VO(t,o,n,r,a)}})}},HO=(e,t,o)=>{if(o.isDocked()){var n=e,r=t,a=o;const s=n.element;a.setDocked(!1),((e,t)=>{const o=n.element;return AO(o,e,t).bind(({box:e})=>DO(o,e,t))})(r.lazyViewport(n),a).each(e=>{switch(e.morph){case"static":IO(n,r,a);break;case"absolute":RO(n,r,a,e.positionCss)}}),a.setVisible(!0),r.contextual.each(e=>{Gs(s,[e.fadeInClass,e.fadeOutClass,e.transitionClass]),e.onShow(n)}),zO(n,r,a)}},LO=h=>(t,o,n)=>{const r=o.lazyViewport(t);var e,a,s,i,l,c,d,u,m,g,p;e=t.element,a=r,s=n,i=h,g=fn(e),p=yn(),("bottom"===(i=i(p,EO({win:p,box:g}),a)).location||"top"===i.location?(l=e,c=g,d=a,m=i,(u=s).getInitialPos().fold(()=>MO(l,c,d,u,m),()=>S),BO(i)):Q.none()).each(e=>{VO(t,o,n,r,e)})},PO=LO(_O),UO=LO(TO);vg=Object.freeze({__proto__:null,refresh:zO,reset:HO,isDocked:(e,t,o)=>o.isDocked(),getModes:(e,t,o)=>o.getModes(),setModes:(e,t,o,n)=>o.setModes(n),forceDockToTop:PO,forceDockToBottom:UO}),Nm=Object.freeze({__proto__:null,events:(n,r)=>qa([ts(ma(),(t,o)=>{n.contextual.each(e=>{Ws(t.element,e.transitionClass)&&(Gs(t.element,[e.transitionClass,e.fadeInClass]),(r.isVisible()?e.onShown:e.onHidden)(t)),o.stop()})}),ne(Ma(),(e,t)=>{zO(e,n,r)}),ne(za(),(e,t)=>{zO(e,n,r)}),ne(Da(),(e,t)=>{HO(e,n,r)})])}),fl=[Mr("contextual",[br("fadeInClass"),br("fadeOutClass"),br("transitionClass"),xr("lazyContext"),e("onShow"),e("onShown"),e("onHide"),e("onHidden")]),Nr("lazyViewport",()=>({bounds:yn(),optScrollEnv:Q.none()})),Vr("modes",["top","bottom"],er),e("onDocked"),e("onUndocked")];const WO=Sl({fields:fl,name:"docking",active:Nm,apis:vg,state:Object.freeze({__proto__:null,init:e=>{const t=D(!1),o=D(!0),n=Yl(),r=D(e.modes);return Ms({isDocked:t.get,setDocked:t.set,getInitialPos:n.get,setInitialPos:n.set,clearInitialPos:n.clear,isVisible:o.get,setVisible:o.set,getModes:r.get,setModes:r.set,readState:()=>`docked:  ${t.get()}, visible: ${o.get()}, modes: `+r.get().join(",")})}})}),jO=T(I("toolbar-height-change")),GO={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},$O="tox-tinymce--toolbar-sticky-on",qO="tox-tinymce--toolbar-sticky-off",XO=(e,t)=>me(WO.getModes(e),t),YO=n=>{const r=n.element;Mt(r).each(e=>{var t,o="padding-"+WO.getModes(n)[0];if(WO.isDocked(n)){const n=wo(e);oe(r,"width",n+"px"),oe(e,o,(t=r,po(t)+(parseInt(no(t,"margin-top"),10)||0)+(parseInt(no(t,"margin-bottom"),10)||0)+"px"))}else lo(r,"width"),lo(e,o)})},KO=(e,t)=>{t?(Us(e,GO.fadeOutClass),js(e,[GO.transitionClass,GO.fadeInClass])):(Us(e,GO.fadeInClass),js(e,[GO.fadeOutClass,GO.transitionClass]))},JO=(e,t)=>{e=te(e.getContainer());t?(Ps(e,$O),Us(e,qO)):(Ps(e,qO),Us(e,$O))},ZO=(a,e)=>{const s=Yl(),o=e.getSink,n=t=>{o().each(e=>t(e.element))},t=e=>{a.inline||YO(e),JO(a,WO.isDocked(e)),e.getSystem().broadcastOn([Nd()],{}),o().each(e=>e.getSystem().broadcastOn([Nd()],{}))},r=a.inline?[]:[_l.config({channels:{[jO()]:{onReceive:YO}}})];return[z.config({}),WO.config({contextual:{lazyContext:n=>{const r=po(n.element),e=a.inline?a.getContentAreaContainer():a.getContainer();return Q.from(e).map(e=>{const o=fn(te(e));return Sx(a,n.element).fold(()=>{var e=o.height-r,t=o.y+(XO(n,"top")?0:r);return hn(o.x,t,o.width,e)},e=>{var e=bn(o,kx(e)),t=XO(n,"top")?e.y:e.y+r;return hn(e.x,t,e.width,e.height-r)})})},onShow:()=>{n(e=>KO(e,!0))},onShown:r=>{n(e=>Gs(e,[GO.transitionClass,GO.fadeInClass])),s.get().each(e=>{{var t=r.element,o=e;const n=Ot(o);Dl(n).filter(e=>!kt(o,e)).filter(e=>kt(e,te(n.dom.body))||Ct(t,e)).each(()=>El(o))}s.clear()})},onHide:e=>{var t;e=e.element,t=o,Bl(e).orThunk(()=>t().toOptional().bind(e=>Bl(e.element))).fold(s.clear,s.set),n(e=>KO(e,!1))},onHidden:()=>{n(e=>Gs(e,[GO.transitionClass]))},...GO},lazyViewport:n=>Sx(a,n.element).fold(()=>{var e=yn(),t=Ch(a),o=e.y+(XO(n,"top")?t:0),t=e.height-(XO(n,"bottom")?t:0);return{bounds:hn(e.x,o,e.width,t),optScrollEnv:Q.none()}},e=>({bounds:kx(e),optScrollEnv:Q.some({currentScrollTop:e.element.dom.scrollTop,scrollElmTop:bo(e.element).top})})),modes:[e.header.getDockingMode()],onDocked:t,onUndocked:t}),...r]};var QO=Object.freeze({__proto__:null,setup:(e,t,o)=>{e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",()=>{o().each(WO.reset)}),e.on("ResizeWindow ResizeEditor",()=>{o().each(YO)}),e.on("SkinLoaded",()=>{o().each(e=>{WO.isDocked(e)?WO.reset(e):WO.refresh(e)})}),e.on("FullscreenStateChanged",()=>{o().each(WO.reset)})),e.on("AfterScrollIntoView",u=>{o().each(e=>{WO.refresh(e);e=e.element;if(Gm(e)){var t=u,o=Ot(e),n=Et(e).dom.innerHeight,r=sn(o),t=te(t.elm),a=vn(t),s=go(t),t=(a=a.y)+s,i=bo(e),e=go(e),l=(i=i.top)+e,c=Math.abs(i-r.top)<2,d=Math.abs(l-(r.top+n))<2;if(c&&a<l)ln(r.left,a-e,o);else if(d&&i<t){const t=a-n+s+e;ln(r.left,t,o)}}})}),e.on("PostRender",()=>{JO(e,!1)})},isDocked:e=>e().map(WO.isDocked).getOr(!1),getBehaviours:ZO});const e_=E([qf,vr("items",Xn([Kn([Xf,kr("items",er)]),er]))].concat(kv)),t_=[_r("text"),_r("tooltip"),_r("icon"),Dr("search",!1,Xn([tr,E([_r("placeholder")])],e=>b(e)?e?Q.some({placeholder:Q.none()}):Q.none():Q.some(e))),xr("fetch"),Nr("onSetup",()=>S)],o_=E([qf,...t_]),n_=e=>lr("menubutton",o_,e),r_=E([qf,lv,iv,sv,uv,ev,rv,Ir("presets","normal",["normal","color","listpreview"]),fv(1),ov,nv]);var a_=Wu({factory:(t,o)=>{var e={focus:se.focusIn,setMenus:(e,t)=>{t=k(t,t=>{var e={type:"menubutton",text:t.text,fetch:e=>{e(t.getItems())}},e=n_(e).mapError(e=>ur(e)).getOrDie();return bk(e,"tox-mbtn",o.backstage,Q.some("menuitem"))});N.set(e,t)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:re([N.config({}),V("menubar-events",[os(e=>{t.onSetup(e)}),ne(na(),(o,e)=>{pi(o.element,".tox-mbtn--active").each(t=>{hi(e.event.target,".tox-mbtn").each(e=>{kt(t,e)||o.getSystem().getByDom(t).each(t=>{o.getSystem().getByDom(e).each(e=>{ux.expand(e),ux.close(t),z.focus(e)})})})})}),ne(Na(),(o,e)=>{e.event.prevFocus.bind(e=>o.getSystem().getByDom(e).toOptional()).each(t=>{e.event.newFocus.bind(e=>o.getSystem().getByDom(e).toOptional()).each(e=>{ux.isOpen(t)&&(ux.expand(e),ux.close(t))})})})]),se.config({mode:"flow",selector:".tox-mbtn",onEscape:e=>(t.onEscape(e),Q.some(!0))}),Hx.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[A("dom"),A("uid"),A("onEscape"),A("backstage"),M("onSetup",S)],apis:{focus:(e,t)=>{e.focus(t)},setMenus:(e,t,o)=>{e.setMenus(t,o)}}});const s_="container",i_=[Gd("slotBehaviours",[])],l_=e=>"<alloy.field."+e+">",c_=(r,e)=>{const t=e=>Iu(r),o=(o,n)=>(e,t)=>Mu(e,r,t).map(e=>o(e,t)).getOr(n),n=(e,t)=>"true"!==Yt(e.element,"aria-hidden"),a=o(n,!1),s=o((e,t)=>{var o;n(e)&&(o=e.element,oe(o,"display","none"),O(o,"aria-hidden","true"),F(e,Va(),{name:t,visible:!1}))}),i=(t,e)=>{ee(e,e=>d(t,e))},l=o((e,t)=>{var o;n(e)||(o=e.element,lo(o,"display"),Zt(o,"aria-hidden"),F(e,Va(),{name:t,visible:!0}))}),c={getSlotNames:t,getSlot:(e,t)=>Mu(e,r,t),isShowing:a,hideSlot:d=s,hideAllSlots:e=>i(e,t()),showSlot:l};var d;return{uid:r.uid,dom:r.dom,components:e,behaviours:$d(r.slotBehaviours),apis:c}},d_=ze({getSlotNames:(e,t)=>e.getSlotNames(t),getSlot:(e,t,o)=>e.getSlot(t,o),isShowing:(e,t,o)=>e.isShowing(t,o),hideSlot:(e,t,o)=>e.hideSlot(t,o),hideAllSlots:(e,t)=>e.hideAllSlots(t),showSlot:(e,t,o)=>e.showSlot(t,o)},e=>Es(e)),u_={...d_,sketch:e=>{var t=(()=>{const o=[];return{slot:(e,t)=>(o.push(e),Ou(s_,l_(e),t)),record:T(o)}})(),e=e(t),t=t.record(),t=k(t,e=>bu({name:e,pname:l_(e)}));return Hu(s_,i_,t,c_,e)}},m_=E([iv,lv,Nr("onShow",S),Nr("onHide",S),rv]),g_=e=>({element:()=>e.element.dom}),p_=t=>u_.sketch(e=>({dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:((o,n)=>{const r=k(Re(n),e=>{var t=n[e],t=cr((t=t,lr("sidebar",m_,t)));return{name:e,getApi:g_,onSetup:t.onSetup,onShow:t.onShow,onHide:t.onHide}});return k(r,e=>{var t=D(S);return o.slot(e.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:eb([hb(e,t),fb(e,t),ne(Va(),(t,e)=>{const o=e.event,n=xe(r,e=>e.name===o.name);n.each(e=>{(o.visible?e.onShow:e.onHide)(e.getApi(t))})})])})})})(e,t),slotBehaviours:eb([os(e=>u_.hideAllSlots(e))])})),h_=(e,t)=>{O(e,"role",t)},f_=e=>R.getCurrent(e).bind(e=>fk.isGrowing(e)||fk.hasGrown(e)?R.getCurrent(e).bind(t=>xe(u_.getSlotNames(t),e=>u_.isShowing(t,e))):Q.none()),v_=I("FixSizeEvent"),b_=I("AutoSizeEvent");zx=Object.freeze({__proto__:null,block:(e,t,o,n)=>{O(e.element,"aria-busy",!0);const r=t.getRoot(e).getOr(e),a=re([se.config({mode:"special",onTab:()=>Q.some(!0),onShiftTab:()=>Q.some(!0)}),z.config({})]),s=n(r,a),i=r.getSystem().build(s);N.append(r,si(i)),i.hasConfigured(se)&&t.focus&&se.focusIn(i),o.isBlocked()||t.onBlock(e),o.blockWith(()=>N.remove(r,i))},unblock:(e,t,o)=>{Zt(e.element,"aria-busy"),o.isBlocked()&&t.onUnblock(e),o.clear()},isBlocked:(e,t,o)=>o.isBlocked()}),bc=[Nr("getRoot",Q.none),Rr("focus",!0),e("onBlock"),e("onUnblock")];const y_=Sl({fields:bc,name:"blocking",apis:zx,state:Object.freeze({__proto__:null,init:()=>{const t=ql(e=>e.destroy());return Ms({readState:t.isSet,blockWith:e=>{t.set({destroy:e})},clear:t.clear,isBlocked:t.isSet})}})}),x_=e=>{const t=((e,t)=>{t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length){const t="HTML does not have a single root node";throw console.error(t,e),new Error(t)}return st(t.childNodes[0])})(e),o=Bt(t),n=(e=void 0!==t.dom.attributes?t.dom.attributes:[],ye(e,(e,t)=>"class"===t.name?e:{...e,[t.name]:t.value},{})),r=(e=t,Array.prototype.slice.call(e.dom.classList,0)),a=0===o.length?{}:{innerHtml:ss(t)};return{tag:gt(t),classes:r,attributes:n,...a}},w_=e=>R.getCurrent(e).each(e=>El(e.element)),S_=(u,m,g)=>{const p=D(!1),o=Yl(),t=e=>{var t;!p.get()||"focusin"===(t=e).type&&(t.composed?De(t.composedPath()):Q.from(t.target)).map(te).filter(ft).exists(e=>Ws(e,"mce-pastebin"))||(e.preventDefault(),w_(m()),u.editorManager.setActive(u))},n=(u.inline||u.on("PreInit",()=>{u.dom.bind(u.getWin(),"focusin",t),u.on("BeforeExecCommand",e=>{"mcefocus"===e.command.toLowerCase()&&!0!==e.value&&t(e)})}),e=>{if(e!==p.get()){p.set(e);var o,t=u,n=m(),r=e,a=g.providers,s=n.element;{var i=t,l=r;const c="tabindex",d="data-mce-"+c;Q.from(i.iframeElement).map(te).each(t=>{l?(Kt(t,c).each(e=>O(t,d,e)),O(t,c,-1)):(Zt(t,c),Kt(t,d).each(e=>{O(t,c,e),Zt(t,d)}))})}if(r)y_.block(n,(o=a,(e,t)=>({dom:{tag:"div",attributes:{"aria-label":o.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:x_('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}))),lo(s,"display"),Zt(s,"aria-hidden"),t.hasFocus()&&w_(n);else{const r=R.getCurrent(n).exists(e=>Ml(e.element));y_.unblock(n),oe(s,"display","none"),O(s,"aria-hidden","true"),r&&t.focus()}u.dispatch("AfterProgressState",{state:e})}});u.on("ProgressState",e=>{var t;o.on(clearTimeout),h(e.time)?(t=zp.setEditorTimeout(u,()=>n(e.state),e.time),o.set(t)):(n(e.state),o.clear())})},k_=(e,t,o)=>({within:e,extra:t,withinWidth:o}),C_=(e,t,r)=>{var e=ye(e,(t,e)=>{return e=e,o=t.len,n=r(e),Q.some({element:e,start:o,finish:o+n,width:n}).fold(T(t),e=>({len:e.finish,list:t.list.concat([e])}));var o,n},{len:0,list:[]}).list,o=ve(e,e=>e.finish<=t),n=be(o,(e,t)=>e+t.width,0);return{within:o,extra:e.slice(o.length),withinWidth:n}},O_=e=>k(e,e=>e.element),__=(e,t)=>{t=k(t,e=>si(e));pO.setGroups(e,t)},T_=(e,t,o)=>{var n,r,a,s,i,l,c,d,u,m,g=t.builtGroups.get();0!==g.length&&(n=Du(e,t,"primary"),e=Gy.getCoupled(e,"overflowGroup"),oe(n.element,"visibility","hidden"),g=g.concat([e]),r=Ie(g,t=>Bl(t.element).bind(e=>t.getSystem().getByDom(e).toOptional())),o([]),__(n,g),a=wo(n.element),s=t.builtGroups.get(),l=e,g=((e,t,o)=>{t=C_(t,e,o);return 0===t.extra.length?Q.some(t):Q.none()})(a,s,i=e=>wo(e.element)).getOrThunk(()=>C_(s,a-i(l),i)),t=g.within,m=g.extra,g=g.withinWidth,0===(g=1===m.length&&m[0].width<=i(l)?(d=t,c=m,u=g,d=O_(d.concat(c)),k_(d,[],u)):1<=m.length?(c=t,d=m,u=l,m=g,c=O_(c).concat([u]),k_(c,O_(d),m)):(m=t,t=g,k_(O_(m),[],t))).extra.length?(N.remove(n,e),o([])):(__(n,g.within),o(g.extra)),lo(n.element,"visibility"),co(n.element),r.each(z.focus))},E_=T([Gd("splitToolbarBehaviours",[Gy]),hr("builtGroups",()=>D([]))]),A_=T([Ei(["overflowToggledClass"]),Er("getOverflowBounds"),A("lazySink"),hr("overflowGroups",()=>D([])),e("onOpened"),e("onClosed")].concat(E_())),M_=T([bu({factory:pO,schema:mO(),name:"primary"}),yu({schema:mO(),name:"overflow"}),yu({name:"overflow-button"}),yu({name:"overflow-group"})]),D_=T((e,t)=>{t=Math.floor(t);t=xo.max(e,t,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]),oe(e,"max-width",t+"px")}),B_=T([Ei(["toggledClass"]),A("lazySink"),xr("fetch"),Er("getBounds"),Mr("fireDismissalEventInstead",[M("event",Ia())]),fc(),e("onToggled")]),F_=T([yu({name:"button",overrides:e=>({dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:re([f.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1,onToggled:e.onToggled})])})}),yu({factory:pO,schema:mO(),name:"toolbar",overrides:t=>({toolbarBehaviours:re([se.config({mode:"cyclic",onEscape:e=>(Mu(e,t,"button").each(z.focus),Q.none())})])})})]),I_=Yl(),R_=(e,t)=>{e=Gy.getCoupled(e,"toolbarSandbox");m.isOpen(e)?m.close(e):m.open(e,t.toolbar())},N_=(e,t,o,n)=>{var r=o.getBounds.map(e=>e()),o=o.lazySink(e).getOrDie();gd.positionWithinBounds(o,t,{anchor:{type:"hotspot",hotspot:e,layouts:n,overrides:{maxWidthFunction:D_()}}},r)},V_=(e,t,o,n,r)=>{pO.setGroups(t,r),N_(e,t,o,n),f.on(e)},z_=ju({name:"FloatingToolbarButton",factory:(i,e,l,o)=>({...Hp.sketch({...o.button(),action:e=>{R_(e,o)},buttonBehaviours:Yd({dump:o.button().buttonBehaviours},[Gy.config({others:{toolbarSandbox:e=>{{var n=e,r=l,a=i;const s=vi();return{dom:{tag:"div",attributes:{id:s.id}},behaviours:re([se.config({mode:"special",onEscape:e=>(m.close(e),Q.some(!0))}),m.config({onOpen:(e,t)=>{const o=I_.get().getOr(!1);a.fetch().get(e=>{V_(n,t,a,r.layouts,e),s.link(n.element),o||se.focusIn(t)})},onClose:()=>{f.off(n),I_.get().getOr(!1)||z.focus(n),s.unlink(n.element)},isPartOf:(e,t,o)=>bi(t,o)||bi(n,o),getAttachPoint:()=>a.lazySink(n).getOrDie()}),_l.config({channels:{...Hd({isExtraPart:K,...a.fireDismissalEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({})}),...Pd({doReposition:()=>{m.getState(Gy.getCoupled(n,"toolbarSandbox")).each(e=>{N_(n,e,a,r.layouts)})}})}})])}}}}})])}),apis:{setGroups:(t,o)=>{m.getState(Gy.getCoupled(t,"toolbarSandbox")).each(e=>{V_(t,e,i,l.layouts,o)})},reposition:t=>{m.getState(Gy.getCoupled(t,"toolbarSandbox")).each(e=>{N_(t,e,i,l.layouts)})},toggle:e=>{R_(e,o)},toggleWithoutFocusing:e=>{var t;e=e,t=o,I_.set(!0),R_(e,t),I_.clear()},getToolbar:e=>m.getState(Gy.getCoupled(e,"toolbarSandbox")),isOpen:e=>m.isOpen(Gy.getCoupled(e,"toolbarSandbox"))}}),configFields:B_(),partFields:F_(),apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},toggleWithoutFocusing:(e,t)=>{e.toggleWithoutFocusing(t)},getToolbar:(e,t)=>e.getToolbar(t),isOpen:(e,t)=>e.isOpen(t)}}),H_=T([A("items"),Ei(["itemSelector"]),Gd("tgroupBehaviours",[se])]),L_=T([wu({name:"items",unit:"item"})]),P_=ju({name:"ToolbarGroup",configFields:H_(),partFields:L_(),factory:(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,behaviours:qd(e.tgroupBehaviours,[se.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}})}),U_=e=>k(e,e=>si(e)),W_=(e,o,n)=>{T_(e,n,t=>{n.overflowGroups.set(t),o.getOpt(e).each(e=>{z_.setGroups(e,U_(t))})})},j_=ju({name:"SplitFloatingToolbar",configFields:A_(),partFields:M_(),factory:(o,e,t,n)=>{const r=ie(z_.sketch({fetch:()=>Ky(e=>{e(U_(o.overflowGroups.get()))}),layouts:{onLtr:()=>[nl,ol],onRtl:()=>[ol,nl],onBottomLtr:()=>[al,rl],onBottomRtl:()=>[rl,al]},getBounds:t.getOverflowBounds,lazySink:o.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:o.markers.overflowToggledClass},parts:{button:n["overflow-button"](),toolbar:n.overflow()},onToggled:(e,t)=>o[t?"onOpened":"onClosed"](e)}));return{uid:o.uid,dom:o.dom,components:e,behaviours:qd(o.splitToolbarBehaviours,[Gy.config({others:{overflowGroup:()=>P_.sketch({...n["overflow-group"](),items:[r.asSpec()]})}})]),apis:{setGroups:(e,t)=>{o.builtGroups.set(k(t,e.getSystem().build)),W_(e,r,o)},refresh:e=>W_(e,r,o),toggle:e=>{r.getOpt(e).each(e=>{z_.toggle(e)})},toggleWithoutFocusing:e=>{r.getOpt(e).each(z_.toggleWithoutFocusing)},isOpen:e=>r.getOpt(e).map(z_.isOpen).getOr(!1),reposition:e=>{r.getOpt(e).each(e=>{z_.reposition(e)})},getOverflow:e=>r.getOpt(e).bind(z_.getToolbar)},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},refresh:(e,t)=>{e.refresh(t)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},toggleWithoutFocusing:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t),getOverflow:(e,t)=>e.getOverflow(t)}}),G_=T([Ei(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),e("onOpened"),e("onClosed")].concat(E_())),$_=T([bu({factory:pO,schema:mO(),name:"primary"}),bu({factory:pO,schema:mO(),name:"overflow",overrides:t=>({toolbarBehaviours:re([fk.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:e=>{Mu(e,t,"overflow-button").each(e=>{f.off(e),z.focus(e)}),t.onClosed(e)},onGrown:e=>{se.focusIn(e),t.onOpened(e)},onStartGrow:e=>{Mu(e,t,"overflow-button").each(f.on)}}),se.config({mode:"acyclic",onEscape:e=>(Mu(e,t,"overflow-button").each(z.focus),Q.some(!0))})])})}),yu({name:"overflow-button",overrides:e=>({buttonBehaviours:re([f.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])})}),yu({name:"overflow-group"})]),q_=(t,o)=>{Mu(t,o,"overflow-button").bind(()=>Mu(t,o,"overflow")).each(e=>{X_(t,o),fk.toggleGrow(e)})},X_=(e,o)=>{Mu(e,o,"overflow").each(t=>{T_(e,o,e=>{e=k(e,e=>si(e));pO.setGroups(t,e)}),Mu(e,o,"overflow-button").each(e=>{fk.hasGrown(t)&&f.on(e)}),fk.refresh(t)})},Y_=ju({name:"SplitSlidingToolbar",configFields:G_(),partFields:$_(),factory:(n,e,t,o)=>{const r="alloy.toolbar.toggle";return{uid:n.uid,dom:n.dom,components:e,behaviours:qd(n.splitToolbarBehaviours,[Gy.config({others:{overflowGroup:t=>P_.sketch({...o["overflow-group"](),items:[Hp.sketch({...o["overflow-button"](),action:e=>{B(t,r)}})]})}}),V("toolbar-toggle-events",[ne(r,e=>{q_(e,n)})])]),apis:{setGroups:(e,t)=>{var o=e;t=k(t,o.getSystem().build),n.builtGroups.set(t),X_(e,n)},refresh:e=>X_(e,n),toggle:e=>q_(e,n),isOpen:e=>{return e=e,t=n,Mu(e,t,"overflow").map(fk.hasGrown).getOr(!1);var t}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},refresh:(e,t)=>{e.refresh(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t)}}),K_=e=>{return{dom:{tag:"div",classes:["tox-toolbar__group"],...e.title.fold(()=>({}),e=>({attributes:{title:e}}))},components:[P_.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled]), .tox-number-input:not([disabled])"},tgroupBehaviours:re([Hx.config({}),z.config({})])}},J_=e=>P_.sketch(K_(e)),Z_=(o,e)=>{var t=os(e=>{var t=k(o.initGroups,J_);pO.setGroups(e,t)});return re([gb(o.providers.isDisabled),db(),se.config({mode:e,onEscape:o.onEscape,selector:".tox-toolbar__group"}),V("toolbar-events",[t])])},Q_=e=>{var t=e.cyclicKeying?"cyclic":"acyclic";return{uid:e.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":K_({title:Q.none(),items:[]}),"overflow-button":Hk({name:"more",icon:Q.some("more-drawer"),enabled:!0,tooltip:Q.some("Reveal or hide additional toolbar items"),primary:!1,buttonType:Q.none(),borderless:!1},Q.none(),e.providers)},splitToolbarBehaviours:Z_(e,t)}},eT=e=>{var t=e.cyclicKeying?"cyclic":"acyclic";return pO.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===Zp.scrolling?["tox-toolbar--scrolling"]:[])},components:[pO.parts.groups({})],toolbarBehaviours:Z_(e,t)})},tT=[sv,iv,_r("tooltip"),Ir("buttonType","secondary",["primary","secondary"]),Rr("borderless",!1),xr("onAction")],oT={button:[...tT,Kf,yr("type",["button"])],togglebutton:[...tT,Rr("active",!1),yr("type",["togglebutton"])]},nT=[yr("type",["group"]),Vr("buttons",[],mr("type",oT))],rT=mr("type",{...oT,group:nT}),aT=E([Vr("buttons",[],rT),xr("onShow"),xr("onHide")]),sT=(e,t)=>{{var n=e,r=t,o;const a="togglebutton"===n.type,s=n.icon.map(e=>NS(e,r.icons)).map(ie),i={...n,name:a?n.text.getOr(n.icon.getOr("")):null!=(o=n.text)?o:n.icon.getOr(""),primary:"primary"===n.buttonType,buttonType:Q.from(n.buttonType),tooltip:n.tooltip,icon:n.icon,enabled:!0,borderless:n.borderless},l=Lk(null!=(o=n.buttonType)?o:"secondary"),c=a?n.text.map(r.translate):Q.some(r.translate(n.text)),d=c.map(ti),u=i.tooltip.or(c).map(e=>({"aria-label":r.translate(e),title:r.translate(e)})).getOr({}),m=s.map(e=>e.asSpec()),g=bb([m,d]),p=n.icon.isSome()&&d.isSome(),h={tag:"button",classes:l.concat(...n.icon.isSome()&&!p?["tox-button--icon"]:[]).concat(...p?["tox-button--icon-and-text"]:[]).concat(...n.borderless?["tox-button--naked"]:[]).concat(..."togglebutton"===n.type&&n.active?["tox-button--enabled"]:[]),attributes:u},f=zk(i,Q.some(o=>{var e=t=>{s.map(e=>e.getOpt(o).each(e=>{N.set(e,[NS(t,r.icons)])}))};return a?n.onAction({setIcon:e,setActive:e=>{var t=o.element;e?(Ps(t,"tox-button--enabled"),O(t,"aria-pressed",!0)):(Us(t,"tox-button--enabled"),Zt(t,"aria-pressed"))},isActive:()=>Ws(o.element,"tox-button--enabled")}):"button"===n.type?n.onAction({setIcon:e}):void 0}),[],h,g,r);return Hp.sketch(f)}},iT=Yo().deviceType,lT=iT.isPhone(),cT=iT.isTablet();var dT=ju({name:"silver.View",configFields:[A("viewConfig")],partFields:[xu({factory:{sketch:n=>{let r=!1;var e=k(n.buttons,e=>{return"group"===e.type?(r=!0,t=e,o=n.providers,{dom:{tag:"div",classes:["tox-view__toolbar__group"]},components:k(t.buttons,e=>sT(e,o))}):sT(e,n.providers);var t,o});return{uid:n.uid,dom:{tag:"div",classes:[r?"tox-view__toolbar":"tox-view__header",...lT||cT?["tox-view--mobile","tox-view--scrolling"]:[]]},behaviours:re([z.config({}),se.config({mode:"flow",selector:"button, .tox-button",focusInside:dm.OnEnterOrSpaceMode})]),components:r?e:[Ix.sketch({dom:{tag:"div",classes:["tox-view__header-start"]},components:[]}),Ix.sketch({dom:{tag:"div",classes:["tox-view__header-end"]},components:e})]}}},schema:[A("buttons"),A("providers")],name:"header"}),xu({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-view__pane"]}})},schema:[],name:"pane"})],factory:(t,e,o,n)=>{return{uid:t.uid,dom:t.dom,components:e,apis:{getPane:e=>sO.getPart(e,t,"pane"),getOnShow:e=>t.viewConfig.onShow,getOnHide:e=>t.viewConfig.onHide}}},apis:{getPane:(e,t)=>e.getPane(t),getOnShow:(e,t)=>e.getOnShow(t),getOnHide:(e,t)=>e.getOnHide(t)}});const uT=(t,r)=>u_.sketch(e=>{return{dom:{tag:"div",classes:["tox-view-wrap__slot-container"]},components:(o=e,e=t,n=r,We(e,(e,t)=>{e=cr(lr("view",aT,e));return o.slot(t,dT.sketch({dom:{tag:"div",classes:["tox-view"]},viewConfig:e,components:[...0<e.buttons.length?[dT.parts.header({buttons:e.buttons,providers:n})]:[],dT.parts.pane({})]}))})),slotBehaviours:eb([os(e=>u_.hideAllSlots(e))])};var o,n}),mT=t=>xe(u_.getSlotNames(t),e=>u_.isShowing(t,e)),gT=(e,t,o)=>{u_.getSlot(e,t).each(t=>{dT.getPane(t).each(e=>{o(t)((e=e.element.dom,{getContainer:T(e)}))})})};var pT,hT=Wu({factory:(e,o)=>{var t={setViews:(e,t)=>{N.set(e,[uT(t,o.backstage.shared.providers)])},whichView:e=>R.getCurrent(e).bind(mT),toggleView:(a,s,i,l)=>R.getCurrent(a).exists(o=>{var e,t=mT(o),n=t.exists(e=>l===e),r=u_.getSlot(o,l).isSome();return r&&(u_.hideAllSlots(o),n?(n=a.element,oe(n,"display","none"),O(n,"aria-hidden","true"),s()):(i(),n=a.element,lo(n,"display"),Zt(n,"aria-hidden"),u_.showSlot(o,l),n=o,e=l,gT(n,e,dT.getOnShow)),t.each(e=>{return t=o,e=e,gT(t,e,dT.getOnHide);var t})),r})};return{uid:e.uid,dom:{tag:"div",classes:["tox-view-wrap"],attributes:{"aria-hidden":"true"},styles:{display:"none"}},components:[],behaviours:re([N.config({}),R.config({find:e=>{e=N.contents(e);return De(e)}})]),apis:t}},name:"silver.ViewWrapper",configFields:[A("backstage")],apis:{setViews:(e,t,o)=>e.setViews(t,o),toggleView:(e,t,o,n,r)=>e.toggleView(t,o,n,r),whichView:(e,t)=>e.whichView(t)}}),Lg=iO.optional({factory:a_,name:"menubar",schema:[A("backstage")]}),Ac=iO.optional({factory:{sketch:e=>uO.sketch({uid:e.uid,dom:e.dom,listBehaviours:re([se.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:()=>eT({type:e.type,uid:I("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:e.providers,onEscape:()=>(e.onEscape(),Q.some(!0))}),setupItem:(e,t,o,n)=>{pO.setGroups(t,o)},shell:!0})},name:"multiple-toolbar",schema:[A("dom"),A("onEscape")]}),Bg=iO.optional({factory:{sketch:o=>{return(o.type===Zp.sliding?t=>{var e=Y_.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),o=Y_.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),n=Q_(t);return Y_.sketch({...n,components:[e,o],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:e=>{e.getSystem().broadcastOn([jO()],{type:"opened"}),t.onToggled(e,!0)},onClosed:e=>{e.getSystem().broadcastOn([jO()],{type:"closed"}),t.onToggled(e,!1)}})}:o.type===Zp.floating?n=>{var e=Q_(n),t=j_.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return j_.sketch({...e,lazySink:n.getSink,getOverflowBounds:()=>{var e=n.moreDrawerData.lazyHeader().element,t=vn(e),e=Tt(e),o=vn(e),e=Math.max(e.dom.scrollHeight,o.height);return hn(t.x+4,o.y,t.width-8,e)},parts:{...e.parts,overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:n.attributes}}},components:[t],markers:{overflowToggledClass:"tox-tbtn--enabled"},onOpened:e=>n.onToggled(e,!0),onClosed:e=>n.onToggled(e,!1)})}:eT)({type:o.type,uid:o.uid,onEscape:()=>(o.onEscape(),Q.some(!0)),onToggled:(e,t)=>o.onToolbarToggled(t),cyclicKeying:!1,initGroups:[],getSink:o.getSink,providers:o.providers,moreDrawerData:{lazyToolbar:o.lazyToolbar,lazyMoreButton:o.lazyMoreButton,lazyHeader:o.lazyHeader},attributes:o.attributes})}},name:"toolbar",schema:[A("dom"),A("onEscape"),A("getSink")]}),Pg=iO.optional({factory:{sketch:e=>{var t=e.editor,o=e.sticky?ZO:vO;return{uid:e.uid,dom:e.dom,components:e.components,behaviours:re(o(t,e.sharedBackstage))}}},name:"header",schema:[A("dom")]}),Kc=iO.optional({factory:{sketch:e=>({uid:e.uid,dom:e.dom,components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/tinymce-self-hosted-premium-features/?utm_source=TinyMCE&utm_medium=SPAP&utm_campaign=SPAP&utm_id=editorreferral",rel:"noopener",target:"_blank","aria-hidden":"true"},classes:["tox-promotion-link"],innerHtml:"⚡️Upgrade"}}]})},name:"promotion",schema:[A("dom")]}),ld=iO.optional({name:"socket",schema:[A("dom")]}),fl=iO.optional({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"presentation"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:re([Hx.config({}),z.config({}),fk.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:e=>{R.getCurrent(e).each(u_.hideAllSlots),B(e,b_)},onGrown:e=>{B(e,b_)},onStartGrow:e=>{F(e,v_,{width:ao(e.element,"width").getOr("")})},onStartShrink:e=>{F(e,v_,{width:wo(e.element)+"px"})}}),N.config({}),R.config({find:e=>{e=N.contents(e);return De(e)}})])}],behaviours:re([Q0(0),V("sidebar-sliding-events",[ne(v_,(e,t)=>{oe(e.element,"width",t.event.width)}),ne(b_,(e,t)=>{lo(e.element,"width")})])])})},name:"sidebar",schema:[A("dom")]}),Nm=iO.optional({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:re([N.config({}),y_.config({focus:!1}),R.config({find:e=>De(e.components())})]),components:[]})},name:"throbber",schema:[A("dom")]}),vg=iO.optional({factory:hT,name:"viewWrapper",schema:[A("backstage")]}),bc=iO.optional({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-editor-container"]},components:e.components})},name:"editorContainer",schema:[]}),fT=ju({name:"OuterContainer",factory:(n,e,t)=>{let o=!1;const r={getSocket:e=>sO.getPart(e,n,"socket"),setSidebar:(e,t,o)=>{sO.getPart(e,n,"sidebar").each(e=>{var n,r,a;n=e,r=t,a=o,R.getCurrent(n).each(t=>{N.set(t,[p_(r)]);const o=null==a?void 0:a.toLowerCase();L(o)&&$e(r,o)&&R.getCurrent(t).each(e=>{u_.showSlot(e,o),fk.immediateGrow(t),lo(t.element,"width"),h_(n.element,"region")})})})},toggleSidebar:(e,t)=>{sO.getPart(e,n,"sidebar").each(e=>{var o,n;o=e,n=t,R.getCurrent(o).each(t=>{R.getCurrent(t).each(e=>{fk.hasGrown(t)?u_.isShowing(e,n)?(fk.shrink(t),h_(o.element,"presentation")):(u_.hideAllSlots(e),u_.showSlot(e,n),h_(o.element,"region")):(u_.hideAllSlots(e),u_.showSlot(e,n),fk.grow(t),h_(o.element,"region"))})})})},whichSidebar:e=>sO.getPart(e,n,"sidebar").bind(f_).getOrNull(),getHeader:e=>sO.getPart(e,n,"header"),getToolbar:e=>sO.getPart(e,n,"toolbar"),setToolbar:(e,o)=>{sO.getPart(e,n,"toolbar").each(e=>{var t=k(o,J_);e.getApis().setGroups(e,t)})},setToolbars:(e,o)=>{sO.getPart(e,n,"multiple-toolbar").each(e=>{var t=k(o,e=>k(e,J_));uO.setItems(e,t)})},refreshToolbar:e=>{sO.getPart(e,n,"toolbar").each(e=>e.getApis().refresh(e))},toggleToolbarDrawer:e=>{sO.getPart(e,n,"toolbar").each(t=>{Je(t.getApis().toggle,e=>e(t))})},toggleToolbarDrawerWithoutFocusing:e=>{sO.getPart(e,n,"toolbar").each(t=>{Je(t.getApis().toggleWithoutFocusing,e=>e(t))})},isToolbarDrawerToggled:e=>sO.getPart(e,n,"toolbar").bind(t=>Q.from(t.getApis().isOpen).map(e=>e(t))).getOr(!1),getThrobber:e=>sO.getPart(e,n,"throbber"),focusToolbar:e=>{sO.getPart(e,n,"toolbar").orThunk(()=>sO.getPart(e,n,"multiple-toolbar")).each(e=>{se.focusIn(e)})},setMenubar:(e,t)=>{sO.getPart(e,n,"menubar").each(e=>{a_.setMenus(e,t)})},focusMenubar:e=>{sO.getPart(e,n,"menubar").each(e=>{a_.focus(e)})},setViews:(e,t)=>{sO.getPart(e,n,"viewWrapper").each(e=>{hT.setViews(e,t)})},toggleView:(t,o)=>sO.getPart(t,n,"viewWrapper").exists(e=>hT.toggleView(e,()=>r.showMainView(t),()=>r.hideMainView(t),o)),whichView:e=>sO.getPart(e,n,"viewWrapper").bind(hT.whichView).getOrNull(),hideMainView:e=>{(o=r.isToolbarDrawerToggled(e))&&r.toggleToolbarDrawer(e),sO.getPart(e,n,"editorContainer").each(e=>{e=e.element;oe(e,"display","none"),O(e,"aria-hidden","true")})},showMainView:e=>{o&&r.toggleToolbarDrawer(e),sO.getPart(e,n,"editorContainer").each(e=>{e=e.element;lo(e,"display"),Zt(e,"aria-hidden")})}};return{uid:n.uid,dom:n.dom,components:e,apis:r,behaviours:n.behaviours}},configFields:[A("dom"),A("behaviours")],partFields:[Pg,Lg,Bg,Ac,ld,fl,Kc,Nm,vg,bc],apis:{getSocket:(e,t)=>e.getSocket(t),setSidebar:(e,t,o,n)=>{e.setSidebar(t,o,n)},toggleSidebar:(e,t,o)=>{e.toggleSidebar(t,o)},whichSidebar:(e,t)=>e.whichSidebar(t),getHeader:(e,t)=>e.getHeader(t),getToolbar:(e,t)=>e.getToolbar(t),setToolbar:(e,t,o)=>{e.setToolbar(t,o)},setToolbars:(e,t,o)=>{e.setToolbars(t,o)},refreshToolbar:(e,t)=>e.refreshToolbar(t),toggleToolbarDrawer:(e,t)=>{e.toggleToolbarDrawer(t)},toggleToolbarDrawerWithoutFocusing:(e,t)=>{e.toggleToolbarDrawerWithoutFocusing(t)},isToolbarDrawerToggled:(e,t)=>e.isToolbarDrawerToggled(t),getThrobber:(e,t)=>e.getThrobber(t),setMenubar:(e,t,o)=>{e.setMenubar(t,o)},focusMenubar:(e,t)=>{e.focusMenubar(t)},focusToolbar:(e,t)=>{e.focusToolbar(t)},setViews:(e,t,o)=>{e.setViews(t,o)},toggleView:(e,t,o)=>e.toggleView(t,o),whichView:(e,t)=>e.whichView(t)}});const vT={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template inserttemplate codesample inserttable accordion | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents footnotes | mergetags | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"aidialog aishortcuts | spellchecker spellcheckerlanguage | autocorrect capitalization | a11ycheck code typography wordcount addtemplate"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},bT=e=>e.split(" "),yT=(r,a)=>{const s={...vT,...a.menus},o=0<Re(a.menus).length,e=void 0===a.menubar||!0===a.menubar?bT("file edit view insert format tools table help"):bT(!1===a.menubar?"":a.menubar),t=ve(e,e=>{var t=$e(vT,e);return o?t||C(a.menus,e).exists(e=>$e(e,"items")):t}),n=k(t,e=>{e=s[e];{var t={title:e.title,items:bT(e.items)},o=a;e=r;const n=vh(e).split(/[ ,]/);return{text:t.title,getItems:()=>ke(t.items,e=>{const t=e.toLowerCase();return 0===t.trim().length||ge(n,e=>e===t)?[]:"separator"===t||"|"===t?[{type:"separator"}]:o.menuItems[t]?[o.menuItems[t]]:[]})}}});return ve(n,e=>0<e.getItems().length&&ge(e.getItems(),e=>L(e)||"separator"!==e.type))},xT=e=>{const t=()=>{e._skinLoaded=!0,e.dispatch("SkinLoaded")};return()=>{e.initialized?t():e.on("init",t)}},wT=(e,t,o)=>(e.on("remove",()=>o.unload(t)),o.load(t)),ST=(e,t)=>{var o,n,r=Gh(t);return r&&t.contentCSS.push(r+(e?"/content.inline":"/content")+".min.css"),!Wh(t)&&L(r)?Promise.all([(e=t,n=r,wT(e,n+"/skin.min.css",e.ui.styleSheetLoader)),(n=t,e=r,r=te(n.getElement()),Ut(r).isSome()?wT(n,e+"/skin.shadowdom.min.css",eh.DOM.styleSheetLoader):Promise.resolve())]).then(xT(t),(o=t,()=>{o.dispatch("SkinLoadError",{message:"Skin could not be loaded"})})):Promise.resolve(xT(t)())},kT=$(ST,!1),CT=$(ST,!0),OT=(e,a,s)=>{const r=(e,t,o,n)=>{var r=a.shared.providers.translate(e.title);if("separator"===e.type)return Q.some({type:"separator",text:r});if("submenu"!==e.type)return Q.some({type:"togglemenuitem",text:r,icon:e.icon,active:e.isSelected(n),enabled:!o,onAction:s.onAction(e),...e.getStylePreview().fold(()=>({}),e=>({meta:{style:e}}))});{const a=ke(e.getStyleItems(),e=>i(e,t,n));return 0===t&&a.length<=0?Q.none():Q.some({type:"nestedmenuitem",text:r,enabled:0<a.length,getSubmenuItems:()=>ke(e.getStyleItems(),e=>i(e,t,n))})}},i=(e,t,o)=>{var n="formatter"===e.type&&s.isInvalid(e);return 0===t?n?[]:r(e,t,!1,o).toArray():r(e,t,n,o).toArray()},l=e=>{const t=s.getCurrentValue(),o=s.shouldHide?0:1;return ke(e,e=>i(e,o,t))};return{validateItems:l,getFetch:(n,r)=>(e,t)=>{var o=r(),o=l(o);t(jS(o,sf.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!1,search:Q.none()}))}}},_T=(e,t,o)=>{const n=o.dataset,r="basic"===n.type?()=>k(n.data,e=>FC(e,o.isSelectedFor,o.getPreviewFor)):n.getData;return{items:OT(0,t,o),getStyleItems:r}},TT=(o,e,n)=>{var{items:t,getStyleItems:r}=_T(0,e,n),a=ay(o,"NodeChange",e=>{var t=e.getComponent();n.updateText(t),ae.set(e.getComponent(),!o.selection.isEditable())});return LS({text:n.icon.isSome()?Q.none():n.text,icon:n.icon,tooltip:Q.from(n.tooltip),role:Q.none(),fetch:t.getFetch(e,r),onSetup:a,getApi:e=>({getComponent:T(e)}),columns:1,presets:"normal",classes:n.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",e.shared)},ET=((zx=pT=pT||{})[zx.SemiColon=0]="SemiColon",zx[zx.Space=1]="Space",(e,t,o)=>{return e=e.options.get(t),t=o===pT.SemiColon?e.replace(/;$/,"").split(";"):e.split(" "),{type:"basic",data:k(t,e=>{let t=e,o=e;e=e.split("=");return 1<e.length&&(t=e[0],o=e[1]),{title:t,format:o}})}}),AT=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],MT=o=>{var e={type:"basic",data:AT};return{tooltip:"Align",text:Q.none(),icon:Q.some("align-left"),isSelectedFor:e=>()=>o.formatter.match(e),getCurrentValue:Q.none,getPreviewFor:e=>Q.none,onAction:t=>()=>xe(AT,e=>e.format===t.format).each(e=>o.execCommand(e.command)),updateText:e=>{var t=xe(AT,e=>o.formatter.match(e.format)).fold(T("left"),e=>e.title.toLowerCase());F(e,HS,{icon:"align-"+t})},dataset:e,shouldHide:!1,isInvalid:e=>!o.formatter.canApply(e.format)}},DT=(e,t)=>{const o=t(),n=k(o,e=>e.format);return Q.from(e.formatter.closest(n)).bind(t=>xe(o,e=>e.format===t)).orThunk(()=>Ze(e.formatter.match("p"),{title:"Paragraph",format:"p"}))},BT=o=>{const n=ET(o,"block_formats",pT.SemiColon);return{tooltip:"Blocks",text:Q.some("Paragraph"),icon:Q.none(),isSelectedFor:e=>()=>o.formatter.match(e),getCurrentValue:Q.none,getPreviewFor:t=>()=>{var e=o.formatter.get(t);return e?Q.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:o.dom.parseStyle(o.formatter.getCssText(t))}):Q.none()},onAction:sy(o),updateText:e=>{var t=DT(o,()=>n.data).fold(T("Paragraph"),e=>e.title);F(e,zS,{text:t})},dataset:n,shouldHide:!1,isInvalid:e=>!o.formatter.canApply(e.format)}},FT=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],IT=e=>{e=e.split(/\s*,\s*/);return k(e,e=>e.replace(/^['"]+|['"]+$/g,""))},RT=a=>{const s="System Font",n=()=>{const t=e=>e?IT(e)[0]:"",e=a.queryCommandValue("FontName"),o=i.data,n=e?e.toLowerCase():"",r=xe(o,e=>{e=e.format;return e.toLowerCase()===n||t(e).toLowerCase()===t(n).toLowerCase()}).orThunk(()=>{return Ze(0===(e=n).indexOf("-apple-system")&&(()=>{const t=IT(e.toLowerCase());return Ce(FT,e=>-1<t.indexOf(e.toLowerCase()))})(),{title:s,format:n});var e});return{matchOpt:r,font:e}},i=ET(a,"font_family_formats",pT.SemiColon);return{tooltip:"Fonts",text:Q.some(s),icon:Q.none(),isSelectedFor:t=>e=>e.exists(e=>e.format===t),getCurrentValue:()=>{var e=n()["matchOpt"];return e},getPreviewFor:e=>()=>Q.some({tag:"div",styles:-1===e.indexOf("dings")?{"font-family":e}:{}}),onAction:e=>()=>{a.undoManager.transact(()=>{a.focus(),a.execCommand("FontName",!1,e.format)})},updateText:e=>{var{matchOpt:t,font:o}=n(),t=t.fold(T(o),e=>e.title);F(e,zS,{text:t})},dataset:i,shouldHide:!1,isInvalid:K}},NT={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},VT=(Lg="[eE][+-]?"+(Pg="[0-9]+"),Pg=["Infinity",Pg+"\\."+(Bg=e=>`(?:${e})?`)(Pg)+Bg(Lg),"\\."+Pg+Bg(Lg),Pg+Bg(Lg)].join("|"),new RegExp(`^([+-]?(?:${Pg}))(.*)$`)),zT=(e,r)=>Q.from(VT.exec(e)).bind(e=>{var t,o,n=Number(e[1]),e=e[2];return t=e,o=r,ge(o,e=>ge(NT[e],e=>t===e))?Q.some({value:n,unit:e}):Q.none()}),HT={tab:T(9),escape:T(27),enter:T(13),backspace:T(8),delete:T(46),left:T(37),up:T(38),right:T(39),down:T(40),space:T(32),home:T(36),end:T(35),pageUp:T(33),pageDown:T(34)},LT={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},PT={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},UT=l=>{const n=()=>{let t=Q.none();const o=c.data,n=l.queryCommandValue("FontSize");if(n)for(let e=3;t.isNone()&&0<=e;e--){r=n,a=e,s=void 0;const c=/[0-9.]+px$/.test(r)?(s=72*parseInt(r,10)/96,a=Math.pow(10,a||0),Math.round(s*a)/a+"pt"):C(PT,r).getOr(r),i=(s=c,C(LT,s).getOr(""));t=xe(o,e=>e.format===n||e.format===c||e.format===i)}var r,a,s;return{matchOpt:t,size:n}},e=T(Q.none),c=ET(l,"font_size_formats",pT.Space);return{tooltip:"Font sizes",text:Q.some("12pt"),icon:Q.none(),isSelectedFor:t=>e=>e.exists(e=>e.format===t),getPreviewFor:e,getCurrentValue:()=>{var e=n()["matchOpt"];return e},onAction:e=>()=>{l.undoManager.transact(()=>{l.focus(),l.execCommand("FontSize",!1,e.format)})},updateText:e=>{var{matchOpt:t,size:o}=n(),t=t.fold(T(o),e=>e.title);F(e,zS,{text:t})},dataset:c,shouldHide:!1,isInvalid:K}},WT=(r,e)=>{return{tooltip:"Formats",text:Q.some("Paragraph"),icon:Q.none(),isSelectedFor:e=>()=>r.formatter.match(e),getCurrentValue:Q.none,getPreviewFor:t=>()=>{var e=r.formatter.get(t);return void 0!==e?Q.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:r.dom.parseStyle(r.formatter.getCssText(t))}):Q.none()},onAction:sy(r),updateText:e=>{const t=e=>EC(e)?ke(e.items,t):AC(e)?[{title:e.title,format:e.format}]:[],o=ke(BC(r),t),n=DT(r,T(o)).fold(T("Paragraph"),e=>e.title);F(e,zS,{text:n})},shouldHide:hh(r),isInvalid:e=>!r.formatter.canApply(e.format),dataset:e}},jT=T([A("toggleClass"),A("fetch"),Di("onExecute"),M("getHotspot",Q.some),M("getAnchorOverrides",T({})),fc(),Di("onItemExecute"),d("lazySink"),A("dom"),e("onOpen"),Gd("splitDropdownBehaviours",[Gy,se,z]),M("matchWidth",!1),M("useMinWidth",!1),M("eventOrder",{}),d("role")].concat(lx())),GT=bu({factory:Hp,schema:[A("dom")],name:"arrow",defaults:()=>({buttonBehaviours:re([z.revoke()])}),overrides:t=>({dom:{tag:"span",attributes:{role:"presentation"}},action:e=>{e.getSystem().getByUid(t.uid).each(Wa)},buttonBehaviours:re([f.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])})}),$T=bu({factory:Hp,schema:[A("dom")],name:"button",defaults:()=>({buttonBehaviours:re([z.revoke()])}),overrides:o=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(o.uid).each(e=>{o.onExecute(e,t)})}})}),qT=T([GT,$T,xu({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[A("text")],name:"aria-descriptor"}),yu({schema:[Ti()],name:"menu",defaults:n=>({onExecute:(t,o)=>{t.getSystem().getByUid(n.uid).each(e=>{n.onItemExecute(e,t,o)})}})}),Qy()]),XT=ju({name:"SplitDropdown",configFields:jT(),partFields:qT(),factory:(n,e,t,o)=>{const r=e=>{R.getCurrent(e).each(e=>{x.highlightFirst(e),se.focusIn(e)})},a=e=>{nx(n,w,e,o,r,lp.HighlightMenuAndItem).get(S)},s=e=>{e=Du(e,n,"button");return Wa(e),Q.some(!0)},i={...qa([os((o,e)=>{Mu(o,n,"aria-descriptor").each(e=>{var t=I("aria");O(e.element,"id",t),O(o.element,"aria-describedby",t)})})]),...dp(Q.some(a))},l={repositionMenus:e=>{f.isOn(e)&&ix(e)}};return{uid:n.uid,dom:n.dom,components:e,apis:l,eventOrder:{...n.eventOrder,[wa()]:["disabling","toggling","alloy.base.behaviour"]},events:i,behaviours:qd(n.splitDropdownBehaviours,[Gy.config({others:{sandbox:e=>{const t=Du(e,n,"arrow");return sx(n,e,{onOpen:()=>{f.on(t),f.on(e)},onClose:()=>{f.off(t),f.off(e)}})}}}),se.config({mode:"special",onSpace:s,onEnter:s,onDown:e=>(a(e),Q.some(!0))}),z.config({}),f.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:n.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:(e,t)=>e.repositionMenus(t)}}),YT=t=>({isEnabled:()=>!ae.isDisabled(t),setEnabled:e=>ae.set(t,!e),setText:e=>F(t,zS,{text:e}),setIcon:e=>F(t,HS,{icon:e})}),KT=t=>({setActive:e=>{f.set(t,e)},isActive:()=>f.isOn(t),isEnabled:()=>!ae.isDisabled(t),setEnabled:e=>ae.set(t,!e),setText:e=>F(t,zS,{text:e}),setIcon:e=>F(t,HS,{icon:e})}),JT=(e,t)=>e.map(e=>({"aria-label":t.translate(e),title:t.translate(e)})).getOr({}),ZT=I("focus-button"),QT=(e,t,o,n,r)=>{const a=t.map(e=>ie(VS(e,"tox-tbtn",r))),s=e.map(e=>ie(NS(e,r.icons)));return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]),attributes:JT(o,r)},components:bb([s.map(e=>e.asSpec()),a.map(e=>e.asSpec())]),eventOrder:{[Qr()]:["focusing","alloy.base.behaviour",DS],[Ba()]:[DS,"toolbar-group-button-events"]},buttonBehaviours:re([gb(r.isDisabled),db(),V(DS,[os((e,t)=>FS(e)),ne(zS,(t,o)=>{a.bind(e=>e.getOpt(t)).each(e=>{N.set(e,[ti(r.translate(o.event.text))])})}),ne(HS,(t,o)=>{s.bind(e=>e.getOpt(t)).each(e=>{N.set(e,[NS(o.event.icon,r.icons)])})}),ne(Qr(),(e,t)=>{t.event.prevent(),B(e,ZT)})])].concat(n.getOr([])))}},e1=(e,t,o)=>{var n,r=D(S),a=QT(e.icon,e.text,e.tooltip,Q.none(),o);return Hp.sketch({dom:a.dom,components:a.components,eventOrder:BS,buttonBehaviours:{...re([V("toolbar-button-events",[(n={onAction:e.onAction,getApi:t.getApi},as((t,e)=>{pb(n,t)(e=>{F(t,MS,{buttonApi:e}),n.onAction(e)})})),hb(t,r),fb(t,r)]),gb(()=>!e.enabled||o.isDisabled()),db()].concat(t.toolbarButtonBehaviours)),[DS]:null==(r=a.buttonBehaviours)?void 0:r[DS]}})},t1=(e,t,o)=>e1(e,{toolbarButtonBehaviours:0<o.length?[V("toolbarButtonWith",o)]:[],getApi:YT,onSetup:e.onSetup},t),o1=(e,t,o)=>e1(e,{toolbarButtonBehaviours:[N.config({}),f.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<o.length?[V("toolbarToggleButtonWith",o)]:[]),getApi:KT,onSetup:e.onSetup},t),n1=[{name:"history",items:["undo","redo"]},{name:"ai",items:["aidialog","aishortcuts"]},{name:"styles",items:["styles"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],r1=(n,r)=>(e,t,o)=>{e=n(e).mapError(e=>ur(e)).getOrDie();return r(e,t,o)},a1={button:r1(Ov,(e,t)=>{return e=e,t=t.shared.providers,t1(e,t,[])}),togglebutton:r1(Ev,(e,t)=>{return e=e,t=t.shared.providers,o1(e,t,[])}),menubutton:r1(n_,(e,t)=>bk(e,"tox-tbtn",t,Q.none(),!1)),splitbutton:r1(e=>lr("SplitButton",r_,e),(e,t)=>{{var o=e,n,r,a;e=t.shared;const s=o=>({isEnabled:()=>!ae.isDisabled(o),setEnabled:e=>ae.set(o,!e),setIconFill:(e,t)=>{pi(o.element,`svg path[class="${e}"], rect[class="${e}"]`).each(e=>{O(e,"fill",t)})},setActive:t=>{O(o.element,"aria-pressed",t),pi(o.element,"span").each(e=>{o.getSystem().getByDom(e).each(e=>f.set(e,t))})},isActive:()=>pi(o.element,"span").exists(e=>o.getSystem().getByDom(e).exists(f.isOn)),setText:t=>pi(o.element,"span").each(e=>o.getSystem().getByDom(e).each(e=>F(e,zS,{text:t}))),setIcon:t=>pi(o.element,"span").each(e=>o.getSystem().getByDom(e).each(e=>F(e,HS,{icon:t})))}),i=D(S),l={getApi:s,onSetup:o.onSetup};return XT.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:{"aria-pressed":!1,...JT(o.tooltip,e.providers)}},onExecute:e=>{e=s(e);e.isEnabled()&&o.onAction(e)},onItemExecute:(e,t,o)=>{},splitDropdownBehaviours:re([mb(e.providers.isDisabled),db(),V("split-dropdown-events",[os((e,t)=>FS(e)),ne(ZT,z.focus),hb(l,i),fb(l,i)]),sw.config({})]),eventOrder:{[Ba()]:["alloy.base.behaviour","split-dropdown-events"]},toggleClass:"tox-tbtn--enabled",lazySink:e.getSink,fetch:(n=s,r=o,a=e.providers,t=>Ky(e=>r.fetch(e)).map(e=>Q.from(vx(Fn(Vy(I("menu-value"),e,e=>{r.onItemAction(n(t),e)},r.columns,r.presets,sf.CLOSE_ON_EXECUTE,r.select.getOr(K),a),{movement:zy(r.columns,r.presets),menuBehaviours:eb("auto"!==r.columns?[]:[os((o,e)=>{Qv(o,4,yf(r.presets)).each(({numRows:e,numColumns:t})=>{se.setGridSize(o,e,t)})})])}))))),parts:{menu:Of(0,o.columns,o.presets)},components:[XT.parts.button(QT(o.icon,o.text,Q.none(),Q.some([f.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),e.providers)),XT.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:$p("chevron-down",e.providers.icons)},buttonBehaviours:re([mb(e.providers.isDisabled),db(),qp()])}),XT.parts["aria-descriptor"]({text:e.providers.translate("To open the popup, press Shift+Enter")})]})}}),grouptoolbarbutton:r1(e=>lr("GroupToolbarButton",e_,e),(e,t,o)=>{const n=o.ui.registry.getAll().buttons,r={"data-alloy-vertical-dir":t.shared.header.isPositionedAtTop()?Tl.TopToBottom:Tl.BottomToTop};if(bh(o)===Zp.floating)return a=e,e=r,s=(s=t).shared,i=D(S),l={toolbarButtonBehaviours:[],getApi:YT,onSetup:a.onSetup},l=[V("toolbar-group-button-events",[hb(l,i),fb(l,i)])],z_.sketch({lazySink:s.getSink,fetch:()=>Ky(e=>{e(k((e=a.items,i1(o,{buttons:n,toolbar:e,allowToolbarGroups:!1},t,Q.none())),J_))}),markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:QT(a.icon,a.text,a.tooltip,Q.some(l),s.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e}}}});var a,s,i,l;throw new Error("Toolbar groups are only supported when using floating toolbar mode")})},s1={styles:(e,t)=>{var o={type:"advanced",...t.styles};return TT(e,t,WT(e,o))},fontsize:(e,t)=>TT(e,t,UT(e)),fontsizeinput:(e,t)=>{{var i=e,c=t,d=(i=>{const l=()=>i.queryCommandValue("FontSize");return{updateInputValue:e=>F(e,zS,{text:l()}),onAction:(e,t)=>i.execCommand("FontSize",!1,e,{skip_focus:!t}),getNewValue:(e,t)=>{zT(e,["unsupportedLength","empty"]);const o=zT(e,["unsupportedLength","empty"]).or(zT(l(),["unsupportedLength","empty"])),n=o.map(e=>e.value).getOr(16),r=Ah(i),a=o.map(e=>e.unit).filter(e=>""!==e).getOr(r),s=t(n,(null!=(e={em:{step:.1},cm:{step:.1},in:{step:.1},pc:{step:.1},ch:{step:.1},rem:{step:.1}}[a])?e:{step:1}).step);return""+(0<=s?s:n)+a}}})(e);let l=Q.none();const o=ay(i,"NodeChange SwitchMode",e=>{e=e.getComponent();l=Q.some(e),d.updateInputValue(e),ae.set(e,!i.selection.isEditable())}),u=e=>({getComponent:T(e)}),m=D(S),n=I("custom-number-input-events"),r=(e,o,t)=>{const n=l.map(e=>y.getValue(e)).getOr(""),r=d.getNewValue(n,e),a=n.length-(""+r).length,s=l.map(e=>e.element.dom.selectionStart-a),i=l.map(e=>e.element.dom.selectionEnd-a);d.onAction(r,t),l.each(t=>{y.setValue(t,r),o&&(s.each(e=>t.element.dom.selectionStart=e),i.each(e=>t.element.dom.selectionEnd=e))})},a=(e,t)=>r((e,t)=>e-t,e,t),s=(e,t)=>r((e,t)=>e+t,e,t),g=e=>Mt(e.element).fold(Q.none,e=>(El(e),Q.some(!0))),p=e=>Ml(e.element)?(It(e.element).each(e=>El(e)),Q.some(!0)):Q.none(),h=(o,e,t,n)=>{var t=c.shared.providers.translate(t),r=I("altExecuting"),a=ay(i,"NodeChange SwitchMode",e=>{ae.set(e.getComponent(),!i.selection.isEditable())}),s=e=>{ae.isDisabled(e)||o(!0)};return Hp.sketch({dom:{tag:"button",attributes:{title:t,"aria-label":t},classes:n.concat(e)},components:[RS(e,c.shared.providers.icons)],buttonBehaviours:re([ae.config({}),V(r,[hb({onSetup:a,getApi:u},m),fb({getApi:u},m),ne(sa(),(e,t)=>{t.event.raw.keyCode!==HT.space()&&t.event.raw.keyCode!==HT.enter()||ae.isDisabled(e)||o(!1)}),ne(da(),s),ne(Jr(),s)])]),eventOrder:{[sa()]:[r,"keying"],[da()]:[r,"alloy.base.behaviour"],[Jr()]:[r,"alloy.base.behaviour"]}})},f=ie(h(e=>a(!1,e),"minus","Decrease font size",["highlight-on-focus"])),v=ie(h(e=>s(!1,e),"plus","Increase font size",["highlight-on-focus"])),b=ie({dom:{tag:"div",classes:["tox-input-wrapper","highlight-on-focus"]},components:[Af.sketch({inputBehaviours:re([ae.config({}),V(n,[hb({onSetup:o,getApi:u},m),fb({getApi:u},m)]),V("input-update-display-text",[ne(zS,(e,t)=>{y.setValue(e,t.event.text)}),ne(aa(),e=>{d.onAction(y.getValue(e))}),ne(ca(),e=>{d.onAction(y.getValue(e))})]),se.config({mode:"special",onEnter:e=>(r(w,!0,!0),Q.some(!0)),onEscape:g,onUp:e=>(s(!0,!1),Q.some(!0)),onDown:e=>(a(!0,!1),Q.some(!0)),onLeft:(e,t)=>(t.cut(),Q.none()),onRight:(e,t)=>(t.cut(),Q.none())})])})],behaviours:re([z.config({}),se.config({mode:"special",onEnter:p,onSpace:p,onEscape:g}),V("input-wrapper-events",[ne(na(),t=>{ee([f,v],e=>{e=te(e.get(t).element.dom);Ml(e)&&Al(e)})})])])});return{dom:{tag:"div",classes:["tox-number-input"]},components:[f.asSpec(),b.asSpec(),v.asSpec()],behaviours:re([z.config({}),se.config({mode:"flow",focusInside:dm.OnEnterOrSpaceMode,cycles:!1,selector:"button, .tox-input-wrapper",onEscape:e=>Ml(e.element)?Q.none():(El(e.element),Q.some(!0))})])}}},fontfamily:(e,t)=>TT(e,t,RT(e)),blocks:(e,t)=>TT(e,t,BT(e)),align:(e,t)=>TT(e,t,MT(e))},i1=(n,l,c,d)=>{t=l.toolbar,e=l.buttons;var o,e=!1===t?[]:void 0===t||!0===t?(o=e,e=k(n1,e=>{var t=ve(e.items,e=>$e(o,e)||$e(s1,e));return{name:e.name,items:t}}),ve(e,e=>0<e.items.length)):L(t)?(e=t.split("|"),k(e,e=>({items:e.trim().split(" ")}))):(e=t,p(e,e=>$e(e,"name")&&$e(e,"items"))?t:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])),t=k(e,e=>{var t=ke(e.items,e=>{return 0===e.trim().length?[]:(r=n,t=l.buttons,a=e,s=l.allowToolbarGroups,i=c,o=d,C(t,a.toLowerCase()).orThunk(()=>o.bind(e=>Ie(e,e=>C(t,e+a.toLowerCase())))).fold(()=>C(s1,a.toLowerCase()).map(e=>e(r,i)),e=>{return"grouptoolbarbutton"!==e.type||s?(t=e,o=i,n=r,C(a1,t.type).fold(()=>(console.error("skipping button defined by",t),Q.none()),e=>Q.some(e(t,o,n)))):(console.warn(`Ignoring the '${a}' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.`),Q.none());var t,o,n}).toArray());var r,t,a,s,i,o});return{title:Q.from(n.translate(e.name)),items:t}});return ve(t,e=>0<e.items.length)},l1=(t,e,o,n)=>{const r=e.mainUi.outerContainer,a=o.toolbar,s=o.buttons;if(p(a,L)){const e=a.map(e=>{e={toolbar:e,buttons:s,allowToolbarGroups:o.allowToolbarGroups};return i1(t,e,n,Q.none())});fT.setToolbars(r,e)}else fT.setToolbar(r,i1(t,o,n,Q.none()))},c1=Yo(),d1=c1.os.isiOS()&&c1.os.version.major<=12;var u1=Object.freeze({__proto__:null,render:async(u,m,t,g,e)=>{const{mainUi:o,uiMotherships:n}=m,p=D(0),h=o.outerContainer;await kT(u);var e=te(e.targetNode),r=Pt(Lt(e)),e=(_d(e,o.mothership),e=u,r=r,a=m,of(e)&&_d(a.mainUi.mothership.element,a.popupUi.mothership),Od(r,a.dialogUi.mothership),u.on("PostRender",()=>{fT.setSidebar(h,t.sidebar,Lh(u)),l1(u,m,t,g),p.set(u.getWin().innerWidth),fT.setMenubar(h,yT(u,t)),fT.setViews(h,t.views);{var o=u;const e=m["uiMotherships"],n=o.dom;let t=o.getWin();const r=o.getDoc().documentElement,a=D(fo(t.innerWidth,t.innerHeight)),s=D(fo(r.offsetWidth,r.offsetHeight)),i=()=>{var e=a.get();e.left===t.innerWidth&&e.top===t.innerHeight||(a.set(fo(t.innerWidth,t.innerHeight)),ey(o))},l=()=>{var e=o.getDoc().documentElement,t=s.get();t.left===e.offsetWidth&&t.top===e.offsetHeight||(s.set(fo(e.offsetWidth,e.offsetHeight)),ey(o))},c=e=>{o.dispatch("ScrollContent",e)},d=(n.bind(t,"resize",i),n.bind(t,"scroll",c),Zl(te(o.getBody()),"load",l));o.on("hide",()=>{ee(e,e=>{oe(e.element,"display","none")})}),o.on("show",()=>{ee(e,e=>{lo(e.element,"display")})}),o.on("NodeChange",l),o.on("remove",()=>{d.unbind(),n.unbind(t,"resize",i),n.unbind(t,"scroll",c),t=null})}}),fT.getSocket(h).getOrDie("Could not find expected socket element"));if(d1){to(e.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});const m=(()=>{let t=null;return{cancel:()=>{i(t)||(clearTimeout(t),t=null)},throttle:(...e)=>{i(t)&&(t=setTimeout(()=>{t=null,(()=>{u.dispatch("ScrollContent")}).apply(null,e)},20))}}})(),t=Jl(e.element,"scroll",m.throttle);u.on("remove",t.unbind)}cb(u,m),u.addCommand("ToggleSidebar",(e,t)=>{fT.toggleSidebar(h,t),u.dispatch("ToggleSidebar")}),u.addQueryValueHandler("ToggleSidebar",()=>{var e;return null!=(e=fT.whichSidebar(h))?e:""}),u.addCommand("ToggleView",(t,e)=>{if(fT.toggleView(h,e)){const t=h.element;o.mothership.broadcastOn([Rd()],{target:t}),ee(n,e=>{e.broadcastOn([Rd()],{target:t})}),i(fT.whichView(h))&&(u.focus(),u.nodeChanged(),fT.refreshToolbar(h))}}),u.addQueryValueHandler("ToggleView",()=>{var e;return null!=(e=fT.whichView(h))?e:""});var r=bh(u),a=(r!==Zp.sliding&&r!==Zp.floating||u.on("ResizeWindow ResizeEditor ResizeContent",()=>{var e=u.getWin().innerWidth;e!==p.get()&&(fT.refreshToolbar(m.mainUi.outerContainer),p.set(e))}),{setEnabled:e=>{lb(m,!e)},isEnabled:()=>!ae.isDisabled(h)});return{iframeContainer:e.element.dom,editorContainer:h.element.dom,api:a}}});const m1=e=>/^[0-9\.]+(|px)$/i.test(""+e)?Q.some(parseInt(""+e,10)):Q.none(),g1=e=>h(e)?e+"px":e,p1=(t,e,o)=>{e=e.filter(e=>t<e),o=o.filter(e=>e<t);return e.or(o).getOr(t)},h1=e=>{const t=lh(e),o=ch(e),n=uh(e);return m1(t).map(e=>p1(e,o,n))},{ToolbarLocation:f1,ToolbarMode:v1}=vl,b1=(u,m,e,t,n)=>{const{mainUi:g,uiMotherships:o}=e,r=eh.DOM,a=Zh(u),s=tf(u),i=uh(u).or(h1(u)),l=t.shared.header,p=l.isPositionedAtTop,c=bh(u),h=c===v1.sliding||c===v1.floating,d=D(!1),f=()=>d.get()&&!u.removed,v=e=>h?e.fold(T(0),e=>1<e.components().length?go(e.components()[1].element):0):0,b=()=>{ee(o,e=>{e.broadcastOn([Nd()],{})})},y=e=>{var t,d;f()&&(a||n.on(e=>{var t=i.getOrThunk(()=>{var e=m1(no(Gt(),"margin-left")).getOr(0);return wo(Gt())-bo(m).left+e});oe(e.element,"max-width",t+"px")}),t=!a&&!a&&(bo(g.outerContainer.element).left+So(g.outerContainer.element)>=window.innerWidth-40||ao(g.outerContainer.element,"width").isSome())?(oe(g.outerContainer.element,"position","absolute"),oe(g.outerContainer.element,"left","0px"),lo(g.outerContainer.element,"width"),t=So(g.outerContainer.element),Q.some(t)):Q.none(),h&&fT.refreshToolbar(g.outerContainer),a||(d=t,n.on(n=>{const e=fT.getToolbar(g.outerContainer),r=v(e),a=fn(m),{top:t,left:o}=(l=u,c=g.outerContainer.element,(of(l)?xO(c):Q.none()).fold(()=>({top:p()?Math.max(a.y-go(n.element)+r,0):a.bottom,left:a.x}),e=>{var t=fn(e),o=null!=(o=e.dom.scrollTop)?o:0,e=kt(e,Gt()),o=e?Math.max(a.y-go(n.element)+r,0):a.y-t.y+o-go(n.element)+r;return{top:p()?o:a.bottom,left:e?a.x:a.x-t.x}})),s={position:"absolute",left:Math.round(o)+"px",top:Math.round(t)+"px"},i=d.map(e=>{var t=sn(),t=window.innerWidth-(o-t.left);return{width:Math.max(Math.min(e,t),150)+"px"}}).getOr({});var l,c;to(g.outerContainer.element,{...s,...i})})),s&&n.on(e),b())},x=()=>!(a||!s||!f())&&n.get().exists(e=>{var o,t=l.getDockingMode(),e=(e=>{switch(xh(t)){case f1.auto:const t=fT.getToolbar(g.outerContainer),o=v(t),n=go(e.element)-o,r=fn(m);if(r.y>n)return"top";{const a=Tt(m),e=Math.max(a.dom.scrollHeight,go(a));return r.bottom<e-n||yn().bottom<r.bottom-n?"bottom":"top"}case f1.bottom:return"bottom";default:f1.top;return"top"}})(e);return e!==t&&(o=e,n.on(e=>{WO.setModes(e,[o]),l.setDockingMode(o);var t=p()?Tl.TopToBottom:Tl.BottomToTop;O(e.element,pc,t)}),!0)});return{isVisible:f,isPositionedAtTop:p,show:()=>{d.set(!0),oe(g.outerContainer.element,"display","flex"),r.addClass(u.getBody(),"mce-edit-focus"),ee(o,e=>{lo(e.element,"display")}),x(),of(u)?y(e=>WO.isDocked(e)?WO.reset(e):WO.refresh(e)):y(WO.refresh)},hide:()=>{d.set(!1),oe(g.outerContainer.element,"display","none"),r.removeClass(u.getBody(),"mce-edit-focus"),ee(o,e=>{oe(e.element,"display","none")})},update:y,updateMode:()=>{x()&&y(WO.reset)},repositionPopups:b}},y1=(e,t)=>{e=fn(e);return{pos:t?e.y:e.bottom,bounds:e}};var x1=Object.freeze({__proto__:null,render:async(c,t,d,u,e)=>{const m=t["mainUi"],g=Yl(),p=te(e.targetNode),h=b1(c,p,t,u,g),f=kh(c),o=(await CT(c),()=>{if(g.isSet())h.show();else{g.set(fT.getHeader(m.outerContainer).getOrDie());var e=Qh(c);of(c)?(_d(p,m.mothership),_d(p,t.popupUi.mothership)):Od(e,m.mothership),Od(e,t.dialogUi.mothership),l1(c,t,d,u),fT.setMenubar(m.outerContainer,yT(c,d)),h.show();{var a=c;var s=p;var i=h;e=f;const l=D(y1(s,i.isPositionedAtTop())),o=e=>{var{pos:t,bounds:o}=y1(s,i.isPositionedAtTop()),{pos:n,bounds:r}=l.get(),r=o.height!==r.height||o.width!==r.width;l.set({pos:t,bounds:o}),r&&ey(a,e),i.isVisible()&&(n!==t?i.update(WO.reset):r&&(i.updateMode(),i.repositionPopups()))};e||(a.on("activate",i.show),a.on("deactivate",i.hide)),a.on("SkinLoaded ResizeWindow",()=>i.update(WO.reset)),a.on("NodeChange keydown",e=>{requestAnimationFrame(()=>o(e))});let t=0;const n=iS(()=>i.update(WO.refresh),33),r=(a.on("ScrollWindow",()=>{var e=sn().left;e!==t&&(t=e,n.throttle()),i.updateMode()}),of(a)&&a.on("ElementScroll",e=>{i.update(WO.refresh)}),Xl());r.set(Zl(te(a.getBody()),"load",e=>o(e.raw))),a.on("remove",()=>{r.clear()})}c.nodeChanged()}});c.on("show",o),c.on("hide",h.hide),f||(c.on("focus",o),c.on("blur",h.hide)),c.on("init",()=>{(c.hasFocus()||f)&&o()}),cb(c,t);e={show:o,hide:h.hide,setEnabled:e=>{lb(t,!e)},isEnabled:()=>!ae.isDisabled(m.outerContainer)};return{editorContainer:m.outerContainer.element.dom,api:e}}});const w1="contexttoolbar-hide",S1=(n,r)=>ne(MS,(e,t)=>{var o;o=n.get(e),r.onAction({hide:()=>B(o,Oa()),getValue:()=>y.getValue(o)},t.event.buttonApi)}),k1=(e,t)=>{const o=e.label.fold(()=>({}),e=>({"aria-label":e})),n=ie(Af.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:e.initValue(),inputAttributes:o,selectOnFocus:!0,inputBehaviours:re([se.config({mode:"special",onEnter:e=>r.findPrimary(e).map(e=>(Wa(e),!0)),onLeft:(e,t)=>(t.cut(),Q.none()),onRight:(e,t)=>(t.cut(),Q.none())})])})),r=((n,e,r)=>{const a=k(e,e=>{return ie((t=n,o=r,("contextformtogglebutton"===(e=e).type?(e,t,o)=>{const{primary:n,...r}=t.original,a=cr(Ev({...r,type:"togglebutton",onAction:S}));return o1(a,o,[S1(e,t)])}:(e,t,o)=>{const{primary:n,...r}=t.original,a=cr(Ov({...r,type:"button",onAction:S}));return t1(a,o,[S1(e,t)])})(t,e,o)));var t,o});return{asSpecs:()=>k(a,e=>e.asSpec()),findPrimary:o=>Ie(e,(e,t)=>e.primary?Q.from(a[t]).bind(e=>e.getOpt(o)).filter(q(ae.isDisabled)):Q.none())}})(n,e.commands,t);return[{title:Q.none(),items:[n.asSpec()]},{title:Q.none(),items:r.asSpecs()}]},C1=(e,t,o)=>t.bottom-e.y>=o&&e.bottom-t.y>=o,O1=e=>{t=e.selection.getRng();var t=(o=t.getBoundingClientRect()).height<=0&&o.width<=0?(t=Nt(te(t.startContainer),t.startOffset).element,(vt(t)?At(t):Q.some(t)).filter(ft).map(e=>e.dom.getBoundingClientRect()).getOr(o)):o;if(e.inline){const e=sn();return hn(e.left+t.left,e.top+t.top,t.width,t.height)}var o=vn(te(e.getBody()));return hn(o.x+t.left,o.y+t.top,t.width,t.height)},_1=(e,t,o,n=0)=>{const r=dn(window),a=fn(te(e.getContentAreaContainer())),s=jh(e)||qh(e)||Yh(e),{x:i,width:l}=(c=a,u=r,d=n,{x:m=Math.max(c.x+d,u.x),width:Math.min(c.right-d,u.right)-m});var c,d,u,m,g;if(e.inline&&!s)return hn(i,r.y,l,r.height);{const s=t.header.isPositionedAtTop(),{y:p,bottom:h}=(c=e,d=a,u=r,m=s,t=o,e=n,o=te(c.getContainer()),n=pi(o,".tox-editor-header").getOr(o),n=fn(n),g=n.y>=d.bottom,m=m&&!g,c.inline&&m?{y:Math.max(n.bottom+e,u.y),bottom:u.bottom}:c.inline&&!m?{y:u.y,bottom:Math.min(n.y-e,u.bottom)}:(g="line"===t?fn(o):d,m?{y:Math.max(n.bottom+e,u.y),bottom:Math.min(g.bottom-e,u.bottom)}:{y:Math.max(g.y+e,u.y),bottom:Math.min(n.y-e,u.bottom)}));return hn(i,p,l,h-p)}},T1={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},E1={maxHeightFunction:ac(),maxWidthFunction:D_()},A1=e=>"node"===e,M1=(s,e,i,t)=>{const o=a=>(e,t,o,n,r)=>({...((e,t,o,n,r)=>{const a=O1(e),s=n.lastElement().exists(e=>kt(o,e));return l=o,e=e.selection.getRng(),c=Nt(te(e.startContainer),e.startOffset),e.startContainer===e.endContainer&&e.startOffset===e.endOffset-1&&kt(c.element,l)?s?yC:pC:s?(i=t,e=n.getMode(),c=ao(i,"position"),oe(i,"position",e),e=C1(a,fn(t),-20)&&!n.isReposition()?wC:yC,c.each(e=>oe(i,"position",e)),e):("fixed"===n.getMode()?r.y+sn().top:r.y)+(go(t)+12)<=a.y?pC:hC;var i,l,c})(s,n,a,i,r)({...e,y:r.y,height:r.height},t,o,n,r),alwaysFit:!0}),n=e=>A1(t)?[o(e)]:[];return e?{onLtr:e=>[il,ol,nl,rl,al,sl].concat(n(e)),onRtl:e=>[il,nl,ol,al,rl,sl].concat(n(e))}:{onLtr:e=>[sl,il,rl,ol,al,nl].concat(n(e)),onRtl:e=>[sl,il,al,nl,rl,ol].concat(n(e))}},D1=(t,e)=>{var e=ve(e,e=>e.predicate(t.dom)),{pass:e,fail:o}=fe(e,e=>"contexttoolbar"===e.type);return{contextToolbars:e,contextForms:o}},B1=(i,l)=>{const c={},d=[],u=[],m={},g={},e=Re(i);return ee(e,e=>{var t,o,n=i[e];if("contextform"===n.type){var r=e,a=n;const s=cr(lr("ContextForm",Rv,a));(c[r]=s).launch.map(e=>{m["form:"+r]={...a.launch,type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:()=>{l(s)}}}),("editor"===s.scope?u:d).push(s),g[r]=s}else"contexttoolbar"===n.type&&(t=e,e=o=n,lr("ContextToolbar",Nv,e).each(e=>{("editor"===o.scope?u:d).push(e),g[t]=e}))}),{forms:c,inNodeScope:d,inEditorScope:u,lookupTable:g,formNavigators:m}},F1=I("forward-slide"),I1=I("backward-slide"),R1=I("change-slide-event"),N1="tox-pop--resizing",V1="tox-pop--transition",z1=(l,e,c,a)=>{const t=a.backstage,d=t.shared,u=Yo().deviceType.isTouch,m=Yl(),g=Yl(),p=Yl(),h=ai((e=>{const o=D([]);return Vp.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:e=>{o.set([]),Vp.getContent(e).each(e=>{lo(e.element,"visibility")}),Us(e.element,N1),lo(e.element,"width")},inlineBehaviours:re([V("context-toolbar-events",[ts(ma(),(e,t)=>{"width"===t.event.raw.propertyName&&(Us(e.element,N1),lo(e.element,"width"))}),ne(R1,(e,t)=>{const o=e.element;lo(o,"width");var n=wo(o);Vp.setContent(e,t.event.contents),Ps(o,N1);const r=wo(o);oe(o,"width",n+"px"),Vp.getContent(e).each(e=>{t.event.focus.bind(e=>(El(e),Bl(o))).orThunk(()=>(se.focusIn(e),Dl(Lt(o))))}),setTimeout(()=>{oe(e.element,"width",r+"px")},0)}),ne(F1,(t,e)=>{Vp.getContent(t).each(e=>{o.set(o.get().concat([{bar:e,focus:Dl(Lt(t.element))}]))}),F(t,R1,{contents:e.event.forwardContents,focus:Q.none()})}),ne(I1,(t,e)=>{Be(o.get()).each(e=>{o.set(o.get().slice(0,o.get().length-1)),F(t,R1,{contents:si(e.bar),focus:e.focus})})})]),se.config({mode:"special",onEscape:t=>Be(o.get()).fold(()=>e.onEscape(),e=>(B(t,I1),Q.some(!0)))})]),lazySink:()=>_.value(e.sink)})})({sink:c,onEscape:()=>(l.focus(),Q.some(!0))})),f=()=>{var e=p.get().getOr("node"),t=A1(e)?1:0;return _1(l,d,e,t)},v=()=>!(l.removed||u()&&t.isContextMenuOpen()),b=()=>{var e,t,o;return!v()||(e=f(),t=Xe(p.get(),"node")?(o=l,m.get().filter(e=>jt(e)&&ht(e)).map(vn).getOrThunk(()=>O1(o))):O1(l),e.height<=0)||!C1(t,e,.01)},o=()=>{m.clear(),g.clear(),p.clear(),Vp.hide(h)},n=()=>{var e;Vp.isOpen(h)&&(e=h.element,lo(e,"display"),b()?oe(e,"display","none"):(g.set(0),Vp.reposition(h)))},y=e=>({dom:{tag:"div",classes:["tox-pop__dialog"]},components:[e],behaviours:re([se.config({mode:"acyclic"}),V("pop-dialog-wrap-events",[os(e=>{l.shortcuts.add("ctrl+F9","focus statusbar",()=>se.focusIn(e))}),ns(e=>{l.shortcuts.remove("ctrl+F9")})])])}),s=ko(()=>B1(e,e=>{e=x([e]);F(h,F1,{forwardContents:y(e)})})),x=e=>{const t=l.ui.registry.getAll()["buttons"],n={...t,...s().formNavigators},o=bh(l)===Zp.scrolling?Zp.scrolling:Zp.default,r=Se(k(e,e=>{return"contexttoolbar"===e.type?(t=n,o=e,i1(l,{buttons:t,toolbar:o.items,allowToolbarGroups:!1},a.backstage,Q.some(["form:"]))):(t=e,o=d.providers,k1(t,o));var t,o}));return eT({type:o,uid:I("context-toolbar"),initGroups:r,onEscape:Q.none,cyclicKeying:!0,providers:d.providers})},r=(e,t)=>{var o,n,r,a,s,i;w.cancel(),v()&&(o=x(e),e=e[0].position,n=t,n="node"===(i=e)?d.anchors.node(n):d.anchors.cursor(),a=l,i=i,r=u(),s={lastElement:m.get,isReposition:()=>Xe(g.get(),0),getMode:()=>gd.getMode(c)},a="line"===i?{bubble:cc(12,0,T1),layouts:{onLtr:()=>[ll],onRtl:()=>[cl]},overrides:E1}:{bubble:cc(0,12,T1,1/12),layouts:M1(a,r,s,i),overrides:E1},r=Fn(n,a),p.set(e),g.set(1),s=h.element,lo(s,"display"),i=t,Xe(Ke(i,m.get(),kt),!0)||(Us(s,V1),gd.reset(c,h)),Vp.showWithinBounds(h,y(o),{anchor:r,transition:{classes:[V1],mode:"placement"}},()=>Q.some(f())),t.fold(m.clear,m.set),b())&&oe(s,"display","none")};let i=!1;const w=iS(()=>{!l.hasFocus()||l.removed||i||(Ws(h.element,V1)?w.throttle():((o,e)=>{const t=te(e.getBody()),r=e=>kt(e,t),a=te(e.selection.getNode());return e=a,r(e)||Ct(t,e)?((e,t,o)=>{var n=D1(e,t);if(0<n.contextForms.length)return Q.some({elem:e,toolbars:[n.contextForms[0]]});{const t=D1(e,o);if(0<t.contextForms.length)return Q.some({elem:e,toolbars:[t.contextForms[0]]});if(0<n.contextToolbars.length||0<t.contextToolbars.length){const o=(e=>{if(e.length<=1)return e;var t=t=>ge(e,e=>e.position===t),o=t=>ve(e,e=>e.position===t),n=t("selection"),t=t("node");if(n||t){if(t&&n){const e=o("node"),r=k(o("selection"),e=>({...e,position:"node"}));return e.concat(r)}return o(n?"selection":"node")}return o("line")})(n.contextToolbars.concat(t.contextToolbars));return Q.some({elem:e,toolbars:o})}return Q.none()}})(a,o.inNodeScope,o.inEditorScope).orThunk(()=>{return e=r,t=a,n=o,e(t)?Q.none():Wr(t,e=>{var t,o;return ft(e)&&({contextToolbars:t,contextForms:o}=D1(e,n.inNodeScope),0<(o=0<o.length?o:(e=>{if(e.length<=1)return e;{const t=t=>xe(e,e=>e.position===t);return t("selection").orThunk(()=>t("node")).orThunk(()=>t("line")).map(e=>e.position).fold(()=>[],t=>ve(e,e=>e.position===t))}})(t)).length)?Q.some({elem:e,toolbars:o}):Q.none()},e);var e,t,n}):Q.none()})(s(),l).fold(o,e=>{r(e.toolbars,Q.some(e.elem))}))},17);l.on("init",()=>{l.on("remove",o),l.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",n),l.on("click keyup focus SetContent",w.throttle),l.on(w1,o),l.on("contexttoolbar-show",t=>{var e=s();C(e.lookupTable,t.toolbarKey).each(e=>{r([e],Ze(t.target!==l,t.target)),Vp.getContent(h).each(se.focusIn)})}),l.on("focusout",e=>{zp.setEditorTimeout(l,()=>{Bl(c.element).isNone()&&Bl(h.element).isNone()&&o()},0)}),l.on("SwitchMode",()=>{l.mode.isReadOnly()&&o()}),l.on("AfterProgressState",e=>{e.state?o():l.hasFocus()&&w.throttle()}),l.on("dragstart",()=>{i=!0}),l.on("dragend drop",()=>{i=!1}),l.on("NodeChange",e=>{Bl(h.element).fold(w.throttle,S)})})},H1=(s,i)=>{const t=()=>{const e=i.getOptions(s),r=i.getCurrent(s).map(i.hash),a=Yl();return k(e,n=>({type:"togglemenuitem",text:i.display(n),onSetup:t=>{var e=e=>{e&&(a.on(e=>e.setActive(!1)),a.set(t)),t.setActive(e)};e(Xe(r,i.hash(n)));const o=i.watcher(s,n,e);return()=>{a.clear(),o()}},onAction:()=>i.setCurrent(s,n)}))};s.ui.registry.addMenuButton(i.name,{tooltip:i.text,icon:i.icon,fetch:e=>e(t()),onSetup:i.onToolbarSetup}),s.ui.registry.addNestedMenuItem(i.name,{type:"nestedmenuitem",text:i.text,getSubmenuItems:t,onSetup:i.onMenuSetup})},L1=t=>{var o,e;H1(t,(e=t,{name:"lineheight",text:"Line height",icon:"line-height",getOptions:$h,hash:e=>{return t=e,zT(t,["fixed","relative","empty"]).map(({value:e,unit:t})=>e+t).getOr(e);var t},display:w,watcher:(e,t,o)=>e.formatter.formatChanged("lineheight",o,!1,{value:t}).unbind,getCurrent:e=>Q.from(e.queryCommandValue("LineHeight")),setCurrent:(e,t)=>e.execCommand("LineHeight",!1,t),onToolbarSetup:ny(e),onMenuSetup:ny(e)})),o=t,Q.from(fh(o)).map(e=>({name:"language",text:"Language",icon:"language",getOptions:T(e),hash:e=>P(e.customCode)?e.code:e.code+"/"+e.customCode,display:e=>e.title,watcher:(e,t,o)=>{return e.formatter.formatChanged("lang",o,!1,{value:t.code,customValue:null!=(e=t.customCode)?e:null}).unbind},getCurrent:e=>{e=te(e.selection.getNode());return jr(e,e=>Q.some(e).filter(ft).bind(t=>Kt(t,"lang").map(e=>({code:e,customCode:Kt(t,"data-mce-lang").getOrUndefined(),title:""}))))},setCurrent:(e,t)=>e.execCommand("Lang",!1,t),onToolbarSetup:e=>{var t=Xl();return e.setActive(o.formatter.match("lang",{},void 0,!0)),t.set(o.formatter.formatChanged("lang",e.setActive,!0)),oy(t.clear,ny(o)(e))},onMenuSetup:ny(o)})).each(e=>H1(t,e))},P1=t=>ay(t,"NodeChange",e=>{e.setEnabled(t.queryCommandState("outdent")&&t.selection.isEditable())}),U1=(o,n)=>t=>{t.setActive(n.get());const e=e=>{n.set(e.state),t.setActive(e.state)};return o.on("PastePlainTextToggle",e),oy(()=>o.off("PastePlainTextToggle",e),ny(o)(t))},W1=(e,t)=>()=>{e.execCommand("mceToggleFormat",!1,t)},j1=e=>{var t,o,n,r=e,a=r;sS.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(e,t)=>{a.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onSetup:ry(a,e.name),onAction:W1(a,e.name)})});for(let e=1;e<=6;e++){var s="h"+e;a.ui.registry.addToggleButton(s,{text:s.toUpperCase(),tooltip:"Heading "+e,onSetup:ry(a,s),onAction:W1(a,s)})}o=r,sS.each([{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"print",text:"Print",action:"mcePrint",icon:"print"}],e=>{o.ui.registry.addButton(e.name,{tooltip:e.text,icon:e.icon,onAction:iy(o,e.action)})}),sS.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],e=>{o.ui.registry.addButton(e.name,{tooltip:e.text,icon:e.icon,onSetup:ny(o),onAction:iy(o,e.action)})}),t=r,sS.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],e=>{t.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onAction:iy(t,e.action),onSetup:ry(t,e.name)})}),n=e,sS.each([{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"},{name:"print",text:"Print...",action:"mcePrint",icon:"print",shortcut:"Meta+P"}],e=>{n.ui.registry.addMenuItem(e.name,{text:e.text,icon:e.icon,shortcut:e.shortcut,onAction:iy(n,e.action)})}),sS.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],e=>{n.ui.registry.addMenuItem(e.name,{text:e.text,icon:e.icon,shortcut:e.shortcut,onSetup:ny(n),onAction:iy(n,e.action)})}),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onSetup:ny(n),onAction:W1(n,"code")})},G1=(t,o)=>ay(t,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",e=>{e.setEnabled(!t.mode.isReadOnly()&&t.undoManager[o]())}),$1=t=>ay(t,"VisualAid",e=>{e.setActive(t.hasVisual)}),q1=(e,t)=>{n=e,ee([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],e=>{n.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onAction:iy(n,e.cmd),onSetup:ry(n,e.name)})}),n.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onSetup:ny(n),onAction:iy(n,"JustifyNone")}),j1(e);var o,a,n,r=e;{var s=r,i=t;const l=_T(0,i,MT(s));s.ui.registry.addNestedMenuItem("align",{text:i.shared.providers.translate("Align"),onSetup:ny(s),getSubmenuItems:()=>l.items.validateItems(l.getStyleItems())})}{i=r,s=t;const c=_T(0,s,RT(i));i.ui.registry.addNestedMenuItem("fontfamily",{text:s.shared.providers.translate("Fonts"),onSetup:ny(i),getSubmenuItems:()=>c.items.validateItems(c.getStyleItems())})}{s=r;const d={type:"advanced",...(i=t).styles},u=_T(0,i,WT(s,d));s.ui.registry.addNestedMenuItem("styles",{text:"Formats",onSetup:ny(s),getSubmenuItems:()=>u.items.validateItems(u.getStyleItems())})}{i=r,s=t;const m=_T(0,s,BT(i));i.ui.registry.addNestedMenuItem("blocks",{text:"Blocks",onSetup:ny(i),getSubmenuItems:()=>m.items.validateItems(m.getStyleItems())})}{s=r,i=t;const g=_T(0,i,UT(s));s.ui.registry.addNestedMenuItem("fontsize",{text:"Font sizes",onSetup:ny(s),getSubmenuItems:()=>g.items.validateItems(g.getStyleItems())})}(t=r=e).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:G1(t,"hasUndo"),onAction:iy(t,"undo")}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:G1(t,"hasRedo"),onAction:iy(t,"redo")}),(t=r).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",enabled:!1,onSetup:G1(t,"hasUndo"),onAction:iy(t,"undo")}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",enabled:!1,onSetup:G1(t,"hasRedo"),onAction:iy(t,"redo")}),(a=i=e).addCommand("mceApplyTextcolor",(e,t)=>{var o,n,r;n=e,r=t,(o=a).undoManager.transact(()=>{o.focus(),o.formatter.apply(n,{value:r}),o.nodeChanged()})}),a.addCommand("mceRemoveTextcolor",e=>{var t,o;o=e,(t=a).undoManager.transact(()=>{t.focus(),t.formatter.remove(o,{value:null},void 0,!0),t.nodeChanged()})}),s=Oy(i),r=_y(i),s=D(s),r=D(r),Iy(i,"forecolor","forecolor","Text color",s),Iy(i,"backcolor","hilitecolor","Background color",r),Ry(i,"forecolor","forecolor","Text color",s),Ry(i,"backcolor","hilitecolor","Background color",r),(s=t=e).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:iy(s,"mceToggleVisualAid")}),(s=t).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:$1(s),onAction:iy(s,"mceToggleVisualAid")}),(i=e).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:P1(i),onAction:iy(i,"outdent")}),i.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onSetup:ny(i),onAction:iy(i,"indent")}),L1(e),o=e,r=D(Hh(o)),t=()=>o.execCommand("mceTogglePlainTextPaste"),o.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:t,onSetup:U1(o,r)}),o.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:t,onSetup:U1(o,r)})},X1=t=>e=>e.options.get(t),Y1=X1("contextmenu_never_use_native"),K1=X1("contextmenu_avoid_overlap"),J1=e=>{const t=e.ui.registry.getAll().contextMenus,o=e.options.get("contextmenu");return e.options.isSet("contextmenu")?o:ve(o,e=>$e(t,e))},Z1=(e,t)=>({type:"makeshift",x:e,y:t}),Q1=e=>"longpress"===e.type||0===e.type.indexOf("touch"),eE=e=>({type:"selection",root:te(e.selection.getNode())}),tE=(e,t,o)=>{switch(o){case"node":return i=e,{type:"node",node:Q.some(te(i.selection.getNode())),root:te(i.getBody())};case"point":return i=e,"contextmenu"===(n=t).type||"longpress"===n.type?i.inline?(a=n,Q1(a)?(s=a.touches[0],Z1(s.pageX,s.pageY)):Z1(a.pageX,a.pageY)):(s=i.getContentAreaContainer(),a=n,n=Q1(a)?(n=a.touches[0],Z1(n.clientX,n.clientY)):Z1(a.clientX,a.clientY),s=eh.DOM.getPos(s),n=n,r=s.x,s=s.y,Z1(n.x+r,n.y+s)):eE(i);case"selection":return eE(e)}var n,r,a,s,i},oE=(e,t,o,n,r,a)=>{const s=o(),i=tE(e,t,a);jS(s,sf.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!1,search:Q.none()}).map(e=>{t.preventDefault(),Vp.showMenuAt(r,{anchor:i},{menu:{markers:Sf("normal")},data:e})})},nE={onLtr:()=>[il,ol,nl,rl,al,sl,pC,hC,gC,uC,mC,dC],onRtl:()=>[il,nl,ol,al,rl,sl,pC,hC,mC,dC,gC,uC]},rE={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},aE=(c,t,d,u,m,g)=>{const e=Yo(),p=e.os.isiOS(),h=e.os.isMacOS(),f=e.os.isAndroid(),v=e.deviceType.isTouch(),s=()=>{var e=d();{var o=c,n=t,r=u,a=m,s=g,i=!(f||p||h&&v);const l=((e,t,o)=>{e=tE(e,t,o);return{bubble:cc(0,"point"===o?12:0,rE),layouts:nE,overrides:{maxWidthFunction:D_(),maxHeightFunction:ac()},...e}})(o,n,s);jS(e,sf.CLOSE_ON_EXECUTE,r,{isHorizontalMenu:!0,search:Q.none()}).map(e=>{n.preventDefault();var t=i?lp.HighlightMenuAndItem:lp.HighlightNone;Vp.showMenuWithinBounds(a,{anchor:l},{menu:{markers:Sf("normal"),highlightOnOpen:t},data:e,type:"horizontal"},()=>Q.some(_1(o,r.shared,"node"===s?"node":"selection"))),o.dispatch(w1)})}};if((h||p)&&"node"!==g){const d=()=>{{var e=c;const t=e.selection.getRng(),o=()=>{zp.setEditorTimeout(e,()=>{e.selection.setRng(t)},10),a()},n=(e.once("touchend",o),e=>{e.preventDefault(),e.stopImmediatePropagation()}),r=(e.on("mousedown",n,!0),()=>a()),a=(e.once("longpresscancel",r),()=>{e.off("touchend",o),e.off("longpresscancel",r),e.off("mousedown",n)})}s()};((e,t)=>{var o=e.selection;if(o.isCollapsed()||t.touches.length<1)return!1;{const n=t.touches[0],r=o.getRng();return jc(e.getWin(),Fc.domRange(r)).exists(e=>e.left<=n.clientX&&e.right>=n.clientX&&e.top<=n.clientY&&e.bottom>=n.clientY)}})(c,t)?d():(c.once("selectionchange",d),c.once("touchend",()=>c.off("selectionchange",d)))}else s()},sE=e=>L(e)?"|"===e:"separator"===e.type,iE={type:"separator"},lE=t=>{var e,o=e=>({text:e.text,icon:e.icon,enabled:e.enabled,shortcut:e.shortcut});if(L(t))return t;switch(t.type){case"separator":return iE;case"submenu":return{type:"nestedmenuitem",...o(t),getSubmenuItems:()=>{var e=t.getSubmenuItems();return L(e)?e:k(e,lE)}};default:var n=t;return{type:"menuitem",...o(n),onAction:(e=n.onAction,()=>e())}}},cE=(e,t)=>{var o;return 0===t.length?e:(o=Be(e).filter(e=>!sE(e)).fold(()=>[],e=>[iE]),e.concat(o).concat(t).concat([iE]))},dE=(e,t)=>{return!("longpress"===(o=t).type||$e(o,"touches"))&&(2!==t.button||t.target===e.getBody()&&""===t.pointerType);var o},uE=(e,t)=>dE(e,t)?e.selection.getStart(!0):t.target,mE=(s,e,r)=>{const i=Yo().deviceType.isTouch,l=ai(Vp.sketch({dom:{tag:"div"},lazySink:e,onEscape:()=>s.focus(),onShow:()=>r.setContextMenuState(!0),onHide:()=>r.setContextMenuState(!1),fireDismissalEventInstead:{},inlineBehaviours:re([V("dismissContextMenu",[ne(Ia(),(e,t)=>{m.close(e),s.focus()})])])})),t=()=>Vp.hide(l),o=a=>{var e,t,o,n;Y1(s)&&a.preventDefault(),e=s,a.ctrlKey&&!Y1(e)||(e=s,0===J1(e).length)||(e=s,t=a,o=K1(e),n=dE(e,t)?"selection":"point",t=rt(o)&&(e=uE(e,t),Cx(te(e),o))?"node":n,(i()?aE:oE)(s,a,()=>{var e=uE(s,a),t=s.ui.registry.getAll(),o=J1(s),n=t.contextMenus,t=o,r=e;return 0<(t=ye(t,(o,e)=>C(n,e.toLowerCase()).map(e=>{var t=e.update(r);if(L(t)&&rt(nt(t)))return cE(o,t.split(" "));if(c(t)&&0<t.length){const e=k(t,lE);return cE(o,e)}return o}).getOrThunk(()=>o.concat([e])),[])).length&&sE(t[t.length-1])&&t.pop(),t},r,l,t))};s.on("init",()=>{var e="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(i()?"":" ResizeWindow");s.on(e,t),s.on("longpress contextmenu",o)})},gE=Hr([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),pE=t=>e=>e.translate(-t.left,-t.top),hE=t=>e=>e.translate(t.left,t.top),fE=o=>(e,t)=>ye(o,(e,t)=>t(e),fo(e,t)),vE=(e,t,o)=>e.fold(fE([hE(o),pE(t)]),fE([pE(t)]),fE([])),bE=(e,t,o)=>e.fold(fE([hE(o)]),fE([]),fE([hE(t)])),yE=(e,t,o)=>e.fold(fE([]),fE([pE(o)]),fE([hE(t),pE(o)])),xE=(e,t,o)=>{e=e.fold((e,t)=>({position:Q.some("absolute"),left:Q.some(e+"px"),top:Q.some(t+"px")}),(e,t)=>({position:Q.some("absolute"),left:Q.some(e-o.left+"px"),top:Q.some(t-o.top+"px")}),(e,t)=>({position:Q.some("fixed"),left:Q.some(e+"px"),top:Q.some(t+"px")}));return{right:Q.none(),bottom:Q.none(),...e}},wE=(e,a,s,i)=>{var t=(n,r)=>(e,t)=>{var o=n(a,s,i);return r(e.getOr(o.left),t.getOr(o.top))};return e.fold(t(yE,SE),t(bE,kE),t(vE,CE))},SE=gE.offset,kE=gE.absolute,CE=gE.fixed,OE=(e,t)=>{e=Yt(e,t);return P(e)?NaN:parseInt(e,10)},_E=(e,t,o,n,r,a)=>{c=o,d=n,o=t,n=(n=e).element,u=OE(n,o.leftAttr),n=OE(n,o.topAttr);const s=(isNaN(u)||isNaN(n)?Q.none():Q.some(fo(u,n))).fold(()=>c,e=>CE(e.left+d.left,e.top+d.top)),i=(t.mustSnap?(e,t,r,a,s)=>{const o=t.getSnapPoints(e);return TE(o,r,a,s).orThunk(()=>{const e=ye(o,(t,o)=>{const e=o.sensor,n=((e,t,o,n,r,a)=>{const s=bE(e,r,a),i=bE(t,r,a),l=Math.abs(s.left-i.left),c=Math.abs(s.top-i.top);return fo(l,c)})(r,e,o.range.left,o.range.top,a,s);return t.deltas.fold(()=>({deltas:Q.some(n),snap:Q.some(o)}),e=>(n.left+n.top)/2<=(e.left+e.top)/2?{deltas:Q.some(n),snap:Q.some(o)}:t)},{deltas:Q.none(),snap:Q.none()});return e.snap.map(e=>({output:wE(e.output,r,a,s),extra:e.extra}))})}:(e,t,o,n,r)=>{const a=t.getSnapPoints(e);return TE(a,o,n,r)})(e,t,s,r,a),l=vE(s,r,a);var c,d,o=e,u=t,n=l;return o=o.element,O(o,u.leftAttr,n.left+"px"),O(o,u.topAttr,n.top+"px"),i.fold(()=>({coord:CE(l.left,l.top),extra:Q.none()}),e=>({coord:e.output,extra:e.extra}))},TE=(e,o,n,r)=>Ie(e,e=>{var t=e.sensor;return((e,t,o,n,r,a)=>{e=bE(e,r,a),t=bE(t,r,a);return Math.abs(e.left-t.left)<=o&&Math.abs(e.top-t.top)<=n})(o,t,e.range.left,e.range.top,n,r)?Q.some({output:wE(e.output,o,n,r),extra:e.extra}):Q.none()});Ac=Object.freeze({__proto__:null,snapTo:(e,t,o,n)=>{var r,a=t.getTarget(e.element);if(t.repositionTarget){const t=Ot(e.element),o=sn(t),s=wO(a),i=(e=n,n=o,r=s,{coord:wE(e.output,e.output,n,r),extra:e.extra}),l=xE(i.coord,0,s);oo(a,l)}}});const EE="data-initial-z-index",AE=(e,t)=>{var o;e.getSystem().addToGui(t),o=t,At(o.element).filter(ft).each(t=>{ao(t,"z-index").each(e=>{O(t,EE,e)}),oe(t,"z-index",no(o.element,"z-index"))})},ME=e=>{var t;t=e,At(t.element).filter(ft).each(t=>{Kt(t,EE).fold(()=>lo(t,"z-index"),e=>oe(t,"z-index",e)),Zt(t,EE)}),e.getSystem().removeFromGui(e)},DE=(e,t,o)=>e.getSystem().build(Ix.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:o}));ld=Mr("snaps",[A("getSnapPoints"),e("onSensor"),A("leftAttr"),A("topAttr"),M("lazyViewport",yn),M("mustSnap",!1)]);const BE=[M("useFixed",K),A("blockerClass"),M("getTarget",w),M("onDrag",S),M("repositionTarget",!0),M("onDrop",S),Nr("getBounds",yn),ld],FE=t=>{return e=ao(t,"left"),o=ao(t,"top"),n=ao(t,"position"),(e.isSome()&&o.isSome()&&n.isSome()?Q.some((e=e.getOrDie(),o=o.getOrDie(),("fixed"===n.getOrDie()?CE:SE)(parseInt(e,10),parseInt(o,10)))):Q.none()).getOrThunk(()=>{var e=bo(t);return kE(e.left,e.top)});var e,o,n},IE=(e,t)=>({bounds:e.getBounds(),height:po(t.element),width:So(t.element)}),RE=(l,c,e,t,o)=>{const n=e.update(t,o),d=e.getStartData().getOrThunk(()=>IE(c,l));n.each(e=>{var t,o,n,r,a,s,i;t=l,o=c,n=d,e=e,i=o.getTarget(t.element),o.repositionTarget&&(s=Ot(t.element),s=sn(s),r=wO(i),a=FE(i),a=((o,e,r,a,s,i,t)=>{{e=e.fold(()=>{o=i.left,n=i.top;var o,n,e=r.fold((e,t)=>SE(e+o,t+n),(e,t)=>kE(e+o,t+n),(e,t)=>CE(e+o,t+n)),e=vE(e,a,s);return CE(e.left,e.top)},t=>{var e=_E(o,t,r,i,a,s);return e.extra.each(e=>{t.onSensor(o,e)}),e.coord});var n=a,l=s;const c=t.bounds,d=bE(e,n,l),u=qi(d.left,c.x,c.x+c.width-t.width),m=qi(d.top,c.y,c.y+c.height-t.height),g=kE(u,m);return e.fold(()=>{var e=yE(g,n,l);return SE(e.left,e.top)},T(g),()=>{var e=vE(g,n,l);return CE(e.left,e.top)})}})(t,o.snaps,a,s,r,e,n),s=xE(a,0,r),oo(i,s)),o.onDrag(t,i,e)})},NE=(o,e,t,n)=>{e.each(ME),t.snaps.each(e=>{var t;e=e,t=(t=o).element,Zt(t,e.leftAttr),Zt(t,e.topAttr)});e=t.getTarget(o.element);n.reset(),t.onDrop(o,e)},VE=e=>(t,o)=>{const n=e=>{o.setStartData(IE(t,e))};return qa([ne(Ma(),e=>{o.getStartData().each(()=>n(e))}),...e(t,o,n)])};var zE=Object.freeze({__proto__:null,getData:e=>Q.from(fo(e.x,e.y)),getDelta:(e,t)=>fo(t.left-e.left,t.top-e.top)});const HE=(i,l,c)=>[ne(Qr(),(t,e)=>{if(0!==e.event.raw.button)return;e.stop();const o=()=>NE(t,Q.some(a),i,l),n=Ox(o,200),r={drop:o,delayDrop:n.schedule,forceDrop:o,move:e=>{n.cancel(),RE(t,i,l,zE,e)}},a=DE(t,i.blockerClass,(s=r,qa([ne(Qr(),s.forceDrop),ne(oa(),s.drop),ne(ea(),(e,t)=>{s.move(t.event)}),ne(ta(),s.delayDrop)])));var s;c(t),AE(t,a)})],LE=[...BE,Fi("dragger",{handlers:VE(HE)})];var PE,UE=Object.freeze({__proto__:null,getData:e=>{var e=e.raw.touches;return 1===e.length?(e=e[0],Q.some(fo(e.clientX,e.clientY))):Q.none()},getDelta:(e,t)=>fo(t.left-e.left,t.top-e.top)});const WE=(n,r,a)=>{const s=Yl(),i=e=>{NE(e,s.get(),n,r),s.clear()};return[ne(Yr(),(t,e)=>{e.stop();var o,e=()=>i(t),e={drop:e,delayDrop:S,forceDrop:e,move:e=>{RE(t,n,r,UE,e)}},e=DE(t,n.blockerClass,(o=e,qa([ne(Yr(),o.forceDrop),ne(Jr(),o.drop),ne(Zr(),o.drop),ne(Kr(),(e,t)=>{o.move(t.event)})])));s.set(e),a(t),AE(t,e)}),ne(Kr(),(e,t)=>{t.stop(),RE(e,n,r,UE,t.event)}),ne(Jr(),(e,t)=>{t.stop(),i(e)}),ne(Zr(),i)]},jE=LE,GE=[...BE,Fi("dragger",{handlers:VE(WE)})],$E=[...BE,Fi("dragger",{handlers:VE((e,t,o)=>[...HE(e,t,o),...WE(e,t,o)])})],qE=Cl({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:jE,touch:GE,mouseOrTouch:$E}),name:"dragging",active:{events:(e,t)=>e.dragger.handlers(e,t)},extra:{snap:e=>({sensor:e.sensor,range:e.range,output:e.output,extra:Q.from(e.extra)})},state:Object.freeze({__proto__:null,init:()=>{let r=Q.none(),t=Q.none();var e=T({});return Ms({readState:e,reset:()=>{r=Q.none(),t=Q.none()},update:(n,e)=>n.getData(e).bind(e=>{return t=n,o=e,e=r.map(e=>t.getDelta(e,o)),r=Q.some(o),e;var t,o}),getStartData:()=>t,setStartData:e=>{t=Q.some(e)}})}}),apis:Ac}),XE=(e,n,r,a,t,o)=>e.fold(()=>qE.snap({sensor:kE(r-20,a-20),range:fo(t,o),output:kE(Q.some(r),Q.some(a)),extra:{td:n}}),e=>{var t=r-20,o=a-20,e=e.element.dom.getBoundingClientRect();return qE.snap({sensor:kE(t,o),range:fo(40,40),output:kE(Q.some(r-e.width/2),Q.some(a-e.height/2)),extra:{td:n}})}),YE=(e,r,a)=>({getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:(e,t)=>{var o,n,t=t.td;o=r.get(),n=t,o.exists(e=>kt(e,n))||(r.set(t),a(t))},mustSnap:!0}),KE=e=>ie(Hp.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:re([qE.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),sw.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}})),JE=(i,o)=>{const n=D([]),r=D([]),e=D(!1),a=Yl(),s=Yl(),t=e=>{var t=vn(e);return XE(u.getOpt(o),e,t.x,t.y,t.width,t.height)},l=e=>{var t=vn(e);return XE(m.getOpt(o),e,t.right,t.bottom,t.width,t.height)},c=YE(()=>k(n.get(),e=>t(e)),a,t=>{s.get().each(e=>{i.dispatch("TableSelectorChange",{start:t,finish:e})})}),d=YE(()=>k(r.get(),e=>l(e)),s,t=>{a.get().each(e=>{i.dispatch("TableSelectorChange",{start:e,finish:t})})}),u=KE(c),m=KE(d),g=ai(u.asSpec()),p=ai(m.asSpec()),h=(e,t,o,n)=>{o=o(t);qE.snapTo(e,o);{o=e,e=t.dom.getBoundingClientRect(),lo(o.element,"display");const r=Et(te(i.getBody())).dom.innerHeight,a=e[n]<0,s=e[n]>r;(a||s)&&oe(o.element,"display","none")}},f=e=>h(g,e,t,"top"),v=e=>h(p,e,l,"bottom");Yo().deviceType.isTouch()&&(i.on("TableSelectionChange",t=>{e.get()||(xd(o,g),xd(o,p),e.set(!0)),a.set(t.start),s.set(t.finish),t.otherCells.each(e=>{n.set(e.upOrLeftCells),r.set(e.downOrRightCells),f(t.start),v(t.finish)})}),i.on("ResizeEditor ResizeWindow ScrollContent",()=>{a.get().each(f),s.get().each(v)}),i.on("TableSelectionClear",()=>{e.get()&&(kd(g),kd(p),e.set(!1)),a.clear(),s.clear()}))},ZE=(a,e,s)=>{const i=null!=(e=e.delimiter)?e:"›";return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:re([se.config({mode:"flow",selector:"div[role=button]"}),ae.config({disabled:s.isDisabled}),db(),Hx.config({}),N.config({}),V("elementPathEvents",[os((t,e)=>{a.shortcuts.add("alt+F11","focus statusbar elementpath",()=>se.focusIn(t)),a.on("NodeChange",e=>{e=(e=>{var t,o=[];let n=e.length;for(;0<n--;){var r=e[n];if(1===r.nodeType&&"BR"!==(t=r).nodeName&&!t.getAttribute("data-mce-bogus")&&"bookmark"!==t.getAttribute("data-mce-type")){t=r;const e=a.dispatch("ResolveName",{name:t.nodeName.toLowerCase(),target:t});if(e.isDefaultPrevented()||o.push({name:e.name,element:r}),e.isPropagationStopped())break}}return o})(e.parents),e=0<e.length?ye(e,(e,t,o)=>{n=t.name,r=t.element,t=o;var n,r,t=Hp.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{"data-index":t,"aria-level":t+1}},components:[ti(n)],action:e=>{a.focus(),a.selection.select(r),a.nodeChanged()},buttonBehaviours:re([ub(s.isDisabled),db()])});return 0===o?e.concat([t]):e.concat([{dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0}},components:[ti(` ${i} `)]},t])},[]):[];N.set(t,e)})})])]),components:[]}},QE=((fl=PE=PE||{})[fl.None=0]="None",fl[fl.Both=1]="Both",fl[fl.Vertical=2]="Vertical",(e,t,o)=>{const n=te(e.getContainer()),r=((e,t,o,n,r)=>{n={height:p1(n+t.top,dh(e),mh(e))};return o===PE.Both&&(n.width=p1(r+t.left,ch(e),uh(e))),n})(e,t,o,go(n),wo(n));Ve(r,(e,t)=>{h(e)&&oe(n,t,g1(e))}),e.dispatch("ResizeEditor")}),eA=(e,t,o,n)=>{o=fo(20*o,20*n);return QE(e,o,t),Q.some(!0)},tA=(l,c)=>{return{dom:{tag:"div",classes:["tox-statusbar"]},components:(e=(()=>{const e=[],t=Uh(l),o=Nh(l),n=Vh(l)||l.hasPlugin("wordcount");return o&&e.push(ZE(l,{},c)),t&&e.push((i=wb("Alt+0"),{dom:{tag:"div",classes:["tox-statusbar__help-text"]},components:[ti(Lp.translate(["Press {0} for help",i]))]})),n&&e.push((i=[],l.hasPlugin("wordcount")&&i.push(((e,n)=>{const r=(e,t,o)=>N.set(e,[ti(n.translate(["{0} "+o,t[o]]))]);return Hp.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:re([ub(n.isDisabled),db(),Hx.config({}),N.config({}),y.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),V("wordcount-events",[as(e=>{var t=y.getValue(e),o="words"===t.mode?"characters":"words";y.setValue(e,{mode:o,count:t.count}),r(e,t.count,o)}),os(o=>{e.on("wordCountUpdate",e=>{var t=y.getValue(o)["mode"];y.setValue(o,{mode:t,count:e.wordCount}),r(o,e.wordCount,t)})})])]),eventOrder:{[wa()]:["disabling","alloy.base.behaviour","wordcount-events"]}})})(l,c)),Vh(l)&&i.push({dom:{tag:"span",classes:["tox-statusbar__branding"]},components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/powered-by-tiny?utm_campaign=editor_referral&utm_medium=poweredby&utm_source=tinymce&utm_content=v6",rel:"noopener",target:"_blank","aria-label":Lp.translate(["Powered by {0}","Tiny"])},innerHtml:'<svg width="50px" height="16px" viewBox="0 0 50 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.143 0c2.608.015 5.186 2.178 5.186 5.331 0 0 .077 3.812-.084 4.87-.361 2.41-2.164 4.074-4.65 4.496-1.453.284-2.523.49-3.212.623-.373.071-.634.122-.785.152-.184.038-.997.145-1.35.145-2.732 0-5.21-2.04-5.248-5.33 0 0 0-3.514.03-4.442.093-2.4 1.758-4.342 4.926-4.963 0 0 3.875-.752 4.036-.782.368-.07.775-.1 1.15-.1Zm1.826 2.8L5.83 3.989v2.393l-2.455.475v5.968l6.137-1.189V9.243l2.456-.476V2.8ZM5.83 6.382l3.682-.713v3.574l-3.682.713V6.382Zm27.173-1.64-.084-1.066h-2.226v9.132h2.456V7.743c-.008-1.151.998-2.064 2.149-2.072 1.15-.008 1.987.92 1.995 2.072v5.065h2.455V7.359c-.015-2.18-1.657-3.929-3.837-3.913a3.993 3.993 0 0 0-2.908 1.296Zm-6.3-4.266L29.16 0v2.387l-2.456.475V.476Zm0 3.2v9.132h2.456V3.676h-2.456Zm18.179 11.787L49.11 3.676H46.58l-1.612 4.527-.46 1.382-.384-1.382-1.611-4.527H39.98l3.3 9.132L42.15 16l2.732-.537ZM22.867 9.738c0 .752.568 1.075.921 1.075.353 0 .668-.047.998-.154l.537 1.765c-.23.154-.92.537-2.225.537-1.305 0-2.655-.997-2.686-2.686a136.877 136.877 0 0 1 0-4.374H18.8V3.676h1.612v-1.98l2.455-.476v2.456h2.302V5.9h-2.302v3.837Z"/>\n</svg>\n'.trim()},behaviours:re([z.config({})])}]}),{dom:{tag:"div",classes:["tox-statusbar__right-container"]},components:i})),0<e.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container",...(a="tox-statusbar__text-container--flex-start",s="tox-statusbar__text-container--flex-end",t?(r="tox-statusbar__text-container-3-cols",n||o?n&&!o?[r,s]:[r,a]:[r,"tox-statusbar__text-container--space-around"]):[n&&!o?s:a])]},components:e}]:[];var r,a,s,i})(),t=((n,e)=>{const r=(e=>{e=zh(e);return!1===e?PE.None:"both"===e?PE.Both:PE.Vertical})(n);var t;return r===PE.None?Q.none():(t=r===PE.Both?"Press the arrow keys to resize the editor.":"Press the Up and Down arrow keys to resize the editor.",Q.some(Yp("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:e.translate("Resize"),"aria-label":e.translate(t)},behaviours:[qE.config({mode:"mouse",repositionTarget:!1,onDrag:(e,t,o)=>QE(n,o,r),blockerClass:"tox-blocker"}),se.config({mode:"special",onLeft:()=>eA(n,r,-1,0),onRight:()=>eA(n,r,1,0),onUp:()=>eA(n,r,0,-1),onDown:()=>eA(n,r,0,1)}),Hx.config({}),z.config({})]},e.icons)))})(l,c),e.concat(t.toArray()))};var e,t},oA=(e,t)=>t.get().getOrDie(`UI for ${e} has not been rendered`),nA=(R,N)=>{const V=R.inline,z=V?x1:u1,H=tf(R)?QO:yO,L=(()=>{const t=Yl(),n=Yl(),o=Yl();return{dialogUi:t,popupUi:n,mainUi:o,getUiMotherships:()=>{const e=t.get().map(e=>e.mothership),o=n.get().map(e=>e.mothership);return e.fold(()=>o.toArray(),t=>o.fold(()=>[t],e=>kt(t.element,e.element)?[t]:[t,e]))},lazyGetInOuterOrDie:(e,t)=>()=>o.get().bind(e=>t(e.outerContainer)).getOrDie(`Could not find ${e} element in OuterContainer`)}})(),P=Yl(),U=Yl(),W=Yl(),j=Yo().deviceType.isTouch()?["tox-platform-touch"]:[],G=Kh(R),$=bh(R),q=ie({dom:{tag:"div",classes:["tox-anchorbar"]}}),X=ie({dom:{tag:"div",classes:["tox-bottom-anchorbar"]}}),Y=()=>L.mainUi.get().map(e=>e.outerContainer).bind(fT.getHeader),e=L.lazyGetInOuterOrDie("anchor bar",q.getOpt),t=L.lazyGetInOuterOrDie("bottom anchor bar",X.getOpt),K=L.lazyGetInOuterOrDie("toolbar",fT.getToolbar),J=L.lazyGetInOuterOrDie("throbber",fT.getThrobber),Z=((e,t,o,n)=>{const r=D(!1),a=(e=>{const t=D(Kh(e)?"bottom":"top");return{isPositionedAtTop:()=>"top"===t.get(),getDockingMode:t.get,setDockingMode:t.set}})(t),s={icons:()=>t.ui.registry.getAll().icons,menuItems:()=>t.ui.registry.getAll().menuItems,translate:Lp.translate,isDisabled:()=>t.mode.isReadOnly()||!t.ui.isEnabled(),getOption:t.options.get},i=aO(t),l=(o=>{const n=e=>()=>o.formatter.match(e),r=t=>()=>{var e=o.formatter.get(t);return void 0!==e?Q.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:o.dom.parseStyle(o.formatter.getCssText(t))}):Q.none()},a=D([]),s=D([]),i=D(!1);return o.on("PreInit",e=>{var t=BC(o),t=IC(o,t,n,r);a.set(t)}),o.on("addStyleModifications",e=>{var t=IC(o,e.items,n,r);s.set(t),i.set(e.replace)}),{getData:()=>{var e=i.get()?[]:a.get(),t=s.get();return e.concat(t)}}})(t),c={colorPicker:(e,t)=>{Ny(b)(e,t)},hasCustomColors:()=>Cy(v),getColors:e=>xy(f,e),getColorCols:(h=f=v=b=t,e=>ky(h,e))},d={isDraggableModal:(p=t,()=>Ih(p))},u={shared:{providers:s,anchors:((e,t,o,n)=>{const r=Zh(e),a=()=>te(e.getBody()),s=()=>te(e.getContentAreaContainer()),i=()=>r||!n();return{inlineDialog:kC(s,t,i),inlineBottomDialog:CC(e.inline,s,o,i),banner:OC(s,t,i),cursor:_C(e,a),node:TC(a)}})(t,o,n,a.isPositionedAtTop),header:a},urlinput:i,styles:l,colorinput:c,dialog:d,isContextMenuOpen:()=>r.get(),setContextMenuState:e=>r.set(e)},m={...u,shared:{...u.shared,interpreter:e=>rC(e,{},m),getSink:e.popup}},g={...u,shared:{...u.shared,interpreter:e=>rC(e,{},g),getSink:e.dialog}};var p,h,f,v,b;return{popup:m,dialog:g}})({popup:()=>_.fromOption(L.popupUi.get().map(e=>e.sink),"(popup) UI has not been rendered"),dialog:()=>_.fromOption(L.dialogUi.get().map(e=>e.sink),"UI has not been rendered")},R,e,t);return{popups:{backstage:Z.popup,getMothership:()=>oA("popups",W)},dialogs:{backstage:Z.dialog,getMothership:()=>oA("dialogs",U)},renderUI:()=>{i={attributes:{"data-alloy-vertical-dir":G?Tl.BottomToTop:Tl.TopToBottom}},o=fT.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:Z.popup,onEscape:()=>{R.focus()}}),n=fT.parts.toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:Z.popup.shared.getSink,providers:Z.popup.shared.providers,onEscape:()=>{R.focus()},onToolbarToggled:e=>{R.dispatch("ToggleToolbarDrawer",{state:e})},type:$,lazyToolbar:K,lazyHeader:()=>Y().getOrDie("Could not find header element"),...i}),t=fT.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:Z.popup.shared.providers,onEscape:()=>{R.focus()},type:$}),e=Yh(R),r=qh(R),s=jh(R),a=Ph(R),l=fT.parts.promotion({dom:{tag:"div",classes:["tox-promotion"]}}),a=a?[l,o]:[o],l=fT.parts.header({dom:{tag:"div",classes:["tox-editor-header"].concat(e||r||s?[]:["tox-editor-header--empty"]),...i},components:Se([s?a:[],e?[t]:r?[n]:[],Zh(R)?[]:[q.asSpec()]]),sticky:tf(R),editor:R,sharedBackstage:Z.popup.shared}),o={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[fT.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),fT.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}})]},i=fT.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:Z.popup}),s=fT.parts.viewWrapper({backstage:Z.popup}),a=Rh(R)&&!V?Q.some(tA(R,Z.popup.shared.providers)):Q.none(),e=Se([G?[]:[l],V?[]:[o],G?[l]:[]]),t=fT.parts.editorContainer({components:Se([e,V?[]:[X.asSpec(),...a.toArray()]])}),r=ef(R),n={role:"application",...Lp.isRtl()?{dir:"rtl"}:{},...r?{"aria-hidden":"true"}:{}},o=ai(fT.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(V?["tox-tinymce-inline"]:[]).concat(G?["tox-tinymce--toolbar-bottom"]:[]).concat(j),styles:{visibility:"hidden",...r?{opacity:"0",border:"0"}:{}},attributes:n},components:[t,...V?[]:[s],i],behaviours:re([db(),ae.config({disableClass:"tox-tinymce--disabled"}),se.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),l=Rx(o),P.set(l);var e={mothership:l,outerContainer:o},t=(a=Qh(R),a=kt(Gt(),a)&&"grid"===no(a,"display"),r={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(j),attributes:{...Lp.isRtl()?{dir:"rtl"}:{}}},behaviours:re([gd.config({useFixed:()=>H.isDocked(Y)})])},n={dom:{styles:{width:document.body.clientWidth+"px"}},events:qa([ne(Da(),e=>{oe(e.element,"width",document.body.clientWidth+"px")})])},r=ai(Fn(r,a?n:{})),a=Rx(r),U.set(a),{sink:r,mothership:a}),o=of(R)?(s={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-silver-popup-sink","tox-tinymce-aux"].concat(j),attributes:{...Lp.isRtl()?{dir:"rtl"}:{}}},behaviours:re([gd.config({useFixed:()=>H.isDocked(Y),getBounds:()=>N.getPopupSinkBounds()})])},s=ai(s),i=Rx(s),W.set(i),{sink:s,mothership:i}):(l=t,W.set(l.mothership),l),n=(L.dialogUi.set(t),L.popupUi.set(o),L.mainUi.set(e),{popupUi:o,dialogUi:t,mainUi:e,uiMotherships:L.getUiMotherships()}),{mainUi:r,popupUi:a,uiMotherships:s}=n,{buttons:i,menuItems:l,contextToolbars:o,sidebars:t,views:e}=(ze(yh(R),(e,t)=>{R.ui.registry.addGroupToolbarButton(t,e)}),R.ui.registry.getAll()),c=Xh(R),l={menuItems:l,menus:nf(R),menubar:Oh(R),toolbar:c.getOrThunk(()=>_h(R)),allowToolbarGroups:$===Zp.floating,buttons:i,sidebar:t,views:e},d=r.outerContainer;R.addShortcut("alt+F9","focus menubar",()=>{fT.focusMenubar(d)}),R.addShortcut("alt+F10","focus toolbar",()=>{fT.focusToolbar(d)}),R.addCommand("ToggleToolbarDrawer",(e,t)=>{null!=t&&t.skipFocus?fT.toggleToolbarDrawerWithoutFocusing(d):fT.toggleToolbarDrawer(d)}),R.addQueryStateHandler("ToggleToolbarDrawer",()=>fT.isToolbarDrawerToggled(d));{var u=R,m=r.mothership,g=s;const h=(t,o)=>{ee([m,...g],e=>{e.broadcastEvent(t,o)})},f=(t,o)=>{ee([m,...g],e=>{e.broadcastOn([t],o)})},v=e=>f(Rd(),{target:e.target}),b=un(),y=Jl(b,"touchstart",v),x=Jl(b,"touchmove",e=>h(Ea(),e)),w=Jl(b,"touchend",e=>h(Aa(),e)),S=Jl(b,"mousedown",v),k=Jl(b,"mouseup",e=>{0===e.raw.button&&f(Vd(),{target:e.target})}),C=e=>f(Rd(),{target:te(e.target)}),O=e=>{0===e.button&&f(Vd(),{target:te(e.target)})},_=()=>{ee(u.editorManager.get(),e=>{u!==e&&e.dispatch("DismissPopups",{relatedTarget:u})})},T=e=>h(Ma(),Ql(e)),E=e=>{f(Nd(),{}),h(Da(),Ql(e))},A=Lt(te(u.getElement())),M=Zl(A,"scroll",t=>{requestAnimationFrame(()=>{var e;null!=u.getContainer()&&(e=Sx(u,m.element).map(e=>[e.element,...e.others]).getOr([]),ge(e,e=>kt(e,t.target)))&&(u.dispatch("ElementScroll",{target:t.target.dom}),h(za(),t))})}),D=()=>f(Nd(),{}),B=e=>{e.state&&f(Rd(),{target:te(u.getContainer())})},F=e=>{f(Rd(),{target:te(e.relatedTarget.getContainer())})};u.on("PostRender",()=>{u.on("click",C),u.on("tap",C),u.on("mouseup",O),u.on("mousedown",_),u.on("ScrollWindow",T),u.on("ResizeWindow",E),u.on("ResizeEditor",D),u.on("AfterProgressState",B),u.on("DismissPopups",F)}),u.on("remove",()=>{u.off("click",C),u.off("tap",C),u.off("mouseup",O),u.off("mousedown",_),u.off("ScrollWindow",T),u.off("ResizeWindow",E),u.off("ResizeEditor",D),u.off("AfterProgressState",B),u.off("DismissPopups",F),S.unbind(),y.unbind(),x.unbind(),w.unbind(),k.unbind(),M.unbind()}),u.on("detach",()=>{ee([m,...g],Ed),ee([m,...g],e=>e.destroy())})}H.setup(R,Z.popup.shared,Y),q1(R,Z.popup),mE(R,Z.popup.shared.getSink,Z.popup);{var p=R;const I=p.ui.registry.getAll()["sidebars"];ee(Re(I),t=>{const e=I[t],o=()=>Xe(Q.from(p.queryCommandValue("ToggleSidebar")),t);p.ui.registry.addToggleButton(t,{icon:e.icon,tooltip:e.tooltip,onAction:e=>{p.execCommand("ToggleSidebar",!1,t),e.setActive(o())},onSetup:e=>{e.setActive(o());const t=()=>e.setActive(o());return p.on("ToggleSidebar",t),()=>{p.off("ToggleSidebar",t)}}})})}return S_(R,J,Z.popup.shared),z1(R,o,a.sink,{backstage:Z.popup}),JE(R,a.sink),e={targetNode:R.getElement(),height:(c=r.outerContainer,i=g1((e=>{const t=ih(e),o=dh(e),n=mh(e);return m1(t).map(e=>p1(e,o,n))})(i=R).getOr(ih(i))),t=g1((t=R,h1(t).getOr(lh(t)))),R.inline||(io("div","width",t)&&oe(c.element,"width",t),io("div","height",i)?oe(c.element,"height",i):oe(c.element,"height","400px")),i)},z.render(R,n,l,Z.popup,e)}}},rA=T([A("lazySink"),d("dragBlockClass"),Nr("getBounds",yn),M("useTabstopAt",J),M("firstTabstop",0),M("eventOrder",{}),Gd("modalBehaviours",[se]),Mi("onExecute"),Bi("onEscape")]),aA={sketch:w},sA=T([xu({name:"draghandle",overrides:(e,t)=>({behaviours:re([qE.config({mode:"mouse",getTarget:e=>mi(e,'[role="dialog"]').getOr(e),blockerClass:e.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])})}),bu({schema:[A("dom")],name:"title"}),bu({factory:aA,schema:[A("dom")],name:"close"}),bu({factory:aA,schema:[A("dom")],name:"body"}),xu({factory:aA,schema:[A("dom")],name:"footer"}),yu({factory:{sketch:(e,t)=>({...e,dom:t.dom,components:t.components})},schema:[M("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),M("components",[])],name:"blocker"})]),iA=ju({name:"ModalDialog",configFields:rA(),partFields:sA(),factory:(n,e,t,r)=>{const a=Yl(),o=I("modal-events"),s={...n.eventOrder,[Ba()]:[o].concat(n.eventOrder["alloy.system.attached"]||[])};return{uid:n.uid,dom:n.dom,components:e,apis:{show:e=>{a.set(e);var t=n.lazySink(e).getOrDie(),o=r.blocker(),o=t.getSystem().build({...o,components:o.components.concat([si(e)]),behaviours:re([z.config({}),V("dialog-blocker-events",[ts(ra(),()=>{y_.isBlocked(e)||se.focusIn(e)})])])});xd(t,o),se.focusIn(e)},hide:t=>{a.clear(),At(t.element).each(e=>{t.getSystem().getByDom(e).each(e=>{kd(e)})})},getBody:e=>Du(e,n,"body"),getFooter:e=>Mu(e,n,"footer"),setIdle:e=>{y_.unblock(e)},setBusy:(e,t)=>{y_.block(e,t)}},eventOrder:s,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:qd(n.modalBehaviours,[N.config({}),se.config({mode:"cyclic",onEnter:n.onExecute,onEscape:n.onEscape,useTabstopAt:n.useTabstopAt,firstTabstop:n.firstTabstop}),y_.config({getRoot:a.get}),V(o,[os(e=>{var t,o;t=e.element,o=Du(e,n,"title").element,e=Kt(t,"id").fold(()=>{var e=I("dialog-label");return O(o,"id",e),e},w),O(t,"aria-labelledby",e)})])])}},apis:{show:(e,t)=>{e.show(t)},hide:(e,t)=>{e.hide(t)},getBody:(e,t)=>e.getBody(t),getFooter:(e,t)=>e.getFooter(t),setBusy:(e,t,o)=>{e.setBusy(t,o)},setIdle:(e,t)=>{e.setIdle(t)}}}),lA=E([qf,Xf].concat(Wv)),cA=tr,dA=[xv("button"),iv,Ir("align","end",["start","end"]),hv,pv,Tr("buttonType",["primary","secondary"])],uA=[...dA,Kf],mA=[yr("type",["submit","cancel","custom"]),...uA],gA=[yr("type",["menu"]),sv,lv,iv,kr("items",lA),...dA],pA=[...dA,yr("type",["togglebutton"]),br("tooltip"),iv,sv,Rr("active",!1)],hA=mr("type",{submit:mA,cancel:mA,custom:mA,menu:gA,togglebutton:pA}),fA=[qf,Kf,yr("level",["info","warn","error","success"]),Zf,M("url","")],vA=E(fA),bA=[qf,Kf,pv,xv("button"),iv,gv,Tr("buttonType",["primary","secondary","toolbar"]),hv],yA=E(bA),xA=[qf,Xf],wA=xA.concat([cv]),SA=xA.concat([Yf,pv]),kA=E(SA),CA=tr,OA=wA.concat([fv("auto")]),_A=E(OA),TA=Kn([Qf,Kf,Zf]),EA=wA.concat([Fr("storageKey","default")]),AA=E(EA),MA=er,DA=E(wA),BA=er,FA=xA.concat([Fr("tag","textarea"),br("scriptId"),br("scriptUrl"),Dr("settings",void 0,rr)]),IA=xA.concat([Fr("tag","textarea"),xr("init")]),RA=sr(e=>lr("customeditor.old",$n(IA),e).orThunk(()=>lr("customeditor.new",$n(FA),e))),NA=er,VA=E(wA),zA=qn(Un),HA=e=>[qf,vr("columns",Qn),e],LA=[qf,br("html"),Ir("presets","presentation",["presentation","document"])],PA=E(LA),UA=wA.concat([Rr("border",!1),Rr("sandboxed",!0),Rr("streamContent",!1),Rr("transparent",!0)]),WA=E(UA),jA=er,GA=E(xA.concat([_r("height")])),$A=E([br("url"),Or("zoom"),Or("cachedWidth"),Or("cachedHeight")]),qA=wA.concat([_r("inputMode"),_r("placeholder"),Rr("maximized",!1),pv]),XA=E(qA),YA=er,KA=[Kf,Qf],JA=[Kf,kr("items",gr(0,()=>ZA))],ZA=Xn([E(KA),E(JA)]),QA=wA.concat([kr("items",ZA),pv]),eM=E(QA),tM=er,oM=wA.concat([Sr("items",[Kf,Qf]),Br("size",1),pv]),nM=E(oM),rM=er,aM=wA.concat([Rr("constrain",!0),pv]),sM=E(aM),iM=E([br("width"),br("height")]),lM=xA.concat([Yf,Br("min",0),Br("max",0)]),cM=E(lM),dM=Qn,uM=[qf,kr("header",er),kr("cells",qn(er))],mM=E(uM),gM=wA.concat([_r("placeholder"),Rr("maximized",!1),pv]),pM=E(gM),hM=er,fM=[yr("type",["directory","leaf"]),Jf,br("id"),Cr("menu",o_)],vM=E(fM),bM=fM.concat([kr("children",gr(0,()=>ar("type",{directory:yM,leaf:vM})))]),yM=E(bM),xM=ar("type",{directory:yM,leaf:vM}),wM=[qf,kr("items",xM),Er("onLeafAction"),Er("onToggleExpand"),Vr("defaultExpandedIds",[],er),_r("defaultSelectedId")],SM=E(wM),kM=wA.concat([Ir("filetype","file",["image","media","file"]),pv]),CM=E(kM),OM=E([Qf,vv]),_M=t=>pr("items","items",{tag:"required",process:{}},qn(sr(e=>lr("Checking item of "+t,TM,e).fold(e=>_.error(ur(e)),e=>_.value(e))))),TM=Gn(()=>{return ar("type",{alertbanner:vA,bar:E((e=_M("bar"),[qf,e])),button:yA,checkbox:kA,colorinput:AA,colorpicker:DA,dropzone:VA,grid:E(HA(_M("grid"))),iframe:WA,input:XA,listbox:eM,selectbox:nM,sizeinput:sM,slider:cM,textarea:pM,urlinput:CM,customeditor:RA,htmlpanel:PA,imagepreview:GA,collection:_A,label:E((e=_M("label"),[qf,Yf,e,Ir("align","start",["start","center","end"])])),table:mM,tree:SM,panel:AM});var e}),EM=[qf,M("classes",[]),kr("items",TM)],AM=E(EM),MM=[xv("tab"),Jf,kr("items",TM)],DM=[qf,Sr("tabs",MM)],BM=E(DM),FM=uA,IM=hA,RM=E([br("title"),vr("body",ar("type",{panel:AM,tabpanel:BM})),Fr("size","normal"),Vr("buttons",[],IM),M("initialData",{}),Nr("onAction",S),Nr("onChange",S),Nr("onSubmit",S),Nr("onClose",S),Nr("onCancel",S),Nr("onTabChange",S)]),NM=E([yr("type",["cancel","custom"]),...FM]),VM=E([br("title"),br("url"),Or("height"),Or("width"),Ar("buttons",NM),Nr("onAction",S),Nr("onCancel",S),Nr("onClose",S),Nr("onMessage",S)]),zM=e=>v(e)?[e].concat(ke(Ge(e),zM)):c(e)?ke(e,zM):[],HM=e=>L(e.type)&&L(e.name),LM={checkbox:CA,colorinput:MA,colorpicker:BA,dropzone:zA,input:YA,iframe:jA,imagepreview:$A,selectbox:rM,sizeinput:iM,slider:dM,listbox:tM,size:iM,textarea:hM,urlinput:OM,customeditor:NA,collection:TA,togglemenuitem:cA},PM=e=>{e=e;e=ve(zM(e),HM),e=ke(e,t=>{return e=t,Q.from(LM[e.type]).fold(()=>[],e=>[vr(t.name,e)]);var e});return E(e)},UM=e=>{return{internalDialog:cr(lr("dialog",RM,e)),dataValidator:PM(e),initialData:null!=(e=e.initialData)?e:{}}},WM={open:(e,t)=>{t=UM(t);return e(t.internalDialog,t.initialData,t.dataValidator)},openUrl:(e,t)=>e(cr(lr("dialog",VM,t))),redial:e=>UM(e)};Kc=Object.freeze({__proto__:null,events:(n,r)=>{const a=(t,o)=>{n.updateState.each(e=>{e=e(t,o);r.set(e)}),n.renderComponents.each(e=>{e=e(o,r.get());(n.reuseDom?Jg:Kg)(t,e)})};return qa([ne(xa(),(e,t)=>{var o=t;if(!o.universal){const t=n.channel;me(o.channels,t)&&a(e,o.data)}}),os((t,e)=>{n.initialData.each(e=>{a(t,e)})})])}}),Nm=Object.freeze({__proto__:null,getState:(e,t,o)=>o}),vg=[A("channel"),d("renderComponents"),d("updateState"),d("initialData"),Rr("reuseDom",!0)];const jM=Sl({fields:vg,name:"reflecting",active:Kc,apis:Nm,state:Object.freeze({__proto__:null,init:()=>{const e=D(Q.none());return{readState:()=>e.get().getOr("none"),get:e.get,set:e.set,clear:()=>e.set(Q.none())}}})}),GM=e=>{const o=[],n={};return Ve(e,(e,t)=>{e.fold(()=>{o.push(t)},e=>{n[t]=e})}),0<o.length?_.error(o):_.value(n)},$M=(e,o,n)=>{var t,r=ie(G0.sketch(t=>({dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:k(e.items,e=>oC(t,e,o,n))})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[r.asSpec()]}],behaviours:re([se.config({mode:"acyclic",useTabstopAt:q(pS)}),(t=r,R.config({find:t.getOpt})),((o,e)=>{const n=dr("RepresentingConfigs.memento processors",eS,e);return y.config({store:{mode:"manual",getValue:e=>{e=o.get(e),e=y.getValue(e);return n.postprocess(e)},setValue:(e,t)=>{t=n.preprocess(t),e=o.get(e);y.setValue(e,t)}}})})(r,{postprocess:e=>GM(e).fold(e=>(console.error(e),{}),w)}),V("dialog-body-panel",[ne(ra(),(e,t)=>{e.getSystem().broadcastOn([xS],{newFocus:Q.some(t.event.target)})})])])}},qM=Wu({name:"TabButton",configFields:[M("uid",void 0),A("value"),pr("dom","dom",Vn(()=>({attributes:{role:"tab",id:I("aria"),"aria-selected":"false"}})),Jn()),d("action"),M("domModification",{}),Gd("tabButtonBehaviours",[z,se,y]),A("view")],factory:(e,t)=>({uid:e.uid,dom:e.dom,components:e.components,events:dp(e.action),behaviours:qd(e.tabButtonBehaviours,[z.config({}),se.config({mode:"execution",useSpace:!0,useEnter:!0}),y.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification})}),XM=T([A("tabs"),A("dom"),M("clickToDismiss",!1),Gd("tabbarBehaviours",[x,se]),Ei(["tabClass","selectedClass"])]),YM=wu({factory:qM,name:"tabs",unit:"tab",overrides:n=>{return{action:e=>{var t=e.getSystem().getByUid(n.uid).getOrDie(),o=x.isHighlighted(t,e);(o&&n.clickToDismiss?(e,t)=>{x.dehighlight(e,t),F(e,La(),{tabbar:e,button:t})}:o?S:(e,t)=>{x.highlight(e,t),F(e,Ha(),{tabbar:e,button:t})})(t,e)},domModification:{classes:[n.markers.tabClass]}}}}),KM=T([YM]),JM=ju({name:"Tabbar",configFields:XM(),partFields:KM(),factory:(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:qd(e.tabbarBehaviours,[x.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:(e,t)=>{O(t.element,"aria-selected","true")},onDehighlight:(e,t)=>{O(t.element,"aria-selected","false")}}),se.config({mode:"flow",getInitial:e=>x.getHighlighted(e).map(e=>e.element),selector:"."+e.markers.tabClass,executeOnMove:!0})])})}),ZM=Wu({name:"Tabview",configFields:[Gd("tabviewBehaviours",[N])],factory:(e,t)=>({uid:e.uid,dom:e.dom,behaviours:qd(e.tabviewBehaviours,[N.config({})]),domModification:{attributes:{role:"tabpanel"}}})}),QM=T([M("selectFirst",!0),e("onChangeTab"),e("onDismissTab"),M("tabs",[]),Gd("tabSectionBehaviours",[])]),eD=bu({factory:JM,schema:[A("dom"),wr("markers",[A("tabClass"),A("selectedClass")])],name:"tabbar",defaults:e=>({tabs:e.tabs})}),tD=bu({factory:ZM,name:"tabview"}),oD=T([eD,tD]),nD=ju({name:"TabSection",configFields:QM(),partFields:oD(),factory:(r,e,t,o)=>{const n=(e,t)=>{Mu(e,r,"tabbar").each(e=>{t(e).each(Wa)})};return{uid:r.uid,dom:r.dom,components:e,behaviours:$d(r.tabSectionBehaviours),events:qa(Se([r.selectFirst?[os((e,t)=>{n(e,x.getFirst)})]:[],[ne(Ha(),(e,t)=>{{var o=t.event.button;const n=y.getValue(o);Mu(o,r,"tabview").each(t=>{xe(r.tabs,e=>e.value===n).each(e=>{e=e.view();Kt(o.element,"id").each(e=>{O(t.element,"aria-labelledby",e)}),N.set(t,e),r.onChangeTab(t,o,e)})})}}),ne(La(),(e,t)=>{t=t.event.button;r.onDismissTab(e,t)})]])),apis:{getViewItems:e=>Mu(e,r,"tabview").map(e=>N.contents(e)).getOr([]),showTab:(e,o)=>{n(e,t=>{var e=x.getCandidates(t);return xe(e,e=>y.getValue(e)===o).filter(e=>!x.isHighlighted(t,e))})}}}},apis:{getViewItems:(e,t)=>e.getViewItems(t),showTab:(e,t,o)=>{e.showTab(t,o)}}}),rD=(e,t)=>{oe(e,"height",t+"px"),oe(e,"flex-basis",t+"px")},aD=(e,i,t)=>{mi(e,'[role="dialog"]').each(s=>{pi(s,'[role="tablist"]').each(a=>{t.get().map(e=>{return oe(i,"height","0"),oe(i,"flex-basis","0"),Math.min(e,(e=s,t=i,o=a,n=Tt(e).dom,r=mi(e,".tox-dialog-wrap").getOr(e),r="fixed"===no(r,"position")?Math.max(n.clientHeight,window.innerHeight):Math.max(n.offsetHeight,n.scrollHeight),n=go(t),t=t.dom.offsetLeft>=o.dom.offsetLeft+wo(o)?Math.max(go(o),n):n,o=parseInt(no(e,"margin-top"),10)||0,n=parseInt(no(e,"margin-bottom"),10)||0,r-(go(e)+o+n-t)));var t,o,n,r}).each(e=>{rD(i,e)})})})},sD=e=>pi(e,'[role="tabpanel"]'),iD="send-data-to-section",lD="send-data-to-view",cD=(e,o,n)=>{const r=D({}),a=e=>{var e=y.getValue(e),e=GM(e).getOr({}),t=r.get(),t=Fn(t,e);r.set(t)},s=e=>{var t=r.get();y.setValue(e,t)},i=D(null),t=k(e.tabs,e=>({value:e.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"]},components:[ti(n.shared.providers.translate(e.title))],view:()=>[G0.sketch(t=>({dom:{tag:"div",classes:["tox-form"]},components:k(e.items,e=>oC(t,e,o,n)),formBehaviours:re([se.config({mode:"acyclic",useTabstopAt:q(pS)}),V("TabView.form.events",[os(s),ns(a)]),_l.config({channels:Pr([{key:iD,value:{onReceive:a}},{key:lD,value:{onReceive:s}}])})])}))]})),l=(a=>{const s=Yl(),e=[os(n=>{const r=n.element;sD(r).each(t=>{var e,o;oe(t,"visibility","hidden"),n.getSystem().getByDom(t).toOptional().each(e=>{o=a,n=t,r=e;var o,n,r,e=k(o,(e,t)=>{N.set(r,o[t].view());t=n.dom.getBoundingClientRect();return N.set(r,[]),t.height});e=e,De(Ae(e,(e,t)=>t<e?-1:e<t?1:0)).fold(s.clear,s.set)}),aD(r,t,s),lo(t,"visibility"),e=a,o=n,De(e).each(e=>nD.showTab(o,e.value)),requestAnimationFrame(()=>{aD(r,t,s)})})}),ne(Da(),e=>{const t=e.element;sD(t).each(e=>{aD(t,e,s)})}),ne(Zx,(e,t)=>{const r=e.element;sD(r).each(t=>{var e=Dl(Lt(t)),o=(oe(t,"visibility","hidden"),ao(t,"height").map(e=>parseInt(e,10)));lo(t,"height"),lo(t,"flex-basis");const n=t.dom.getBoundingClientRect().height;o.forall(e=>n>e)?(s.set(n),aD(r,t,s)):o.each(e=>{rD(t,e)}),lo(t,"visibility"),e.each(El)})})];return{extraEvents:e,selectFirst:!1}})(t);return nD.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:(e,t,o)=>{t=y.getValue(t);F(e,Jx,{name:t,oldName:i.get()}),i.set(t)},tabs:t,components:[nD.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[JM.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:re([Hx.config({})])}),nD.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:l.selectFirst,tabSectionBehaviours:re([V("tabpanel",l.extraEvents),se.config({mode:"acyclic"}),R.config({find:e=>De(nD.getViewItems(e))}),tS(Q.none(),e=>(e.getSystem().broadcastOn([iD],{}),r.get()),(e,t)=>{r.set(t),e.getSystem().broadcastOn([lD],{})})])})},dD=(e,t,o,n,r)=>({dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:{...o.map(e=>({id:e})).getOr({}),...r?{"aria-live":"polite"}:{}}},components:[],behaviours:re([Q0(0),jM.config({channel:vS+"-"+t,updateState:(e,t)=>Q.some({isTabPanel:()=>"tabpanel"===t.body.type}),renderComponents:e=>{var t=e.body;return"tabpanel"===t.type?[cD(t,e.initialData,n)]:[$M(t,e.initialData,n)]},initialData:e})])});function uD(e){return(uD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mD(e,t){return(mD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gD(e,t,o){return(gD=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),1}catch(e){}}}()?Reflect.construct:function(e,t,o){var n=[null],t=(n.push.apply(n,t),new(Function.bind.apply(e,n)));return o&&mD(t,o.prototype),t}).apply(null,arguments)}function pD(e){return function(e){if(Array.isArray(e))return hD(e)}(e)||function(){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}()||function(e){var t;if(e)return"string"==typeof e?hD(e,void 0):"Map"===(t="Object"===(t=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?hD(e,void 0):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hD(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function fD(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return _D(vD,t)}var vD,bD=Object.hasOwnProperty,yD=Object.setPrototypeOf,xD=Object.isFrozen,wD=Object.getPrototypeOf,SD=Object.getOwnPropertyDescriptor,kD=Object.freeze,bc=Object.seal,CD=Object.create,zx="undefined"!=typeof Reflect&&Reflect,OD=(OD=zx.apply)||function(e,t,o){return e.apply(t,o)},kD=kD||function(e){return e},bc=bc||function(e){return e},_D=(_D=zx.construct)||function(e,t){return gD(e,pD(t))},TD=ND(Array.prototype.forEach),ED=ND(Array.prototype.pop),AD=ND(Array.prototype.push),MD=ND(String.prototype.toLowerCase),DD=ND(String.prototype.match),BD=ND(String.prototype.replace),FD=ND(String.prototype.indexOf),ID=ND(String.prototype.trim),RD=ND(RegExp.prototype.test);vD=TypeError;function ND(r){return function(e){for(var t=arguments.length,o=new Array(1<t?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];return OD(r,e,o)}}function VD(e,t){yD&&yD(e,null);for(var o=t.length;o--;){var n,r=t[o];"string"==typeof r&&(n=MD(r))!==r&&(xD(t)||(t[o]=n),r=n),e[r]=!0}return e}function zD(e){var t,o=CD(null);for(t in e)OD(bD,e,[t])&&(o[t]=e[t]);return o}function HD(e,t){for(;null!==e;){var o=SD(e,t);if(o){if(o.get)return ND(o.get);if("function"==typeof o.value)return ND(o.value)}e=wD(e)}return function(e){return console.warn("fallback value for",e),null}}var LD=kD(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),PD=kD(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),UD=kD(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),WD=kD(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),jD=kD(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),GD=kD(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),$D=kD(["#text"]),qD=kD(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),XD=kD(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),YD=kD(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),KD=kD(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),JD=bc(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ZD=bc(/<%[\w\W]*|[\w\W]*%>/gm),QD=bc(/^data-[\-\w.\u00B7-\uFFFF]/),eB=bc(/^aria-[\-\w]+$/),tB=bc(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),oB=bc(/^(?:\w+script|data):/i),nB=bc(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),rB=bc(/^html$/i),aB=function R(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,c=function(e){return R(e)};if(c.version="2.3.8",c.removed=[],i&&i.document&&9===i.document.nodeType){var l=i.document,r=i.document,N=i.DocumentFragment,e=i.HTMLTemplateElement,d=i.Node,V=i.Element,t=i.NodeFilter,o=i.NamedNodeMap,z=void 0===o?i.NamedNodeMap||i.MozNamedAttrMap:o,H=i.HTMLFormElement,L=i.DOMParser,o=i.trustedTypes,n=V.prototype,P=HD(n,"cloneNode"),U=HD(n,"nextSibling"),W=HD(n,"childNodes"),u=HD(n,"parentNode"),m=("function"==typeof e&&(n=r.createElement("template")).content&&n.content.ownerDocument&&(r=n.content.ownerDocument),function(e,t){if("object"!==uD(e)||"function"!=typeof e.createPolicy)return null;var o=null,n="data-tt-policy-suffix",t="dompurify"+((o=t.currentScript&&t.currentScript.hasAttribute(n)?t.currentScript.getAttribute(n):o)?"#"+o:"");try{return e.createPolicy(t,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+t+" could not be created."),null}}(o,l)),j=m?m.createHTML(""):"",e=r,a=e.implementation,G=e.createNodeIterator,$=e.createDocumentFragment,q=e.getElementsByTagName,X=l.importNode,n={};try{n=zD(r).documentMode?r.documentMode:{}}catch(R){}var s={};c.isSupported="function"==typeof u&&a&&void 0!==a.createHTMLDocument&&9!==n;var g,p,Y,K=JD,J=ZD,Z=QD,Q=eB,ee=oB,te=nB,oe=tB,h=null,ne=VD({},[].concat(pD(LD),pD(PD),pD(UD),pD(jD),pD($D))),f=null,re=VD({},[].concat(pD(qD),pD(XD),pD(YD),pD(KD))),v=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),b=null,ae=null,se=!0,ie=!0,le=!1,y=!1,x=!1,ce=!1,de=!1,w=!1,S=!1,k=!1,ue=!0,me=!0,C=!1,O={},_=null,ge=VD({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),pe=null,he=VD({},["audio","video","img","source","image","track"]),fe=null,ve=VD({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),be="http://www.w3.org/1998/Math/MathML",ye="http://www.w3.org/2000/svg",T="http://www.w3.org/1999/xhtml",E=T,xe=["application/xhtml+xml","text/html"],A=null,we=r.createElement("form"),Se=function(e){return e instanceof RegExp||e instanceof Function},ke=function(e){A&&A===e||(e=zD(e=e&&"object"===uD(e)?e:{}),h="ALLOWED_TAGS"in e?VD({},e.ALLOWED_TAGS):ne,f="ALLOWED_ATTR"in e?VD({},e.ALLOWED_ATTR):re,fe="ADD_URI_SAFE_ATTR"in e?VD(zD(ve),e.ADD_URI_SAFE_ATTR):ve,pe="ADD_DATA_URI_TAGS"in e?VD(zD(he),e.ADD_DATA_URI_TAGS):he,_="FORBID_CONTENTS"in e?VD({},e.FORBID_CONTENTS):ge,b="FORBID_TAGS"in e?VD({},e.FORBID_TAGS):{},ae="FORBID_ATTR"in e?VD({},e.FORBID_ATTR):{},O="USE_PROFILES"in e&&e.USE_PROFILES,se=!1!==e.ALLOW_ARIA_ATTR,ie=!1!==e.ALLOW_DATA_ATTR,le=e.ALLOW_UNKNOWN_PROTOCOLS||!1,y=e.SAFE_FOR_TEMPLATES||!1,x=e.WHOLE_DOCUMENT||!1,w=e.RETURN_DOM||!1,S=e.RETURN_DOM_FRAGMENT||!1,k=e.RETURN_TRUSTED_TYPE||!1,de=e.FORCE_BODY||!1,ue=!1!==e.SANITIZE_DOM,me=!1!==e.KEEP_CONTENT,C=e.IN_PLACE||!1,oe=e.ALLOWED_URI_REGEXP||oe,E=e.NAMESPACE||T,e.CUSTOM_ELEMENT_HANDLING&&Se(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(v.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Se(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(v.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(v.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),g=-1===xe.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,p="application/xhtml+xml"===g?function(e){return e}:MD,y&&(ie=!1),S&&(w=!0),O&&(h=VD({},pD($D)),f=[],!0===O.html&&(VD(h,LD),VD(f,qD)),!0===O.svg&&(VD(h,PD),VD(f,XD),VD(f,KD)),!0===O.svgFilters&&(VD(h,UD),VD(f,XD),VD(f,KD)),!0===O.mathMl)&&(VD(h,jD),VD(f,YD),VD(f,KD)),e.ADD_TAGS&&VD(h=h===ne?zD(h):h,e.ADD_TAGS),e.ADD_ATTR&&VD(f=f===re?zD(f):f,e.ADD_ATTR),e.ADD_URI_SAFE_ATTR&&VD(fe,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&VD(_=_===ge?zD(_):_,e.FORBID_CONTENTS),me&&(h["#text"]=!0),x&&VD(h,["html","head","body"]),h.table&&(VD(h,["tbody"]),delete b.tbody),kD&&kD(e),A=e)},Ce=VD({},["mi","mo","mn","ms","mtext"]),Oe=VD({},["foreignobject","desc","title","annotation-xml"]),_e=VD({},["title","style","font","a","script"]),M=VD({},PD),Te=(VD(M,UD),VD(M,WD),VD({},jD)),D=(VD(Te,GD),function(t){AD(c.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=j}catch(e){t.remove()}}}),B=function(e,t){try{AD(c.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){AD(c.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!f[e])if(w||S)try{D(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Ee=function(e){de?e="<remove></remove>"+e:o=(o=DD(e,/^[\r\n\t ]+/))&&o[0],"application/xhtml+xml"===g&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var t,o,n=m?m.createHTML(e):e;if(E===T)try{t=(new L).parseFromString(n,g)}catch(e){}if(!t||!t.documentElement){t=a.createDocument(E,"template",null);try{t.documentElement.innerHTML=Y?"":n}catch(e){}}n=t.body||t.documentElement;return e&&o&&n.insertBefore(r.createTextNode(o),n.childNodes[0]||null),E===T?q.call(t,x?"html":"body")[0]:x?t.documentElement:n},Ae=function(e){return G.call(e.ownerDocument||e,e,t.SHOW_ELEMENT|t.SHOW_COMMENT|t.SHOW_TEXT,null,!1)},F=function(e){return"object"===uD(d)?e instanceof d:e&&"object"===uD(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},I=function(e,t,o){s[e]&&TD(s[e],function(e){e.call(c,t,o,A)})},Me=function(e){if(I("beforeSanitizeElements",e,null),(!((a=e)instanceof H)||"string"==typeof a.nodeName&&"string"==typeof a.textContent&&"function"==typeof a.removeChild&&a.attributes instanceof z&&"function"==typeof a.removeAttribute&&"function"==typeof a.setAttribute&&"string"==typeof a.namespaceURI&&"function"==typeof a.insertBefore)&&!RD(/[\u0080-\uFFFF]/,e.nodeName)){var t,o,n,r,a=p(e.nodeName);if(I("uponSanitizeElement",e,{tagName:a,allowedTags:h}),(!e.hasChildNodes()||F(e.firstElementChild)||F(e.content)&&F(e.content.firstElementChild)||!RD(/<[/\w]/g,e.innerHTML)||!RD(/<[/\w]/g,e.textContent))&&("select"!==a||!RD(/<template/i,e.innerHTML))){if(h[a]&&!b[a])return(!(e instanceof V)||((o=u(t=e))&&o.tagName||(o={namespaceURI:T,tagName:"template"}),n=MD(t.tagName),r=MD(o.tagName),t.namespaceURI===ye?o.namespaceURI===T?"svg"===n:o.namespaceURI===be?"svg"===n&&("annotation-xml"===r||Ce[r]):Boolean(M[n]):t.namespaceURI===be?o.namespaceURI===T?"math"===n:o.namespaceURI===ye?"math"===n&&Oe[r]:Boolean(Te[n]):t.namespaceURI===T&&(o.namespaceURI!==ye||Oe[r])&&(o.namespaceURI!==be||Ce[r])&&!Te[n]&&(_e[n]||!M[n])))&&("noscript"!==a&&"noembed"!==a||!RD(/<\/no(script|embed)/i,e.innerHTML))?(y&&3===e.nodeType&&(t=e.textContent,t=BD(t,K," "),t=BD(t,J," "),e.textContent!==t)&&(AD(c.removed,{element:e.cloneNode()}),e.textContent=t),I("afterSanitizeElements",e,null),!1):(D(e),!0);if(!b[a]&&Be(a)){if(v.tagNameCheck instanceof RegExp&&RD(v.tagNameCheck,a))return!1;if(v.tagNameCheck instanceof Function&&v.tagNameCheck(a))return!1}if(me&&!_[a]){var s=u(e)||e.parentNode,i=W(e)||e.childNodes;if(i&&s)for(var l=i.length-1;0<=l;--l)s.insertBefore(P(i[l],!0),U(e))}}}return D(e),!0},De=function(e,t,o){if(ue&&("id"===t||"name"===t)&&(o in r||o in we))return!1;if((!ie||ae[t]||!RD(Z,t))&&(!se||!RD(Q,t)))if(!f[t]||ae[t]){if(!(Be(e)&&(v.tagNameCheck instanceof RegExp&&RD(v.tagNameCheck,e)||v.tagNameCheck instanceof Function&&v.tagNameCheck(e))&&(v.attributeNameCheck instanceof RegExp&&RD(v.attributeNameCheck,t)||v.attributeNameCheck instanceof Function&&v.attributeNameCheck(t))||"is"===t&&v.allowCustomizedBuiltInElements&&(v.tagNameCheck instanceof RegExp&&RD(v.tagNameCheck,o)||v.tagNameCheck instanceof Function&&v.tagNameCheck(o))))return!1}else if(!fe[t]&&!RD(oe,BD(o,te,""))&&("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==FD(o,"data:")||!pe[e])&&(!le||RD(ee,BD(o,te,"")))&&o)return!1;return!0},Be=function(e){return 0<e.indexOf("-")},Fe=function(e){I("beforeSanitizeAttributes",e,null);var t,o=e.attributes;if(o){for(var n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:f},r=o.length;r--;){t=o[r];var a=t.name,s=t.namespaceURI,i="value"===a?t.value:ID(t.value),l=p(a),c=i;if(n.attrName=l,n.attrValue=i,n.keepAttr=!0,n.forceKeepAttr=void 0,I("uponSanitizeAttribute",e,n),i=n.attrValue,!n.forceKeepAttr)if(n.keepAttr)if(RD(/\/>/i,i))B(a,e);else{y&&(i=BD(i,K," "),i=BD(i,J," "));var d=p(e.nodeName);if(De(d,l,i)){if(i!==c)try{s?e.setAttributeNS(s,a,i):e.setAttribute(a,i)}catch(t){B(a,e)}}else B(a,e)}else B(a,e)}I("afterSanitizeAttributes",e,null)}},Ie=function e(t){var o,n=Ae(t);for(I("beforeSanitizeShadowDOM",t,null);o=n.nextNode();)I("uponSanitizeShadowNode",o,null),Me(o)||(o.content instanceof N&&e(o.content),Fe(o));I("afterSanitizeShadowDOM",t,null)};c.sanitize=function(e,t){var o,n,r,a;if("string"!=typeof(e=(Y=!e)?"\x3c!--\x3e":e)&&!F(e)){if("function"!=typeof e.toString)throw fD("toString is not a function");if("string"!=typeof(e=e.toString()))throw fD("dirty is not a string, aborting")}if(!c.isSupported){if("object"===uD(i.toStaticHTML)||"function"==typeof i.toStaticHTML){if("string"==typeof e)return i.toStaticHTML(e);if(F(e))return i.toStaticHTML(e.outerHTML)}return e}if(ce||ke(t),c.removed=[],C="string"==typeof e?!1:C){if(e.nodeName){var t=p(e.nodeName);if(!h[t]||b[t])throw fD("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof d)1===(t=(o=Ee("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===t.nodeName||"HTML"===t.nodeName?o=t:o.appendChild(t);else{if(!w&&!y&&!x&&-1===e.indexOf("<"))return m&&k?m.createHTML(e):e;if(!(o=Ee(e)))return w?null:k?j:""}o&&de&&D(o.firstChild);for(var s=Ae(C?e:o);n=s.nextNode();)3===n.nodeType&&n===r||Me(n)||(n.content instanceof N&&Ie(n.content),Fe(n),r=n);if(r=null,C)return e;if(w){if(S)for(a=$.call(o.ownerDocument);o.firstChild;)a.appendChild(o.firstChild);else a=o;return a=f.shadowroot?X.call(l,a,!0):a}t=x?o.outerHTML:o.innerHTML;return x&&h["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&RD(rB,o.ownerDocument.doctype.name)&&(t="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+t),y&&(t=BD(t,K," "),t=BD(t,J," ")),m&&k?m.createHTML(t):t},c.setConfig=function(e){ke(e),ce=!0},c.clearConfig=function(){A=null,ce=!1},c.isValidAttribute=function(e,t,o){A||ke({});e=p(e),t=p(t);return De(e,t,o)},c.addHook=function(e,t){"function"==typeof t&&(s[e]=s[e]||[],AD(s[e],t))},c.removeHook=function(e){if(s[e])return ED(s[e])},c.removeHooks=function(e){s[e]&&(s[e]=[])},c.removeAllHooks=function(){s={}}}else c.isSupported=!1;return c}();const sB=e=>aB().sanitize(e),iB=oh.deviceType.isTouch(),lB=(e,t)=>({dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}),cB=(e,t)=>iA.parts.close(Hp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:re([Hx.config({})])})),dB=()=>iA.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}}),uB=(e,t)=>iA.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:x_(`<p>${sB(t.translate(e))}</p>`)}]}]}),mB=e=>iA.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e}),gB=(e,t)=>[Ix.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),Ix.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})],pB=t=>{const e="tox-dialog",o=e+"-wrap",n=o+"__backdrop",r=e+"__disable-scroll";return iA.sketch({lazySink:t.lazySink,onEscape:e=>(t.onEscape(e),Q.some(!0)),useTabstopAt:e=>!pS(e),firstTabstop:t.firstTabstop,dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:{position:"relative",...t.extraStyles}},components:[t.header,t.body,...t.footer.toArray()],parts:{blocker:{dom:x_(`<div class="${o}"></div>`),components:[{dom:{tag:"div",classes:iB?[n,n+"--opaque"]:[n]}}]}},dragBlockClass:o,modalBehaviours:re([z.config({}),V("dialog-events",t.dialogEvents.concat([ts(ra(),(e,t)=>{y_.isBlocked(e)||se.focusIn(e)}),ne(Na(),(e,t)=>{e.getSystem().broadcastOn([xS],{newFocus:t.event.newFocus})})])),V("scroll-lock",[os(()=>{Ps(Gt(),r)}),ns(()=>{Us(Gt(),r)})]),...t.extraBehaviours]),eventOrder:{[wa()]:["dialog-events"],[Ba()]:["scroll-lock","dialog-events","alloy.base.behaviour"],[Fa()]:["alloy.base.behaviour","dialog-events","scroll-lock"],...t.eventOrder}})},hB=e=>Hp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),title:e.translate("Close")}},buttonBehaviours:re([Hx.config({})]),components:[Yp("close",{tag:"span",classes:["tox-icon"]},e.icons)],action:e=>{B(e,$x)}}),fB=(e,t,o,n)=>({dom:{tag:"div",classes:["tox-dialog__title"],attributes:{...o.map(e=>({id:e})).getOr({})}},components:[],behaviours:re([jM.config({channel:fS+"-"+t,initialData:e,renderComponents:e=>[ti(n.translate(e.title))]})])}),vB=()=>({dom:x_('<div class="tox-dialog__draghandle"></div>')}),bB=(e,t,o)=>{return e={title:o.shared.providers.translate(e),draggable:o.dialog.isDraggableModal()},t=t,o=o.shared.providers,t=iA.parts.title(fB(e,t,Q.none(),o)),n=iA.parts.draghandle(vB()),o=iA.parts.close(hB(o)),t=[t].concat(e.draggable?[n]:[]).concat([o]),Ix.sketch({dom:x_('<div class="tox-dialog__header"></div>'),components:t});var n},yB=(e,t,o,n)=>({dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":o.translate(e)},styles:{left:"0px",right:"0px",bottom:"0px",top:n.getOr(0)+"px",position:"absolute"}},behaviours:t,components:[{dom:x_('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),xB=(e,r,t)=>({onClose:()=>t.closeWindow(),onBlock:o=>{const n=pi(e().element,".tox-dialog__header").map(e=>go(e));iA.setBusy(e(),(e,t)=>yB(o.message,t,r,n))},onUnblock:()=>{iA.setIdle(e())}}),wB=(e,t,o,n)=>ai(pB({...e,firstTabstop:1,lazySink:n.shared.getSink,extraBehaviours:[jM.config({channel:hS+"-"+e.id,updateState:(e,t)=>Q.some(t),initialData:t}),nS({}),...e.extraBehaviours],onEscape:e=>{B(e,$x)},dialogEvents:o,eventOrder:{[xa()]:[jM.name(),_l.name()],[Ba()]:["scroll-lock",jM.name(),"messages","dialog-events","alloy.base.behaviour"],[Fa()]:["alloy.base.behaviour","dialog-events","messages",jM.name(),"scroll-lock"]}})),SB=(e,n={})=>k(e,e=>{return"menu"===e.type?(t=e,o=k(t.items,e=>{var t=C(n,e.name).getOr(D(!1));return{...e,storage:t}}),{...t,items:o}):e;var t,o}),kB=e=>ye(e,(e,t)=>"menu"===t.type?ye(t.items,(e,t)=>(e[t.name]=t.storage,e),e):e,{}),CB=(e,r)=>[Qa(ra(),gS),e(Gx,(e,t,o,n)=>{Dl(Lt(n.element)).fold(S,Al),r.onClose(),t.onClose()}),e($x,(e,t,o,n)=>{t.onCancel(e),B(n,Gx)}),ne(Kx,(e,t)=>r.onUnblock()),ne(Yx,(e,t)=>r.onBlock(t.event))],OB=(s,e,l)=>{const t=(e,a)=>ne(e,(o,n)=>{var t,r;t=o,r=(e,t)=>{a(s(),e,n.event,o)},jM.getState(t).get().each(e=>{r(e.internalDialog,t)})});return[...CB(t,e),t(Xx,(e,t)=>t.onSubmit(e)),t(jx,(e,t,o)=>{t.onChange(e,{name:o.name})}),t(qx,(e,t,o,n)=>{const r=()=>n.getSystem().isConnected()?se.focusIn(n):void 0,a=e=>Jt(e,"disabled")||Kt(e,"aria-disabled").exists(e=>"true"===e),s=Lt(n.element),i=Dl(s);t.onAction(e,{name:o.name,value:o.value}),Dl(s).fold(r,t=>{a(t)||i.exists(e=>Ct(t,e)&&a(e))?r():l().toOptional().filter(e=>!Ct(e.element,t)).each(r)})}),t(Jx,(e,t,o)=>{t.onTabChange(e,{newTabName:o.name,oldTabName:o.oldName})}),ns(e=>{var t=s();y.setValue(e,t.getData())})]},_B=(e,t)=>{var t=t.map(e=>e.footerButtons).getOr([]),t=fe(t,e=>"start"===e.align),o=(e,t)=>Ix.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+e]},components:k(t,e=>e.memento.asSpec())});return[o("start",t.pass),o("end",t.fail)]},TB=(e,t,n)=>({dom:x_('<div class="tox-dialog__footer"></div>'),components:[],behaviours:re([jM.config({channel:bS+"-"+t,initialData:e,updateState:(r,e)=>{const a=k(e.buttons,e=>{var t,o=ie((o=e,t=n,jk(o,o.type,t)));return{name:e.name,align:e.align,memento:o}});return Q.some({lookupByName:e=>{return t=r,o=a,n=e,xe(o,e=>e.name===n).bind(e=>e.memento.getOpt(t));var t,o,n},footerButtons:a})},renderComponents:_B})])}),EB=(e,t,o)=>iA.parts.footer(TB(e,t,o)),AB=(e,t)=>{var o;return e.getRoot().getSystem().isConnected()?(o=R.getCurrent(e.getFormWrapper()).getOr(e.getFormWrapper()),G0.getField(o,t).orThunk(()=>{return e.getFooter().bind(e=>jM.getState(e).get()).bind(e=>e.lookupByName(t))})):Q.none()},MB=(s,a,i)=>{const e=e=>{var t=s.getRoot();t.getSystem().isConnected()&&e(t)},l={getData:()=>{var e=s.getRoot(),e=e.getSystem().isConnected()?s.getFormWrapper():e;return{...y.getValue(e),...ze(i,e=>e.get())}},setData:a=>{e(e=>{const t=l.getData(),o=Fn(t,a),n=((e,t)=>{e=e.getRoot();return jM.getState(e).get().map(e=>cr(lr("data",e.dataValidator,t))).getOr(t)})(s,o),r=s.getFormWrapper();y.setValue(r,n),Ve(i,(e,t)=>{$e(o,t)&&e.set(o[t])})})},setEnabled:(e,t)=>{AB(s,e).each(t?ae.enable:ae.disable)},focus:e=>{AB(s,e).each(z.focus)},block:t=>{if(!L(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");e(e=>{F(e,Yx,{message:t})})},unblock:()=>{e(e=>{B(e,Kx)})},showTab:o=>{e(e=>{var t=s.getBody();jM.getState(t).get().exists(e=>e.isTabPanel())&&R.getCurrent(t).each(e=>{nD.showTab(e,o)})})},redial:r=>{e(e=>{var t=s.getId(),o=a(r),n=SB(o.internalDialog.buttons,i);e.getSystem().broadcastOn([hS+"-"+t],o),e.getSystem().broadcastOn([fS+"-"+t],o.internalDialog),e.getSystem().broadcastOn([vS+"-"+t],o.internalDialog),e.getSystem().broadcastOn([bS+"-"+t],{...o.internalDialog,buttons:n}),l.setData(o.initialData)})},close:()=>{e(e=>{B(e,Gx)})},toggleFullscreen:s.toggleFullscreen};return l},DB=(e,t,r,o=!1)=>{const n=I("dialog"),a=I("dialog-label"),s=I("dialog-content"),i=e.internalDialog,l="medium"===i.size?Q.some("tox-dialog--width-md"):Q.none(),c=ie((b={title:i.title,draggable:!0},y=n,x=a,w=r.shared.providers,Ix.sketch({dom:x_('<div class="tox-dialog__header"></div>'),components:[fB(b,y,Q.some(x),w),vB(),hB(w)],containerBehaviours:re([qE.config({mode:"mouse",blockerClass:"blocker",getTarget:e=>hi(e,'[role="dialog"]').getOrDie(),snaps:{getSnapPoints:()=>[],leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),d=ie((b={body:i.body,initialData:i.initialData},y=n,x=s,w=r,o=o,dD(b,y,Q.some(x),w,o))),u=SB(i.buttons),m=kB(u),g=Ze(0!==u.length,ie((b={buttons:u},y=n,x=r,TB(b,y,x)))),p=OB(()=>v,{onBlock:n=>{y_.block(f,(e,t)=>{var o=c.getOpt(f).map(e=>go(e.element));return yB(n.message,t,r.shared.providers,o)})},onUnblock:()=>{y_.unblock(f)},onClose:()=>t.closeWindow()},r.shared.getSink),h="tox-dialog-inline",f=ai({dom:{tag:"div",classes:["tox-dialog",h,...l.toArray()],attributes:{role:"dialog","aria-labelledby":a}},eventOrder:{[xa()]:[jM.name(),_l.name()],[wa()]:["execute-on-form"],[Ba()]:["reflecting","execute-on-form"]},behaviours:re([se.config({mode:"cyclic",onEscape:e=>(B(e,Gx),Q.some(!0)),useTabstopAt:e=>!pS(e)&&("button"!==gt(e)||"disabled"!==Yt(e,"disabled")),firstTabstop:1}),jM.config({channel:hS+"-"+n,updateState:(e,t)=>Q.some(t),initialData:e}),z.config({}),V("execute-on-form",p.concat([ts(ra(),(e,t)=>{se.focusIn(e)}),ne(Na(),(e,t)=>{e.getSystem().broadcastOn([xS],{newFocus:t.event.newFocus})})])),y_.config({getRoot:()=>Q.some(f)}),N.config({}),nS({})]),components:[c.asSpec(),d.asSpec(),...g.map(e=>e.asSpec()).toArray()]}),v=MB({getId:T(n),getRoot:T(f),getFooter:()=>g.map(e=>e.get(f)),getBody:()=>d.get(f),getFormWrapper:()=>{var e=d.get(f);return R.getCurrent(e).getOr(e)},toggleFullscreen:()=>{var e="tox-dialog--fullscreen",t=te(f.element.dom);$s(t,[e])?(Gs(t,[e]),js(t,[h])):(Gs(t,[h]),js(t,[e]))}},t.redial,m);var b,y,x,w;return{dialog:f,instanceApi:v}};var BB=tinymce.util.Tools.resolve("tinymce.util.URI");const FB=["insertContent","setContent","execCommand","close","block","unblock"],IB=e=>v(e)&&-1!==FB.indexOf(e.mceAction),RB=(s,e,i,t)=>{const o=I("dialog"),n=bB(s.title,o,t),r=(e=>{e={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[uS(Q.none(),{dom:{tag:"iframe",attributes:{src:e.url}},behaviours:re([Hx.config({}),z.config({})])})]}],behaviours:re([se.config({mode:"acyclic",useTabstopAt:q(pS)})])};return iA.parts.body(e)})(s),a=s.buttons.bind(e=>0===e.length?Q.none():Q.some(EB({buttons:e},o,t))),l=(e=>{const t=(e,r)=>ne(e,(o,n)=>{a(o,(e,t)=>{r(f,e,n.event,o)})}),a=(t,o)=>{jM.getState(t).get().each(e=>{o(e,t)})};return[...CB(t,e),t(qx,(e,t,o)=>{t.onAction(e,{name:o.name})})]})(xB(()=>h,t.shared.providers,e)),c={...s.height.fold(()=>({}),e=>({height:e+"px","max-height":e+"px"})),...s.width.fold(()=>({}),e=>({width:e+"px","max-width":e+"px"}))},d=s.width.isNone()&&s.height.isNone()?["tox-dialog--width-lg"]:[],u=new BB(s.url,{base_uri:new BB(window.location.href)}),m=u.protocol+"://"+u.host+(u.port?":"+u.port:""),g=Xl(),p=[V("messages",[os(()=>{var e=Jl(te(window),"message",e=>{if(u.isSameOrigin(new BB(e.raw.origin))){e=e.raw.data;if(IB(e)){var t=i,o=f,n=e;switch(n.mceAction){case"insertContent":t.insertContent(n.content);break;case"setContent":t.setContent(n.content);break;case"execCommand":var r=!!b(n.ui)&&n.ui;t.execCommand(n.cmd,r,n.value);break;case"close":o.close();break;case"block":o.block(n.message);break;case"unblock":o.unblock()}}else a=e,!IB(a)&&v(a)&&$e(a,"mceAction")&&s.onMessage(f,e)}var a});g.set(e)}),ns(g.clear)]),_l.config({channels:{[yS]:{onReceive:(e,t)=>{pi(e.element,"iframe").each(e=>{e=e.dom.contentWindow;W(e)&&e.postMessage(t,m)})}}}})],h=wB({id:o,header:n,body:r,footer:a,extraClasses:d,extraBehaviours:p,extraStyles:c},s,l,t),f=(t=>{const e=e=>{t.getSystem().isConnected()&&e(t)};return{block:t=>{if(!L(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");e(e=>{F(e,Yx,{message:t})})},unblock:()=>{e(e=>{B(e,Kx)})},close:()=>{e(e=>{B(e,Gx)})},sendMessage:t=>{e(e=>{e.getSystem().broadcastOn([yS],t)})}}})(h);return{dialog:h,instanceApi:f}},NB=(e,t)=>cr(lr("data",t,e)),VB=e=>Cx(e,".tox-alert-dialog")||Cx(e,".tox-confirm-dialog"),zB=g=>{const p=g.editor,h=tf(p),o=(i=>{const l=i.shared;return{open:(e,t)=>{const o=()=>{iA.hide(s),t()},n=ie(jk({name:"close-alert",text:"OK",primary:!0,buttonType:Q.some("primary"),align:"end",enabled:!0,icon:Q.none()},"cancel",i)),r=dB(),a=cB(o,l.providers),s=ai(pB({lazySink:()=>l.getSink(),header:lB(r,a),body:uB(e,l.providers),footer:Q.some(mB(gB([],[n.asSpec()]))),onEscape:o,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[ne($x,o)],eventOrder:{}}));iA.show(s);e=n.get(s);z.focus(e)}}})(g.backstages.dialog),n=(l=>{const c=l.shared;return{open:(e,t)=>{const o=e=>{iA.hide(i),t(e)},n=ie(jk({name:"yes",text:"Yes",primary:!0,buttonType:Q.some("primary"),align:"end",enabled:!0,icon:Q.none()},"submit",l)),r=jk({name:"no",text:"No",primary:!1,buttonType:Q.some("secondary"),align:"end",enabled:!0,icon:Q.none()},"cancel",l),a=dB(),s=cB(()=>o(!1),c.providers),i=ai(pB({lazySink:()=>c.getSink(),header:lB(a,s),body:uB(e,c.providers),footer:Q.some(mB(gB([],[r,n.asSpec()]))),onEscape:()=>o(!1),extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[ne($x,()=>o(!1)),ne(Xx,()=>o(!0))],eventOrder:{}}));iA.show(i);e=n.get(i);z.focus(e)}}})(g.backstages.dialog),r=(e,d,u,m)=>WM.open((e,t,o)=>{const n=NB(t,o),r=Yl(),a=g.backstages.popup.shared.header.isPositionedAtTop(),s=()=>r.on(e=>{Vp.reposition(e),WO.refresh(e)}),i=DB({dataValidator:o,initialData:n,internalDialog:e},{redial:WM.redial,closeWindow:()=>{r.on(Vp.hide),p.off("ResizeEditor",s),r.clear(),u(i.instanceApi)}},g.backstages.popup,m.ariaAttrs),l=ai(Vp.sketch({lazySink:g.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:m.persistent?{event:"doNotDismissYet"}:{},...a?{}:{fireRepositionEventInstead:{}},inlineBehaviours:re([V("window-manager-inline-events",[ne(Ia(),(e,t)=>{B(i.dialog,$x)})]),...(c=p,t=h,o=a,t&&o?[]:[WO.config({contextual:{lazyContext:()=>Q.some(fn(te(c.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"],lazyViewport:e=>Sx(c,e.element).map(e=>({bounds:kx(e),optScrollEnv:Q.some({currentScrollTop:e.element.dom.scrollTop,scrollElmTop:bo(e.element).top})})).getOrThunk(()=>({bounds:yn(),optScrollEnv:Q.none()}))})])]),isExtraPart:(e,t)=>VB(t)}));var c;return r.set(l),Vp.showWithinBounds(l,si(i.dialog),{anchor:d},()=>{var e=p.inline?Gt():te(p.getContainer()),e=fn(e);return Q.some(e)}),h&&a||(WO.refresh(l),p.on("ResizeEditor",s)),i.instanceApi.setData(n),se.focusIn(i.dialog),i.instanceApi},e);return{open:(e,t,o)=>{if(!P(t)){if("toolbar"===t.inline)return r(e,g.backstages.popup.shared.anchors.inlineDialog(),o,t);if("bottom"===t.inline)return n=e,c=g.backstages.popup.shared.anchors.inlineBottomDialog(),d=o,u=t,WM.open((e,t,o)=>{const n=NB(t,o),r=Yl(),a=g.backstages.popup.shared.header.isPositionedAtTop(),s=()=>r.on(e=>{Vp.reposition(e),WO.refresh(e)}),i=DB({dataValidator:o,initialData:n,internalDialog:e},{redial:WM.redial,closeWindow:()=>{r.on(Vp.hide),p.off("ResizeEditor ScrollWindow ElementScroll",s),r.clear(),d(i.instanceApi)}},g.backstages.popup,u.ariaAttrs),l=ai(Vp.sketch({lazySink:g.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:u.persistent?{event:"doNotDismissYet"}:{},...a?{}:{fireRepositionEventInstead:{}},inlineBehaviours:re([V("window-manager-inline-events",[ne(Ia(),(e,t)=>{B(i.dialog,$x)})]),WO.config({contextual:{lazyContext:()=>Q.some(fn(te(p.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top","bottom"],lazyViewport:e=>Sx(p,e.element).map(e=>({bounds:kx(e),optScrollEnv:Q.some({currentScrollTop:e.element.dom.scrollTop,scrollElmTop:bo(e.element).top})})).getOrThunk(()=>({bounds:yn(),optScrollEnv:Q.none()}))})]),isExtraPart:(e,t)=>VB(t)}));return r.set(l),Vp.showWithinBounds(l,si(i.dialog),{anchor:c},()=>g.backstages.popup.shared.getSink().toOptional().bind(e=>{var e=Sx(p,e.element).map(e=>kx(e)).getOr(yn()),t=fn(te(p.getContentAreaContainer())),t=bn(t,e);return Q.some(hn(t.x,t.y,t.width,t.height-15))})),WO.refresh(l),p.on("ResizeEditor ScrollWindow ElementScroll",s),i.instanceApi.setData(n),se.focusIn(i.dialog),i.instanceApi},n);if("cursor"===t.inline)return r(e,g.backstages.popup.shared.anchors.cursor(),o,t)}var c,d,u,n,a;return n=e,a=o,WM.open((e,t,o)=>{const n=t,r=((e,t,o)=>{const n=I("dialog"),r=e.internalDialog,a=bB(r.title,n,o),s=((e,t,o)=>{e=dD(e,t,Q.none(),o,!1);return iA.parts.body(e)})({body:r.body,initialData:r.initialData},n,o),i=SB(r.buttons),l=kB(i),c=Ze(0!==i.length,EB({buttons:i},n,o)),d=OB(()=>p,xB(()=>m,o.shared.providers,t),o.shared.getSink),u=(()=>{switch(r.size){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}})(),m=wB({id:n,header:a,body:s,footer:c,extraClasses:u,extraBehaviours:[],extraStyles:{}},e,d,o),g={getId:T(n),getRoot:T(m),getBody:()=>iA.getBody(m),getFooter:()=>iA.getFooter(m),getFormWrapper:()=>{var e=iA.getBody(m);return R.getCurrent(e).getOr(e)},toggleFullscreen:()=>{var e="tox-dialog--fullscreen",t=te(m.element.dom);Ws(t,e)?(Us(t,e),js(t,u)):(Gs(t,u),Ps(t,e))}},p=MB(g,t.redial,l);return{dialog:m,instanceApi:p}})({dataValidator:o,initialData:n,internalDialog:e},{redial:WM.redial,closeWindow:()=>{iA.hide(r.dialog),a(r.instanceApi)}},g.backstages.dialog);return iA.show(r.dialog),r.instanceApi.setData(n),r.instanceApi},n)},openUrl:(e,t)=>{return e=e,o=t,WM.openUrl(e=>{const t=RB(e,{closeWindow:()=>{iA.hide(t.dialog),o(t.instanceApi)}},p,g.backstages.dialog);return iA.show(t.dialog),t.instanceApi},e);var o},alert:(e,t)=>{o.open(e,t)},close:e=>{e.close()},confirm:(e,t)=>{n.open(e,t)}}};wn.add("silver",t=>{var e,o,n,r;e=t,ah(e),n=(o=e).options.register,l=e=>h(e)&&0<e?{value:e,valid:!0}:{valid:!1,message:"Must be a positive number."},n("color_map",{processor:r=e=>p(e,L)?{value:(t=>{var o=[];for(let e=0;e<t.length;e+=2)o.push({text:t[e+1],value:"#"+hy(t[e]).value,icon:"checkmark",type:"choiceitem"});return o})(e),valid:!0}:{valid:!1,message:"Must be an array of strings."},default:["#BFEDD2","Light Green","#FBEEB8","Light Yellow","#F8CAC6","Light Red","#ECCAFA","Light Purple","#C2E0F4","Light Blue","#2DC26B","Green","#F1C40F","Yellow","#E03E2D","Red","#B96AD9","Purple","#3598DB","Blue","#169179","Dark Turquoise","#E67E23","Orange","#BA372A","Dark Red","#843FA1","Dark Purple","#236FA1","Dark Blue","#ECF0F1","Light Gray","#CED4D9","Medium Gray","#95A5A6","Gray","#7E8C8D","Dark Gray","#34495E","Navy Blue","#000000","Black","#ffffff","White"]}),n("color_map_background",{processor:r}),n("color_map_foreground",{processor:r}),n("color_cols",{processor:l,default:wy(o)}),n("color_cols_foreground",{processor:l,default:Sy(o,fy)}),n("color_cols_background",{processor:l,default:Sy(o,vy)}),n("custom_colors",{processor:"boolean",default:!0}),n("color_default_foreground",{processor:"string",default:yy}),n("color_default_background",{processor:"string",default:yy}),(r=e.options.register)("contextmenu_avoid_overlap",{processor:"string",default:""}),r("contextmenu_never_use_native",{processor:"boolean",default:!1}),r("contextmenu",{processor:e=>{return!1===e?{value:[],valid:!0}:L(e)||p(e,L)?{value:(e=e,L(e)?e.split(/[ ,]/):e),valid:!0}:{valid:!1,message:"Must be false or a string."}},default:"link linkchecker image editimage table spellchecker configurepermanentpen"});let a=()=>yn();const{dialogs:s,popups:d,renderUI:i}=nA(t,{getPopupSinkBounds:()=>a()});bx(t,d.backstage.shared);var l=zB({editor:t,backstages:{popup:d.backstage,dialog:s.backstage}});return{renderUI:async()=>{var e=await i();return Sx(t,d.getMothership().element).each(e=>{a=()=>kx(e)}),e},getWindowManagerImpl:T(l),getNotificationManagerImpl:()=>{{var i=t,e={backstage:d.backstage},n=d.getMothership();const l=e.backstage.shared,c=()=>{var e=fn(te(i.getContentAreaContainer())),t=yn(),o=qi(t.x,e.x,e.right),n=qi(t.y,e.y,e.bottom),r=Math.max(e.right,t.right),e=Math.max(e.bottom,t.bottom);return Q.some(hn(o,n,r-o,e-n))};return{open:(e,t)=>{const o=()=>{t(),Vp.hide(a)},r=ai(Jp.sketch({text:e.text,level:me(["success","error","warning","warn","info"],e.type)?e.type:void 0,progress:!0===e.progressBar,icon:e.icon,closeButton:e.closeButton,onAction:o,iconProvider:l.providers.icons,translationProvider:l.providers.translate})),a=ai(Vp.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:l.getSink,fireDismissalEventInstead:{},...l.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}}})),s=(n.add(a),h(e.timeout)&&0<e.timeout&&zp.setEditorTimeout(i,()=>{o()},e.timeout),{close:o,reposition:()=>{const t=si(r),o={maxHeightFunction:ac()},n=i.notificationManager.getNotifications();if(n[0]===s){const i={...l.anchors.banner(),overrides:o};Vp.showWithinBounds(a,t,{anchor:i},c)}else ue(n,s).each(e=>{e=n[e-1].getEl(),e={type:"node",root:Gt(),node:Q.some(te(e)),overrides:o,layouts:{onRtl:()=>[il],onLtr:()=>[il]}};Vp.showWithinBounds(a,t,{anchor:e},c)})},text:e=>{Jp.updateText(r,e)},settings:e,getEl:()=>r.element.dom,progressBar:{value:e=>{Jp.updateProgress(r,e)}}});return s},close:e=>{e.close()},getArgs:e=>e.settings}}}}})}();